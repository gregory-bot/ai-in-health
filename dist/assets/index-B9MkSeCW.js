function BA(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var Zl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function K1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function uj(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var zA={exports:{}},Uy={},UA={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pf=Symbol.for("react.element"),dj=Symbol.for("react.portal"),hj=Symbol.for("react.fragment"),fj=Symbol.for("react.strict_mode"),pj=Symbol.for("react.profiler"),mj=Symbol.for("react.provider"),gj=Symbol.for("react.context"),yj=Symbol.for("react.forward_ref"),xj=Symbol.for("react.suspense"),vj=Symbol.for("react.memo"),bj=Symbol.for("react.lazy"),qT=Symbol.iterator;function wj(t){return t===null||typeof t!="object"?null:(t=qT&&t[qT]||t["@@iterator"],typeof t=="function"?t:null)}var jA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},WA=Object.assign,GA={};function Ou(t,e,n){this.props=t,this.context=e,this.refs=GA,this.updater=n||jA}Ou.prototype.isReactComponent={};Ou.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ou.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function HA(){}HA.prototype=Ou.prototype;function X1(t,e,n){this.props=t,this.context=e,this.refs=GA,this.updater=n||jA}var Y1=X1.prototype=new HA;Y1.constructor=X1;WA(Y1,Ou.prototype);Y1.isPureReactComponent=!0;var KT=Array.isArray,qA=Object.prototype.hasOwnProperty,Z1={current:null},KA={key:!0,ref:!0,__self:!0,__source:!0};function XA(t,e,n){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)qA.call(e,s)&&!KA.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:pf,type:t,key:i,ref:o,props:r,_owner:Z1.current}}function kj(t,e){return{$$typeof:pf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function J1(t){return typeof t=="object"&&t!==null&&t.$$typeof===pf}function Cj(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var XT=/\/+/g;function cv(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Cj(""+t.key):e.toString(36)}function Lm(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case pf:case dj:o=!0}}if(o)return o=t,r=r(o),t=s===""?"."+cv(o,0):s,KT(r)?(n="",t!=null&&(n=t.replace(XT,"$&/")+"/"),Lm(r,e,n,"",function(c){return c})):r!=null&&(J1(r)&&(r=kj(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(XT,"$&/")+"/")+t)),e.push(r)),1;if(o=0,s=s===""?".":s+":",KT(t))for(var a=0;a<t.length;a++){i=t[a];var l=s+cv(i,a);o+=Lm(i,e,n,l,r)}else if(l=wj(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=s+cv(i,a++),o+=Lm(i,e,n,l,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function em(t,e,n){if(t==null)return t;var s=[],r=0;return Lm(t,s,"","",function(i){return e.call(n,i,r++)}),s}function Sj(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ys={current:null},Vm={transition:null},Ij={ReactCurrentDispatcher:ys,ReactCurrentBatchConfig:Vm,ReactCurrentOwner:Z1};function YA(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:em,forEach:function(t,e,n){em(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return em(t,function(){e++}),e},toArray:function(t){return em(t,function(e){return e})||[]},only:function(t){if(!J1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ye.Component=Ou;Ye.Fragment=hj;Ye.Profiler=pj;Ye.PureComponent=X1;Ye.StrictMode=fj;Ye.Suspense=xj;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ij;Ye.act=YA;Ye.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=WA({},t.props),r=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Z1.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)qA.call(e,l)&&!KA.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];s.children=a}return{$$typeof:pf,type:t.type,key:r,ref:i,props:s,_owner:o}};Ye.createContext=function(t){return t={$$typeof:gj,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:mj,_context:t},t.Consumer=t};Ye.createElement=XA;Ye.createFactory=function(t){var e=XA.bind(null,t);return e.type=t,e};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(t){return{$$typeof:yj,render:t}};Ye.isValidElement=J1;Ye.lazy=function(t){return{$$typeof:bj,_payload:{_status:-1,_result:t},_init:Sj}};Ye.memo=function(t,e){return{$$typeof:vj,type:t,compare:e===void 0?null:e}};Ye.startTransition=function(t){var e=Vm.transition;Vm.transition={};try{t()}finally{Vm.transition=e}};Ye.unstable_act=YA;Ye.useCallback=function(t,e){return ys.current.useCallback(t,e)};Ye.useContext=function(t){return ys.current.useContext(t)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(t){return ys.current.useDeferredValue(t)};Ye.useEffect=function(t,e){return ys.current.useEffect(t,e)};Ye.useId=function(){return ys.current.useId()};Ye.useImperativeHandle=function(t,e,n){return ys.current.useImperativeHandle(t,e,n)};Ye.useInsertionEffect=function(t,e){return ys.current.useInsertionEffect(t,e)};Ye.useLayoutEffect=function(t,e){return ys.current.useLayoutEffect(t,e)};Ye.useMemo=function(t,e){return ys.current.useMemo(t,e)};Ye.useReducer=function(t,e,n){return ys.current.useReducer(t,e,n)};Ye.useRef=function(t){return ys.current.useRef(t)};Ye.useState=function(t){return ys.current.useState(t)};Ye.useSyncExternalStore=function(t,e,n){return ys.current.useSyncExternalStore(t,e,n)};Ye.useTransition=function(){return ys.current.useTransition()};Ye.version="18.3.1";UA.exports=Ye;var M=UA.exports;const rr=K1(M),Tj=BA({__proto__:null,default:rr},[M]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nj=M,Ej=Symbol.for("react.element"),$j=Symbol.for("react.fragment"),_j=Object.prototype.hasOwnProperty,Aj=Nj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Rj={key:!0,ref:!0,__self:!0,__source:!0};function ZA(t,e,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)_j.call(e,s)&&!Rj.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:Ej,type:t,key:i,ref:o,props:r,_owner:Aj.current}}Uy.Fragment=$j;Uy.jsx=ZA;Uy.jsxs=ZA;zA.exports=Uy;var w=zA.exports,JA={exports:{}},Ks={},QA={exports:{}},eR={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(A,z){var P=A.length;A.push(z);e:for(;0<P;){var X=P-1>>>1,te=A[X];if(0<r(te,z))A[X]=z,A[P]=te,P=X;else break e}}function n(A){return A.length===0?null:A[0]}function s(A){if(A.length===0)return null;var z=A[0],P=A.pop();if(P!==z){A[0]=P;e:for(var X=0,te=A.length,se=te>>>1;X<se;){var ce=2*(X+1)-1,ie=A[ce],de=ce+1,ge=A[de];if(0>r(ie,P))de<te&&0>r(ge,ie)?(A[X]=ge,A[de]=P,X=de):(A[X]=ie,A[ce]=P,X=ce);else if(de<te&&0>r(ge,P))A[X]=ge,A[de]=P,X=de;else break e}}return z}function r(A,z){var P=A.sortIndex-z.sortIndex;return P!==0?P:A.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(A){for(var z=n(c);z!==null;){if(z.callback===null)s(c);else if(z.startTime<=A)s(c),z.sortIndex=z.expirationTime,e(l,z);else break;z=n(c)}}function b(A){if(m=!1,v(A),!p)if(n(l)!==null)p=!0,G(k);else{var z=n(c);z!==null&&q(b,z.startTime-A)}}function k(A,z){p=!1,m&&(m=!1,g(I),I=-1),f=!0;var P=h;try{for(v(z),d=n(l);d!==null&&(!(d.expirationTime>z)||A&&!D());){var X=d.callback;if(typeof X=="function"){d.callback=null,h=d.priorityLevel;var te=X(d.expirationTime<=z);z=t.unstable_now(),typeof te=="function"?d.callback=te:d===n(l)&&s(l),v(z)}else s(l);d=n(l)}if(d!==null)var se=!0;else{var ce=n(c);ce!==null&&q(b,ce.startTime-z),se=!1}return se}finally{d=null,h=P,f=!1}}var C=!1,S=null,I=-1,N=5,E=-1;function D(){return!(t.unstable_now()-E<N)}function R(){if(S!==null){var A=t.unstable_now();E=A;var z=!0;try{z=S(!0,A)}finally{z?L():(C=!1,S=null)}}else C=!1}var L;if(typeof x=="function")L=function(){x(R)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,W=B.port2;B.port1.onmessage=R,L=function(){W.postMessage(null)}}else L=function(){y(R,0)};function G(A){S=A,C||(C=!0,L())}function q(A,z){I=y(function(){A(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(A){A.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,G(k))},t.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<A?Math.floor(1e3/A):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(A){switch(h){case 1:case 2:case 3:var z=3;break;default:z=h}var P=h;h=z;try{return A()}finally{h=P}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(A,z){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var P=h;h=A;try{return z()}finally{h=P}},t.unstable_scheduleCallback=function(A,z,P){var X=t.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?X+P:X):P=X,A){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=P+te,A={id:u++,callback:z,priorityLevel:A,startTime:P,expirationTime:te,sortIndex:-1},P>X?(A.sortIndex=P,e(c,A),n(l)===null&&A===n(c)&&(m?(g(I),I=-1):m=!0,q(b,P-X))):(A.sortIndex=te,e(l,A),p||f||(p=!0,G(k))),A},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(A){var z=h;return function(){var P=h;h=z;try{return A.apply(this,arguments)}finally{h=P}}}})(eR);QA.exports=eR;var Dj=QA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pj=M,Gs=Dj;function le(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var tR=new Set,ph={};function Jl(t,e){au(t,e),au(t+"Capture",e)}function au(t,e){for(ph[t]=e,t=0;t<e.length;t++)tR.add(e[t])}var eo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_b=Object.prototype.hasOwnProperty,Oj=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,YT={},ZT={};function Fj(t){return _b.call(ZT,t)?!0:_b.call(YT,t)?!1:Oj.test(t)?ZT[t]=!0:(YT[t]=!0,!1)}function Mj(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Lj(t,e,n,s){if(e===null||typeof e>"u"||Mj(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function xs(t,e,n,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Fn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Fn[t]=new xs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Fn[e]=new xs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Fn[t]=new xs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Fn[t]=new xs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Fn[t]=new xs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Fn[t]=new xs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Fn[t]=new xs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Fn[t]=new xs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Fn[t]=new xs(t,5,!1,t.toLowerCase(),null,!1,!1)});var Q1=/[\-:]([a-z])/g;function ek(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Q1,ek);Fn[e]=new xs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Q1,ek);Fn[e]=new xs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Q1,ek);Fn[e]=new xs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Fn[t]=new xs(t,1,!1,t.toLowerCase(),null,!1,!1)});Fn.xlinkHref=new xs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Fn[t]=new xs(t,1,!1,t.toLowerCase(),null,!0,!0)});function tk(t,e,n,s){var r=Fn.hasOwnProperty(e)?Fn[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Lj(e,n,r,s)&&(n=null),s||r===null?Fj(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var go=Pj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tm=Symbol.for("react.element"),Ic=Symbol.for("react.portal"),Tc=Symbol.for("react.fragment"),nk=Symbol.for("react.strict_mode"),Ab=Symbol.for("react.profiler"),nR=Symbol.for("react.provider"),sR=Symbol.for("react.context"),sk=Symbol.for("react.forward_ref"),Rb=Symbol.for("react.suspense"),Db=Symbol.for("react.suspense_list"),rk=Symbol.for("react.memo"),Ro=Symbol.for("react.lazy"),rR=Symbol.for("react.offscreen"),JT=Symbol.iterator;function hd(t){return t===null||typeof t!="object"?null:(t=JT&&t[JT]||t["@@iterator"],typeof t=="function"?t:null)}var Wt=Object.assign,uv;function Rd(t){if(uv===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);uv=e&&e[1]||""}return`
`+uv+t}var dv=!1;function hv(t,e){if(!t||dv)return"";dv=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var s=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){s=c}t.call(e.prototype)}else{try{throw Error()}catch(c){s=c}t()}}catch(c){if(c&&s&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,a=i.length-1;1<=o&&0<=a&&r[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==i[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{dv=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Rd(t):""}function Vj(t){switch(t.tag){case 5:return Rd(t.type);case 16:return Rd("Lazy");case 13:return Rd("Suspense");case 19:return Rd("SuspenseList");case 0:case 2:case 15:return t=hv(t.type,!1),t;case 11:return t=hv(t.type.render,!1),t;case 1:return t=hv(t.type,!0),t;default:return""}}function Pb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Tc:return"Fragment";case Ic:return"Portal";case Ab:return"Profiler";case nk:return"StrictMode";case Rb:return"Suspense";case Db:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case sR:return(t.displayName||"Context")+".Consumer";case nR:return(t._context.displayName||"Context")+".Provider";case sk:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case rk:return e=t.displayName||null,e!==null?e:Pb(t.type)||"Memo";case Ro:e=t._payload,t=t._init;try{return Pb(t(e))}catch{}}return null}function Bj(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pb(e);case 8:return e===nk?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function da(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function iR(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function zj(t){var e=iR(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function nm(t){t._valueTracker||(t._valueTracker=zj(t))}function oR(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=iR(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function dg(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ob(t,e){var n=e.checked;return Wt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function QT(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=da(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function aR(t,e){e=e.checked,e!=null&&tk(t,"checked",e,!1)}function Fb(t,e){aR(t,e);var n=da(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Mb(t,e.type,n):e.hasOwnProperty("defaultValue")&&Mb(t,e.type,da(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function eN(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Mb(t,e,n){(e!=="number"||dg(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Dd=Array.isArray;function Gc(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+da(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Lb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(le(91));return Wt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function tN(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(le(92));if(Dd(n)){if(1<n.length)throw Error(le(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:da(n)}}function lR(t,e){var n=da(e.value),s=da(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function nN(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function cR(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?cR(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var sm,uR=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(sm=sm||document.createElement("div"),sm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=sm.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function mh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var qd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Uj=["Webkit","ms","Moz","O"];Object.keys(qd).forEach(function(t){Uj.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),qd[e]=qd[t]})});function dR(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||qd.hasOwnProperty(t)&&qd[t]?(""+e).trim():e+"px"}function hR(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=dR(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var jj=Wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bb(t,e){if(e){if(jj[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(le(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(le(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(le(61))}if(e.style!=null&&typeof e.style!="object")throw Error(le(62))}}function zb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ub=null;function ik(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var jb=null,Hc=null,qc=null;function sN(t){if(t=yf(t)){if(typeof jb!="function")throw Error(le(280));var e=t.stateNode;e&&(e=qy(e),jb(t.stateNode,t.type,e))}}function fR(t){Hc?qc?qc.push(t):qc=[t]:Hc=t}function pR(){if(Hc){var t=Hc,e=qc;if(qc=Hc=null,sN(t),e)for(t=0;t<e.length;t++)sN(e[t])}}function mR(t,e){return t(e)}function gR(){}var fv=!1;function yR(t,e,n){if(fv)return t(e,n);fv=!0;try{return mR(t,e,n)}finally{fv=!1,(Hc!==null||qc!==null)&&(gR(),pR())}}function gh(t,e){var n=t.stateNode;if(n===null)return null;var s=qy(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(le(231,e,typeof n));return n}var Wb=!1;if(eo)try{var fd={};Object.defineProperty(fd,"passive",{get:function(){Wb=!0}}),window.addEventListener("test",fd,fd),window.removeEventListener("test",fd,fd)}catch{Wb=!1}function Wj(t,e,n,s,r,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Kd=!1,hg=null,fg=!1,Gb=null,Gj={onError:function(t){Kd=!0,hg=t}};function Hj(t,e,n,s,r,i,o,a,l){Kd=!1,hg=null,Wj.apply(Gj,arguments)}function qj(t,e,n,s,r,i,o,a,l){if(Hj.apply(this,arguments),Kd){if(Kd){var c=hg;Kd=!1,hg=null}else throw Error(le(198));fg||(fg=!0,Gb=c)}}function Ql(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function xR(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function rN(t){if(Ql(t)!==t)throw Error(le(188))}function Kj(t){var e=t.alternate;if(!e){if(e=Ql(t),e===null)throw Error(le(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return rN(r),t;if(i===s)return rN(r),e;i=i.sibling}throw Error(le(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,s=i;break}if(a===s){o=!0,s=r,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,s=r;break}if(a===s){o=!0,s=i,n=r;break}a=a.sibling}if(!o)throw Error(le(189))}}if(n.alternate!==s)throw Error(le(190))}if(n.tag!==3)throw Error(le(188));return n.stateNode.current===n?t:e}function vR(t){return t=Kj(t),t!==null?bR(t):null}function bR(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=bR(t);if(e!==null)return e;t=t.sibling}return null}var wR=Gs.unstable_scheduleCallback,iN=Gs.unstable_cancelCallback,Xj=Gs.unstable_shouldYield,Yj=Gs.unstable_requestPaint,tn=Gs.unstable_now,Zj=Gs.unstable_getCurrentPriorityLevel,ok=Gs.unstable_ImmediatePriority,kR=Gs.unstable_UserBlockingPriority,pg=Gs.unstable_NormalPriority,Jj=Gs.unstable_LowPriority,CR=Gs.unstable_IdlePriority,jy=null,hi=null;function Qj(t){if(hi&&typeof hi.onCommitFiberRoot=="function")try{hi.onCommitFiberRoot(jy,t,void 0,(t.current.flags&128)===128)}catch{}}var Lr=Math.clz32?Math.clz32:nW,eW=Math.log,tW=Math.LN2;function nW(t){return t>>>=0,t===0?32:31-(eW(t)/tW|0)|0}var rm=64,im=4194304;function Pd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function mg(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?s=Pd(a):(i&=o,i!==0&&(s=Pd(i)))}else o=n&~r,o!==0?s=Pd(o):i!==0&&(s=Pd(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-Lr(e),r=1<<n,s|=t[n],e&=~r;return s}function sW(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rW(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Lr(i),a=1<<o,l=r[o];l===-1?(!(a&n)||a&s)&&(r[o]=sW(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Hb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function SR(){var t=rm;return rm<<=1,!(rm&4194240)&&(rm=64),t}function pv(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function mf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Lr(e),t[e]=n}function iW(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Lr(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function ak(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-Lr(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var pt=0;function IR(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var TR,lk,NR,ER,$R,qb=!1,om=[],Xo=null,Yo=null,Zo=null,yh=new Map,xh=new Map,Oo=[],oW="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oN(t,e){switch(t){case"focusin":case"focusout":Xo=null;break;case"dragenter":case"dragleave":Yo=null;break;case"mouseover":case"mouseout":Zo=null;break;case"pointerover":case"pointerout":yh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":xh.delete(e.pointerId)}}function pd(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=yf(e),e!==null&&lk(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function aW(t,e,n,s,r){switch(e){case"focusin":return Xo=pd(Xo,t,e,n,s,r),!0;case"dragenter":return Yo=pd(Yo,t,e,n,s,r),!0;case"mouseover":return Zo=pd(Zo,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return yh.set(i,pd(yh.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,xh.set(i,pd(xh.get(i)||null,t,e,n,s,r)),!0}return!1}function _R(t){var e=sl(t.target);if(e!==null){var n=Ql(e);if(n!==null){if(e=n.tag,e===13){if(e=xR(n),e!==null){t.blockedOn=e,$R(t.priority,function(){NR(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Bm(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Kb(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Ub=s,n.target.dispatchEvent(s),Ub=null}else return e=yf(n),e!==null&&lk(e),t.blockedOn=n,!1;e.shift()}return!0}function aN(t,e,n){Bm(t)&&n.delete(e)}function lW(){qb=!1,Xo!==null&&Bm(Xo)&&(Xo=null),Yo!==null&&Bm(Yo)&&(Yo=null),Zo!==null&&Bm(Zo)&&(Zo=null),yh.forEach(aN),xh.forEach(aN)}function md(t,e){t.blockedOn===e&&(t.blockedOn=null,qb||(qb=!0,Gs.unstable_scheduleCallback(Gs.unstable_NormalPriority,lW)))}function vh(t){function e(r){return md(r,t)}if(0<om.length){md(om[0],t);for(var n=1;n<om.length;n++){var s=om[n];s.blockedOn===t&&(s.blockedOn=null)}}for(Xo!==null&&md(Xo,t),Yo!==null&&md(Yo,t),Zo!==null&&md(Zo,t),yh.forEach(e),xh.forEach(e),n=0;n<Oo.length;n++)s=Oo[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Oo.length&&(n=Oo[0],n.blockedOn===null);)_R(n),n.blockedOn===null&&Oo.shift()}var Kc=go.ReactCurrentBatchConfig,gg=!0;function cW(t,e,n,s){var r=pt,i=Kc.transition;Kc.transition=null;try{pt=1,ck(t,e,n,s)}finally{pt=r,Kc.transition=i}}function uW(t,e,n,s){var r=pt,i=Kc.transition;Kc.transition=null;try{pt=4,ck(t,e,n,s)}finally{pt=r,Kc.transition=i}}function ck(t,e,n,s){if(gg){var r=Kb(t,e,n,s);if(r===null)Sv(t,e,s,yg,n),oN(t,s);else if(aW(r,t,e,n,s))s.stopPropagation();else if(oN(t,s),e&4&&-1<oW.indexOf(t)){for(;r!==null;){var i=yf(r);if(i!==null&&TR(i),i=Kb(t,e,n,s),i===null&&Sv(t,e,s,yg,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else Sv(t,e,s,null,n)}}var yg=null;function Kb(t,e,n,s){if(yg=null,t=ik(s),t=sl(t),t!==null)if(e=Ql(t),e===null)t=null;else if(n=e.tag,n===13){if(t=xR(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return yg=t,null}function AR(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zj()){case ok:return 1;case kR:return 4;case pg:case Jj:return 16;case CR:return 536870912;default:return 16}default:return 16}}var jo=null,uk=null,zm=null;function RR(){if(zm)return zm;var t,e=uk,n=e.length,s,r="value"in jo?jo.value:jo.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===r[i-s];s++);return zm=r.slice(t,1<s?1-s:void 0)}function Um(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function am(){return!0}function lN(){return!1}function Xs(t){function e(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?am:lN,this.isPropagationStopped=lN,this}return Wt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=am)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=am)},persist:function(){},isPersistent:am}),e}var Fu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dk=Xs(Fu),gf=Wt({},Fu,{view:0,detail:0}),dW=Xs(gf),mv,gv,gd,Wy=Wt({},gf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hk,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==gd&&(gd&&t.type==="mousemove"?(mv=t.screenX-gd.screenX,gv=t.screenY-gd.screenY):gv=mv=0,gd=t),mv)},movementY:function(t){return"movementY"in t?t.movementY:gv}}),cN=Xs(Wy),hW=Wt({},Wy,{dataTransfer:0}),fW=Xs(hW),pW=Wt({},gf,{relatedTarget:0}),yv=Xs(pW),mW=Wt({},Fu,{animationName:0,elapsedTime:0,pseudoElement:0}),gW=Xs(mW),yW=Wt({},Fu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),xW=Xs(yW),vW=Wt({},Fu,{data:0}),uN=Xs(vW),bW={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function CW(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=kW[t])?!!e[t]:!1}function hk(){return CW}var SW=Wt({},gf,{key:function(t){if(t.key){var e=bW[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Um(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?wW[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hk,charCode:function(t){return t.type==="keypress"?Um(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Um(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),IW=Xs(SW),TW=Wt({},Wy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dN=Xs(TW),NW=Wt({},gf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hk}),EW=Xs(NW),$W=Wt({},Fu,{propertyName:0,elapsedTime:0,pseudoElement:0}),_W=Xs($W),AW=Wt({},Wy,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),RW=Xs(AW),DW=[9,13,27,32],fk=eo&&"CompositionEvent"in window,Xd=null;eo&&"documentMode"in document&&(Xd=document.documentMode);var PW=eo&&"TextEvent"in window&&!Xd,DR=eo&&(!fk||Xd&&8<Xd&&11>=Xd),hN=" ",fN=!1;function PR(t,e){switch(t){case"keyup":return DW.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function OR(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Nc=!1;function OW(t,e){switch(t){case"compositionend":return OR(e);case"keypress":return e.which!==32?null:(fN=!0,hN);case"textInput":return t=e.data,t===hN&&fN?null:t;default:return null}}function FW(t,e){if(Nc)return t==="compositionend"||!fk&&PR(t,e)?(t=RR(),zm=uk=jo=null,Nc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return DR&&e.locale!=="ko"?null:e.data;default:return null}}var MW={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pN(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!MW[t.type]:e==="textarea"}function FR(t,e,n,s){fR(s),e=xg(e,"onChange"),0<e.length&&(n=new dk("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Yd=null,bh=null;function LW(t){qR(t,0)}function Gy(t){var e=_c(t);if(oR(e))return t}function VW(t,e){if(t==="change")return e}var MR=!1;if(eo){var xv;if(eo){var vv="oninput"in document;if(!vv){var mN=document.createElement("div");mN.setAttribute("oninput","return;"),vv=typeof mN.oninput=="function"}xv=vv}else xv=!1;MR=xv&&(!document.documentMode||9<document.documentMode)}function gN(){Yd&&(Yd.detachEvent("onpropertychange",LR),bh=Yd=null)}function LR(t){if(t.propertyName==="value"&&Gy(bh)){var e=[];FR(e,bh,t,ik(t)),yR(LW,e)}}function BW(t,e,n){t==="focusin"?(gN(),Yd=e,bh=n,Yd.attachEvent("onpropertychange",LR)):t==="focusout"&&gN()}function zW(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Gy(bh)}function UW(t,e){if(t==="click")return Gy(e)}function jW(t,e){if(t==="input"||t==="change")return Gy(e)}function WW(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Wr=typeof Object.is=="function"?Object.is:WW;function wh(t,e){if(Wr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!_b.call(e,r)||!Wr(t[r],e[r]))return!1}return!0}function yN(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function xN(t,e){var n=yN(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=yN(n)}}function VR(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?VR(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function BR(){for(var t=window,e=dg();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=dg(t.document)}return e}function pk(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function GW(t){var e=BR(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&VR(n.ownerDocument.documentElement,n)){if(s!==null&&pk(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=xN(n,i);var o=xN(n,s);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var HW=eo&&"documentMode"in document&&11>=document.documentMode,Ec=null,Xb=null,Zd=null,Yb=!1;function vN(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Yb||Ec==null||Ec!==dg(s)||(s=Ec,"selectionStart"in s&&pk(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Zd&&wh(Zd,s)||(Zd=s,s=xg(Xb,"onSelect"),0<s.length&&(e=new dk("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=Ec)))}function lm(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var $c={animationend:lm("Animation","AnimationEnd"),animationiteration:lm("Animation","AnimationIteration"),animationstart:lm("Animation","AnimationStart"),transitionend:lm("Transition","TransitionEnd")},bv={},zR={};eo&&(zR=document.createElement("div").style,"AnimationEvent"in window||(delete $c.animationend.animation,delete $c.animationiteration.animation,delete $c.animationstart.animation),"TransitionEvent"in window||delete $c.transitionend.transition);function Hy(t){if(bv[t])return bv[t];if(!$c[t])return t;var e=$c[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in zR)return bv[t]=e[n];return t}var UR=Hy("animationend"),jR=Hy("animationiteration"),WR=Hy("animationstart"),GR=Hy("transitionend"),HR=new Map,bN="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ia(t,e){HR.set(t,e),Jl(e,[t])}for(var wv=0;wv<bN.length;wv++){var kv=bN[wv],qW=kv.toLowerCase(),KW=kv[0].toUpperCase()+kv.slice(1);Ia(qW,"on"+KW)}Ia(UR,"onAnimationEnd");Ia(jR,"onAnimationIteration");Ia(WR,"onAnimationStart");Ia("dblclick","onDoubleClick");Ia("focusin","onFocus");Ia("focusout","onBlur");Ia(GR,"onTransitionEnd");au("onMouseEnter",["mouseout","mouseover"]);au("onMouseLeave",["mouseout","mouseover"]);au("onPointerEnter",["pointerout","pointerover"]);au("onPointerLeave",["pointerout","pointerover"]);Jl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Jl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Jl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Jl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Jl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Jl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Od="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XW=new Set("cancel close invalid load scroll toggle".split(" ").concat(Od));function wN(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,qj(s,e,void 0,t),t.currentTarget=null}function qR(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break e;wN(r,a,c),i=l}else for(o=0;o<s.length;o++){if(a=s[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break e;wN(r,a,c),i=l}}}if(fg)throw t=Gb,fg=!1,Gb=null,t}function At(t,e){var n=e[tw];n===void 0&&(n=e[tw]=new Set);var s=t+"__bubble";n.has(s)||(KR(e,t,2,!1),n.add(s))}function Cv(t,e,n){var s=0;e&&(s|=4),KR(n,t,s,e)}var cm="_reactListening"+Math.random().toString(36).slice(2);function kh(t){if(!t[cm]){t[cm]=!0,tR.forEach(function(n){n!=="selectionchange"&&(XW.has(n)||Cv(n,!1,t),Cv(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[cm]||(e[cm]=!0,Cv("selectionchange",!1,e))}}function KR(t,e,n,s){switch(AR(e)){case 1:var r=cW;break;case 4:r=uW;break;default:r=ck}n=r.bind(null,e,n,t),r=void 0,!Wb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Sv(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=sl(a),o===null)return;if(l=o.tag,l===5||l===6){s=i=o;continue e}a=a.parentNode}}s=s.return}yR(function(){var c=i,u=ik(n),d=[];e:{var h=HR.get(t);if(h!==void 0){var f=dk,p=t;switch(t){case"keypress":if(Um(n)===0)break e;case"keydown":case"keyup":f=IW;break;case"focusin":p="focus",f=yv;break;case"focusout":p="blur",f=yv;break;case"beforeblur":case"afterblur":f=yv;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=cN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=fW;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=EW;break;case UR:case jR:case WR:f=gW;break;case GR:f=_W;break;case"scroll":f=dW;break;case"wheel":f=RW;break;case"copy":case"cut":case"paste":f=xW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=dN}var m=(e&4)!==0,y=!m&&t==="scroll",g=m?h!==null?h+"Capture":null:h;m=[];for(var x=c,v;x!==null;){v=x;var b=v.stateNode;if(v.tag===5&&b!==null&&(v=b,g!==null&&(b=gh(x,g),b!=null&&m.push(Ch(x,b,v)))),y)break;x=x.return}0<m.length&&(h=new f(h,p,null,n,u),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==Ub&&(p=n.relatedTarget||n.fromElement)&&(sl(p)||p[to]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?sl(p):null,p!==null&&(y=Ql(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=cN,b="onMouseLeave",g="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(m=dN,b="onPointerLeave",g="onPointerEnter",x="pointer"),y=f==null?h:_c(f),v=p==null?h:_c(p),h=new m(b,x+"leave",f,n,u),h.target=y,h.relatedTarget=v,b=null,sl(u)===c&&(m=new m(g,x+"enter",p,n,u),m.target=v,m.relatedTarget=y,b=m),y=b,f&&p)t:{for(m=f,g=p,x=0,v=m;v;v=mc(v))x++;for(v=0,b=g;b;b=mc(b))v++;for(;0<x-v;)m=mc(m),x--;for(;0<v-x;)g=mc(g),v--;for(;x--;){if(m===g||g!==null&&m===g.alternate)break t;m=mc(m),g=mc(g)}m=null}else m=null;f!==null&&kN(d,h,f,m,!1),p!==null&&y!==null&&kN(d,y,p,m,!0)}}e:{if(h=c?_c(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var k=VW;else if(pN(h))if(MR)k=jW;else{k=zW;var C=BW}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(k=UW);if(k&&(k=k(t,c))){FR(d,k,n,u);break e}C&&C(t,h,c),t==="focusout"&&(C=h._wrapperState)&&C.controlled&&h.type==="number"&&Mb(h,"number",h.value)}switch(C=c?_c(c):window,t){case"focusin":(pN(C)||C.contentEditable==="true")&&(Ec=C,Xb=c,Zd=null);break;case"focusout":Zd=Xb=Ec=null;break;case"mousedown":Yb=!0;break;case"contextmenu":case"mouseup":case"dragend":Yb=!1,vN(d,n,u);break;case"selectionchange":if(HW)break;case"keydown":case"keyup":vN(d,n,u)}var S;if(fk)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Nc?PR(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(DR&&n.locale!=="ko"&&(Nc||I!=="onCompositionStart"?I==="onCompositionEnd"&&Nc&&(S=RR()):(jo=u,uk="value"in jo?jo.value:jo.textContent,Nc=!0)),C=xg(c,I),0<C.length&&(I=new uN(I,t,null,n,u),d.push({event:I,listeners:C}),S?I.data=S:(S=OR(n),S!==null&&(I.data=S)))),(S=PW?OW(t,n):FW(t,n))&&(c=xg(c,"onBeforeInput"),0<c.length&&(u=new uN("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=S))}qR(d,e)})}function Ch(t,e,n){return{instance:t,listener:e,currentTarget:n}}function xg(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=gh(t,n),i!=null&&s.unshift(Ch(t,i,r)),i=gh(t,e),i!=null&&s.push(Ch(t,i,r))),t=t.return}return s}function mc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function kN(t,e,n,s,r){for(var i=e._reactName,o=[];n!==null&&n!==s;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&c!==null&&(a=c,r?(l=gh(n,i),l!=null&&o.unshift(Ch(n,l,a))):r||(l=gh(n,i),l!=null&&o.push(Ch(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var YW=/\r\n?/g,ZW=/\u0000|\uFFFD/g;function CN(t){return(typeof t=="string"?t:""+t).replace(YW,`
`).replace(ZW,"")}function um(t,e,n){if(e=CN(e),CN(t)!==e&&n)throw Error(le(425))}function vg(){}var Zb=null,Jb=null;function Qb(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ew=typeof setTimeout=="function"?setTimeout:void 0,JW=typeof clearTimeout=="function"?clearTimeout:void 0,SN=typeof Promise=="function"?Promise:void 0,QW=typeof queueMicrotask=="function"?queueMicrotask:typeof SN<"u"?function(t){return SN.resolve(null).then(t).catch(e5)}:ew;function e5(t){setTimeout(function(){throw t})}function Iv(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),vh(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);vh(e)}function Jo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function IN(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Mu=Math.random().toString(36).slice(2),li="__reactFiber$"+Mu,Sh="__reactProps$"+Mu,to="__reactContainer$"+Mu,tw="__reactEvents$"+Mu,t5="__reactListeners$"+Mu,n5="__reactHandles$"+Mu;function sl(t){var e=t[li];if(e)return e;for(var n=t.parentNode;n;){if(e=n[to]||n[li]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=IN(t);t!==null;){if(n=t[li])return n;t=IN(t)}return e}t=n,n=t.parentNode}return null}function yf(t){return t=t[li]||t[to],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function _c(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(le(33))}function qy(t){return t[Sh]||null}var nw=[],Ac=-1;function Ta(t){return{current:t}}function Rt(t){0>Ac||(t.current=nw[Ac],nw[Ac]=null,Ac--)}function It(t,e){Ac++,nw[Ac]=t.current,t.current=e}var ha={},ts=Ta(ha),Ts=Ta(!1),kl=ha;function lu(t,e){var n=t.type.contextTypes;if(!n)return ha;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Ns(t){return t=t.childContextTypes,t!=null}function bg(){Rt(Ts),Rt(ts)}function TN(t,e,n){if(ts.current!==ha)throw Error(le(168));It(ts,e),It(Ts,n)}function XR(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(le(108,Bj(t)||"Unknown",r));return Wt({},n,s)}function wg(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ha,kl=ts.current,It(ts,t),It(Ts,Ts.current),!0}function NN(t,e,n){var s=t.stateNode;if(!s)throw Error(le(169));n?(t=XR(t,e,kl),s.__reactInternalMemoizedMergedChildContext=t,Rt(Ts),Rt(ts),It(ts,t)):Rt(Ts),It(Ts,n)}var zi=null,Ky=!1,Tv=!1;function YR(t){zi===null?zi=[t]:zi.push(t)}function s5(t){Ky=!0,YR(t)}function Na(){if(!Tv&&zi!==null){Tv=!0;var t=0,e=pt;try{var n=zi;for(pt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}zi=null,Ky=!1}catch(r){throw zi!==null&&(zi=zi.slice(t+1)),wR(ok,Na),r}finally{pt=e,Tv=!1}}return null}var Rc=[],Dc=0,kg=null,Cg=0,or=[],ar=0,Cl=null,Gi=1,Hi="";function Ha(t,e){Rc[Dc++]=Cg,Rc[Dc++]=kg,kg=t,Cg=e}function ZR(t,e,n){or[ar++]=Gi,or[ar++]=Hi,or[ar++]=Cl,Cl=t;var s=Gi;t=Hi;var r=32-Lr(s)-1;s&=~(1<<r),n+=1;var i=32-Lr(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,Gi=1<<32-Lr(e)+r|n<<r|s,Hi=i+t}else Gi=1<<i|n<<r|s,Hi=t}function mk(t){t.return!==null&&(Ha(t,1),ZR(t,1,0))}function gk(t){for(;t===kg;)kg=Rc[--Dc],Rc[Dc]=null,Cg=Rc[--Dc],Rc[Dc]=null;for(;t===Cl;)Cl=or[--ar],or[ar]=null,Hi=or[--ar],or[ar]=null,Gi=or[--ar],or[ar]=null}var Bs=null,Ls=null,Ft=!1,_r=null;function JR(t,e){var n=cr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function EN(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Bs=t,Ls=Jo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Bs=t,Ls=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Cl!==null?{id:Gi,overflow:Hi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=cr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Bs=t,Ls=null,!0):!1;default:return!1}}function sw(t){return(t.mode&1)!==0&&(t.flags&128)===0}function rw(t){if(Ft){var e=Ls;if(e){var n=e;if(!EN(t,e)){if(sw(t))throw Error(le(418));e=Jo(n.nextSibling);var s=Bs;e&&EN(t,e)?JR(s,n):(t.flags=t.flags&-4097|2,Ft=!1,Bs=t)}}else{if(sw(t))throw Error(le(418));t.flags=t.flags&-4097|2,Ft=!1,Bs=t}}}function $N(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Bs=t}function dm(t){if(t!==Bs)return!1;if(!Ft)return $N(t),Ft=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Qb(t.type,t.memoizedProps)),e&&(e=Ls)){if(sw(t))throw QR(),Error(le(418));for(;e;)JR(t,e),e=Jo(e.nextSibling)}if($N(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(le(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ls=Jo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ls=null}}else Ls=Bs?Jo(t.stateNode.nextSibling):null;return!0}function QR(){for(var t=Ls;t;)t=Jo(t.nextSibling)}function cu(){Ls=Bs=null,Ft=!1}function yk(t){_r===null?_r=[t]:_r.push(t)}var r5=go.ReactCurrentBatchConfig;function yd(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(le(309));var s=n.stateNode}if(!s)throw Error(le(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=r.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(le(284));if(!n._owner)throw Error(le(290,t))}return t}function hm(t,e){throw t=Object.prototype.toString.call(e),Error(le(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function _N(t){var e=t._init;return e(t._payload)}function eD(t){function e(g,x){if(t){var v=g.deletions;v===null?(g.deletions=[x],g.flags|=16):v.push(x)}}function n(g,x){if(!t)return null;for(;x!==null;)e(g,x),x=x.sibling;return null}function s(g,x){for(g=new Map;x!==null;)x.key!==null?g.set(x.key,x):g.set(x.index,x),x=x.sibling;return g}function r(g,x){return g=na(g,x),g.index=0,g.sibling=null,g}function i(g,x,v){return g.index=v,t?(v=g.alternate,v!==null?(v=v.index,v<x?(g.flags|=2,x):v):(g.flags|=2,x)):(g.flags|=1048576,x)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,x,v,b){return x===null||x.tag!==6?(x=Dv(v,g.mode,b),x.return=g,x):(x=r(x,v),x.return=g,x)}function l(g,x,v,b){var k=v.type;return k===Tc?u(g,x,v.props.children,b,v.key):x!==null&&(x.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Ro&&_N(k)===x.type)?(b=r(x,v.props),b.ref=yd(g,x,v),b.return=g,b):(b=Xm(v.type,v.key,v.props,null,g.mode,b),b.ref=yd(g,x,v),b.return=g,b)}function c(g,x,v,b){return x===null||x.tag!==4||x.stateNode.containerInfo!==v.containerInfo||x.stateNode.implementation!==v.implementation?(x=Pv(v,g.mode,b),x.return=g,x):(x=r(x,v.children||[]),x.return=g,x)}function u(g,x,v,b,k){return x===null||x.tag!==7?(x=ml(v,g.mode,b,k),x.return=g,x):(x=r(x,v),x.return=g,x)}function d(g,x,v){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Dv(""+x,g.mode,v),x.return=g,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case tm:return v=Xm(x.type,x.key,x.props,null,g.mode,v),v.ref=yd(g,null,x),v.return=g,v;case Ic:return x=Pv(x,g.mode,v),x.return=g,x;case Ro:var b=x._init;return d(g,b(x._payload),v)}if(Dd(x)||hd(x))return x=ml(x,g.mode,v,null),x.return=g,x;hm(g,x)}return null}function h(g,x,v,b){var k=x!==null?x.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return k!==null?null:a(g,x,""+v,b);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case tm:return v.key===k?l(g,x,v,b):null;case Ic:return v.key===k?c(g,x,v,b):null;case Ro:return k=v._init,h(g,x,k(v._payload),b)}if(Dd(v)||hd(v))return k!==null?null:u(g,x,v,b,null);hm(g,v)}return null}function f(g,x,v,b,k){if(typeof b=="string"&&b!==""||typeof b=="number")return g=g.get(v)||null,a(x,g,""+b,k);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case tm:return g=g.get(b.key===null?v:b.key)||null,l(x,g,b,k);case Ic:return g=g.get(b.key===null?v:b.key)||null,c(x,g,b,k);case Ro:var C=b._init;return f(g,x,v,C(b._payload),k)}if(Dd(b)||hd(b))return g=g.get(v)||null,u(x,g,b,k,null);hm(x,b)}return null}function p(g,x,v,b){for(var k=null,C=null,S=x,I=x=0,N=null;S!==null&&I<v.length;I++){S.index>I?(N=S,S=null):N=S.sibling;var E=h(g,S,v[I],b);if(E===null){S===null&&(S=N);break}t&&S&&E.alternate===null&&e(g,S),x=i(E,x,I),C===null?k=E:C.sibling=E,C=E,S=N}if(I===v.length)return n(g,S),Ft&&Ha(g,I),k;if(S===null){for(;I<v.length;I++)S=d(g,v[I],b),S!==null&&(x=i(S,x,I),C===null?k=S:C.sibling=S,C=S);return Ft&&Ha(g,I),k}for(S=s(g,S);I<v.length;I++)N=f(S,g,I,v[I],b),N!==null&&(t&&N.alternate!==null&&S.delete(N.key===null?I:N.key),x=i(N,x,I),C===null?k=N:C.sibling=N,C=N);return t&&S.forEach(function(D){return e(g,D)}),Ft&&Ha(g,I),k}function m(g,x,v,b){var k=hd(v);if(typeof k!="function")throw Error(le(150));if(v=k.call(v),v==null)throw Error(le(151));for(var C=k=null,S=x,I=x=0,N=null,E=v.next();S!==null&&!E.done;I++,E=v.next()){S.index>I?(N=S,S=null):N=S.sibling;var D=h(g,S,E.value,b);if(D===null){S===null&&(S=N);break}t&&S&&D.alternate===null&&e(g,S),x=i(D,x,I),C===null?k=D:C.sibling=D,C=D,S=N}if(E.done)return n(g,S),Ft&&Ha(g,I),k;if(S===null){for(;!E.done;I++,E=v.next())E=d(g,E.value,b),E!==null&&(x=i(E,x,I),C===null?k=E:C.sibling=E,C=E);return Ft&&Ha(g,I),k}for(S=s(g,S);!E.done;I++,E=v.next())E=f(S,g,I,E.value,b),E!==null&&(t&&E.alternate!==null&&S.delete(E.key===null?I:E.key),x=i(E,x,I),C===null?k=E:C.sibling=E,C=E);return t&&S.forEach(function(R){return e(g,R)}),Ft&&Ha(g,I),k}function y(g,x,v,b){if(typeof v=="object"&&v!==null&&v.type===Tc&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case tm:e:{for(var k=v.key,C=x;C!==null;){if(C.key===k){if(k=v.type,k===Tc){if(C.tag===7){n(g,C.sibling),x=r(C,v.props.children),x.return=g,g=x;break e}}else if(C.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Ro&&_N(k)===C.type){n(g,C.sibling),x=r(C,v.props),x.ref=yd(g,C,v),x.return=g,g=x;break e}n(g,C);break}else e(g,C);C=C.sibling}v.type===Tc?(x=ml(v.props.children,g.mode,b,v.key),x.return=g,g=x):(b=Xm(v.type,v.key,v.props,null,g.mode,b),b.ref=yd(g,x,v),b.return=g,g=b)}return o(g);case Ic:e:{for(C=v.key;x!==null;){if(x.key===C)if(x.tag===4&&x.stateNode.containerInfo===v.containerInfo&&x.stateNode.implementation===v.implementation){n(g,x.sibling),x=r(x,v.children||[]),x.return=g,g=x;break e}else{n(g,x);break}else e(g,x);x=x.sibling}x=Pv(v,g.mode,b),x.return=g,g=x}return o(g);case Ro:return C=v._init,y(g,x,C(v._payload),b)}if(Dd(v))return p(g,x,v,b);if(hd(v))return m(g,x,v,b);hm(g,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,x!==null&&x.tag===6?(n(g,x.sibling),x=r(x,v),x.return=g,g=x):(n(g,x),x=Dv(v,g.mode,b),x.return=g,g=x),o(g)):n(g,x)}return y}var uu=eD(!0),tD=eD(!1),Sg=Ta(null),Ig=null,Pc=null,xk=null;function vk(){xk=Pc=Ig=null}function bk(t){var e=Sg.current;Rt(Sg),t._currentValue=e}function iw(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Xc(t,e){Ig=t,xk=Pc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Cs=!0),t.firstContext=null)}function gr(t){var e=t._currentValue;if(xk!==t)if(t={context:t,memoizedValue:e,next:null},Pc===null){if(Ig===null)throw Error(le(308));Pc=t,Ig.dependencies={lanes:0,firstContext:t}}else Pc=Pc.next=t;return e}var rl=null;function wk(t){rl===null?rl=[t]:rl.push(t)}function nD(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,wk(e)):(n.next=r.next,r.next=n),e.interleaved=n,no(t,s)}function no(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Do=!1;function kk(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sD(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Yi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Qo(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,rt&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,no(t,n)}return r=s.interleaved,r===null?(e.next=e,wk(s)):(e.next=r.next,r.next=e),s.interleaved=e,no(t,n)}function jm(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,ak(t,n)}}function AN(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Tg(t,e,n,s){var r=t.updateQueue;Do=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=r.baseState;o=0,u=c=l=null,a=i;do{var h=a.lane,f=a.eventTime;if((s&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=Wt({},d,h);break e;case 2:Do=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,o|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);if(u===null&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);Il|=o,t.lanes=o,t.memoizedState=d}}function RN(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(le(191,r));r.call(s)}}}var xf={},fi=Ta(xf),Ih=Ta(xf),Th=Ta(xf);function il(t){if(t===xf)throw Error(le(174));return t}function Ck(t,e){switch(It(Th,e),It(Ih,t),It(fi,xf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Vb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Vb(e,t)}Rt(fi),It(fi,e)}function du(){Rt(fi),Rt(Ih),Rt(Th)}function rD(t){il(Th.current);var e=il(fi.current),n=Vb(e,t.type);e!==n&&(It(Ih,t),It(fi,n))}function Sk(t){Ih.current===t&&(Rt(fi),Rt(Ih))}var Bt=Ta(0);function Ng(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Nv=[];function Ik(){for(var t=0;t<Nv.length;t++)Nv[t]._workInProgressVersionPrimary=null;Nv.length=0}var Wm=go.ReactCurrentDispatcher,Ev=go.ReactCurrentBatchConfig,Sl=0,jt=null,yn=null,Sn=null,Eg=!1,Jd=!1,Nh=0,i5=0;function jn(){throw Error(le(321))}function Tk(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Wr(t[n],e[n]))return!1;return!0}function Nk(t,e,n,s,r,i){if(Sl=i,jt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Wm.current=t===null||t.memoizedState===null?c5:u5,t=n(s,r),Jd){i=0;do{if(Jd=!1,Nh=0,25<=i)throw Error(le(301));i+=1,Sn=yn=null,e.updateQueue=null,Wm.current=d5,t=n(s,r)}while(Jd)}if(Wm.current=$g,e=yn!==null&&yn.next!==null,Sl=0,Sn=yn=jt=null,Eg=!1,e)throw Error(le(300));return t}function Ek(){var t=Nh!==0;return Nh=0,t}function ti(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sn===null?jt.memoizedState=Sn=t:Sn=Sn.next=t,Sn}function yr(){if(yn===null){var t=jt.alternate;t=t!==null?t.memoizedState:null}else t=yn.next;var e=Sn===null?jt.memoizedState:Sn.next;if(e!==null)Sn=e,yn=t;else{if(t===null)throw Error(le(310));yn=t,t={memoizedState:yn.memoizedState,baseState:yn.baseState,baseQueue:yn.baseQueue,queue:yn.queue,next:null},Sn===null?jt.memoizedState=Sn=t:Sn=Sn.next=t}return Sn}function Eh(t,e){return typeof e=="function"?e(t):e}function $v(t){var e=yr(),n=e.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=t;var s=yn,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((Sl&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),s=c.hasEagerState?c.eagerState:t(s,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=s):l=l.next=d,jt.lanes|=u,Il|=u}c=c.next}while(c!==null&&c!==i);l===null?o=s:l.next=a,Wr(s,e.memoizedState)||(Cs=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,jt.lanes|=i,Il|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function _v(t){var e=yr(),n=e.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=t(i,o.action),o=o.next;while(o!==r);Wr(i,e.memoizedState)||(Cs=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function iD(){}function oD(t,e){var n=jt,s=yr(),r=e(),i=!Wr(s.memoizedState,r);if(i&&(s.memoizedState=r,Cs=!0),s=s.queue,$k(cD.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||Sn!==null&&Sn.memoizedState.tag&1){if(n.flags|=2048,$h(9,lD.bind(null,n,s,r,e),void 0,null),Nn===null)throw Error(le(349));Sl&30||aD(n,e,r)}return r}function aD(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=jt.updateQueue,e===null?(e={lastEffect:null,stores:null},jt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function lD(t,e,n,s){e.value=n,e.getSnapshot=s,uD(e)&&dD(t)}function cD(t,e,n){return n(function(){uD(e)&&dD(t)})}function uD(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Wr(t,n)}catch{return!0}}function dD(t){var e=no(t,1);e!==null&&Vr(e,t,1,-1)}function DN(t){var e=ti();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eh,lastRenderedState:t},e.queue=t,t=t.dispatch=l5.bind(null,jt,t),[e.memoizedState,t]}function $h(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=jt.updateQueue,e===null?(e={lastEffect:null,stores:null},jt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function hD(){return yr().memoizedState}function Gm(t,e,n,s){var r=ti();jt.flags|=t,r.memoizedState=$h(1|e,n,void 0,s===void 0?null:s)}function Xy(t,e,n,s){var r=yr();s=s===void 0?null:s;var i=void 0;if(yn!==null){var o=yn.memoizedState;if(i=o.destroy,s!==null&&Tk(s,o.deps)){r.memoizedState=$h(e,n,i,s);return}}jt.flags|=t,r.memoizedState=$h(1|e,n,i,s)}function PN(t,e){return Gm(8390656,8,t,e)}function $k(t,e){return Xy(2048,8,t,e)}function fD(t,e){return Xy(4,2,t,e)}function pD(t,e){return Xy(4,4,t,e)}function mD(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function gD(t,e,n){return n=n!=null?n.concat([t]):null,Xy(4,4,mD.bind(null,e,t),n)}function _k(){}function yD(t,e){var n=yr();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Tk(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function xD(t,e){var n=yr();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Tk(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function vD(t,e,n){return Sl&21?(Wr(n,e)||(n=SR(),jt.lanes|=n,Il|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Cs=!0),t.memoizedState=n)}function o5(t,e){var n=pt;pt=n!==0&&4>n?n:4,t(!0);var s=Ev.transition;Ev.transition={};try{t(!1),e()}finally{pt=n,Ev.transition=s}}function bD(){return yr().memoizedState}function a5(t,e,n){var s=ta(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},wD(t))kD(e,n);else if(n=nD(t,e,n,s),n!==null){var r=ds();Vr(n,t,s,r),CD(n,e,s)}}function l5(t,e,n){var s=ta(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(wD(t))kD(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(r.hasEagerState=!0,r.eagerState=a,Wr(a,o)){var l=e.interleaved;l===null?(r.next=r,wk(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=nD(t,e,r,s),n!==null&&(r=ds(),Vr(n,t,s,r),CD(n,e,s))}}function wD(t){var e=t.alternate;return t===jt||e!==null&&e===jt}function kD(t,e){Jd=Eg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function CD(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,ak(t,n)}}var $g={readContext:gr,useCallback:jn,useContext:jn,useEffect:jn,useImperativeHandle:jn,useInsertionEffect:jn,useLayoutEffect:jn,useMemo:jn,useReducer:jn,useRef:jn,useState:jn,useDebugValue:jn,useDeferredValue:jn,useTransition:jn,useMutableSource:jn,useSyncExternalStore:jn,useId:jn,unstable_isNewReconciler:!1},c5={readContext:gr,useCallback:function(t,e){return ti().memoizedState=[t,e===void 0?null:e],t},useContext:gr,useEffect:PN,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Gm(4194308,4,mD.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Gm(4194308,4,t,e)},useInsertionEffect:function(t,e){return Gm(4,2,t,e)},useMemo:function(t,e){var n=ti();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=ti();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=a5.bind(null,jt,t),[s.memoizedState,t]},useRef:function(t){var e=ti();return t={current:t},e.memoizedState=t},useState:DN,useDebugValue:_k,useDeferredValue:function(t){return ti().memoizedState=t},useTransition:function(){var t=DN(!1),e=t[0];return t=o5.bind(null,t[1]),ti().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=jt,r=ti();if(Ft){if(n===void 0)throw Error(le(407));n=n()}else{if(n=e(),Nn===null)throw Error(le(349));Sl&30||aD(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,PN(cD.bind(null,s,i,t),[t]),s.flags|=2048,$h(9,lD.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=ti(),e=Nn.identifierPrefix;if(Ft){var n=Hi,s=Gi;n=(s&~(1<<32-Lr(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=Nh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=i5++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},u5={readContext:gr,useCallback:yD,useContext:gr,useEffect:$k,useImperativeHandle:gD,useInsertionEffect:fD,useLayoutEffect:pD,useMemo:xD,useReducer:$v,useRef:hD,useState:function(){return $v(Eh)},useDebugValue:_k,useDeferredValue:function(t){var e=yr();return vD(e,yn.memoizedState,t)},useTransition:function(){var t=$v(Eh)[0],e=yr().memoizedState;return[t,e]},useMutableSource:iD,useSyncExternalStore:oD,useId:bD,unstable_isNewReconciler:!1},d5={readContext:gr,useCallback:yD,useContext:gr,useEffect:$k,useImperativeHandle:gD,useInsertionEffect:fD,useLayoutEffect:pD,useMemo:xD,useReducer:_v,useRef:hD,useState:function(){return _v(Eh)},useDebugValue:_k,useDeferredValue:function(t){var e=yr();return yn===null?e.memoizedState=t:vD(e,yn.memoizedState,t)},useTransition:function(){var t=_v(Eh)[0],e=yr().memoizedState;return[t,e]},useMutableSource:iD,useSyncExternalStore:oD,useId:bD,unstable_isNewReconciler:!1};function Er(t,e){if(t&&t.defaultProps){e=Wt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ow(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Wt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Yy={isMounted:function(t){return(t=t._reactInternals)?Ql(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=ds(),r=ta(t),i=Yi(s,r);i.payload=e,n!=null&&(i.callback=n),e=Qo(t,i,r),e!==null&&(Vr(e,t,r,s),jm(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=ds(),r=ta(t),i=Yi(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Qo(t,i,r),e!==null&&(Vr(e,t,r,s),jm(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ds(),s=ta(t),r=Yi(n,s);r.tag=2,e!=null&&(r.callback=e),e=Qo(t,r,s),e!==null&&(Vr(e,t,s,n),jm(e,t,s))}};function ON(t,e,n,s,r,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!wh(n,s)||!wh(r,i):!0}function SD(t,e,n){var s=!1,r=ha,i=e.contextType;return typeof i=="object"&&i!==null?i=gr(i):(r=Ns(e)?kl:ts.current,s=e.contextTypes,i=(s=s!=null)?lu(t,r):ha),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Yy,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function FN(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&Yy.enqueueReplaceState(e,e.state,null)}function aw(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},kk(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=gr(i):(i=Ns(e)?kl:ts.current,r.context=lu(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(ow(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Yy.enqueueReplaceState(r,r.state,null),Tg(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function hu(t,e){try{var n="",s=e;do n+=Vj(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function Av(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function lw(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var h5=typeof WeakMap=="function"?WeakMap:Map;function ID(t,e,n){n=Yi(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){Ag||(Ag=!0,xw=s),lw(t,e)},n}function TD(t,e,n){n=Yi(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){lw(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){lw(t,e),typeof s!="function"&&(ea===null?ea=new Set([this]):ea.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function MN(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new h5;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=T5.bind(null,t,e,n),e.then(t,t))}function LN(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function VN(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Yi(-1,1),e.tag=2,Qo(n,e,1))),n.lanes|=1),t)}var f5=go.ReactCurrentOwner,Cs=!1;function os(t,e,n,s){e.child=t===null?tD(e,null,n,s):uu(e,t.child,n,s)}function BN(t,e,n,s,r){n=n.render;var i=e.ref;return Xc(e,r),s=Nk(t,e,n,s,i,r),n=Ek(),t!==null&&!Cs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,so(t,e,r)):(Ft&&n&&mk(e),e.flags|=1,os(t,e,s,r),e.child)}function zN(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!Lk(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,ND(t,e,i,s,r)):(t=Xm(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:wh,n(o,s)&&t.ref===e.ref)return so(t,e,r)}return e.flags|=1,t=na(i,s),t.ref=e.ref,t.return=e,e.child=t}function ND(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(wh(i,s)&&t.ref===e.ref)if(Cs=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(Cs=!0);else return e.lanes=t.lanes,so(t,e,r)}return cw(t,e,n,s,r)}function ED(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},It(Fc,Fs),Fs|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,It(Fc,Fs),Fs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,It(Fc,Fs),Fs|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,It(Fc,Fs),Fs|=s;return os(t,e,r,n),e.child}function $D(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function cw(t,e,n,s,r){var i=Ns(n)?kl:ts.current;return i=lu(e,i),Xc(e,r),n=Nk(t,e,n,s,i,r),s=Ek(),t!==null&&!Cs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,so(t,e,r)):(Ft&&s&&mk(e),e.flags|=1,os(t,e,n,r),e.child)}function UN(t,e,n,s,r){if(Ns(n)){var i=!0;wg(e)}else i=!1;if(Xc(e,r),e.stateNode===null)Hm(t,e),SD(e,n,s),aw(e,n,s,r),s=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=gr(c):(c=Ns(n)?kl:ts.current,c=lu(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||l!==c)&&FN(e,o,s,c),Do=!1;var h=e.memoizedState;o.state=h,Tg(e,s,o,r),l=e.memoizedState,a!==s||h!==l||Ts.current||Do?(typeof u=="function"&&(ow(e,n,u,s),l=e.memoizedState),(a=Do||ON(e,n,a,s,h,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=c,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,sD(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Er(e.type,a),o.props=c,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=gr(l):(l=Ns(n)?kl:ts.current,l=lu(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&FN(e,o,s,l),Do=!1,h=e.memoizedState,o.state=h,Tg(e,s,o,r);var p=e.memoizedState;a!==d||h!==p||Ts.current||Do?(typeof f=="function"&&(ow(e,n,f,s),p=e.memoizedState),(c=Do||ON(e,n,c,s,h,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=p),o.props=s,o.state=p,o.context=l,s=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),s=!1)}return uw(t,e,n,s,i,r)}function uw(t,e,n,s,r,i){$D(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&NN(e,n,!1),so(t,e,i);s=e.stateNode,f5.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=uu(e,t.child,null,i),e.child=uu(e,null,a,i)):os(t,e,a,i),e.memoizedState=s.state,r&&NN(e,n,!0),e.child}function _D(t){var e=t.stateNode;e.pendingContext?TN(t,e.pendingContext,e.pendingContext!==e.context):e.context&&TN(t,e.context,!1),Ck(t,e.containerInfo)}function jN(t,e,n,s,r){return cu(),yk(r),e.flags|=256,os(t,e,n,s),e.child}var dw={dehydrated:null,treeContext:null,retryLane:0};function hw(t){return{baseLanes:t,cachePool:null,transitions:null}}function AD(t,e,n){var s=e.pendingProps,r=Bt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),It(Bt,r&1),t===null)return rw(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Qy(o,s,0,null),t=ml(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=hw(n),e.memoizedState=dw,t):Ak(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return p5(t,e,o,s,a,r,n);if(i){i=s.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=na(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?i=na(a,i):(i=ml(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?hw(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=dw,s}return i=t.child,t=i.sibling,s=na(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function Ak(t,e){return e=Qy({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function fm(t,e,n,s){return s!==null&&yk(s),uu(e,t.child,null,n),t=Ak(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function p5(t,e,n,s,r,i,o){if(n)return e.flags&256?(e.flags&=-257,s=Av(Error(le(422))),fm(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=Qy({mode:"visible",children:s.children},r,0,null),i=ml(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&uu(e,t.child,null,o),e.child.memoizedState=hw(o),e.memoizedState=dw,i);if(!(e.mode&1))return fm(t,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,i=Error(le(419)),s=Av(i,s,void 0),fm(t,e,o,s)}if(a=(o&t.childLanes)!==0,Cs||a){if(s=Nn,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,no(t,r),Vr(s,t,r,-1))}return Mk(),s=Av(Error(le(421))),fm(t,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=N5.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,Ls=Jo(r.nextSibling),Bs=e,Ft=!0,_r=null,t!==null&&(or[ar++]=Gi,or[ar++]=Hi,or[ar++]=Cl,Gi=t.id,Hi=t.overflow,Cl=e),e=Ak(e,s.children),e.flags|=4096,e)}function WN(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),iw(t.return,e,n)}function Rv(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function RD(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(os(t,e,s.children,n),s=Bt.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&WN(t,n,e);else if(t.tag===19)WN(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(It(Bt,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Ng(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Rv(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Ng(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Rv(e,!0,n,null,i);break;case"together":Rv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Hm(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function so(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Il|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(le(153));if(e.child!==null){for(t=e.child,n=na(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=na(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function m5(t,e,n){switch(e.tag){case 3:_D(e),cu();break;case 5:rD(e);break;case 1:Ns(e.type)&&wg(e);break;case 4:Ck(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;It(Sg,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(It(Bt,Bt.current&1),e.flags|=128,null):n&e.child.childLanes?AD(t,e,n):(It(Bt,Bt.current&1),t=so(t,e,n),t!==null?t.sibling:null);It(Bt,Bt.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return RD(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),It(Bt,Bt.current),s)break;return null;case 22:case 23:return e.lanes=0,ED(t,e,n)}return so(t,e,n)}var DD,fw,PD,OD;DD=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};fw=function(){};PD=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,il(fi.current);var i=null;switch(n){case"input":r=Ob(t,r),s=Ob(t,s),i=[];break;case"select":r=Wt({},r,{value:void 0}),s=Wt({},s,{value:void 0}),i=[];break;case"textarea":r=Lb(t,r),s=Lb(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=vg)}Bb(n,s);var o;n=null;for(c in r)if(!s.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ph.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in s){var l=s[c];if(a=r!=null?r[c]:void 0,s.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ph.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&At("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};OD=function(t,e,n,s){n!==s&&(e.flags|=4)};function xd(t,e){if(!Ft)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Wn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function g5(t,e,n){var s=e.pendingProps;switch(gk(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wn(e),null;case 1:return Ns(e.type)&&bg(),Wn(e),null;case 3:return s=e.stateNode,du(),Rt(Ts),Rt(ts),Ik(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(dm(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,_r!==null&&(ww(_r),_r=null))),fw(t,e),Wn(e),null;case 5:Sk(e);var r=il(Th.current);if(n=e.type,t!==null&&e.stateNode!=null)PD(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(le(166));return Wn(e),null}if(t=il(fi.current),dm(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[li]=e,s[Sh]=i,t=(e.mode&1)!==0,n){case"dialog":At("cancel",s),At("close",s);break;case"iframe":case"object":case"embed":At("load",s);break;case"video":case"audio":for(r=0;r<Od.length;r++)At(Od[r],s);break;case"source":At("error",s);break;case"img":case"image":case"link":At("error",s),At("load",s);break;case"details":At("toggle",s);break;case"input":QT(s,i),At("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},At("invalid",s);break;case"textarea":tN(s,i),At("invalid",s)}Bb(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?s.textContent!==a&&(i.suppressHydrationWarning!==!0&&um(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&um(s.textContent,a,t),r=["children",""+a]):ph.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&At("scroll",s)}switch(n){case"input":nm(s),eN(s,i,!0);break;case"textarea":nm(s),nN(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=vg)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=cR(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[li]=e,t[Sh]=s,DD(t,e,!1,!1),e.stateNode=t;e:{switch(o=zb(n,s),n){case"dialog":At("cancel",t),At("close",t),r=s;break;case"iframe":case"object":case"embed":At("load",t),r=s;break;case"video":case"audio":for(r=0;r<Od.length;r++)At(Od[r],t);r=s;break;case"source":At("error",t),r=s;break;case"img":case"image":case"link":At("error",t),At("load",t),r=s;break;case"details":At("toggle",t),r=s;break;case"input":QT(t,s),r=Ob(t,s),At("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=Wt({},s,{value:void 0}),At("invalid",t);break;case"textarea":tN(t,s),r=Lb(t,s),At("invalid",t);break;default:r=s}Bb(n,r),a=r;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?hR(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&uR(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&mh(t,l):typeof l=="number"&&mh(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ph.hasOwnProperty(i)?l!=null&&i==="onScroll"&&At("scroll",t):l!=null&&tk(t,i,l,o))}switch(n){case"input":nm(t),eN(t,s,!1);break;case"textarea":nm(t),nN(t);break;case"option":s.value!=null&&t.setAttribute("value",""+da(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?Gc(t,!!s.multiple,i,!1):s.defaultValue!=null&&Gc(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=vg)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Wn(e),null;case 6:if(t&&e.stateNode!=null)OD(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(le(166));if(n=il(Th.current),il(fi.current),dm(e)){if(s=e.stateNode,n=e.memoizedProps,s[li]=e,(i=s.nodeValue!==n)&&(t=Bs,t!==null))switch(t.tag){case 3:um(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&um(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[li]=e,e.stateNode=s}return Wn(e),null;case 13:if(Rt(Bt),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ft&&Ls!==null&&e.mode&1&&!(e.flags&128))QR(),cu(),e.flags|=98560,i=!1;else if(i=dm(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(le(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(le(317));i[li]=e}else cu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Wn(e),i=!1}else _r!==null&&(ww(_r),_r=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Bt.current&1?bn===0&&(bn=3):Mk())),e.updateQueue!==null&&(e.flags|=4),Wn(e),null);case 4:return du(),fw(t,e),t===null&&kh(e.stateNode.containerInfo),Wn(e),null;case 10:return bk(e.type._context),Wn(e),null;case 17:return Ns(e.type)&&bg(),Wn(e),null;case 19:if(Rt(Bt),i=e.memoizedState,i===null)return Wn(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)xd(i,!1);else{if(bn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ng(t),o!==null){for(e.flags|=128,xd(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return It(Bt,Bt.current&1|2),e.child}t=t.sibling}i.tail!==null&&tn()>fu&&(e.flags|=128,s=!0,xd(i,!1),e.lanes=4194304)}else{if(!s)if(t=Ng(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),xd(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ft)return Wn(e),null}else 2*tn()-i.renderingStartTime>fu&&n!==1073741824&&(e.flags|=128,s=!0,xd(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=tn(),e.sibling=null,n=Bt.current,It(Bt,s?n&1|2:n&1),e):(Wn(e),null);case 22:case 23:return Fk(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Fs&1073741824&&(Wn(e),e.subtreeFlags&6&&(e.flags|=8192)):Wn(e),null;case 24:return null;case 25:return null}throw Error(le(156,e.tag))}function y5(t,e){switch(gk(e),e.tag){case 1:return Ns(e.type)&&bg(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return du(),Rt(Ts),Rt(ts),Ik(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Sk(e),null;case 13:if(Rt(Bt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(le(340));cu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Rt(Bt),null;case 4:return du(),null;case 10:return bk(e.type._context),null;case 22:case 23:return Fk(),null;case 24:return null;default:return null}}var pm=!1,Xn=!1,x5=typeof WeakSet=="function"?WeakSet:Set,be=null;function Oc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Ht(t,e,s)}else n.current=null}function pw(t,e,n){try{n()}catch(s){Ht(t,e,s)}}var GN=!1;function v5(t,e){if(Zb=gg,t=BR(),pk(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==n||r!==0&&d.nodeType!==3||(a=o+r),d!==i||s!==0&&d.nodeType!==3||(l=o+s),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++c===r&&(a=o),h===i&&++u===s&&(l=o),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Jb={focusedElem:t,selectionRange:n},gg=!1,be=e;be!==null;)if(e=be,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,be=t;else for(;be!==null;){e=be;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,y=p.memoizedState,g=e.stateNode,x=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:Er(e.type,m),y);g.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(b){Ht(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,be=t;break}be=e.return}return p=GN,GN=!1,p}function Qd(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&pw(e,n,i)}r=r.next}while(r!==s)}}function Zy(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function mw(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function FD(t){var e=t.alternate;e!==null&&(t.alternate=null,FD(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[li],delete e[Sh],delete e[tw],delete e[t5],delete e[n5])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function MD(t){return t.tag===5||t.tag===3||t.tag===4}function HN(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||MD(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function gw(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=vg));else if(s!==4&&(t=t.child,t!==null))for(gw(t,e,n),t=t.sibling;t!==null;)gw(t,e,n),t=t.sibling}function yw(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(yw(t,e,n),t=t.sibling;t!==null;)yw(t,e,n),t=t.sibling}var Rn=null,$r=!1;function So(t,e,n){for(n=n.child;n!==null;)LD(t,e,n),n=n.sibling}function LD(t,e,n){if(hi&&typeof hi.onCommitFiberUnmount=="function")try{hi.onCommitFiberUnmount(jy,n)}catch{}switch(n.tag){case 5:Xn||Oc(n,e);case 6:var s=Rn,r=$r;Rn=null,So(t,e,n),Rn=s,$r=r,Rn!==null&&($r?(t=Rn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Rn.removeChild(n.stateNode));break;case 18:Rn!==null&&($r?(t=Rn,n=n.stateNode,t.nodeType===8?Iv(t.parentNode,n):t.nodeType===1&&Iv(t,n),vh(t)):Iv(Rn,n.stateNode));break;case 4:s=Rn,r=$r,Rn=n.stateNode.containerInfo,$r=!0,So(t,e,n),Rn=s,$r=r;break;case 0:case 11:case 14:case 15:if(!Xn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&pw(n,e,o),r=r.next}while(r!==s)}So(t,e,n);break;case 1:if(!Xn&&(Oc(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){Ht(n,e,a)}So(t,e,n);break;case 21:So(t,e,n);break;case 22:n.mode&1?(Xn=(s=Xn)||n.memoizedState!==null,So(t,e,n),Xn=s):So(t,e,n);break;default:So(t,e,n)}}function qN(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new x5),e.forEach(function(s){var r=E5.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function Cr(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Rn=a.stateNode,$r=!1;break e;case 3:Rn=a.stateNode.containerInfo,$r=!0;break e;case 4:Rn=a.stateNode.containerInfo,$r=!0;break e}a=a.return}if(Rn===null)throw Error(le(160));LD(i,o,r),Rn=null,$r=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){Ht(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)VD(e,t),e=e.sibling}function VD(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Cr(e,t),Qr(t),s&4){try{Qd(3,t,t.return),Zy(3,t)}catch(m){Ht(t,t.return,m)}try{Qd(5,t,t.return)}catch(m){Ht(t,t.return,m)}}break;case 1:Cr(e,t),Qr(t),s&512&&n!==null&&Oc(n,n.return);break;case 5:if(Cr(e,t),Qr(t),s&512&&n!==null&&Oc(n,n.return),t.flags&32){var r=t.stateNode;try{mh(r,"")}catch(m){Ht(t,t.return,m)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&aR(r,i),zb(a,o);var c=zb(a,i);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?hR(r,d):u==="dangerouslySetInnerHTML"?uR(r,d):u==="children"?mh(r,d):tk(r,u,d,c)}switch(a){case"input":Fb(r,i);break;case"textarea":lR(r,i);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Gc(r,!!i.multiple,f,!1):h!==!!i.multiple&&(i.defaultValue!=null?Gc(r,!!i.multiple,i.defaultValue,!0):Gc(r,!!i.multiple,i.multiple?[]:"",!1))}r[Sh]=i}catch(m){Ht(t,t.return,m)}}break;case 6:if(Cr(e,t),Qr(t),s&4){if(t.stateNode===null)throw Error(le(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(m){Ht(t,t.return,m)}}break;case 3:if(Cr(e,t),Qr(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{vh(e.containerInfo)}catch(m){Ht(t,t.return,m)}break;case 4:Cr(e,t),Qr(t);break;case 13:Cr(e,t),Qr(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(Pk=tn())),s&4&&qN(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Xn=(c=Xn)||u,Cr(e,t),Xn=c):Cr(e,t),Qr(t),s&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(be=t,u=t.child;u!==null;){for(d=be=u;be!==null;){switch(h=be,f=h.child,h.tag){case 0:case 11:case 14:case 15:Qd(4,h,h.return);break;case 1:Oc(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){s=h,n=h.return;try{e=s,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Ht(s,n,m)}}break;case 5:Oc(h,h.return);break;case 22:if(h.memoizedState!==null){XN(d);continue}}f!==null?(f.return=h,be=f):XN(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{r=d.stateNode,c?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=dR("display",o))}catch(m){Ht(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){Ht(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Cr(e,t),Qr(t),s&4&&qN(t);break;case 21:break;default:Cr(e,t),Qr(t)}}function Qr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(MD(n)){var s=n;break e}n=n.return}throw Error(le(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(mh(r,""),s.flags&=-33);var i=HN(t);yw(t,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,a=HN(t);gw(t,a,o);break;default:throw Error(le(161))}}catch(l){Ht(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function b5(t,e,n){be=t,BD(t)}function BD(t,e,n){for(var s=(t.mode&1)!==0;be!==null;){var r=be,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||pm;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Xn;a=pm;var c=Xn;if(pm=o,(Xn=l)&&!c)for(be=r;be!==null;)o=be,l=o.child,o.tag===22&&o.memoizedState!==null?YN(r):l!==null?(l.return=o,be=l):YN(r);for(;i!==null;)be=i,BD(i),i=i.sibling;be=r,pm=a,Xn=c}KN(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,be=i):KN(t)}}function KN(t){for(;be!==null;){var e=be;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Xn||Zy(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Xn)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Er(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&RN(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}RN(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&vh(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}Xn||e.flags&512&&mw(e)}catch(h){Ht(e,e.return,h)}}if(e===t){be=null;break}if(n=e.sibling,n!==null){n.return=e.return,be=n;break}be=e.return}}function XN(t){for(;be!==null;){var e=be;if(e===t){be=null;break}var n=e.sibling;if(n!==null){n.return=e.return,be=n;break}be=e.return}}function YN(t){for(;be!==null;){var e=be;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Zy(4,e)}catch(l){Ht(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){Ht(e,r,l)}}var i=e.return;try{mw(e)}catch(l){Ht(e,i,l)}break;case 5:var o=e.return;try{mw(e)}catch(l){Ht(e,o,l)}}}catch(l){Ht(e,e.return,l)}if(e===t){be=null;break}var a=e.sibling;if(a!==null){a.return=e.return,be=a;break}be=e.return}}var w5=Math.ceil,_g=go.ReactCurrentDispatcher,Rk=go.ReactCurrentOwner,mr=go.ReactCurrentBatchConfig,rt=0,Nn=null,cn=null,On=0,Fs=0,Fc=Ta(0),bn=0,_h=null,Il=0,Jy=0,Dk=0,eh=null,ws=null,Pk=0,fu=1/0,Bi=null,Ag=!1,xw=null,ea=null,mm=!1,Wo=null,Rg=0,th=0,vw=null,qm=-1,Km=0;function ds(){return rt&6?tn():qm!==-1?qm:qm=tn()}function ta(t){return t.mode&1?rt&2&&On!==0?On&-On:r5.transition!==null?(Km===0&&(Km=SR()),Km):(t=pt,t!==0||(t=window.event,t=t===void 0?16:AR(t.type)),t):1}function Vr(t,e,n,s){if(50<th)throw th=0,vw=null,Error(le(185));mf(t,n,s),(!(rt&2)||t!==Nn)&&(t===Nn&&(!(rt&2)&&(Jy|=n),bn===4&&Fo(t,On)),Es(t,s),n===1&&rt===0&&!(e.mode&1)&&(fu=tn()+500,Ky&&Na()))}function Es(t,e){var n=t.callbackNode;rW(t,e);var s=mg(t,t===Nn?On:0);if(s===0)n!==null&&iN(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&iN(n),e===1)t.tag===0?s5(ZN.bind(null,t)):YR(ZN.bind(null,t)),QW(function(){!(rt&6)&&Na()}),n=null;else{switch(IR(s)){case 1:n=ok;break;case 4:n=kR;break;case 16:n=pg;break;case 536870912:n=CR;break;default:n=pg}n=KD(n,zD.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function zD(t,e){if(qm=-1,Km=0,rt&6)throw Error(le(327));var n=t.callbackNode;if(Yc()&&t.callbackNode!==n)return null;var s=mg(t,t===Nn?On:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=Dg(t,s);else{e=s;var r=rt;rt|=2;var i=jD();(Nn!==t||On!==e)&&(Bi=null,fu=tn()+500,pl(t,e));do try{S5();break}catch(a){UD(t,a)}while(!0);vk(),_g.current=i,rt=r,cn!==null?e=0:(Nn=null,On=0,e=bn)}if(e!==0){if(e===2&&(r=Hb(t),r!==0&&(s=r,e=bw(t,r))),e===1)throw n=_h,pl(t,0),Fo(t,s),Es(t,tn()),n;if(e===6)Fo(t,s);else{if(r=t.current.alternate,!(s&30)&&!k5(r)&&(e=Dg(t,s),e===2&&(i=Hb(t),i!==0&&(s=i,e=bw(t,i))),e===1))throw n=_h,pl(t,0),Fo(t,s),Es(t,tn()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(le(345));case 2:qa(t,ws,Bi);break;case 3:if(Fo(t,s),(s&130023424)===s&&(e=Pk+500-tn(),10<e)){if(mg(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){ds(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ew(qa.bind(null,t,ws,Bi),e);break}qa(t,ws,Bi);break;case 4:if(Fo(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var o=31-Lr(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=tn()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*w5(s/1960))-s,10<s){t.timeoutHandle=ew(qa.bind(null,t,ws,Bi),s);break}qa(t,ws,Bi);break;case 5:qa(t,ws,Bi);break;default:throw Error(le(329))}}}return Es(t,tn()),t.callbackNode===n?zD.bind(null,t):null}function bw(t,e){var n=eh;return t.current.memoizedState.isDehydrated&&(pl(t,e).flags|=256),t=Dg(t,e),t!==2&&(e=ws,ws=n,e!==null&&ww(e)),t}function ww(t){ws===null?ws=t:ws.push.apply(ws,t)}function k5(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!Wr(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Fo(t,e){for(e&=~Dk,e&=~Jy,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Lr(e),s=1<<n;t[n]=-1,e&=~s}}function ZN(t){if(rt&6)throw Error(le(327));Yc();var e=mg(t,0);if(!(e&1))return Es(t,tn()),null;var n=Dg(t,e);if(t.tag!==0&&n===2){var s=Hb(t);s!==0&&(e=s,n=bw(t,s))}if(n===1)throw n=_h,pl(t,0),Fo(t,e),Es(t,tn()),n;if(n===6)throw Error(le(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,qa(t,ws,Bi),Es(t,tn()),null}function Ok(t,e){var n=rt;rt|=1;try{return t(e)}finally{rt=n,rt===0&&(fu=tn()+500,Ky&&Na())}}function Tl(t){Wo!==null&&Wo.tag===0&&!(rt&6)&&Yc();var e=rt;rt|=1;var n=mr.transition,s=pt;try{if(mr.transition=null,pt=1,t)return t()}finally{pt=s,mr.transition=n,rt=e,!(rt&6)&&Na()}}function Fk(){Fs=Fc.current,Rt(Fc)}function pl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,JW(n)),cn!==null)for(n=cn.return;n!==null;){var s=n;switch(gk(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&bg();break;case 3:du(),Rt(Ts),Rt(ts),Ik();break;case 5:Sk(s);break;case 4:du();break;case 13:Rt(Bt);break;case 19:Rt(Bt);break;case 10:bk(s.type._context);break;case 22:case 23:Fk()}n=n.return}if(Nn=t,cn=t=na(t.current,null),On=Fs=e,bn=0,_h=null,Dk=Jy=Il=0,ws=eh=null,rl!==null){for(e=0;e<rl.length;e++)if(n=rl[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}rl=null}return t}function UD(t,e){do{var n=cn;try{if(vk(),Wm.current=$g,Eg){for(var s=jt.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Eg=!1}if(Sl=0,Sn=yn=jt=null,Jd=!1,Nh=0,Rk.current=null,n===null||n.return===null){bn=1,_h=e,cn=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=On,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=LN(o);if(f!==null){f.flags&=-257,VN(f,o,a,i,e),f.mode&1&&MN(i,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){MN(i,c,e),Mk();break e}l=Error(le(426))}}else if(Ft&&a.mode&1){var y=LN(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),VN(y,o,a,i,e),yk(hu(l,a));break e}}i=l=hu(l,a),bn!==4&&(bn=2),eh===null?eh=[i]:eh.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=ID(i,l,e);AN(i,g);break e;case 1:a=l;var x=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ea===null||!ea.has(v)))){i.flags|=65536,e&=-e,i.lanes|=e;var b=TD(i,a,e);AN(i,b);break e}}i=i.return}while(i!==null)}GD(n)}catch(k){e=k,cn===n&&n!==null&&(cn=n=n.return);continue}break}while(!0)}function jD(){var t=_g.current;return _g.current=$g,t===null?$g:t}function Mk(){(bn===0||bn===3||bn===2)&&(bn=4),Nn===null||!(Il&268435455)&&!(Jy&268435455)||Fo(Nn,On)}function Dg(t,e){var n=rt;rt|=2;var s=jD();(Nn!==t||On!==e)&&(Bi=null,pl(t,e));do try{C5();break}catch(r){UD(t,r)}while(!0);if(vk(),rt=n,_g.current=s,cn!==null)throw Error(le(261));return Nn=null,On=0,bn}function C5(){for(;cn!==null;)WD(cn)}function S5(){for(;cn!==null&&!Xj();)WD(cn)}function WD(t){var e=qD(t.alternate,t,Fs);t.memoizedProps=t.pendingProps,e===null?GD(t):cn=e,Rk.current=null}function GD(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=y5(n,e),n!==null){n.flags&=32767,cn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{bn=6,cn=null;return}}else if(n=g5(n,e,Fs),n!==null){cn=n;return}if(e=e.sibling,e!==null){cn=e;return}cn=e=t}while(e!==null);bn===0&&(bn=5)}function qa(t,e,n){var s=pt,r=mr.transition;try{mr.transition=null,pt=1,I5(t,e,n,s)}finally{mr.transition=r,pt=s}return null}function I5(t,e,n,s){do Yc();while(Wo!==null);if(rt&6)throw Error(le(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(le(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(iW(t,i),t===Nn&&(cn=Nn=null,On=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||mm||(mm=!0,KD(pg,function(){return Yc(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=mr.transition,mr.transition=null;var o=pt;pt=1;var a=rt;rt|=4,Rk.current=null,v5(t,n),VD(n,t),GW(Jb),gg=!!Zb,Jb=Zb=null,t.current=n,b5(n),Yj(),rt=a,pt=o,mr.transition=i}else t.current=n;if(mm&&(mm=!1,Wo=t,Rg=r),i=t.pendingLanes,i===0&&(ea=null),Qj(n.stateNode),Es(t,tn()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(Ag)throw Ag=!1,t=xw,xw=null,t;return Rg&1&&t.tag!==0&&Yc(),i=t.pendingLanes,i&1?t===vw?th++:(th=0,vw=t):th=0,Na(),null}function Yc(){if(Wo!==null){var t=IR(Rg),e=mr.transition,n=pt;try{if(mr.transition=null,pt=16>t?16:t,Wo===null)var s=!1;else{if(t=Wo,Wo=null,Rg=0,rt&6)throw Error(le(331));var r=rt;for(rt|=4,be=t.current;be!==null;){var i=be,o=i.child;if(be.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(be=c;be!==null;){var u=be;switch(u.tag){case 0:case 11:case 15:Qd(8,u,i)}var d=u.child;if(d!==null)d.return=u,be=d;else for(;be!==null;){u=be;var h=u.sibling,f=u.return;if(FD(u),u===c){be=null;break}if(h!==null){h.return=f,be=h;break}be=f}}}var p=i.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}be=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,be=o;else e:for(;be!==null;){if(i=be,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Qd(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,be=g;break e}be=i.return}}var x=t.current;for(be=x;be!==null;){o=be;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,be=v;else e:for(o=x;be!==null;){if(a=be,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Zy(9,a)}}catch(k){Ht(a,a.return,k)}if(a===o){be=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,be=b;break e}be=a.return}}if(rt=r,Na(),hi&&typeof hi.onPostCommitFiberRoot=="function")try{hi.onPostCommitFiberRoot(jy,t)}catch{}s=!0}return s}finally{pt=n,mr.transition=e}}return!1}function JN(t,e,n){e=hu(n,e),e=ID(t,e,1),t=Qo(t,e,1),e=ds(),t!==null&&(mf(t,1,e),Es(t,e))}function Ht(t,e,n){if(t.tag===3)JN(t,t,n);else for(;e!==null;){if(e.tag===3){JN(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(ea===null||!ea.has(s))){t=hu(n,t),t=TD(e,t,1),e=Qo(e,t,1),t=ds(),e!==null&&(mf(e,1,t),Es(e,t));break}}e=e.return}}function T5(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=ds(),t.pingedLanes|=t.suspendedLanes&n,Nn===t&&(On&n)===n&&(bn===4||bn===3&&(On&130023424)===On&&500>tn()-Pk?pl(t,0):Dk|=n),Es(t,e)}function HD(t,e){e===0&&(t.mode&1?(e=im,im<<=1,!(im&130023424)&&(im=4194304)):e=1);var n=ds();t=no(t,e),t!==null&&(mf(t,e,n),Es(t,n))}function N5(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),HD(t,n)}function E5(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(le(314))}s!==null&&s.delete(e),HD(t,n)}var qD;qD=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ts.current)Cs=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Cs=!1,m5(t,e,n);Cs=!!(t.flags&131072)}else Cs=!1,Ft&&e.flags&1048576&&ZR(e,Cg,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Hm(t,e),t=e.pendingProps;var r=lu(e,ts.current);Xc(e,n),r=Nk(null,e,s,t,r,n);var i=Ek();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ns(s)?(i=!0,wg(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,kk(e),r.updater=Yy,e.stateNode=r,r._reactInternals=e,aw(e,s,t,n),e=uw(null,e,s,!0,i,n)):(e.tag=0,Ft&&i&&mk(e),os(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Hm(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=_5(s),t=Er(s,t),r){case 0:e=cw(null,e,s,t,n);break e;case 1:e=UN(null,e,s,t,n);break e;case 11:e=BN(null,e,s,t,n);break e;case 14:e=zN(null,e,s,Er(s.type,t),n);break e}throw Error(le(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Er(s,r),cw(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Er(s,r),UN(t,e,s,r,n);case 3:e:{if(_D(e),t===null)throw Error(le(387));s=e.pendingProps,i=e.memoizedState,r=i.element,sD(t,e),Tg(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=hu(Error(le(423)),e),e=jN(t,e,s,n,r);break e}else if(s!==r){r=hu(Error(le(424)),e),e=jN(t,e,s,n,r);break e}else for(Ls=Jo(e.stateNode.containerInfo.firstChild),Bs=e,Ft=!0,_r=null,n=tD(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(cu(),s===r){e=so(t,e,n);break e}os(t,e,s,n)}e=e.child}return e;case 5:return rD(e),t===null&&rw(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,o=r.children,Qb(s,r)?o=null:i!==null&&Qb(s,i)&&(e.flags|=32),$D(t,e),os(t,e,o,n),e.child;case 6:return t===null&&rw(e),null;case 13:return AD(t,e,n);case 4:return Ck(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=uu(e,null,s,n):os(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Er(s,r),BN(t,e,s,r,n);case 7:return os(t,e,e.pendingProps,n),e.child;case 8:return os(t,e,e.pendingProps.children,n),e.child;case 12:return os(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,It(Sg,s._currentValue),s._currentValue=o,i!==null)if(Wr(i.value,o)){if(i.children===r.children&&!Ts.current){e=so(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=Yi(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),iw(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(le(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),iw(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}os(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Xc(e,n),r=gr(r),s=s(r),e.flags|=1,os(t,e,s,n),e.child;case 14:return s=e.type,r=Er(s,e.pendingProps),r=Er(s.type,r),zN(t,e,s,r,n);case 15:return ND(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Er(s,r),Hm(t,e),e.tag=1,Ns(s)?(t=!0,wg(e)):t=!1,Xc(e,n),SD(e,s,r),aw(e,s,r,n),uw(null,e,s,!0,t,n);case 19:return RD(t,e,n);case 22:return ED(t,e,n)}throw Error(le(156,e.tag))};function KD(t,e){return wR(t,e)}function $5(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cr(t,e,n,s){return new $5(t,e,n,s)}function Lk(t){return t=t.prototype,!(!t||!t.isReactComponent)}function _5(t){if(typeof t=="function")return Lk(t)?1:0;if(t!=null){if(t=t.$$typeof,t===sk)return 11;if(t===rk)return 14}return 2}function na(t,e){var n=t.alternate;return n===null?(n=cr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Xm(t,e,n,s,r,i){var o=2;if(s=t,typeof t=="function")Lk(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Tc:return ml(n.children,r,i,e);case nk:o=8,r|=8;break;case Ab:return t=cr(12,n,e,r|2),t.elementType=Ab,t.lanes=i,t;case Rb:return t=cr(13,n,e,r),t.elementType=Rb,t.lanes=i,t;case Db:return t=cr(19,n,e,r),t.elementType=Db,t.lanes=i,t;case rR:return Qy(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case nR:o=10;break e;case sR:o=9;break e;case sk:o=11;break e;case rk:o=14;break e;case Ro:o=16,s=null;break e}throw Error(le(130,t==null?t:typeof t,""))}return e=cr(o,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function ml(t,e,n,s){return t=cr(7,t,s,e),t.lanes=n,t}function Qy(t,e,n,s){return t=cr(22,t,s,e),t.elementType=rR,t.lanes=n,t.stateNode={isHidden:!1},t}function Dv(t,e,n){return t=cr(6,t,null,e),t.lanes=n,t}function Pv(t,e,n){return e=cr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function A5(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pv(0),this.expirationTimes=pv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pv(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Vk(t,e,n,s,r,i,o,a,l){return t=new A5(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=cr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},kk(i),t}function R5(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ic,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function XD(t){if(!t)return ha;t=t._reactInternals;e:{if(Ql(t)!==t||t.tag!==1)throw Error(le(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ns(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(le(171))}if(t.tag===1){var n=t.type;if(Ns(n))return XR(t,n,e)}return e}function YD(t,e,n,s,r,i,o,a,l){return t=Vk(n,s,!0,t,r,i,o,a,l),t.context=XD(null),n=t.current,s=ds(),r=ta(n),i=Yi(s,r),i.callback=e??null,Qo(n,i,r),t.current.lanes=r,mf(t,r,s),Es(t,s),t}function ex(t,e,n,s){var r=e.current,i=ds(),o=ta(r);return n=XD(n),e.context===null?e.context=n:e.pendingContext=n,e=Yi(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Qo(r,e,o),t!==null&&(Vr(t,r,o,i),jm(t,r,o)),o}function Pg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function QN(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Bk(t,e){QN(t,e),(t=t.alternate)&&QN(t,e)}function D5(){return null}var ZD=typeof reportError=="function"?reportError:function(t){console.error(t)};function zk(t){this._internalRoot=t}tx.prototype.render=zk.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(le(409));ex(t,e,null,null)};tx.prototype.unmount=zk.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Tl(function(){ex(null,t,null,null)}),e[to]=null}};function tx(t){this._internalRoot=t}tx.prototype.unstable_scheduleHydration=function(t){if(t){var e=ER();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Oo.length&&e!==0&&e<Oo[n].priority;n++);Oo.splice(n,0,t),n===0&&_R(t)}};function Uk(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function nx(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function e2(){}function P5(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var c=Pg(o);i.call(c)}}var o=YD(e,s,t,0,null,!1,!1,"",e2);return t._reactRootContainer=o,t[to]=o.current,kh(t.nodeType===8?t.parentNode:t),Tl(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var c=Pg(l);a.call(c)}}var l=Vk(t,0,!1,null,null,!1,!1,"",e2);return t._reactRootContainer=l,t[to]=l.current,kh(t.nodeType===8?t.parentNode:t),Tl(function(){ex(e,l,n,s)}),l}function sx(t,e,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var a=r;r=function(){var l=Pg(o);a.call(l)}}ex(e,o,t,r)}else o=P5(n,e,t,r,s);return Pg(o)}TR=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Pd(e.pendingLanes);n!==0&&(ak(e,n|1),Es(e,tn()),!(rt&6)&&(fu=tn()+500,Na()))}break;case 13:Tl(function(){var s=no(t,1);if(s!==null){var r=ds();Vr(s,t,1,r)}}),Bk(t,1)}};lk=function(t){if(t.tag===13){var e=no(t,134217728);if(e!==null){var n=ds();Vr(e,t,134217728,n)}Bk(t,134217728)}};NR=function(t){if(t.tag===13){var e=ta(t),n=no(t,e);if(n!==null){var s=ds();Vr(n,t,e,s)}Bk(t,e)}};ER=function(){return pt};$R=function(t,e){var n=pt;try{return pt=t,e()}finally{pt=n}};jb=function(t,e,n){switch(e){case"input":if(Fb(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=qy(s);if(!r)throw Error(le(90));oR(s),Fb(s,r)}}}break;case"textarea":lR(t,n);break;case"select":e=n.value,e!=null&&Gc(t,!!n.multiple,e,!1)}};mR=Ok;gR=Tl;var O5={usingClientEntryPoint:!1,Events:[yf,_c,qy,fR,pR,Ok]},vd={findFiberByHostInstance:sl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},F5={bundleType:vd.bundleType,version:vd.version,rendererPackageName:vd.rendererPackageName,rendererConfig:vd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:go.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=vR(t),t===null?null:t.stateNode},findFiberByHostInstance:vd.findFiberByHostInstance||D5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gm.isDisabled&&gm.supportsFiber)try{jy=gm.inject(F5),hi=gm}catch{}}Ks.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O5;Ks.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Uk(e))throw Error(le(200));return R5(t,e,null,n)};Ks.createRoot=function(t,e){if(!Uk(t))throw Error(le(299));var n=!1,s="",r=ZD;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Vk(t,1,!1,null,null,n,!1,s,r),t[to]=e.current,kh(t.nodeType===8?t.parentNode:t),new zk(e)};Ks.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(le(188)):(t=Object.keys(t).join(","),Error(le(268,t)));return t=vR(e),t=t===null?null:t.stateNode,t};Ks.flushSync=function(t){return Tl(t)};Ks.hydrate=function(t,e,n){if(!nx(e))throw Error(le(200));return sx(null,t,e,!0,n)};Ks.hydrateRoot=function(t,e,n){if(!Uk(t))throw Error(le(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=ZD;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=YD(e,null,t,1,n??null,r,!1,i,o),t[to]=e.current,kh(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new tx(e)};Ks.render=function(t,e,n){if(!nx(e))throw Error(le(200));return sx(null,t,e,!1,n)};Ks.unmountComponentAtNode=function(t){if(!nx(t))throw Error(le(40));return t._reactRootContainer?(Tl(function(){sx(null,null,t,!1,function(){t._reactRootContainer=null,t[to]=null})}),!0):!1};Ks.unstable_batchedUpdates=Ok;Ks.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!nx(n))throw Error(le(200));if(t==null||t._reactInternals===void 0)throw Error(le(38));return sx(t,e,n,!1,s)};Ks.version="18.3.1-next-f1338f8080-20240426";function JD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(JD)}catch(t){console.error(t)}}JD(),JA.exports=Ks;var M5=JA.exports,QD,t2=M5;QD=t2.createRoot,t2.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ah(){return Ah=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ah.apply(this,arguments)}var Go;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Go||(Go={}));const n2="popstate";function L5(t){t===void 0&&(t={});function e(s,r){let{pathname:i,search:o,hash:a}=s.location;return kw("",{pathname:i,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:Og(r)}return B5(e,n,null,t)}function sn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function eP(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function V5(){return Math.random().toString(36).substr(2,8)}function s2(t,e){return{usr:t.state,key:t.key,idx:e}}function kw(t,e,n,s){return n===void 0&&(n=null),Ah({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Lu(e):e,{state:n,key:e&&e.key||s||V5()})}function Og(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Lu(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function B5(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,a=Go.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(Ah({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function d(){a=Go.Pop;let y=u(),g=y==null?null:y-c;c=y,l&&l({action:a,location:m.location,delta:g})}function h(y,g){a=Go.Push;let x=kw(m.location,y,g);c=u()+1;let v=s2(x,c),b=m.createHref(x);try{o.pushState(v,"",b)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;r.location.assign(b)}i&&l&&l({action:a,location:m.location,delta:1})}function f(y,g){a=Go.Replace;let x=kw(m.location,y,g);c=u();let v=s2(x,c),b=m.createHref(x);o.replaceState(v,"",b),i&&l&&l({action:a,location:m.location,delta:0})}function p(y){let g=r.location.origin!=="null"?r.location.origin:r.location.href,x=typeof y=="string"?y:Og(y);return x=x.replace(/ $/,"%20"),sn(g,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,g)}let m={get action(){return a},get location(){return t(r,o)},listen(y){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(n2,d),l=y,()=>{r.removeEventListener(n2,d),l=null}},createHref(y){return e(r,y)},createURL:p,encodeLocation(y){let g=p(y);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:h,replace:f,go(y){return o.go(y)}};return m}var r2;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(r2||(r2={}));function z5(t,e,n){return n===void 0&&(n="/"),U5(t,e,n)}function U5(t,e,n,s){let r=typeof e=="string"?Lu(e):e,i=jk(r.pathname||"/",n);if(i==null)return null;let o=tP(t);j5(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=t6(i);a=J5(o[l],c)}return a}function tP(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(sn(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let c=sa([s,l.relativePath]),u=n.concat(l);i.children&&i.children.length>0&&(sn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),tP(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:Y5(c,i.index),routesMeta:u})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))r(i,o);else for(let l of nP(i.path))r(i,o,l)}),e}function nP(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=nP(s.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),r&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function j5(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Z5(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const W5=/^:[\w-]+$/,G5=3,H5=2,q5=1,K5=10,X5=-2,i2=t=>t==="*";function Y5(t,e){let n=t.split("/"),s=n.length;return n.some(i2)&&(s+=X5),e&&(s+=H5),n.filter(r=>!i2(r)).reduce((r,i)=>r+(W5.test(i)?G5:i===""?q5:K5),s)}function Z5(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function J5(t,e,n){let{routesMeta:s}=t,r={},i="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],c=a===s.length-1,u=i==="/"?e:e.slice(i.length)||"/",d=Q5({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d)return null;Object.assign(r,d.params),o.push({params:r,pathname:sa([i,d.pathname]),pathnameBase:i6(sa([i,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(i=sa([i,d.pathnameBase]))}return o}function Q5(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=e6(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:s.reduce((c,u,d)=>{let{paramName:h,isOptional:f}=u;if(h==="*"){let m=a[d]||"";o=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[d];return f&&!p?c[h]=void 0:c[h]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function e6(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),eP(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function t6(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return eP(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function jk(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function n6(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?Lu(t):t;return{pathname:n?n.startsWith("/")?n:s6(n,e):e,search:o6(s),hash:a6(r)}}function s6(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Ov(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function r6(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Wk(t,e){let n=r6(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function Gk(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=Lu(t):(r=Ah({},t),sn(!r.pathname||!r.pathname.includes("?"),Ov("?","pathname","search",r)),sn(!r.pathname||!r.pathname.includes("#"),Ov("#","pathname","hash",r)),sn(!r.search||!r.search.includes("#"),Ov("#","search","hash",r)));let i=t===""||r.pathname==="",o=i?"/":r.pathname,a;if(o==null)a=n;else{let d=e.length-1;if(!s&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),d-=1;r.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=n6(r,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const sa=t=>t.join("/").replace(/\/\/+/g,"/"),i6=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),o6=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,a6=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function l6(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const sP=["post","put","patch","delete"];new Set(sP);const c6=["get",...sP];new Set(c6);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rh(){return Rh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Rh.apply(this,arguments)}const Hk=M.createContext(null),u6=M.createContext(null),Ea=M.createContext(null),rx=M.createContext(null),$a=M.createContext({outlet:null,matches:[],isDataRoute:!1}),rP=M.createContext(null);function d6(t,e){let{relative:n}=e===void 0?{}:e;Vu()||sn(!1);let{basename:s,navigator:r}=M.useContext(Ea),{hash:i,pathname:o,search:a}=oP(t,{relative:n}),l=o;return s!=="/"&&(l=o==="/"?s:sa([s,o])),r.createHref({pathname:l,search:a,hash:i})}function Vu(){return M.useContext(rx)!=null}function vf(){return Vu()||sn(!1),M.useContext(rx).location}function iP(t){M.useContext(Ea).static||M.useLayoutEffect(t)}function Bu(){let{isDataRoute:t}=M.useContext($a);return t?S6():h6()}function h6(){Vu()||sn(!1);let t=M.useContext(Hk),{basename:e,future:n,navigator:s}=M.useContext(Ea),{matches:r}=M.useContext($a),{pathname:i}=vf(),o=JSON.stringify(Wk(r,n.v7_relativeSplatPath)),a=M.useRef(!1);return iP(()=>{a.current=!0}),M.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){s.go(c);return}let d=Gk(c,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:sa([e,d.pathname])),(u.replace?s.replace:s.push)(d,u.state,u)},[e,s,o,i,t])}function oP(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=M.useContext(Ea),{matches:r}=M.useContext($a),{pathname:i}=vf(),o=JSON.stringify(Wk(r,s.v7_relativeSplatPath));return M.useMemo(()=>Gk(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function f6(t,e){return p6(t,e)}function p6(t,e,n,s){Vu()||sn(!1);let{navigator:r,static:i}=M.useContext(Ea),{matches:o}=M.useContext($a),a=o[o.length-1],l=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=vf(),d;if(e){var h;let g=typeof e=="string"?Lu(e):e;c==="/"||(h=g.pathname)!=null&&h.startsWith(c)||sn(!1),d=g}else d=u;let f=d.pathname||"/",p=f;if(c!=="/"){let g=c.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(g.length).join("/")}let m=z5(t,{pathname:p}),y=v6(m&&m.map(g=>Object.assign({},g,{params:Object.assign({},l,g.params),pathname:sa([c,r.encodeLocation?r.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?c:sa([c,r.encodeLocation?r.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),o,n,s);return e&&y?M.createElement(rx.Provider,{value:{location:Rh({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Go.Pop}},y):y}function m6(){let t=C6(),e=l6(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return M.createElement(M.Fragment,null,M.createElement("h2",null,"Unexpected Application Error!"),M.createElement("h3",{style:{fontStyle:"italic"}},e),n?M.createElement("pre",{style:r},n):null,null)}const g6=M.createElement(m6,null);class y6 extends M.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?M.createElement($a.Provider,{value:this.props.routeContext},M.createElement(rP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function x6(t){let{routeContext:e,match:n,children:s}=t,r=M.useContext(Hk);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),M.createElement($a.Provider,{value:e},s)}function v6(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let u=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||sn(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(n&&s&&s.v7_partialHydration)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:h,errors:f}=n,p=d.route.loader&&h[d.route.id]===void 0&&(!f||f[d.route.id]===void 0);if(d.route.lazy||p){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,d,h)=>{let f,p=!1,m=null,y=null;n&&(f=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||g6,l&&(c<0&&h===0?(I6("route-fallback"),p=!0,y=null):c===h&&(p=!0,y=d.route.hydrateFallbackElement||null)));let g=e.concat(o.slice(0,h+1)),x=()=>{let v;return f?v=m:p?v=y:d.route.Component?v=M.createElement(d.route.Component,null):d.route.element?v=d.route.element:v=u,M.createElement(x6,{match:d,routeContext:{outlet:u,matches:g,isDataRoute:n!=null},children:v})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?M.createElement(y6,{location:n.location,revalidation:n.revalidation,component:m,error:f,children:x(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):x()},null)}var aP=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(aP||{}),lP=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(lP||{});function b6(t){let e=M.useContext(Hk);return e||sn(!1),e}function w6(t){let e=M.useContext(u6);return e||sn(!1),e}function k6(t){let e=M.useContext($a);return e||sn(!1),e}function cP(t){let e=k6(),n=e.matches[e.matches.length-1];return n.route.id||sn(!1),n.route.id}function C6(){var t;let e=M.useContext(rP),n=w6(),s=cP();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function S6(){let{router:t}=b6(aP.UseNavigateStable),e=cP(lP.UseNavigateStable),n=M.useRef(!1);return iP(()=>{n.current=!0}),M.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,Rh({fromRouteId:e},i)))},[t,e])}const o2={};function I6(t,e,n){o2[t]||(o2[t]=!0)}function T6(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function N6(t){let{to:e,replace:n,state:s,relative:r}=t;Vu()||sn(!1);let{future:i,static:o}=M.useContext(Ea),{matches:a}=M.useContext($a),{pathname:l}=vf(),c=Bu(),u=Gk(e,Wk(a,i.v7_relativeSplatPath),l,r==="path"),d=JSON.stringify(u);return M.useEffect(()=>c(JSON.parse(d),{replace:n,state:s,relative:r}),[c,d,r,n,s]),null}function _o(t){sn(!1)}function E6(t){let{basename:e="/",children:n=null,location:s,navigationType:r=Go.Pop,navigator:i,static:o=!1,future:a}=t;Vu()&&sn(!1);let l=e.replace(/^\/*/,"/"),c=M.useMemo(()=>({basename:l,navigator:i,static:o,future:Rh({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof s=="string"&&(s=Lu(s));let{pathname:u="/",search:d="",hash:h="",state:f=null,key:p="default"}=s,m=M.useMemo(()=>{let y=jk(u,l);return y==null?null:{location:{pathname:y,search:d,hash:h,state:f,key:p},navigationType:r}},[l,u,d,h,f,p,r]);return m==null?null:M.createElement(Ea.Provider,{value:c},M.createElement(rx.Provider,{children:n,value:m}))}function $6(t){let{children:e,location:n}=t;return f6(Cw(e),n)}new Promise(()=>{});function Cw(t,e){e===void 0&&(e=[]);let n=[];return M.Children.forEach(t,(s,r)=>{if(!M.isValidElement(s))return;let i=[...e,r];if(s.type===M.Fragment){n.push.apply(n,Cw(s.props.children,i));return}s.type!==_o&&sn(!1),!s.props.index||!s.props.children||sn(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=Cw(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sw(){return Sw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Sw.apply(this,arguments)}function _6(t,e){if(t==null)return{};var n={},s=Object.keys(t),r,i;for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function A6(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function R6(t,e){return t.button===0&&(!e||e==="_self")&&!A6(t)}const D6=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],P6="6";try{window.__reactRouterVersion=P6}catch{}const O6="startTransition",a2=Tj[O6];function F6(t){let{basename:e,children:n,future:s,window:r}=t,i=M.useRef();i.current==null&&(i.current=L5({window:r,v5Compat:!0}));let o=i.current,[a,l]=M.useState({action:o.action,location:o.location}),{v7_startTransition:c}=s||{},u=M.useCallback(d=>{c&&a2?a2(()=>l(d)):l(d)},[l,c]);return M.useLayoutEffect(()=>o.listen(u),[o,u]),M.useEffect(()=>T6(s),[s]),M.createElement(E6,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:s})}const M6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",L6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ym=M.forwardRef(function(e,n){let{onClick:s,relative:r,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d}=e,h=_6(e,D6),{basename:f}=M.useContext(Ea),p,m=!1;if(typeof c=="string"&&L6.test(c)&&(p=c,M6))try{let v=new URL(window.location.href),b=c.startsWith("//")?new URL(v.protocol+c):new URL(c),k=jk(b.pathname,f);b.origin===v.origin&&k!=null?c=k+b.search+b.hash:m=!0}catch{}let y=d6(c,{relative:r}),g=V6(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:r,viewTransition:d});function x(v){s&&s(v),v.defaultPrevented||g(v)}return M.createElement("a",Sw({},h,{href:p||y,onClick:m||i?s:x,ref:n,target:l}))});var l2;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(l2||(l2={}));var c2;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(c2||(c2={}));function V6(t,e){let{target:n,replace:s,state:r,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=Bu(),c=vf(),u=oP(t,{relative:o});return M.useCallback(d=>{if(R6(d,n)){d.preventDefault();let h=s!==void 0?s:Og(c)===Og(u);l(t,{replace:h,state:r,preventScrollReset:i,relative:o,viewTransition:a})}},[c,l,u,s,r,n,t,i,o,a])}let B6={data:""},z6=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||B6,U6=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,j6=/\/\*[^]*?\*\/|  +/g,u2=/\n+/g,Mo=(t,e)=>{let n="",s="",r="";for(let i in t){let o=t[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":s+=i[1]=="f"?Mo(o,i):i+"{"+Mo(o,i[1]=="k"?"":e)+"}":typeof o=="object"?s+=Mo(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,a):a?a+" "+l:l)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=Mo.p?Mo.p(i,o):i+":"+o+";")}return n+(e&&r?e+"{"+r+"}":r)+s},Oi={},uP=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+uP(t[n]);return e}return t},W6=(t,e,n,s,r)=>{let i=uP(t),o=Oi[i]||(Oi[i]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(i));if(!Oi[o]){let l=i!==t?t:(c=>{let u,d,h=[{}];for(;u=U6.exec(c.replace(j6,""));)u[4]?h.shift():u[3]?(d=u[3].replace(u2," ").trim(),h.unshift(h[0][d]=h[0][d]||{})):h[0][u[1]]=u[2].replace(u2," ").trim();return h[0]})(t);Oi[o]=Mo(r?{["@keyframes "+o]:l}:l,n?"":"."+o)}let a=n&&Oi.g?Oi.g:null;return n&&(Oi.g=Oi[o]),((l,c,u,d)=>{d?c.data=c.data.replace(d,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(Oi[o],e,s,a),o},G6=(t,e,n)=>t.reduce((s,r,i)=>{let o=e[i];if(o&&o.call){let a=o(n),l=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=l?"."+l:a&&typeof a=="object"?a.props?"":Mo(a,""):a===!1?"":a}return s+r+(o??"")},"");function ix(t){let e=this||{},n=t.call?t(e.p):t;return W6(n.unshift?n.raw?G6(n,[].slice.call(arguments,1),e.p):n.reduce((s,r)=>Object.assign(s,r&&r.call?r(e.p):r),{}):n,z6(e.target),e.g,e.o,e.k)}let dP,Iw,Tw;ix.bind({g:1});let ro=ix.bind({k:1});function H6(t,e,n,s){Mo.p=e,dP=t,Iw=n,Tw=s}function _a(t,e){let n=this||{};return function(){let s=arguments;function r(i,o){let a=Object.assign({},i),l=a.className||r.className;n.p=Object.assign({theme:Iw&&Iw()},a),n.o=/ *go\d+/.test(l),a.className=ix.apply(n,s)+(l?" "+l:"");let c=t;return t[0]&&(c=a.as||t,delete a.as),Tw&&c[0]&&Tw(a),dP(c,a)}return r}}var q6=t=>typeof t=="function",Fg=(t,e)=>q6(t)?t(e):t,K6=(()=>{let t=0;return()=>(++t).toString()})(),hP=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),X6=20,fP=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,X6)};case 1:return{...t,toasts:t.toasts.map(i=>i.id===e.toast.id?{...i,...e.toast}:i)};case 2:let{toast:n}=e;return fP(t,{type:t.toasts.find(i=>i.id===n.id)?1:0,toast:n});case 3:let{toastId:s}=e;return{...t,toasts:t.toasts.map(i=>i.id===s||s===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(i=>i.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let r=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+r}))}}},Ym=[],ol={toasts:[],pausedAt:void 0},ec=t=>{ol=fP(ol,t),Ym.forEach(e=>{e(ol)})},Y6={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Z6=(t={})=>{let[e,n]=M.useState(ol),s=M.useRef(ol);M.useEffect(()=>(s.current!==ol&&n(ol),Ym.push(n),()=>{let i=Ym.indexOf(n);i>-1&&Ym.splice(i,1)}),[]);let r=e.toasts.map(i=>{var o,a,l;return{...t,...t[i.type],...i,removeDelay:i.removeDelay||((o=t[i.type])==null?void 0:o.removeDelay)||(t==null?void 0:t.removeDelay),duration:i.duration||((a=t[i.type])==null?void 0:a.duration)||(t==null?void 0:t.duration)||Y6[i.type],style:{...t.style,...(l=t[i.type])==null?void 0:l.style,...i.style}}});return{...e,toasts:r}},J6=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||K6()}),bf=t=>(e,n)=>{let s=J6(e,t,n);return ec({type:2,toast:s}),s.id},zt=(t,e)=>bf("blank")(t,e);zt.error=bf("error");zt.success=bf("success");zt.loading=bf("loading");zt.custom=bf("custom");zt.dismiss=t=>{ec({type:3,toastId:t})};zt.remove=t=>ec({type:4,toastId:t});zt.promise=(t,e,n)=>{let s=zt.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(r=>{let i=e.success?Fg(e.success,r):void 0;return i?zt.success(i,{id:s,...n,...n==null?void 0:n.success}):zt.dismiss(s),r}).catch(r=>{let i=e.error?Fg(e.error,r):void 0;i?zt.error(i,{id:s,...n,...n==null?void 0:n.error}):zt.dismiss(s)}),t};var Q6=(t,e)=>{ec({type:1,toast:{id:t,height:e}})},eG=()=>{ec({type:5,time:Date.now()})},nh=new Map,tG=1e3,nG=(t,e=tG)=>{if(nh.has(t))return;let n=setTimeout(()=>{nh.delete(t),ec({type:4,toastId:t})},e);nh.set(t,n)},sG=t=>{let{toasts:e,pausedAt:n}=Z6(t);M.useEffect(()=>{if(n)return;let i=Date.now(),o=e.map(a=>{if(a.duration===1/0)return;let l=(a.duration||0)+a.pauseDuration-(i-a.createdAt);if(l<0){a.visible&&zt.dismiss(a.id);return}return setTimeout(()=>zt.dismiss(a.id),l)});return()=>{o.forEach(a=>a&&clearTimeout(a))}},[e,n]);let s=M.useCallback(()=>{n&&ec({type:6,time:Date.now()})},[n]),r=M.useCallback((i,o)=>{let{reverseOrder:a=!1,gutter:l=8,defaultPosition:c}=o||{},u=e.filter(f=>(f.position||c)===(i.position||c)&&f.height),d=u.findIndex(f=>f.id===i.id),h=u.filter((f,p)=>p<d&&f.visible).length;return u.filter(f=>f.visible).slice(...a?[h+1]:[0,h]).reduce((f,p)=>f+(p.height||0)+l,0)},[e]);return M.useEffect(()=>{e.forEach(i=>{if(i.dismissed)nG(i.id,i.removeDelay);else{let o=nh.get(i.id);o&&(clearTimeout(o),nh.delete(i.id))}})},[e]),{toasts:e,handlers:{updateHeight:Q6,startPause:eG,endPause:s,calculateOffset:r}}},rG=ro`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,iG=ro`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,oG=ro`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,aG=_a("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${rG} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${iG} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${oG} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,lG=ro`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,cG=_a("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${lG} 1s linear infinite;
`,uG=ro`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,dG=ro`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,hG=_a("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${uG} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${dG} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,fG=_a("div")`
  position: absolute;
`,pG=_a("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,mG=ro`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,gG=_a("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${mG} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,yG=({toast:t})=>{let{icon:e,type:n,iconTheme:s}=t;return e!==void 0?typeof e=="string"?M.createElement(gG,null,e):e:n==="blank"?null:M.createElement(pG,null,M.createElement(cG,{...s}),n!=="loading"&&M.createElement(fG,null,n==="error"?M.createElement(aG,{...s}):M.createElement(hG,{...s})))},xG=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,vG=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,bG="0%{opacity:0;} 100%{opacity:1;}",wG="0%{opacity:1;} 100%{opacity:0;}",kG=_a("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,CG=_a("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,SG=(t,e)=>{let n=t.includes("top")?1:-1,[s,r]=hP()?[bG,wG]:[xG(n),vG(n)];return{animation:e?`${ro(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ro(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},IG=M.memo(({toast:t,position:e,style:n,children:s})=>{let r=t.height?SG(t.position||e||"top-center",t.visible):{opacity:0},i=M.createElement(yG,{toast:t}),o=M.createElement(CG,{...t.ariaProps},Fg(t.message,t));return M.createElement(kG,{className:t.className,style:{...r,...n,...t.style}},typeof s=="function"?s({icon:i,message:o}):M.createElement(M.Fragment,null,i,o))});H6(M.createElement);var TG=({id:t,className:e,style:n,onHeightUpdate:s,children:r})=>{let i=M.useCallback(o=>{if(o){let a=()=>{let l=o.getBoundingClientRect().height;s(t,l)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[t,s]);return M.createElement("div",{ref:i,className:e,style:n},r)},NG=(t,e)=>{let n=t.includes("top"),s=n?{top:0}:{bottom:0},r=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:hP()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...s,...r}},EG=ix`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,xm=16,$G=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:s,children:r,containerStyle:i,containerClassName:o})=>{let{toasts:a,handlers:l}=sG(n);return M.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:xm,left:xm,right:xm,bottom:xm,pointerEvents:"none",...i},className:o,onMouseEnter:l.startPause,onMouseLeave:l.endPause},a.map(c=>{let u=c.position||e,d=l.calculateOffset(c,{reverseOrder:t,gutter:s,defaultPosition:e}),h=NG(u,d);return M.createElement(TG,{id:c.id,key:c.id,onHeightUpdate:l.updateHeight,className:c.visible?EG:"",style:h},c.type==="custom"?Fg(c.message,c):r?r(c):M.createElement(IG,{toast:c,position:u}))}))};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var _G={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AG=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),$t=(t,e)=>{const n=M.forwardRef(({color:s="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:a="",children:l,...c},u)=>M.createElement("svg",{ref:u,..._G,width:r,height:r,stroke:s,strokeWidth:o?Number(i)*24/Number(r):i,className:["lucide",`lucide-${AG(t)}`,a].join(" "),...c},[...e.map(([d,h])=>M.createElement(d,h)),...Array.isArray(l)?l:[l]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RG=$t("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DG=$t("AlarmClock",[["circle",{cx:"12",cy:"13",r:"8",key:"3y4lt7"}],["path",{d:"M12 9v4l2 2",key:"1c63tq"}],["path",{d:"M5 3 2 6",key:"18tl5t"}],["path",{d:"m22 6-3-3",key:"1opdir"}],["path",{d:"M6.38 18.7 4 21",key:"17xu3x"}],["path",{d:"M17.64 18.67 20 21",key:"kv2oe2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PG=$t("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OG=$t("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d2=$t("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FG=$t("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MG=$t("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LG=$t("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vm=$t("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VG=$t("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BG=$t("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zG=$t("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mg=$t("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pP=$t("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UG=$t("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jG=$t("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mP=$t("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WG=$t("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gP=$t("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GG=$t("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HG=$t("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qG=$t("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=$t("Stethoscope",[["path",{d:"M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3",key:"1jd90r"}],["path",{d:"M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4",key:"126ukv"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ox=$t("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KG=$t("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qk=$t("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function yP(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=yP(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function XG(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=yP(t))&&(s&&(s+=" "),s+=e);return s}const Kk="-",YG=t=>{const e=JG(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=t;return{getClassGroupId:o=>{const a=o.split(Kk);return a[0]===""&&a.length!==1&&a.shift(),xP(a,e)||ZG(o)},getConflictingClassGroupIds:(o,a)=>{const l=n[o]||[];return a&&s[o]?[...l,...s[o]]:l}}},xP=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],s=e.nextPart.get(n),r=s?xP(t.slice(1),s):void 0;if(r)return r;if(e.validators.length===0)return;const i=t.join(Kk);return(o=e.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},f2=/^\[(.+)\]$/,ZG=t=>{if(f2.test(t)){const e=f2.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},JG=t=>{const{theme:e,prefix:n}=t,s={nextPart:new Map,validators:[]};return eH(Object.entries(t.classGroups),n).forEach(([i,o])=>{Nw(o,s,i,e)}),s},Nw=(t,e,n,s)=>{t.forEach(r=>{if(typeof r=="string"){const i=r===""?e:p2(e,r);i.classGroupId=n;return}if(typeof r=="function"){if(QG(r)){Nw(r(s),e,n,s);return}e.validators.push({validator:r,classGroupId:n});return}Object.entries(r).forEach(([i,o])=>{Nw(o,p2(e,i),n,s)})})},p2=(t,e)=>{let n=t;return e.split(Kk).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},QG=t=>t.isThemeGetter,eH=(t,e)=>e?t.map(([n,s])=>{const r=s.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[e+o,a])):i);return[n,r]}):t,tH=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,s=new Map;const r=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,s=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=s.get(i))!==void 0)return r(i,o),o},set(i,o){n.has(i)?n.set(i,o):r(i,o)}}},vP="!",nH=t=>{const{separator:e,experimentalParseClassName:n}=t,s=e.length===1,r=e[0],i=e.length,o=a=>{const l=[];let c=0,u=0,d;for(let y=0;y<a.length;y++){let g=a[y];if(c===0){if(g===r&&(s||a.slice(y,y+i)===e)){l.push(a.slice(u,y)),u=y+i;continue}if(g==="/"){d=y;continue}}g==="["?c++:g==="]"&&c--}const h=l.length===0?a:a.substring(u),f=h.startsWith(vP),p=f?h.substring(1):h,m=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:m}};return n?a=>n({className:a,parseClassName:o}):o},sH=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(s=>{s[0]==="["?(e.push(...n.sort(),s),n=[]):n.push(s)}),e.push(...n.sort()),e},rH=t=>({cache:tH(t.cacheSize),parseClassName:nH(t),...YG(t)}),iH=/\s+/,oH=(t,e)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:r}=e,i=[],o=t.trim().split(iH);let a="";for(let l=o.length-1;l>=0;l-=1){const c=o[l],{modifiers:u,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:f}=n(c);let p=!!f,m=s(p?h.substring(0,f):h);if(!m){if(!p){a=c+(a.length>0?" "+a:a);continue}if(m=s(h),!m){a=c+(a.length>0?" "+a:a);continue}p=!1}const y=sH(u).join(":"),g=d?y+vP:y,x=g+m;if(i.includes(x))continue;i.push(x);const v=r(m,p);for(let b=0;b<v.length;++b){const k=v[b];i.push(g+k)}a=c+(a.length>0?" "+a:a)}return a};function aH(){let t=0,e,n,s="";for(;t<arguments.length;)(e=arguments[t++])&&(n=bP(e))&&(s&&(s+=" "),s+=n);return s}const bP=t=>{if(typeof t=="string")return t;let e,n="";for(let s=0;s<t.length;s++)t[s]&&(e=bP(t[s]))&&(n&&(n+=" "),n+=e);return n};function lH(t,...e){let n,s,r,i=o;function o(l){const c=e.reduce((u,d)=>d(u),t());return n=rH(c),s=n.cache.get,r=n.cache.set,i=a,a(l)}function a(l){const c=s(l);if(c)return c;const u=oH(l,n);return r(l,u),u}return function(){return i(aH.apply(null,arguments))}}const _t=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},wP=/^\[(?:([a-z-]+):)?(.+)\]$/i,cH=/^\d+\/\d+$/,uH=new Set(["px","full","screen"]),dH=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,hH=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,fH=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,pH=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,mH=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Fi=t=>Zc(t)||uH.has(t)||cH.test(t),Io=t=>zu(t,"length",CH),Zc=t=>!!t&&!Number.isNaN(Number(t)),Fv=t=>zu(t,"number",Zc),bd=t=>!!t&&Number.isInteger(Number(t)),gH=t=>t.endsWith("%")&&Zc(t.slice(0,-1)),je=t=>wP.test(t),To=t=>dH.test(t),yH=new Set(["length","size","percentage"]),xH=t=>zu(t,yH,kP),vH=t=>zu(t,"position",kP),bH=new Set(["image","url"]),wH=t=>zu(t,bH,IH),kH=t=>zu(t,"",SH),wd=()=>!0,zu=(t,e,n)=>{const s=wP.exec(t);return s?s[1]?typeof e=="string"?s[1]===e:e.has(s[1]):n(s[2]):!1},CH=t=>hH.test(t)&&!fH.test(t),kP=()=>!1,SH=t=>pH.test(t),IH=t=>mH.test(t),TH=()=>{const t=_t("colors"),e=_t("spacing"),n=_t("blur"),s=_t("brightness"),r=_t("borderColor"),i=_t("borderRadius"),o=_t("borderSpacing"),a=_t("borderWidth"),l=_t("contrast"),c=_t("grayscale"),u=_t("hueRotate"),d=_t("invert"),h=_t("gap"),f=_t("gradientColorStops"),p=_t("gradientColorStopPositions"),m=_t("inset"),y=_t("margin"),g=_t("opacity"),x=_t("padding"),v=_t("saturate"),b=_t("scale"),k=_t("sepia"),C=_t("skew"),S=_t("space"),I=_t("translate"),N=()=>["auto","contain","none"],E=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto",je,e],R=()=>[je,e],L=()=>["",Fi,Io],B=()=>["auto",Zc,je],W=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],G=()=>["solid","dashed","dotted","double","none"],q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],A=()=>["start","end","center","between","around","evenly","stretch"],z=()=>["","0",je],P=()=>["auto","avoid","all","avoid-page","page","left","right","column"],X=()=>[Zc,je];return{cacheSize:500,separator:":",theme:{colors:[wd],spacing:[Fi,Io],blur:["none","",To,je],brightness:X(),borderColor:[t],borderRadius:["none","","full",To,je],borderSpacing:R(),borderWidth:L(),contrast:X(),grayscale:z(),hueRotate:X(),invert:z(),gap:R(),gradientColorStops:[t],gradientColorStopPositions:[gH,Io],inset:D(),margin:D(),opacity:X(),padding:R(),saturate:X(),scale:X(),sepia:z(),skew:X(),space:R(),translate:R()},classGroups:{aspect:[{aspect:["auto","square","video",je]}],container:["container"],columns:[{columns:[To]}],"break-after":[{"break-after":P()}],"break-before":[{"break-before":P()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...W(),je]}],overflow:[{overflow:E()}],"overflow-x":[{"overflow-x":E()}],"overflow-y":[{"overflow-y":E()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",bd,je]}],basis:[{basis:D()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",je]}],grow:[{grow:z()}],shrink:[{shrink:z()}],order:[{order:["first","last","none",bd,je]}],"grid-cols":[{"grid-cols":[wd]}],"col-start-end":[{col:["auto",{span:["full",bd,je]},je]}],"col-start":[{"col-start":B()}],"col-end":[{"col-end":B()}],"grid-rows":[{"grid-rows":[wd]}],"row-start-end":[{row:["auto",{span:[bd,je]},je]}],"row-start":[{"row-start":B()}],"row-end":[{"row-end":B()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",je]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",je]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...A()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...A(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...A(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[x]}],px:[{px:[x]}],py:[{py:[x]}],ps:[{ps:[x]}],pe:[{pe:[x]}],pt:[{pt:[x]}],pr:[{pr:[x]}],pb:[{pb:[x]}],pl:[{pl:[x]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",je,e]}],"min-w":[{"min-w":[je,e,"min","max","fit"]}],"max-w":[{"max-w":[je,e,"none","full","min","max","fit","prose",{screen:[To]},To]}],h:[{h:[je,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[je,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[je,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[je,e,"auto","min","max","fit"]}],"font-size":[{text:["base",To,Io]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Fv]}],"font-family":[{font:[wd]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",je]}],"line-clamp":[{"line-clamp":["none",Zc,Fv]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Fi,je]}],"list-image":[{"list-image":["none",je]}],"list-style-type":[{list:["none","disc","decimal",je]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...G(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Fi,Io]}],"underline-offset":[{"underline-offset":["auto",Fi,je]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",je]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",je]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...W(),vH]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",xH]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},wH]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:[...G(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:G()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...G()]}],"outline-offset":[{"outline-offset":[Fi,je]}],"outline-w":[{outline:[Fi,Io]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:L()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[Fi,Io]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",To,kH]}],"shadow-color":[{shadow:[wd]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":[...q(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":q()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",To,je]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[v]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[v]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",je]}],duration:[{duration:X()}],ease:[{ease:["linear","in","out","in-out",je]}],delay:[{delay:X()}],animate:[{animate:["none","spin","ping","pulse","bounce",je]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[bd,je]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",je]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",je]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",je]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Fi,Io,Fv]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},NH=lH(TH);function EH(...t){return NH(XG(t))}const In=M.forwardRef(({className:t,variant:e="primary",size:n="md",...s},r)=>w.jsx("button",{ref:r,className:EH("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-blue-600 text-white hover:bg-blue-700":e==="primary","bg-gray-100 text-gray-900 hover:bg-gray-200":e==="secondary","border border-gray-300 bg-transparent hover:bg-gray-50":e==="outline","h-8 px-3 text-sm":n==="sm","h-10 px-4":n==="md","h-12 px-6 text-lg":n==="lg"},t),...s}));In.displayName="Button";const $H={},m2=t=>{let e;const n=new Set,s=(u,d)=>{const h=typeof u=="function"?u(e):u;if(!Object.is(h,e)){const f=e;e=d??(typeof h!="object"||h===null)?h:Object.assign({},e,h),n.forEach(p=>p(e,f))}},r=()=>e,l={setState:s,getState:r,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{($H?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=e=t(s,r,l);return l},_H=t=>t?m2(t):m2;var CP={exports:{}},SP={},IP={exports:{}},TP={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pu=M;function AH(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var RH=typeof Object.is=="function"?Object.is:AH,DH=pu.useState,PH=pu.useEffect,OH=pu.useLayoutEffect,FH=pu.useDebugValue;function MH(t,e){var n=e(),s=DH({inst:{value:n,getSnapshot:e}}),r=s[0].inst,i=s[1];return OH(function(){r.value=n,r.getSnapshot=e,Mv(r)&&i({inst:r})},[t,n,e]),PH(function(){return Mv(r)&&i({inst:r}),t(function(){Mv(r)&&i({inst:r})})},[t]),FH(n),n}function Mv(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!RH(t,n)}catch{return!0}}function LH(t,e){return e()}var VH=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?LH:MH;TP.useSyncExternalStore=pu.useSyncExternalStore!==void 0?pu.useSyncExternalStore:VH;IP.exports=TP;var BH=IP.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ax=M,zH=BH;function UH(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var jH=typeof Object.is=="function"?Object.is:UH,WH=zH.useSyncExternalStore,GH=ax.useRef,HH=ax.useEffect,qH=ax.useMemo,KH=ax.useDebugValue;SP.useSyncExternalStoreWithSelector=function(t,e,n,s,r){var i=GH(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=qH(function(){function l(f){if(!c){if(c=!0,u=f,f=s(f),r!==void 0&&o.hasValue){var p=o.value;if(r(p,f))return d=p}return d=f}if(p=d,jH(u,f))return p;var m=s(f);return r!==void 0&&r(p,m)?(u=f,p):(u=f,d=m)}var c=!1,u,d,h=n===void 0?null:n;return[function(){return l(e())},h===null?void 0:function(){return l(h())}]},[e,n,s,r]);var a=WH(t,i[0],i[1]);return HH(function(){o.hasValue=!0,o.value=a},[a]),KH(a),a};CP.exports=SP;var XH=CP.exports;const YH=K1(XH),NP={},{useDebugValue:ZH}=rr,{useSyncExternalStoreWithSelector:JH}=YH;let g2=!1;const QH=t=>t;function e8(t,e=QH,n){(NP?"production":void 0)!=="production"&&n&&!g2&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),g2=!0);const s=JH(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return ZH(s),s}const y2=t=>{(NP?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?_H(t):t,n=(s,r)=>e8(e,s,r);return Object.assign(n,e),n},EP=t=>t?y2(t):y2,t8={};function n8(t,e){let n;try{n=t()}catch{return}return{getItem:r=>{var i;const o=l=>l===null?null:JSON.parse(l,void 0),a=(i=n.getItem(r))!=null?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(r,i)=>n.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>n.removeItem(r)}}const Dh=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(s){return Dh(s)(n)},catch(s){return this}}}catch(n){return{then(s){return this},catch(s){return Dh(s)(n)}}}},s8=(t,e)=>(n,s,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:y=>y,version:0,merge:(y,g)=>({...g,...y}),...e},o=!1;const a=new Set,l=new Set;let c;try{c=i.getStorage()}catch{}if(!c)return t((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...y)},s,r);const u=Dh(i.serialize),d=()=>{const y=i.partialize({...s()});let g;const x=u({state:y,version:i.version}).then(v=>c.setItem(i.name,v)).catch(v=>{g=v});if(g)throw g;return x},h=r.setState;r.setState=(y,g)=>{h(y,g),d()};const f=t((...y)=>{n(...y),d()},s,r);let p;const m=()=>{var y;if(!c)return;o=!1,a.forEach(x=>x(s()));const g=((y=i.onRehydrateStorage)==null?void 0:y.call(i,s()))||void 0;return Dh(c.getItem.bind(c))(i.name).then(x=>{if(x)return i.deserialize(x)}).then(x=>{if(x)if(typeof x.version=="number"&&x.version!==i.version){if(i.migrate)return i.migrate(x.state,x.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return x.state}).then(x=>{var v;return p=i.merge(x,(v=s())!=null?v:f),n(p,!0),d()}).then(()=>{g==null||g(p,void 0),o=!0,l.forEach(x=>x(p))}).catch(x=>{g==null||g(void 0,x)})};return r.persist={setOptions:y=>{i={...i,...y},y.getStorage&&(c=y.getStorage())},clearStorage:()=>{c==null||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>m(),hasHydrated:()=>o,onHydrate:y=>(a.add(y),()=>{a.delete(y)}),onFinishHydration:y=>(l.add(y),()=>{l.delete(y)})},m(),p||f},r8=(t,e)=>(n,s,r)=>{let i={storage:n8(()=>localStorage),partialize:m=>m,version:0,merge:(m,y)=>({...y,...m}),...e},o=!1;const a=new Set,l=new Set;let c=i.storage;if(!c)return t((...m)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...m)},s,r);const u=()=>{const m=i.partialize({...s()});return c.setItem(i.name,{state:m,version:i.version})},d=r.setState;r.setState=(m,y)=>{d(m,y),u()};const h=t((...m)=>{n(...m),u()},s,r);r.getInitialState=()=>h;let f;const p=()=>{var m,y;if(!c)return;o=!1,a.forEach(x=>{var v;return x((v=s())!=null?v:h)});const g=((y=i.onRehydrateStorage)==null?void 0:y.call(i,(m=s())!=null?m:h))||void 0;return Dh(c.getItem.bind(c))(i.name).then(x=>{if(x)if(typeof x.version=="number"&&x.version!==i.version){if(i.migrate)return[!0,i.migrate(x.state,x.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,x.state];return[!1,void 0]}).then(x=>{var v;const[b,k]=x;if(f=i.merge(k,(v=s())!=null?v:h),n(f,!0),b)return u()}).then(()=>{g==null||g(f,void 0),f=s(),o=!0,l.forEach(x=>x(f))}).catch(x=>{g==null||g(void 0,x)})};return r.persist={setOptions:m=>{i={...i,...m},m.storage&&(c=m.storage)},clearStorage:()=>{c==null||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>p(),hasHydrated:()=>o,onHydrate:m=>(a.add(m),()=>{a.delete(m)}),onFinishHydration:m=>(l.add(m),()=>{l.delete(m)})},i.skipHydration||p(),f||h},i8=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((t8?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),s8(t,e)):r8(t,e),o8=i8,wf=EP()(o8(t=>({user:null,isAuthenticated:!1,login:(e,n,s)=>{const r={id:"1",email:e,name:e.split("@")[0],username:s};t({user:r,isAuthenticated:!0})},register:e=>{const n={id:"1",email:e.email,name:e.name,username:e.username};t({user:n,isAuthenticated:!0})},logout:()=>t({user:null,isAuthenticated:!1})}),{name:"auth-storage"})),a8=EP(t=>({isOpen:!1,messages:[],toggleChat:()=>t(e=>({isOpen:!e.isOpen})),addMessage:e=>t(n=>({messages:[...n.messages,{id:crypto.randomUUID(),timestamp:new Date,...e}]}))}));function l8(){const t=Bu(),[e,n]=M.useState(!1),{isAuthenticated:s,logout:r}=wf(),i=()=>{r(),t("/login")};return w.jsx("header",{className:"bg-white shadow-sm",children:w.jsxs("nav",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8","aria-label":"Top",children:[w.jsxs("div",{className:"flex h-16 items-center justify-between",children:[w.jsx("div",{className:"flex items-center",children:w.jsxs("a",{href:"/",className:"flex items-center space-x-2",children:[w.jsx("img",{src:"https://i.postimg.cc/hjmyGVDp/fave.png",alt:"TeleCure Logo",className:"h-8 w-8"}),w.jsx("span",{className:"text-2xl font-bold text-red-600",children:"teleCure"})]})}),w.jsx("div",{className:"hidden md:flex md:items-center md:space-x-6",children:s?w.jsxs(w.Fragment,{children:[w.jsx("a",{href:"/symptoms",className:"text-base font-medium text-gray-500 hover:text-gray-900",children:"Symptoms"}),w.jsx(In,{onClick:i,children:"Sign out"})]}):w.jsxs(w.Fragment,{children:[w.jsx(In,{variant:"outline",onClick:()=>t("/login"),children:"Sign in"}),w.jsx(In,{onClick:()=>t("/register"),children:"Sign up"})]})}),w.jsx("div",{className:"flex md:hidden",children:w.jsxs("button",{type:"button",className:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500",onClick:()=>n(!e),children:[w.jsx("span",{className:"sr-only",children:"Open main menu"}),e?w.jsx(qk,{className:"block h-6 w-6","aria-hidden":"true"}):w.jsx(jG,{className:"block h-6 w-6","aria-hidden":"true"})]})})]}),e&&w.jsx("div",{className:"md:hidden",children:w.jsx("div",{className:"space-y-1 pb-3 pt-2",children:s?w.jsxs(w.Fragment,{children:[w.jsx("a",{href:"/symptoms",className:"block px-3 py-2 text-base font-medium text-gray-500 hover:bg-gray-50 hover:text-gray-900",children:"Symptoms"}),w.jsx(In,{onClick:i,className:"w-full",children:"Sign out"})]}):w.jsxs("div",{className:"space-y-2 px-3 py-2",children:[w.jsx(In,{variant:"outline",onClick:()=>t("/login"),className:"w-full",children:"Sign in"}),w.jsx(In,{onClick:()=>t("/register"),className:"w-full",children:"Sign up"})]})})})]})})}const No=["https://th.bing.com/th/id/OIP.UtX0_UXLxAYlc7JqCwGN6gHaE0?cb=iwc2&rs=1&pid=ImgDetMain","https://th.bing.com/th/id/OIP.aCFNQ4HBUV9RP00fm6tIwwHaEK?cb=iwc2&rs=1&pid=ImgDetMain","https://actionchange.org/wp-content/uploads/2019/10/pict_large-6.jpg","https://images.pexels.com/photos/3786157/pexels-photo-3786157.jpeg?auto=compress&cs=tinysrgb&w=1200"];function c8({}){const t=Bu(),e=wf(c=>c.login),[n,s]=M.useState(""),[r,i]=M.useState(""),[o,a]=M.useState(""),l=async c=>{c.preventDefault();try{await e(n,o,r),zt.success("Successfully logged in!"),t("/")}catch{zt.error("Invalid credentials")}};return w.jsxs("div",{className:"flex min-h-screen flex-col md:flex-row",children:[w.jsxs("div",{className:"hidden md:grid grid-cols-2 grid-rows-2 w-1/2 h-screen",children:[w.jsx("img",{src:No[0],alt:"Image 1",className:"object-cover w-full h-full"}),w.jsx("img",{src:No[1],alt:"Image 2",className:"object-cover w-full h-full"}),w.jsx("img",{src:No[2],alt:"Image 3",className:"object-cover w-full h-full"}),w.jsx("img",{src:No[3],alt:"Image 4",className:"object-cover w-full h-full"})]}),w.jsx("div",{className:"flex flex-1 items-center justify-center bg-gray-50 px-4 sm:px-6 lg:px-8",children:w.jsxs("div",{className:"w-full max-w-sm sm:max-w-md space-y-8 rounded-xl bg-white p-6 sm:p-8 shadow-lg",children:[w.jsxs("div",{className:"text-center",children:[w.jsx("h2",{className:"text-2xl sm:text-3xl font-bold tracking-tight text-gray-900",children:"log in to teleCure"}),w.jsx("p",{className:"mt-2 text-xl text-gray-600",children:"your home to healthcare and mental wellness assistant"})]}),w.jsxs("form",{className:"mt-6 space-y-5",onSubmit:l,children:[w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),w.jsxs("div",{className:"relative mt-1",children:[w.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:w.jsx(pP,{className:"h-5 w-5 text-gray-400"})}),w.jsx("input",{id:"email",type:"email",required:!0,className:"block w-full rounded-md border border-gray-300 pl-10 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500",placeholder:"Enter your email",value:n,onChange:c=>s(c.target.value)})]})]}),w.jsxs("div",{children:[w.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),w.jsxs("div",{className:"relative mt-1",children:[w.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:w.jsx(ox,{className:"h-5 w-5 text-gray-400"})}),w.jsx("input",{id:"username",type:"text",required:!0,className:"block w-full rounded-md border border-gray-300 pl-10 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500",placeholder:"Enter your username",value:r,onChange:c=>i(c.target.value)})]})]}),w.jsxs("div",{children:[w.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),w.jsxs("div",{className:"relative mt-1",children:[w.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:w.jsx(Mg,{className:"h-5 w-5 text-gray-400"})}),w.jsx("input",{id:"password",type:"password",required:!0,className:"block w-full rounded-md border border-gray-300 pl-10 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500",placeholder:"Enter your password",value:o,onChange:c=>a(c.target.value)})]})]})]}),w.jsx(In,{type:"submit",className:"w-full py-2",children:"Sign in"}),w.jsxs("p",{className:"text-center text-sm text-gray-600",children:["Don't have an account?"," ",w.jsx("a",{href:"/register",className:"font-medium text-blue-600 hover:text-blue-500",children:"Sign up"})]})]}),w.jsxs("div",{className:"grid grid-cols-2 grid-rows-2 gap-1 mt-8 md:hidden",children:[w.jsx("img",{src:No[0],alt:"Image 1",className:"object-cover w-full h-24 rounded"}),w.jsx("img",{src:No[1],alt:"Image 2",className:"object-cover w-full h-24 rounded"}),w.jsx("img",{src:No[2],alt:"Image 3",className:"object-cover w-full h-24 rounded"}),w.jsx("img",{src:No[3],alt:"Image 4",className:"object-cover w-full h-24 rounded"})]})]})})]})}var kf=t=>t.type==="checkbox",al=t=>t instanceof Date,as=t=>t==null;const $P=t=>typeof t=="object";var rn=t=>!as(t)&&!Array.isArray(t)&&$P(t)&&!al(t),u8=t=>rn(t)&&t.target?kf(t.target)?t.target.checked:t.target.value:t,d8=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,h8=(t,e)=>t.has(d8(e)),f8=t=>{const e=t.constructor&&t.constructor.prototype;return rn(e)&&e.hasOwnProperty("isPrototypeOf")},Xk=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Gn(t){let e;const n=Array.isArray(t),s=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set(t);else if(!(Xk&&(t instanceof Blob||s))&&(n||rn(t)))if(e=n?[]:{},!n&&!f8(t))e=t;else for(const r in t)t.hasOwnProperty(r)&&(e[r]=Gn(t[r]));else return t;return e}var lx=t=>Array.isArray(t)?t.filter(Boolean):[],an=t=>t===void 0,ke=(t,e,n)=>{if(!e||!rn(t))return n;const s=lx(e.split(/[,[\].]+?/)).reduce((r,i)=>as(r)?r:r[i],t);return an(s)||s===t?an(t[e])?n:t[e]:s},si=t=>typeof t=="boolean",Yk=t=>/^\w*$/.test(t),_P=t=>lx(t.replace(/["|']|\]/g,"").split(/\.|\[/)),gt=(t,e,n)=>{let s=-1;const r=Yk(e)?[e]:_P(e),i=r.length,o=i-1;for(;++s<i;){const a=r[s];let l=n;if(s!==o){const c=t[a];l=rn(c)||Array.isArray(c)?c:isNaN(+r[s+1])?{}:[]}if(a==="__proto__"||a==="constructor"||a==="prototype")return;t[a]=l,t=t[a]}};const x2={BLUR:"blur",FOCUS_OUT:"focusout"},Dr={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Mi={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};rr.createContext(null);var p8=(t,e,n,s=!0)=>{const r={defaultValues:e._defaultValues};for(const i in t)Object.defineProperty(r,i,{get:()=>{const o=i;return e._proxyFormState[o]!==Dr.all&&(e._proxyFormState[o]=!s||Dr.all),t[o]}});return r};const m8=typeof window<"u"?M.useLayoutEffect:M.useEffect;var ui=t=>typeof t=="string",g8=(t,e,n,s,r)=>ui(t)?(s&&e.watch.add(t),ke(n,t,r)):Array.isArray(t)?t.map(i=>(s&&e.watch.add(i),ke(n,i))):(s&&(e.watchAll=!0),n),AP=(t,e,n,s,r)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[s]:r||!0}}:{},sh=t=>Array.isArray(t)?t:[t],v2=()=>{let t=[];return{get observers(){return t},next:r=>{for(const i of t)i.next&&i.next(r)},subscribe:r=>(t.push(r),{unsubscribe:()=>{t=t.filter(i=>i!==r)}}),unsubscribe:()=>{t=[]}}},Ew=t=>as(t)||!$P(t);function Lo(t,e){if(Ew(t)||Ew(e))return t===e;if(al(t)&&al(e))return t.getTime()===e.getTime();const n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(const r of n){const i=t[r];if(!s.includes(r))return!1;if(r!=="ref"){const o=e[r];if(al(i)&&al(o)||rn(i)&&rn(o)||Array.isArray(i)&&Array.isArray(o)?!Lo(i,o):i!==o)return!1}}return!0}var is=t=>rn(t)&&!Object.keys(t).length,Zk=t=>t.type==="file",Pr=t=>typeof t=="function",Lg=t=>{if(!Xk)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},RP=t=>t.type==="select-multiple",Jk=t=>t.type==="radio",y8=t=>Jk(t)||kf(t),Lv=t=>Lg(t)&&t.isConnected;function x8(t,e){const n=e.slice(0,-1).length;let s=0;for(;s<n;)t=an(t)?s++:t[e[s++]];return t}function v8(t){for(const e in t)if(t.hasOwnProperty(e)&&!an(t[e]))return!1;return!0}function gn(t,e){const n=Array.isArray(e)?e:Yk(e)?[e]:_P(e),s=n.length===1?t:x8(t,n),r=n.length-1,i=n[r];return s&&delete s[i],r!==0&&(rn(s)&&is(s)||Array.isArray(s)&&v8(s))&&gn(t,n.slice(0,-1)),t}var DP=t=>{for(const e in t)if(Pr(t[e]))return!0;return!1};function Vg(t,e={}){const n=Array.isArray(t);if(rn(t)||n)for(const s in t)Array.isArray(t[s])||rn(t[s])&&!DP(t[s])?(e[s]=Array.isArray(t[s])?[]:{},Vg(t[s],e[s])):as(t[s])||(e[s]=!0);return e}function PP(t,e,n){const s=Array.isArray(t);if(rn(t)||s)for(const r in t)Array.isArray(t[r])||rn(t[r])&&!DP(t[r])?an(e)||Ew(n[r])?n[r]=Array.isArray(t[r])?Vg(t[r],[]):{...Vg(t[r])}:PP(t[r],as(e)?{}:e[r],n[r]):n[r]=!Lo(t[r],e[r]);return n}var kd=(t,e)=>PP(t,e,Vg(e));const b2={value:!1,isValid:!1},w2={value:!0,isValid:!0};var OP=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!an(t[0].attributes.value)?an(t[0].value)||t[0].value===""?w2:{value:t[0].value,isValid:!0}:w2:b2}return b2},FP=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:s})=>an(t)?t:e?t===""?NaN:t&&+t:n&&ui(t)?new Date(t):s?s(t):t;const k2={isValid:!1,value:null};var MP=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,k2):k2;function C2(t){const e=t.ref;return Zk(e)?e.files:Jk(e)?MP(t.refs).value:RP(e)?[...e.selectedOptions].map(({value:n})=>n):kf(e)?OP(t.refs).value:FP(an(e.value)?t.ref.value:e.value,t)}var b8=(t,e,n,s)=>{const r={};for(const i of t){const o=ke(e,i);o&&gt(r,i,o._f)}return{criteriaMode:n,names:[...t],fields:r,shouldUseNativeValidation:s}},Bg=t=>t instanceof RegExp,Cd=t=>an(t)?t:Bg(t)?t.source:rn(t)?Bg(t.value)?t.value.source:t.value:t,S2=t=>({isOnSubmit:!t||t===Dr.onSubmit,isOnBlur:t===Dr.onBlur,isOnChange:t===Dr.onChange,isOnAll:t===Dr.all,isOnTouch:t===Dr.onTouched});const I2="AsyncFunction";var w8=t=>!!t&&!!t.validate&&!!(Pr(t.validate)&&t.validate.constructor.name===I2||rn(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===I2)),k8=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),T2=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(s=>t.startsWith(s)&&/^\.\w+/.test(t.slice(s.length))));const rh=(t,e,n,s)=>{for(const r of n||Object.keys(t)){const i=ke(t,r);if(i){const{_f:o,...a}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],r)&&!s)return!0;if(o.ref&&e(o.ref,o.name)&&!s)return!0;if(rh(a,e))break}else if(rn(a)&&rh(a,e))break}}};function N2(t,e,n){const s=ke(t,n);if(s||Yk(n))return{error:s,name:n};const r=n.split(".");for(;r.length;){const i=r.join("."),o=ke(e,i),a=ke(t,i);if(o&&!Array.isArray(o)&&n!==i)return{name:n};if(a&&a.type)return{name:i,error:a};r.pop()}return{name:n}}var C8=(t,e,n,s)=>{n(t);const{name:r,...i}=t;return is(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!s||Dr.all))},S8=(t,e,n)=>!t||!e||t===e||sh(t).some(s=>s&&(n?s===e:s.startsWith(e)||e.startsWith(s))),I8=(t,e,n,s,r)=>r.isOnAll?!1:!n&&r.isOnTouch?!(e||t):(n?s.isOnBlur:r.isOnBlur)?!t:(n?s.isOnChange:r.isOnChange)?t:!0,T8=(t,e)=>!lx(ke(t,e)).length&&gn(t,e),N8=(t,e,n)=>{const s=sh(ke(t,n));return gt(s,"root",e[n]),gt(t,n,s),t},Zm=t=>ui(t);function E2(t,e,n="validate"){if(Zm(t)||Array.isArray(t)&&t.every(Zm)||si(t)&&!t)return{type:n,message:Zm(t)?t:"",ref:e}}var gc=t=>rn(t)&&!Bg(t)?t:{value:t,message:""},$2=async(t,e,n,s,r,i)=>{const{ref:o,refs:a,required:l,maxLength:c,minLength:u,min:d,max:h,pattern:f,validate:p,name:m,valueAsNumber:y,mount:g}=t._f,x=ke(n,m);if(!g||e.has(m))return{};const v=a?a[0]:o,b=R=>{r&&v.reportValidity&&(v.setCustomValidity(si(R)?"":R||""),v.reportValidity())},k={},C=Jk(o),S=kf(o),I=C||S,N=(y||Zk(o))&&an(o.value)&&an(x)||Lg(o)&&o.value===""||x===""||Array.isArray(x)&&!x.length,E=AP.bind(null,m,s,k),D=(R,L,B,W=Mi.maxLength,G=Mi.minLength)=>{const q=R?L:B;k[m]={type:R?W:G,message:q,ref:o,...E(R?W:G,q)}};if(i?!Array.isArray(x)||!x.length:l&&(!I&&(N||as(x))||si(x)&&!x||S&&!OP(a).isValid||C&&!MP(a).isValid)){const{value:R,message:L}=Zm(l)?{value:!!l,message:l}:gc(l);if(R&&(k[m]={type:Mi.required,message:L,ref:v,...E(Mi.required,L)},!s))return b(L),k}if(!N&&(!as(d)||!as(h))){let R,L;const B=gc(h),W=gc(d);if(!as(x)&&!isNaN(x)){const G=o.valueAsNumber||x&&+x;as(B.value)||(R=G>B.value),as(W.value)||(L=G<W.value)}else{const G=o.valueAsDate||new Date(x),q=P=>new Date(new Date().toDateString()+" "+P),A=o.type=="time",z=o.type=="week";ui(B.value)&&x&&(R=A?q(x)>q(B.value):z?x>B.value:G>new Date(B.value)),ui(W.value)&&x&&(L=A?q(x)<q(W.value):z?x<W.value:G<new Date(W.value))}if((R||L)&&(D(!!R,B.message,W.message,Mi.max,Mi.min),!s))return b(k[m].message),k}if((c||u)&&!N&&(ui(x)||i&&Array.isArray(x))){const R=gc(c),L=gc(u),B=!as(R.value)&&x.length>+R.value,W=!as(L.value)&&x.length<+L.value;if((B||W)&&(D(B,R.message,L.message),!s))return b(k[m].message),k}if(f&&!N&&ui(x)){const{value:R,message:L}=gc(f);if(Bg(R)&&!x.match(R)&&(k[m]={type:Mi.pattern,message:L,ref:o,...E(Mi.pattern,L)},!s))return b(L),k}if(p){if(Pr(p)){const R=await p(x,n),L=E2(R,v);if(L&&(k[m]={...L,...E(Mi.validate,L.message)},!s))return b(L.message),k}else if(rn(p)){let R={};for(const L in p){if(!is(R)&&!s)break;const B=E2(await p[L](x,n),v,L);B&&(R={...B,...E(L,B.message)},b(B.message),s&&(k[m]=R))}if(!is(R)&&(k[m]={ref:v,...R},!s))return k}}return b(!0),k};const E8={mode:Dr.onSubmit,reValidateMode:Dr.onChange,shouldFocusError:!0};function $8(t={}){let e={...E8,...t},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:Pr(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1};const s={};let r=rn(e.defaultValues)||rn(e.values)?Gn(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:Gn(r),o={action:!1,mount:!1,watch:!1},a={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},l,c=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let d={...u};const h={array:v2(),state:v2()},f=e.criteriaMode===Dr.all,p=_=>K=>{clearTimeout(c),c=setTimeout(_,K)},m=async _=>{if(!e.disabled&&(u.isValid||d.isValid||_)){const K=e.resolver?is((await S()).errors):await N(s,!0);K!==n.isValid&&h.state.next({isValid:K})}},y=(_,K)=>{!e.disabled&&(u.isValidating||u.validatingFields||d.isValidating||d.validatingFields)&&((_||Array.from(a.mount)).forEach(ee=>{ee&&(K?gt(n.validatingFields,ee,K):gn(n.validatingFields,ee))}),h.state.next({validatingFields:n.validatingFields,isValidating:!is(n.validatingFields)}))},g=(_,K=[],ee,pe,ue=!0,ae=!0)=>{if(pe&&ee&&!e.disabled){if(o.action=!0,ae&&Array.isArray(ke(s,_))){const Se=ee(ke(s,_),pe.argA,pe.argB);ue&&gt(s,_,Se)}if(ae&&Array.isArray(ke(n.errors,_))){const Se=ee(ke(n.errors,_),pe.argA,pe.argB);ue&&gt(n.errors,_,Se),T8(n.errors,_)}if((u.touchedFields||d.touchedFields)&&ae&&Array.isArray(ke(n.touchedFields,_))){const Se=ee(ke(n.touchedFields,_),pe.argA,pe.argB);ue&&gt(n.touchedFields,_,Se)}(u.dirtyFields||d.dirtyFields)&&(n.dirtyFields=kd(r,i)),h.state.next({name:_,isDirty:D(_,K),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else gt(i,_,K)},x=(_,K)=>{gt(n.errors,_,K),h.state.next({errors:n.errors})},v=_=>{n.errors=_,h.state.next({errors:n.errors,isValid:!1})},b=(_,K,ee,pe)=>{const ue=ke(s,_);if(ue){const ae=ke(i,_,an(ee)?ke(r,_):ee);an(ae)||pe&&pe.defaultChecked||K?gt(i,_,K?ae:C2(ue._f)):B(_,ae),o.mount&&m()}},k=(_,K,ee,pe,ue)=>{let ae=!1,Se=!1;const Xe={name:_};if(!e.disabled){if(!ee||pe){(u.isDirty||d.isDirty)&&(Se=n.isDirty,n.isDirty=Xe.isDirty=D(),ae=Se!==Xe.isDirty);const Ze=Lo(ke(r,_),K);Se=!!ke(n.dirtyFields,_),Ze?gn(n.dirtyFields,_):gt(n.dirtyFields,_,!0),Xe.dirtyFields=n.dirtyFields,ae=ae||(u.dirtyFields||d.dirtyFields)&&Se!==!Ze}if(ee){const Ze=ke(n.touchedFields,_);Ze||(gt(n.touchedFields,_,ee),Xe.touchedFields=n.touchedFields,ae=ae||(u.touchedFields||d.touchedFields)&&Ze!==ee)}ae&&ue&&h.state.next(Xe)}return ae?Xe:{}},C=(_,K,ee,pe)=>{const ue=ke(n.errors,_),ae=(u.isValid||d.isValid)&&si(K)&&n.isValid!==K;if(e.delayError&&ee?(l=p(()=>x(_,ee)),l(e.delayError)):(clearTimeout(c),l=null,ee?gt(n.errors,_,ee):gn(n.errors,_)),(ee?!Lo(ue,ee):ue)||!is(pe)||ae){const Se={...pe,...ae&&si(K)?{isValid:K}:{},errors:n.errors,name:_};n={...n,...Se},h.state.next(Se)}},S=async _=>{y(_,!0);const K=await e.resolver(i,e.context,b8(_||a.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return y(_),K},I=async _=>{const{errors:K}=await S(_);if(_)for(const ee of _){const pe=ke(K,ee);pe?gt(n.errors,ee,pe):gn(n.errors,ee)}else n.errors=K;return K},N=async(_,K,ee={valid:!0})=>{for(const pe in _){const ue=_[pe];if(ue){const{_f:ae,...Se}=ue;if(ae){const Xe=a.array.has(ae.name),Ze=ue._f&&w8(ue._f);Ze&&u.validatingFields&&y([pe],!0);const Cn=await $2(ue,a.disabled,i,f,e.shouldUseNativeValidation&&!K,Xe);if(Ze&&u.validatingFields&&y([pe]),Cn[ae.name]&&(ee.valid=!1,K))break;!K&&(ke(Cn,ae.name)?Xe?N8(n.errors,Cn,ae.name):gt(n.errors,ae.name,Cn[ae.name]):gn(n.errors,ae.name))}!is(Se)&&await N(Se,K,ee)}}return ee.valid},E=()=>{for(const _ of a.unMount){const K=ke(s,_);K&&(K._f.refs?K._f.refs.every(ee=>!Lv(ee)):!Lv(K._f.ref))&&ge(_)}a.unMount=new Set},D=(_,K)=>!e.disabled&&(_&&K&&gt(i,_,K),!Lo(P(),r)),R=(_,K,ee)=>g8(_,a,{...o.mount?i:an(K)?r:ui(_)?{[_]:K}:K},ee,K),L=_=>lx(ke(o.mount?i:r,_,e.shouldUnregister?ke(r,_,[]):[])),B=(_,K,ee={})=>{const pe=ke(s,_);let ue=K;if(pe){const ae=pe._f;ae&&(!ae.disabled&&gt(i,_,FP(K,ae)),ue=Lg(ae.ref)&&as(K)?"":K,RP(ae.ref)?[...ae.ref.options].forEach(Se=>Se.selected=ue.includes(Se.value)):ae.refs?kf(ae.ref)?ae.refs.forEach(Se=>{(!Se.defaultChecked||!Se.disabled)&&(Array.isArray(ue)?Se.checked=!!ue.find(Xe=>Xe===Se.value):Se.checked=ue===Se.value||!!ue)}):ae.refs.forEach(Se=>Se.checked=Se.value===ue):Zk(ae.ref)?ae.ref.value="":(ae.ref.value=ue,ae.ref.type||h.state.next({name:_,values:Gn(i)})))}(ee.shouldDirty||ee.shouldTouch)&&k(_,ue,ee.shouldTouch,ee.shouldDirty,!0),ee.shouldValidate&&z(_)},W=(_,K,ee)=>{for(const pe in K){if(!K.hasOwnProperty(pe))return;const ue=K[pe],ae=`${_}.${pe}`,Se=ke(s,ae);(a.array.has(_)||rn(ue)||Se&&!Se._f)&&!al(ue)?W(ae,ue,ee):B(ae,ue,ee)}},G=(_,K,ee={})=>{const pe=ke(s,_),ue=a.array.has(_),ae=Gn(K);gt(i,_,ae),ue?(h.array.next({name:_,values:Gn(i)}),(u.isDirty||u.dirtyFields||d.isDirty||d.dirtyFields)&&ee.shouldDirty&&h.state.next({name:_,dirtyFields:kd(r,i),isDirty:D(_,ae)})):pe&&!pe._f&&!as(ae)?W(_,ae,ee):B(_,ae,ee),T2(_,a)&&h.state.next({...n}),h.state.next({name:o.mount?_:void 0,values:Gn(i)})},q=async _=>{o.mount=!0;const K=_.target;let ee=K.name,pe=!0;const ue=ke(s,ee),ae=Ze=>{pe=Number.isNaN(Ze)||al(Ze)&&isNaN(Ze.getTime())||Lo(Ze,ke(i,ee,Ze))},Se=S2(e.mode),Xe=S2(e.reValidateMode);if(ue){let Ze,Cn;const ko=K.type?C2(ue._f):u8(_),Qs=_.type===x2.BLUR||_.type===x2.FOCUS_OUT,av=!k8(ue._f)&&!e.resolver&&!ke(n.errors,ee)&&!ue._f.deps||I8(Qs,ke(n.touchedFields,ee),n.isSubmitted,Xe,Se),Co=T2(ee,a,Qs);gt(i,ee,ko),Qs?(ue._f.onBlur&&ue._f.onBlur(_),l&&l(0)):ue._f.onChange&&ue._f.onChange(_);const dd=k(ee,ko,Qs),lv=!is(dd)||Co;if(!Qs&&h.state.next({name:ee,type:_.type,values:Gn(i)}),av)return(u.isValid||d.isValid)&&(e.mode==="onBlur"?Qs&&m():Qs||m()),lv&&h.state.next({name:ee,...Co?{}:dd});if(!Qs&&Co&&h.state.next({...n}),e.resolver){const{errors:GT}=await S([ee]);if(ae(ko),pe){const cj=N2(n.errors,s,ee),HT=N2(GT,s,cj.name||ee);Ze=HT.error,ee=HT.name,Cn=is(GT)}}else y([ee],!0),Ze=(await $2(ue,a.disabled,i,f,e.shouldUseNativeValidation))[ee],y([ee]),ae(ko),pe&&(Ze?Cn=!1:(u.isValid||d.isValid)&&(Cn=await N(s,!0)));pe&&(ue._f.deps&&z(ue._f.deps),C(ee,Cn,Ze,dd))}},A=(_,K)=>{if(ke(n.errors,K)&&_.focus)return _.focus(),1},z=async(_,K={})=>{let ee,pe;const ue=sh(_);if(e.resolver){const ae=await I(an(_)?_:ue);ee=is(ae),pe=_?!ue.some(Se=>ke(ae,Se)):ee}else _?(pe=(await Promise.all(ue.map(async ae=>{const Se=ke(s,ae);return await N(Se&&Se._f?{[ae]:Se}:Se)}))).every(Boolean),!(!pe&&!n.isValid)&&m()):pe=ee=await N(s);return h.state.next({...!ui(_)||(u.isValid||d.isValid)&&ee!==n.isValid?{}:{name:_},...e.resolver||!_?{isValid:ee}:{},errors:n.errors}),K.shouldFocus&&!pe&&rh(s,A,_?ue:a.mount),pe},P=_=>{const K={...o.mount?i:r};return an(_)?K:ui(_)?ke(K,_):_.map(ee=>ke(K,ee))},X=(_,K)=>({invalid:!!ke((K||n).errors,_),isDirty:!!ke((K||n).dirtyFields,_),error:ke((K||n).errors,_),isValidating:!!ke(n.validatingFields,_),isTouched:!!ke((K||n).touchedFields,_)}),te=_=>{_&&sh(_).forEach(K=>gn(n.errors,K)),h.state.next({errors:_?n.errors:{}})},se=(_,K,ee)=>{const pe=(ke(s,_,{_f:{}})._f||{}).ref,ue=ke(n.errors,_)||{},{ref:ae,message:Se,type:Xe,...Ze}=ue;gt(n.errors,_,{...Ze,...K,ref:pe}),h.state.next({name:_,errors:n.errors,isValid:!1}),ee&&ee.shouldFocus&&pe&&pe.focus&&pe.focus()},ce=(_,K)=>Pr(_)?h.state.subscribe({next:ee=>_(R(void 0,K),ee)}):R(_,K,!0),ie=_=>h.state.subscribe({next:K=>{S8(_.name,K.name,_.exact)&&C8(K,_.formState||u,Ct,_.reRenderRoot)&&_.callback({values:{...i},...n,...K})}}).unsubscribe,de=_=>(o.mount=!0,d={...d,..._.formState},ie({..._,formState:d})),ge=(_,K={})=>{for(const ee of _?sh(_):a.mount)a.mount.delete(ee),a.array.delete(ee),K.keepValue||(gn(s,ee),gn(i,ee)),!K.keepError&&gn(n.errors,ee),!K.keepDirty&&gn(n.dirtyFields,ee),!K.keepTouched&&gn(n.touchedFields,ee),!K.keepIsValidating&&gn(n.validatingFields,ee),!e.shouldUnregister&&!K.keepDefaultValue&&gn(r,ee);h.state.next({values:Gn(i)}),h.state.next({...n,...K.keepDirty?{isDirty:D()}:{}}),!K.keepIsValid&&m()},Ee=({disabled:_,name:K})=>{(si(_)&&o.mount||_||a.disabled.has(K))&&(_?a.disabled.add(K):a.disabled.delete(K))},Te=(_,K={})=>{let ee=ke(s,_);const pe=si(K.disabled)||si(e.disabled);return gt(s,_,{...ee||{},_f:{...ee&&ee._f?ee._f:{ref:{name:_}},name:_,mount:!0,...K}}),a.mount.add(_),ee?Ee({disabled:si(K.disabled)?K.disabled:e.disabled,name:_}):b(_,!0,K.value),{...pe?{disabled:K.disabled||e.disabled}:{},...e.progressive?{required:!!K.required,min:Cd(K.min),max:Cd(K.max),minLength:Cd(K.minLength),maxLength:Cd(K.maxLength),pattern:Cd(K.pattern)}:{},name:_,onChange:q,onBlur:q,ref:ue=>{if(ue){Te(_,K),ee=ke(s,_);const ae=an(ue.value)&&ue.querySelectorAll&&ue.querySelectorAll("input,select,textarea")[0]||ue,Se=y8(ae),Xe=ee._f.refs||[];if(Se?Xe.find(Ze=>Ze===ae):ae===ee._f.ref)return;gt(s,_,{_f:{...ee._f,...Se?{refs:[...Xe.filter(Lv),ae,...Array.isArray(ke(r,_))?[{}]:[]],ref:{type:ae.type,name:_}}:{ref:ae}}}),b(_,!1,void 0,ae)}else ee=ke(s,_,{}),ee._f&&(ee._f.mount=!1),(e.shouldUnregister||K.shouldUnregister)&&!(h8(a.array,_)&&o.action)&&a.unMount.add(_)}}},Me=()=>e.shouldFocusError&&rh(s,A,a.mount),Ve=_=>{si(_)&&(h.state.next({disabled:_}),rh(s,(K,ee)=>{const pe=ke(s,ee);pe&&(K.disabled=pe._f.disabled||_,Array.isArray(pe._f.refs)&&pe._f.refs.forEach(ue=>{ue.disabled=pe._f.disabled||_}))},0,!1))},st=(_,K)=>async ee=>{let pe;ee&&(ee.preventDefault&&ee.preventDefault(),ee.persist&&ee.persist());let ue=Gn(i);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:ae,values:Se}=await S();n.errors=ae,ue=Se}else await N(s);if(a.disabled.size)for(const ae of a.disabled)gt(ue,ae,void 0);if(gn(n.errors,"root"),is(n.errors)){h.state.next({errors:{}});try{await _(ue,ee)}catch(ae){pe=ae}}else K&&await K({...n.errors},ee),Me(),setTimeout(Me);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:is(n.errors)&&!pe,submitCount:n.submitCount+1,errors:n.errors}),pe)throw pe},ht=(_,K={})=>{ke(s,_)&&(an(K.defaultValue)?G(_,Gn(ke(r,_))):(G(_,K.defaultValue),gt(r,_,Gn(K.defaultValue))),K.keepTouched||gn(n.touchedFields,_),K.keepDirty||(gn(n.dirtyFields,_),n.isDirty=K.defaultValue?D(_,Gn(ke(r,_))):D()),K.keepError||(gn(n.errors,_),u.isValid&&m()),h.state.next({...n}))},kt=(_,K={})=>{const ee=_?Gn(_):r,pe=Gn(ee),ue=is(_),ae=ue?r:pe;if(K.keepDefaultValues||(r=ee),!K.keepValues){if(K.keepDirtyValues){const Se=new Set([...a.mount,...Object.keys(kd(r,i))]);for(const Xe of Array.from(Se))ke(n.dirtyFields,Xe)?gt(ae,Xe,ke(i,Xe)):G(Xe,ke(ae,Xe))}else{if(Xk&&an(_))for(const Se of a.mount){const Xe=ke(s,Se);if(Xe&&Xe._f){const Ze=Array.isArray(Xe._f.refs)?Xe._f.refs[0]:Xe._f.ref;if(Lg(Ze)){const Cn=Ze.closest("form");if(Cn){Cn.reset();break}}}}for(const Se of a.mount)G(Se,ke(ae,Se))}i=Gn(ae),h.array.next({values:{...ae}}),h.state.next({values:{...ae}})}a={mount:K.keepDirtyValues?a.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!u.isValid||!!K.keepIsValid||!!K.keepDirtyValues,o.watch=!!e.shouldUnregister,h.state.next({submitCount:K.keepSubmitCount?n.submitCount:0,isDirty:ue?!1:K.keepDirty?n.isDirty:!!(K.keepDefaultValues&&!Lo(_,r)),isSubmitted:K.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:ue?{}:K.keepDirtyValues?K.keepDefaultValues&&i?kd(r,i):n.dirtyFields:K.keepDefaultValues&&_?kd(r,_):K.keepDirty?n.dirtyFields:{},touchedFields:K.keepTouched?n.touchedFields:{},errors:K.keepErrors?n.errors:{},isSubmitSuccessful:K.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1})},ct=(_,K)=>kt(Pr(_)?_(i):_,K),lt=(_,K={})=>{const ee=ke(s,_),pe=ee&&ee._f;if(pe){const ue=pe.refs?pe.refs[0]:pe.ref;ue.focus&&(ue.focus(),K.shouldSelect&&Pr(ue.select)&&ue.select())}},Ct=_=>{n={...n,..._}},Js={control:{register:Te,unregister:ge,getFieldState:X,handleSubmit:st,setError:se,_subscribe:ie,_runSchema:S,_getWatch:R,_getDirty:D,_setValid:m,_setFieldArray:g,_setDisabledField:Ee,_setErrors:v,_getFieldArray:L,_reset:kt,_resetDefaultValues:()=>Pr(e.defaultValues)&&e.defaultValues().then(_=>{ct(_,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:E,_disableForm:Ve,_subjects:h,_proxyFormState:u,get _fields(){return s},get _formValues(){return i},get _state(){return o},set _state(_){o=_},get _defaultValues(){return r},get _names(){return a},set _names(_){a=_},get _formState(){return n},get _options(){return e},set _options(_){e={...e,..._}}},subscribe:de,trigger:z,register:Te,handleSubmit:st,watch:ce,setValue:G,getValues:P,reset:ct,resetField:ht,clearErrors:te,unregister:ge,setError:se,setFocus:lt,getFieldState:X};return{...Js,formControl:Js}}function Qk(t={}){const e=rr.useRef(void 0),n=rr.useRef(void 0),[s,r]=rr.useState({isDirty:!1,isValidating:!1,isLoading:Pr(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:Pr(t.defaultValues)?void 0:t.defaultValues});e.current||(e.current={...t.formControl?t.formControl:$8(t),formState:s},t.formControl&&t.defaultValues&&!Pr(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions));const i=e.current.control;return i._options=t,m8(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(a=>({...a,isReady:!0})),i._formState.isReady=!0,o},[i]),rr.useEffect(()=>i._disableForm(t.disabled),[i,t.disabled]),rr.useEffect(()=>{t.mode&&(i._options.mode=t.mode),t.reValidateMode&&(i._options.reValidateMode=t.reValidateMode),t.errors&&!is(t.errors)&&i._setErrors(t.errors)},[i,t.errors,t.mode,t.reValidateMode]),rr.useEffect(()=>{t.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,t.shouldUnregister]),rr.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==s.isDirty&&i._subjects.state.next({isDirty:o})}},[i,s.isDirty]),rr.useEffect(()=>{t.values&&!Lo(t.values,n.current)?(i._reset(t.values,i._options.resetOptions),n.current=t.values,r(o=>({...o}))):i._resetDefaultValues()},[i,t.values]),rr.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=p8(s,i),e.current}const _2=(t,e,n)=>{if(t&&"reportValidity"in t){const s=ke(n,e);t.setCustomValidity(s&&s.message||""),t.reportValidity()}},LP=(t,e)=>{for(const n in e.fields){const s=e.fields[n];s&&s.ref&&"reportValidity"in s.ref?_2(s.ref,n,t):s.refs&&s.refs.forEach(r=>_2(r,n,t))}},_8=(t,e)=>{e.shouldUseNativeValidation&&LP(t,e);const n={};for(const s in t){const r=ke(e.fields,s),i=Object.assign(t[s]||{},{ref:r&&r.ref});if(A8(e.names||Object.keys(t),s)){const o=Object.assign({},ke(n,s));gt(o,"root",i),gt(n,s,o)}else gt(n,s,i)}return n},A8=(t,e)=>t.some(n=>n.startsWith(e+"."));var R8=function(t,e){for(var n={};t.length;){var s=t[0],r=s.code,i=s.message,o=s.path.join(".");if(!n[o])if("unionErrors"in s){var a=s.unionErrors[0].errors[0];n[o]={message:a.message,type:a.code}}else n[o]={message:i,type:r};if("unionErrors"in s&&s.unionErrors.forEach(function(u){return u.errors.forEach(function(d){return t.push(d)})}),e){var l=n[o].types,c=l&&l[s.code];n[o]=AP(o,e,n,r,c?[].concat(c,s.message):s.message)}t.shift()}return n},eC=function(t,e,n){return n===void 0&&(n={}),function(s,r,i){try{return Promise.resolve(function(o,a){try{var l=Promise.resolve(t[n.mode==="sync"?"parse":"parseAsync"](s,e)).then(function(c){return i.shouldUseNativeValidation&&LP({},i),{errors:{},values:n.raw?s:c}})}catch(c){return a(c)}return l&&l.then?l.then(void 0,a):l}(0,function(o){if(function(a){return Array.isArray(a==null?void 0:a.errors)}(o))return{values:{},errors:_8(R8(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}}},tt;(function(t){t.assertEqual=r=>r;function e(r){}t.assertIs=e;function n(r){throw new Error}t.assertNever=n,t.arrayToEnum=r=>{const i={};for(const o of r)i[o]=o;return i},t.getValidEnumValues=r=>{const i=t.objectKeys(r).filter(a=>typeof r[r[a]]!="number"),o={};for(const a of i)o[a]=r[a];return t.objectValues(o)},t.objectValues=r=>t.objectKeys(r).map(function(i){return r[i]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const i=[];for(const o in r)Object.prototype.hasOwnProperty.call(r,o)&&i.push(o);return i},t.find=(r,i)=>{for(const o of r)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function s(r,i=" | "){return r.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(r,i)=>typeof i=="bigint"?i.toString():i})(tt||(tt={}));var $w;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})($w||($w={}));const ve=tt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ui=t=>{switch(typeof t){case"undefined":return ve.undefined;case"string":return ve.string;case"number":return isNaN(t)?ve.nan:ve.number;case"boolean":return ve.boolean;case"function":return ve.function;case"bigint":return ve.bigint;case"symbol":return ve.symbol;case"object":return Array.isArray(t)?ve.array:t===null?ve.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ve.promise:typeof Map<"u"&&t instanceof Map?ve.map:typeof Set<"u"&&t instanceof Set?ve.set:typeof Date<"u"&&t instanceof Date?ve.date:ve.object;default:return ve.unknown}},oe=tt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),D8=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class zs extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(i){return i.message},s={_errors:[]},r=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(r);else if(o.code==="invalid_return_type")r(o.returnTypeError);else if(o.code==="invalid_arguments")r(o.argumentsError);else if(o.path.length===0)s._errors.push(n(o));else{let a=s,l=0;for(;l<o.path.length;){const c=o.path[l];l===o.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(n(o))):a[c]=a[c]||{_errors:[]},a=a[c],l++}}};return r(this),s}static assert(e){if(!(e instanceof zs))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,tt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},s=[];for(const r of this.issues)r.path.length>0?(n[r.path[0]]=n[r.path[0]]||[],n[r.path[0]].push(e(r))):s.push(e(r));return{formErrors:s,fieldErrors:n}}get formErrors(){return this.flatten()}}zs.create=t=>new zs(t);const mu=(t,e)=>{let n;switch(t.code){case oe.invalid_type:t.received===ve.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case oe.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,tt.jsonStringifyReplacer)}`;break;case oe.unrecognized_keys:n=`Unrecognized key(s) in object: ${tt.joinValues(t.keys,", ")}`;break;case oe.invalid_union:n="Invalid input";break;case oe.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${tt.joinValues(t.options)}`;break;case oe.invalid_enum_value:n=`Invalid enum value. Expected ${tt.joinValues(t.options)}, received '${t.received}'`;break;case oe.invalid_arguments:n="Invalid function arguments";break;case oe.invalid_return_type:n="Invalid function return type";break;case oe.invalid_date:n="Invalid date";break;case oe.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:tt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case oe.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case oe.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case oe.custom:n="Invalid input";break;case oe.invalid_intersection_types:n="Intersection results could not be merged";break;case oe.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case oe.not_finite:n="Number must be finite";break;default:n=e.defaultError,tt.assertNever(t)}return{message:n}};let VP=mu;function P8(t){VP=t}function zg(){return VP}const Ug=t=>{const{data:e,path:n,errorMaps:s,issueData:r}=t,i=[...n,...r.path||[]],o={...r,path:i};if(r.message!==void 0)return{...r,path:i,message:r.message};let a="";const l=s.filter(c=>!!c).slice().reverse();for(const c of l)a=c(o,{data:e,defaultError:a}).message;return{...r,path:i,message:a}},O8=[];function me(t,e){const n=zg(),s=Ug({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===mu?void 0:mu].filter(r=>!!r)});t.common.issues.push(s)}class ns{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const s=[];for(const r of n){if(r.status==="aborted")return Oe;r.status==="dirty"&&e.dirty(),s.push(r.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,n){const s=[];for(const r of n){const i=await r.key,o=await r.value;s.push({key:i,value:o})}return ns.mergeObjectSync(e,s)}static mergeObjectSync(e,n){const s={};for(const r of n){const{key:i,value:o}=r;if(i.status==="aborted"||o.status==="aborted")return Oe;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||r.alwaysSet)&&(s[i.value]=o.value)}return{status:e.value,value:s}}}const Oe=Object.freeze({status:"aborted"}),Mc=t=>({status:"dirty",value:t}),fs=t=>({status:"valid",value:t}),_w=t=>t.status==="aborted",Aw=t=>t.status==="dirty",Nl=t=>t.status==="valid",Ph=t=>typeof Promise<"u"&&t instanceof Promise;function jg(t,e,n,s){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function BP(t,e,n,s,r){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var Ie;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Ie||(Ie={}));var Fd,Md;class Ii{constructor(e,n,s,r){this._cachedPath=[],this.parent=e,this.data=n,this._path=s,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const A2=(t,e)=>{if(Nl(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new zs(t.common.issues);return this._error=n,this._error}}};function Ue(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:s,description:r}=t;if(e&&(n||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(o,a)=>{var l,c;const{message:u}=t;return o.code==="invalid_enum_value"?{message:u??a.defaultError}:typeof a.data>"u"?{message:(l=u??s)!==null&&l!==void 0?l:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(c=u??n)!==null&&c!==void 0?c:a.defaultError}},description:r}}class Ge{get description(){return this._def.description}_getType(e){return Ui(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Ui(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ns,ctx:{common:e.parent.common,data:e.data,parsedType:Ui(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Ph(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const s=this.safeParse(e,n);if(s.success)return s.data;throw s.error}safeParse(e,n){var s;const r={common:{issues:[],async:(s=n==null?void 0:n.async)!==null&&s!==void 0?s:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ui(e)},i=this._parseSync({data:e,path:r.path,parent:r});return A2(r,i)}"~validate"(e){var n,s;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ui(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:r});return Nl(i)?{value:i.value}:{issues:r.common.issues}}catch(i){!((s=(n=i==null?void 0:i.message)===null||n===void 0?void 0:n.toLowerCase())===null||s===void 0)&&s.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>Nl(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(e,n){const s=await this.safeParseAsync(e,n);if(s.success)return s.data;throw s.error}async safeParseAsync(e,n){const s={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ui(e)},r=this._parse({data:e,path:s.path,parent:s}),i=await(Ph(r)?r:Promise.resolve(r));return A2(s,i)}refine(e,n){const s=r=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(r):n;return this._refinement((r,i)=>{const o=e(r),a=()=>i.addIssue({code:oe.custom,...s(r)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((s,r)=>e(s)?!0:(r.addIssue(typeof n=="function"?n(s,r):n),!1))}_refinement(e){return new Gr({schema:this,typeName:Pe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return pi.create(this,this._def)}nullable(){return ga.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Br.create(this)}promise(){return yu.create(this,this._def)}or(e){return Lh.create([this,e],this._def)}and(e){return Vh.create(this,e,this._def)}transform(e){return new Gr({...Ue(this._def),schema:this,typeName:Pe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Wh({...Ue(this._def),innerType:this,defaultValue:n,typeName:Pe.ZodDefault})}brand(){return new tC({typeName:Pe.ZodBranded,type:this,...Ue(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Gh({...Ue(this._def),innerType:this,catchValue:n,typeName:Pe.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Cf.create(this,e)}readonly(){return Hh.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const F8=/^c[^\s-]{8,}$/i,M8=/^[0-9a-z]+$/,L8=/^[0-9A-HJKMNP-TV-Z]{26}$/i,V8=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,B8=/^[a-z0-9_-]{21}$/i,z8=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,U8=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,j8=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,W8="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Vv;const G8=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,H8=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,q8=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,K8=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,X8=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Y8=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,zP="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Z8=new RegExp(`^${zP}$`);function UP(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function J8(t){return new RegExp(`^${UP(t)}$`)}function jP(t){let e=`${zP}T${UP(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function Q8(t,e){return!!((e==="v4"||!e)&&G8.test(t)||(e==="v6"||!e)&&q8.test(t))}function eq(t,e){if(!z8.test(t))return!1;try{const[n]=t.split("."),s=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),r=JSON.parse(atob(s));return!(typeof r!="object"||r===null||!r.typ||!r.alg||e&&r.alg!==e)}catch{return!1}}function tq(t,e){return!!((e==="v4"||!e)&&H8.test(t)||(e==="v6"||!e)&&K8.test(t))}class Or extends Ge{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ve.string){const i=this._getOrReturnCtx(e);return me(i,{code:oe.invalid_type,expected:ve.string,received:i.parsedType}),Oe}const s=new ns;let r;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),me(r,{code:oe.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="max")e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),me(r,{code:oe.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(r=this._getOrReturnCtx(e,r),o?me(r,{code:oe.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&me(r,{code:oe.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),s.dirty())}else if(i.kind==="email")j8.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"email",code:oe.invalid_string,message:i.message}),s.dirty());else if(i.kind==="emoji")Vv||(Vv=new RegExp(W8,"u")),Vv.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"emoji",code:oe.invalid_string,message:i.message}),s.dirty());else if(i.kind==="uuid")V8.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"uuid",code:oe.invalid_string,message:i.message}),s.dirty());else if(i.kind==="nanoid")B8.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"nanoid",code:oe.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid")F8.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"cuid",code:oe.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid2")M8.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"cuid2",code:oe.invalid_string,message:i.message}),s.dirty());else if(i.kind==="ulid")L8.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"ulid",code:oe.invalid_string,message:i.message}),s.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),me(r,{validation:"url",code:oe.invalid_string,message:i.message}),s.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"regex",code:oe.invalid_string,message:i.message}),s.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),me(r,{code:oe.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),s.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),me(r,{code:oe.invalid_string,validation:{startsWith:i.value},message:i.message}),s.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),me(r,{code:oe.invalid_string,validation:{endsWith:i.value},message:i.message}),s.dirty()):i.kind==="datetime"?jP(i).test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{code:oe.invalid_string,validation:"datetime",message:i.message}),s.dirty()):i.kind==="date"?Z8.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{code:oe.invalid_string,validation:"date",message:i.message}),s.dirty()):i.kind==="time"?J8(i).test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{code:oe.invalid_string,validation:"time",message:i.message}),s.dirty()):i.kind==="duration"?U8.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"duration",code:oe.invalid_string,message:i.message}),s.dirty()):i.kind==="ip"?Q8(e.data,i.version)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"ip",code:oe.invalid_string,message:i.message}),s.dirty()):i.kind==="jwt"?eq(e.data,i.alg)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"jwt",code:oe.invalid_string,message:i.message}),s.dirty()):i.kind==="cidr"?tq(e.data,i.version)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"cidr",code:oe.invalid_string,message:i.message}),s.dirty()):i.kind==="base64"?X8.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"base64",code:oe.invalid_string,message:i.message}),s.dirty()):i.kind==="base64url"?Y8.test(e.data)||(r=this._getOrReturnCtx(e,r),me(r,{validation:"base64url",code:oe.invalid_string,message:i.message}),s.dirty()):tt.assertNever(i);return{status:s.value,value:e.data}}_regex(e,n,s){return this.refinement(r=>e.test(r),{validation:n,code:oe.invalid_string,...Ie.errToObj(s)})}_addCheck(e){return new Or({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Ie.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Ie.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Ie.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Ie.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Ie.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Ie.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Ie.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Ie.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Ie.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Ie.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Ie.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Ie.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Ie.errToObj(e)})}datetime(e){var n,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...Ie.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Ie.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Ie.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...Ie.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...Ie.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...Ie.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...Ie.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...Ie.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...Ie.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...Ie.errToObj(n)})}nonempty(e){return this.min(1,Ie.errToObj(e))}trim(){return new Or({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Or({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Or({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Or.create=t=>{var e;return new Or({checks:[],typeName:Pe.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ue(t)})};function nq(t,e){const n=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,r=n>s?n:s,i=parseInt(t.toFixed(r).replace(".","")),o=parseInt(e.toFixed(r).replace(".",""));return i%o/Math.pow(10,r)}class fa extends Ge{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ve.number){const i=this._getOrReturnCtx(e);return me(i,{code:oe.invalid_type,expected:ve.number,received:i.parsedType}),Oe}let s;const r=new ns;for(const i of this._def.checks)i.kind==="int"?tt.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),me(s,{code:oe.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),me(s,{code:oe.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),me(s,{code:oe.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="multipleOf"?nq(e.data,i.value)!==0&&(s=this._getOrReturnCtx(e,s),me(s,{code:oe.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),me(s,{code:oe.not_finite,message:i.message}),r.dirty()):tt.assertNever(i);return{status:r.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Ie.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Ie.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Ie.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Ie.toString(n))}setLimit(e,n,s,r){return new fa({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:s,message:Ie.toString(r)}]})}_addCheck(e){return new fa({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Ie.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ie.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Ie.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:Ie.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ie.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ie.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&tt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(n===null||s.value>n)&&(n=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(n)&&Number.isFinite(e)}}fa.create=t=>new fa({checks:[],typeName:Pe.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ue(t)});class pa extends Ge{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ve.bigint)return this._getInvalidInput(e);let s;const r=new ns;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),me(s,{code:oe.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),me(s,{code:oe.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),me(s,{code:oe.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):tt.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return me(n,{code:oe.invalid_type,expected:ve.bigint,received:n.parsedType}),Oe}gte(e,n){return this.setLimit("min",e,!0,Ie.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Ie.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Ie.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Ie.toString(n))}setLimit(e,n,s,r){return new pa({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:s,message:Ie.toString(r)}]})}_addCheck(e){return new pa({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ie.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ie.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ie.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ie.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Ie.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}pa.create=t=>{var e;return new pa({checks:[],typeName:Pe.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ue(t)})};class Oh extends Ge{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ve.boolean){const s=this._getOrReturnCtx(e);return me(s,{code:oe.invalid_type,expected:ve.boolean,received:s.parsedType}),Oe}return fs(e.data)}}Oh.create=t=>new Oh({typeName:Pe.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ue(t)});class El extends Ge{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ve.date){const i=this._getOrReturnCtx(e);return me(i,{code:oe.invalid_type,expected:ve.date,received:i.parsedType}),Oe}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return me(i,{code:oe.invalid_date}),Oe}const s=new ns;let r;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(r=this._getOrReturnCtx(e,r),me(r,{code:oe.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),s.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(r=this._getOrReturnCtx(e,r),me(r,{code:oe.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),s.dirty()):tt.assertNever(i);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new El({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:Ie.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:Ie.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}El.create=t=>new El({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Pe.ZodDate,...Ue(t)});class Wg extends Ge{_parse(e){if(this._getType(e)!==ve.symbol){const s=this._getOrReturnCtx(e);return me(s,{code:oe.invalid_type,expected:ve.symbol,received:s.parsedType}),Oe}return fs(e.data)}}Wg.create=t=>new Wg({typeName:Pe.ZodSymbol,...Ue(t)});class Fh extends Ge{_parse(e){if(this._getType(e)!==ve.undefined){const s=this._getOrReturnCtx(e);return me(s,{code:oe.invalid_type,expected:ve.undefined,received:s.parsedType}),Oe}return fs(e.data)}}Fh.create=t=>new Fh({typeName:Pe.ZodUndefined,...Ue(t)});class Mh extends Ge{_parse(e){if(this._getType(e)!==ve.null){const s=this._getOrReturnCtx(e);return me(s,{code:oe.invalid_type,expected:ve.null,received:s.parsedType}),Oe}return fs(e.data)}}Mh.create=t=>new Mh({typeName:Pe.ZodNull,...Ue(t)});class gu extends Ge{constructor(){super(...arguments),this._any=!0}_parse(e){return fs(e.data)}}gu.create=t=>new gu({typeName:Pe.ZodAny,...Ue(t)});class gl extends Ge{constructor(){super(...arguments),this._unknown=!0}_parse(e){return fs(e.data)}}gl.create=t=>new gl({typeName:Pe.ZodUnknown,...Ue(t)});class io extends Ge{_parse(e){const n=this._getOrReturnCtx(e);return me(n,{code:oe.invalid_type,expected:ve.never,received:n.parsedType}),Oe}}io.create=t=>new io({typeName:Pe.ZodNever,...Ue(t)});class Gg extends Ge{_parse(e){if(this._getType(e)!==ve.undefined){const s=this._getOrReturnCtx(e);return me(s,{code:oe.invalid_type,expected:ve.void,received:s.parsedType}),Oe}return fs(e.data)}}Gg.create=t=>new Gg({typeName:Pe.ZodVoid,...Ue(t)});class Br extends Ge{_parse(e){const{ctx:n,status:s}=this._processInputParams(e),r=this._def;if(n.parsedType!==ve.array)return me(n,{code:oe.invalid_type,expected:ve.array,received:n.parsedType}),Oe;if(r.exactLength!==null){const o=n.data.length>r.exactLength.value,a=n.data.length<r.exactLength.value;(o||a)&&(me(n,{code:o?oe.too_big:oe.too_small,minimum:a?r.exactLength.value:void 0,maximum:o?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),s.dirty())}if(r.minLength!==null&&n.data.length<r.minLength.value&&(me(n,{code:oe.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),s.dirty()),r.maxLength!==null&&n.data.length>r.maxLength.value&&(me(n,{code:oe.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),s.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>r.type._parseAsync(new Ii(n,o,n.path,a)))).then(o=>ns.mergeArray(s,o));const i=[...n.data].map((o,a)=>r.type._parseSync(new Ii(n,o,n.path,a)));return ns.mergeArray(s,i)}get element(){return this._def.type}min(e,n){return new Br({...this._def,minLength:{value:e,message:Ie.toString(n)}})}max(e,n){return new Br({...this._def,maxLength:{value:e,message:Ie.toString(n)}})}length(e,n){return new Br({...this._def,exactLength:{value:e,message:Ie.toString(n)}})}nonempty(e){return this.min(1,e)}}Br.create=(t,e)=>new Br({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Pe.ZodArray,...Ue(e)});function wc(t){if(t instanceof Vt){const e={};for(const n in t.shape){const s=t.shape[n];e[n]=pi.create(wc(s))}return new Vt({...t._def,shape:()=>e})}else return t instanceof Br?new Br({...t._def,type:wc(t.element)}):t instanceof pi?pi.create(wc(t.unwrap())):t instanceof ga?ga.create(wc(t.unwrap())):t instanceof Ti?Ti.create(t.items.map(e=>wc(e))):t}class Vt extends Ge{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=tt.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==ve.object){const c=this._getOrReturnCtx(e);return me(c,{code:oe.invalid_type,expected:ve.object,received:c.parsedType}),Oe}const{status:s,ctx:r}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof io&&this._def.unknownKeys==="strip"))for(const c in r.data)o.includes(c)||a.push(c);const l=[];for(const c of o){const u=i[c],d=r.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Ii(r,d,r.path,c)),alwaysSet:c in r.data})}if(this._def.catchall instanceof io){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of a)l.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(c==="strict")a.length>0&&(me(r,{code:oe.unrecognized_keys,keys:a}),s.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of a){const d=r.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Ii(r,d,r.path,u)),alwaysSet:u in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>ns.mergeObjectSync(s,c)):ns.mergeObjectSync(s,l)}get shape(){return this._def.shape()}strict(e){return Ie.errToObj,new Vt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,s)=>{var r,i,o,a;const l=(o=(i=(r=this._def).errorMap)===null||i===void 0?void 0:i.call(r,n,s).message)!==null&&o!==void 0?o:s.defaultError;return n.code==="unrecognized_keys"?{message:(a=Ie.errToObj(e).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new Vt({...this._def,unknownKeys:"strip"})}passthrough(){return new Vt({...this._def,unknownKeys:"passthrough"})}extend(e){return new Vt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Vt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Pe.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Vt({...this._def,catchall:e})}pick(e){const n={};return tt.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(n[s]=this.shape[s])}),new Vt({...this._def,shape:()=>n})}omit(e){const n={};return tt.objectKeys(this.shape).forEach(s=>{e[s]||(n[s]=this.shape[s])}),new Vt({...this._def,shape:()=>n})}deepPartial(){return wc(this)}partial(e){const n={};return tt.objectKeys(this.shape).forEach(s=>{const r=this.shape[s];e&&!e[s]?n[s]=r:n[s]=r.optional()}),new Vt({...this._def,shape:()=>n})}required(e){const n={};return tt.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])n[s]=this.shape[s];else{let i=this.shape[s];for(;i instanceof pi;)i=i._def.innerType;n[s]=i}}),new Vt({...this._def,shape:()=>n})}keyof(){return WP(tt.objectKeys(this.shape))}}Vt.create=(t,e)=>new Vt({shape:()=>t,unknownKeys:"strip",catchall:io.create(),typeName:Pe.ZodObject,...Ue(e)});Vt.strictCreate=(t,e)=>new Vt({shape:()=>t,unknownKeys:"strict",catchall:io.create(),typeName:Pe.ZodObject,...Ue(e)});Vt.lazycreate=(t,e)=>new Vt({shape:t,unknownKeys:"strip",catchall:io.create(),typeName:Pe.ZodObject,...Ue(e)});class Lh extends Ge{_parse(e){const{ctx:n}=this._processInputParams(e),s=this._def.options;function r(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new zs(a.ctx.common.issues));return me(n,{code:oe.invalid_union,unionErrors:o}),Oe}if(n.common.async)return Promise.all(s.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(r);{let i;const o=[];for(const l of s){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(l=>new zs(l));return me(n,{code:oe.invalid_union,unionErrors:a}),Oe}}get options(){return this._def.options}}Lh.create=(t,e)=>new Lh({options:t,typeName:Pe.ZodUnion,...Ue(e)});const Vi=t=>t instanceof zh?Vi(t.schema):t instanceof Gr?Vi(t.innerType()):t instanceof Uh?[t.value]:t instanceof ma?t.options:t instanceof jh?tt.objectValues(t.enum):t instanceof Wh?Vi(t._def.innerType):t instanceof Fh?[void 0]:t instanceof Mh?[null]:t instanceof pi?[void 0,...Vi(t.unwrap())]:t instanceof ga?[null,...Vi(t.unwrap())]:t instanceof tC||t instanceof Hh?Vi(t.unwrap()):t instanceof Gh?Vi(t._def.innerType):[];class cx extends Ge{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ve.object)return me(n,{code:oe.invalid_type,expected:ve.object,received:n.parsedType}),Oe;const s=this.discriminator,r=n.data[s],i=this.optionsMap.get(r);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(me(n,{code:oe.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),Oe)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,s){const r=new Map;for(const i of n){const o=Vi(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(r.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);r.set(a,i)}}return new cx({typeName:Pe.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:r,...Ue(s)})}}function Rw(t,e){const n=Ui(t),s=Ui(e);if(t===e)return{valid:!0,data:t};if(n===ve.object&&s===ve.object){const r=tt.objectKeys(e),i=tt.objectKeys(t).filter(a=>r.indexOf(a)!==-1),o={...t,...e};for(const a of i){const l=Rw(t[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(n===ve.array&&s===ve.array){if(t.length!==e.length)return{valid:!1};const r=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],l=Rw(o,a);if(!l.valid)return{valid:!1};r.push(l.data)}return{valid:!0,data:r}}else return n===ve.date&&s===ve.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Vh extends Ge{_parse(e){const{status:n,ctx:s}=this._processInputParams(e),r=(i,o)=>{if(_w(i)||_w(o))return Oe;const a=Rw(i.value,o.value);return a.valid?((Aw(i)||Aw(o))&&n.dirty(),{status:n.value,value:a.data}):(me(s,{code:oe.invalid_intersection_types}),Oe)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,o])=>r(i,o)):r(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}Vh.create=(t,e,n)=>new Vh({left:t,right:e,typeName:Pe.ZodIntersection,...Ue(n)});class Ti extends Ge{_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==ve.array)return me(s,{code:oe.invalid_type,expected:ve.array,received:s.parsedType}),Oe;if(s.data.length<this._def.items.length)return me(s,{code:oe.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Oe;!this._def.rest&&s.data.length>this._def.items.length&&(me(s,{code:oe.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...s.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new Ii(s,o,s.path,a)):null}).filter(o=>!!o);return s.common.async?Promise.all(i).then(o=>ns.mergeArray(n,o)):ns.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new Ti({...this._def,rest:e})}}Ti.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ti({items:t,typeName:Pe.ZodTuple,rest:null,...Ue(e)})};class Bh extends Ge{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==ve.object)return me(s,{code:oe.invalid_type,expected:ve.object,received:s.parsedType}),Oe;const r=[],i=this._def.keyType,o=this._def.valueType;for(const a in s.data)r.push({key:i._parse(new Ii(s,a,s.path,a)),value:o._parse(new Ii(s,s.data[a],s.path,a)),alwaysSet:a in s.data});return s.common.async?ns.mergeObjectAsync(n,r):ns.mergeObjectSync(n,r)}get element(){return this._def.valueType}static create(e,n,s){return n instanceof Ge?new Bh({keyType:e,valueType:n,typeName:Pe.ZodRecord,...Ue(s)}):new Bh({keyType:Or.create(),valueType:e,typeName:Pe.ZodRecord,...Ue(n)})}}class Hg extends Ge{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==ve.map)return me(s,{code:oe.invalid_type,expected:ve.map,received:s.parsedType}),Oe;const r=this._def.keyType,i=this._def.valueType,o=[...s.data.entries()].map(([a,l],c)=>({key:r._parse(new Ii(s,a,s.path,[c,"key"])),value:i._parse(new Ii(s,l,s.path,[c,"value"]))}));if(s.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const l of o){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return Oe;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(c.value,u.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const l of o){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return Oe;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(c.value,u.value)}return{status:n.value,value:a}}}}Hg.create=(t,e,n)=>new Hg({valueType:e,keyType:t,typeName:Pe.ZodMap,...Ue(n)});class $l extends Ge{_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==ve.set)return me(s,{code:oe.invalid_type,expected:ve.set,received:s.parsedType}),Oe;const r=this._def;r.minSize!==null&&s.data.size<r.minSize.value&&(me(s,{code:oe.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),n.dirty()),r.maxSize!==null&&s.data.size>r.maxSize.value&&(me(s,{code:oe.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),n.dirty());const i=this._def.valueType;function o(l){const c=new Set;for(const u of l){if(u.status==="aborted")return Oe;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const a=[...s.data.values()].map((l,c)=>i._parse(new Ii(s,l,s.path,c)));return s.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,n){return new $l({...this._def,minSize:{value:e,message:Ie.toString(n)}})}max(e,n){return new $l({...this._def,maxSize:{value:e,message:Ie.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}$l.create=(t,e)=>new $l({valueType:t,minSize:null,maxSize:null,typeName:Pe.ZodSet,...Ue(e)});class Jc extends Ge{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ve.function)return me(n,{code:oe.invalid_type,expected:ve.function,received:n.parsedType}),Oe;function s(a,l){return Ug({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,zg(),mu].filter(c=>!!c),issueData:{code:oe.invalid_arguments,argumentsError:l}})}function r(a,l){return Ug({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,zg(),mu].filter(c=>!!c),issueData:{code:oe.invalid_return_type,returnTypeError:l}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof yu){const a=this;return fs(async function(...l){const c=new zs([]),u=await a._def.args.parseAsync(l,i).catch(f=>{throw c.addIssue(s(l,f)),c}),d=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(d,i).catch(f=>{throw c.addIssue(r(d,f)),c})})}else{const a=this;return fs(function(...l){const c=a._def.args.safeParse(l,i);if(!c.success)throw new zs([s(l,c.error)]);const u=Reflect.apply(o,this,c.data),d=a._def.returns.safeParse(u,i);if(!d.success)throw new zs([r(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Jc({...this._def,args:Ti.create(e).rest(gl.create())})}returns(e){return new Jc({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,s){return new Jc({args:e||Ti.create([]).rest(gl.create()),returns:n||gl.create(),typeName:Pe.ZodFunction,...Ue(s)})}}class zh extends Ge{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}zh.create=(t,e)=>new zh({getter:t,typeName:Pe.ZodLazy,...Ue(e)});class Uh extends Ge{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return me(n,{received:n.data,code:oe.invalid_literal,expected:this._def.value}),Oe}return{status:"valid",value:e.data}}get value(){return this._def.value}}Uh.create=(t,e)=>new Uh({value:t,typeName:Pe.ZodLiteral,...Ue(e)});function WP(t,e){return new ma({values:t,typeName:Pe.ZodEnum,...Ue(e)})}class ma extends Ge{constructor(){super(...arguments),Fd.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),s=this._def.values;return me(n,{expected:tt.joinValues(s),received:n.parsedType,code:oe.invalid_type}),Oe}if(jg(this,Fd)||BP(this,Fd,new Set(this._def.values)),!jg(this,Fd).has(e.data)){const n=this._getOrReturnCtx(e),s=this._def.values;return me(n,{received:n.data,code:oe.invalid_enum_value,options:s}),Oe}return fs(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return ma.create(e,{...this._def,...n})}exclude(e,n=this._def){return ma.create(this.options.filter(s=>!e.includes(s)),{...this._def,...n})}}Fd=new WeakMap;ma.create=WP;class jh extends Ge{constructor(){super(...arguments),Md.set(this,void 0)}_parse(e){const n=tt.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==ve.string&&s.parsedType!==ve.number){const r=tt.objectValues(n);return me(s,{expected:tt.joinValues(r),received:s.parsedType,code:oe.invalid_type}),Oe}if(jg(this,Md)||BP(this,Md,new Set(tt.getValidEnumValues(this._def.values))),!jg(this,Md).has(e.data)){const r=tt.objectValues(n);return me(s,{received:s.data,code:oe.invalid_enum_value,options:r}),Oe}return fs(e.data)}get enum(){return this._def.values}}Md=new WeakMap;jh.create=(t,e)=>new jh({values:t,typeName:Pe.ZodNativeEnum,...Ue(e)});class yu extends Ge{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ve.promise&&n.common.async===!1)return me(n,{code:oe.invalid_type,expected:ve.promise,received:n.parsedType}),Oe;const s=n.parsedType===ve.promise?n.data:Promise.resolve(n.data);return fs(s.then(r=>this._def.type.parseAsync(r,{path:n.path,errorMap:n.common.contextualErrorMap})))}}yu.create=(t,e)=>new yu({type:t,typeName:Pe.ZodPromise,...Ue(e)});class Gr extends Ge{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Pe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:s}=this._processInputParams(e),r=this._def.effect||null,i={addIssue:o=>{me(s,o),o.fatal?n.abort():n.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),r.type==="preprocess"){const o=r.transform(s.data,i);if(s.common.async)return Promise.resolve(o).then(async a=>{if(n.value==="aborted")return Oe;const l=await this._def.schema._parseAsync({data:a,path:s.path,parent:s});return l.status==="aborted"?Oe:l.status==="dirty"||n.value==="dirty"?Mc(l.value):l});{if(n.value==="aborted")return Oe;const a=this._def.schema._parseSync({data:o,path:s.path,parent:s});return a.status==="aborted"?Oe:a.status==="dirty"||n.value==="dirty"?Mc(a.value):a}}if(r.type==="refinement"){const o=a=>{const l=r.refinement(a,i);if(s.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(s.common.async===!1){const a=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?Oe:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(a=>a.status==="aborted"?Oe:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(r.type==="transform")if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Nl(o))return o;const a=r.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>Nl(o)?Promise.resolve(r.transform(o.value,i)).then(a=>({status:n.value,value:a})):o);tt.assertNever(r)}}Gr.create=(t,e,n)=>new Gr({schema:t,typeName:Pe.ZodEffects,effect:e,...Ue(n)});Gr.createWithPreprocess=(t,e,n)=>new Gr({schema:e,effect:{type:"preprocess",transform:t},typeName:Pe.ZodEffects,...Ue(n)});class pi extends Ge{_parse(e){return this._getType(e)===ve.undefined?fs(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}pi.create=(t,e)=>new pi({innerType:t,typeName:Pe.ZodOptional,...Ue(e)});class ga extends Ge{_parse(e){return this._getType(e)===ve.null?fs(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ga.create=(t,e)=>new ga({innerType:t,typeName:Pe.ZodNullable,...Ue(e)});class Wh extends Ge{_parse(e){const{ctx:n}=this._processInputParams(e);let s=n.data;return n.parsedType===ve.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Wh.create=(t,e)=>new Wh({innerType:t,typeName:Pe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ue(e)});class Gh extends Ge{_parse(e){const{ctx:n}=this._processInputParams(e),s={...n,common:{...n.common,issues:[]}},r=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return Ph(r)?r.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new zs(s.common.issues)},input:s.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new zs(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}Gh.create=(t,e)=>new Gh({innerType:t,typeName:Pe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ue(e)});class qg extends Ge{_parse(e){if(this._getType(e)!==ve.nan){const s=this._getOrReturnCtx(e);return me(s,{code:oe.invalid_type,expected:ve.nan,received:s.parsedType}),Oe}return{status:"valid",value:e.data}}}qg.create=t=>new qg({typeName:Pe.ZodNaN,...Ue(t)});const sq=Symbol("zod_brand");class tC extends Ge{_parse(e){const{ctx:n}=this._processInputParams(e),s=n.data;return this._def.type._parse({data:s,path:n.path,parent:n})}unwrap(){return this._def.type}}class Cf extends Ge{_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?Oe:i.status==="dirty"?(n.dirty(),Mc(i.value)):this._def.out._parseAsync({data:i.value,path:s.path,parent:s})})();{const r=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return r.status==="aborted"?Oe:r.status==="dirty"?(n.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:s.path,parent:s})}}static create(e,n){return new Cf({in:e,out:n,typeName:Pe.ZodPipeline})}}class Hh extends Ge{_parse(e){const n=this._def.innerType._parse(e),s=r=>(Nl(r)&&(r.value=Object.freeze(r.value)),r);return Ph(n)?n.then(r=>s(r)):s(n)}unwrap(){return this._def.innerType}}Hh.create=(t,e)=>new Hh({innerType:t,typeName:Pe.ZodReadonly,...Ue(e)});function R2(t,e){const n=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof n=="string"?{message:n}:n}function GP(t,e={},n){return t?gu.create().superRefine((s,r)=>{var i,o;const a=t(s);if(a instanceof Promise)return a.then(l=>{var c,u;if(!l){const d=R2(e,s),h=(u=(c=d.fatal)!==null&&c!==void 0?c:n)!==null&&u!==void 0?u:!0;r.addIssue({code:"custom",...d,fatal:h})}});if(!a){const l=R2(e,s),c=(o=(i=l.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0;r.addIssue({code:"custom",...l,fatal:c})}}):gu.create()}const rq={object:Vt.lazycreate};var Pe;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Pe||(Pe={}));const iq=(t,e={message:`Input not instance of ${t.name}`})=>GP(n=>n instanceof t,e),HP=Or.create,qP=fa.create,oq=qg.create,aq=pa.create,KP=Oh.create,lq=El.create,cq=Wg.create,uq=Fh.create,dq=Mh.create,hq=gu.create,fq=gl.create,pq=io.create,mq=Gg.create,gq=Br.create,yq=Vt.create,xq=Vt.strictCreate,vq=Lh.create,bq=cx.create,wq=Vh.create,kq=Ti.create,Cq=Bh.create,Sq=Hg.create,Iq=$l.create,Tq=Jc.create,Nq=zh.create,Eq=Uh.create,$q=ma.create,_q=jh.create,Aq=yu.create,D2=Gr.create,Rq=pi.create,Dq=ga.create,Pq=Gr.createWithPreprocess,Oq=Cf.create,Fq=()=>HP().optional(),Mq=()=>qP().optional(),Lq=()=>KP().optional(),Vq={string:t=>Or.create({...t,coerce:!0}),number:t=>fa.create({...t,coerce:!0}),boolean:t=>Oh.create({...t,coerce:!0}),bigint:t=>pa.create({...t,coerce:!0}),date:t=>El.create({...t,coerce:!0})},Bq=Oe;var Pn=Object.freeze({__proto__:null,defaultErrorMap:mu,setErrorMap:P8,getErrorMap:zg,makeIssue:Ug,EMPTY_PATH:O8,addIssueToContext:me,ParseStatus:ns,INVALID:Oe,DIRTY:Mc,OK:fs,isAborted:_w,isDirty:Aw,isValid:Nl,isAsync:Ph,get util(){return tt},get objectUtil(){return $w},ZodParsedType:ve,getParsedType:Ui,ZodType:Ge,datetimeRegex:jP,ZodString:Or,ZodNumber:fa,ZodBigInt:pa,ZodBoolean:Oh,ZodDate:El,ZodSymbol:Wg,ZodUndefined:Fh,ZodNull:Mh,ZodAny:gu,ZodUnknown:gl,ZodNever:io,ZodVoid:Gg,ZodArray:Br,ZodObject:Vt,ZodUnion:Lh,ZodDiscriminatedUnion:cx,ZodIntersection:Vh,ZodTuple:Ti,ZodRecord:Bh,ZodMap:Hg,ZodSet:$l,ZodFunction:Jc,ZodLazy:zh,ZodLiteral:Uh,ZodEnum:ma,ZodNativeEnum:jh,ZodPromise:yu,ZodEffects:Gr,ZodTransformer:Gr,ZodOptional:pi,ZodNullable:ga,ZodDefault:Wh,ZodCatch:Gh,ZodNaN:qg,BRAND:sq,ZodBranded:tC,ZodPipeline:Cf,ZodReadonly:Hh,custom:GP,Schema:Ge,ZodSchema:Ge,late:rq,get ZodFirstPartyTypeKind(){return Pe},coerce:Vq,any:hq,array:gq,bigint:aq,boolean:KP,date:lq,discriminatedUnion:bq,effect:D2,enum:$q,function:Tq,instanceof:iq,intersection:wq,lazy:Nq,literal:Eq,map:Sq,nan:oq,nativeEnum:_q,never:pq,null:dq,nullable:Dq,number:qP,object:yq,oboolean:Lq,onumber:Mq,optional:Rq,ostring:Fq,pipeline:Oq,preprocess:Pq,promise:Aq,record:Cq,set:Iq,strictObject:xq,string:HP,symbol:cq,transformer:D2,tuple:kq,undefined:uq,union:vq,unknown:fq,void:mq,NEVER:Bq,ZodIssueCode:oe,quotelessJson:D8,ZodError:zs});const zq=()=>{};var P2={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Uq=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],a=t[n++],l=((r&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},YP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,a=o?t[r+1]:0,l=r+2<t.length,c=l?t[r+2]:0,u=i>>2,d=(i&3)<<4|a>>4;let h=(a&15)<<2|c>>6,f=c&63;l||(f=64,o||(h=64)),s.push(n[u],n[d],n[h],n[f])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(XP(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Uq(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;const c=r<t.length?n[t.charAt(r)]:64;++r;const d=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||a==null||c==null||d==null)throw new jq;const h=i<<2|a>>4;if(s.push(h),c!==64){const f=a<<4&240|c>>2;if(s.push(f),d!==64){const p=c<<6&192|d;s.push(p)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class jq extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Wq=function(t){const e=XP(t);return YP.encodeByteArray(e,!0)},ZP=function(t){return Wq(t).replace(/\./g,"")},JP=function(t){try{return YP.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gq(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hq=()=>Gq().__FIREBASE_DEFAULTS__,qq=()=>{if(typeof process>"u"||typeof P2>"u")return;const t=P2.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Kq=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&JP(t[1]);return e&&JSON.parse(e)},nC=()=>{try{return zq()||Hq()||qq()||Kq()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Xq=t=>{var e,n;return(n=(e=nC())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},QP=()=>{var t;return(t=nC())===null||t===void 0?void 0:t.config},eO=t=>{var e;return(e=nC())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yq{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sC(t){return t.endsWith(".cloudworkstations.dev")}async function Zq(t){return(await fetch(t,{credentials:"include"})).ok}const ih={};function Jq(){const t={prod:[],emulator:[]};for(const e of Object.keys(ih))ih[e]?t.emulator.push(e):t.prod.push(e);return t}function Qq(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let O2=!1;function tO(t,e){if(typeof window>"u"||typeof document>"u"||!sC(window.location.host)||ih[t]===e||ih[t]||O2)return;ih[t]=e;function n(h){return`__firebase__banner__${h}`}const s="__firebase__banner",i=Jq().prod.length>0;function o(){const h=document.getElementById(s);h&&h.remove()}function a(h){h.style.display="flex",h.style.background="#7faaf0",h.style.position="fixed",h.style.bottom="5px",h.style.left="5px",h.style.padding=".5em",h.style.borderRadius="5px",h.style.alignItems="center"}function l(h,f){h.setAttribute("width","24"),h.setAttribute("id",f),h.setAttribute("height","24"),h.setAttribute("viewBox","0 0 24 24"),h.setAttribute("fill","none"),h.style.marginLeft="-6px"}function c(){const h=document.createElement("span");return h.style.cursor="pointer",h.style.marginLeft="16px",h.style.fontSize="24px",h.innerHTML=" &times;",h.onclick=()=>{O2=!0,o()},h}function u(h,f){h.setAttribute("id",f),h.innerText="Learn more",h.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",h.setAttribute("target","__blank"),h.style.paddingLeft="5px",h.style.textDecoration="underline"}function d(){const h=Qq(s),f=n("text"),p=document.getElementById(f)||document.createElement("span"),m=n("learnmore"),y=document.getElementById(m)||document.createElement("a"),g=n("preprendIcon"),x=document.getElementById(g)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(h.created){const v=h.element;a(v),u(y,m);const b=c();l(x,g),v.append(x,p,y,b),document.body.appendChild(v)}i?(p.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,p.innerText="Preview backend running in this workspace."),p.setAttribute("id",f)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ps(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function e7(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ps())}function t7(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function nO(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function n7(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function s7(){const t=ps();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function sO(){try{return typeof indexedDB=="object"}catch{return!1}}function rO(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var i;e(((i=r.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function r7(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i7="FirebaseError";class Di extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=i7,Object.setPrototypeOf(this,Di.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,tc.prototype.create)}}class tc{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?o7(i,s):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Di(r,a,s)}}function o7(t,e){return t.replace(a7,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const a7=/\{\$([^}]+)}/g;function l7(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function _l(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(F2(i)&&F2(o)){if(!_l(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function F2(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sf(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function c7(t,e){const n=new u7(t,e);return n.subscribe.bind(n)}class u7{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");d7(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=Bv),r.error===void 0&&(r.error=Bv),r.complete===void 0&&(r.complete=Bv);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function d7(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Bv(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h7=1e3,f7=2,p7=4*60*60*1e3,m7=.5;function M2(t,e=h7,n=f7){const s=e*Math.pow(n,t),r=Math.round(m7*s*(Math.random()-.5)*2);return Math.min(p7,s+r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yo(t){return t&&t._delegate?t._delegate:t}class Ni{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ka="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g7{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new Yq;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(x7(e))try{this.getOrInitializeService({instanceIdentifier:Ka})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=Ka){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ka){return this.instances.has(e)}getOptions(e=Ka){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);s===a&&o.resolve(r)}return r}onInit(e,n){var s;const r=this.normalizeInstanceIdentifier(n),i=(s=this.onInitCallbacks.get(r))!==null&&s!==void 0?s:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:y7(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Ka){return this.component?this.component.multipleInstances?e:Ka:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function y7(t){return t===Ka?void 0:t}function x7(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v7{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new g7(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(xt||(xt={}));const b7={debug:xt.DEBUG,verbose:xt.VERBOSE,info:xt.INFO,warn:xt.WARN,error:xt.ERROR,silent:xt.SILENT},w7=xt.INFO,k7={[xt.DEBUG]:"log",[xt.VERBOSE]:"log",[xt.INFO]:"info",[xt.WARN]:"warn",[xt.ERROR]:"error"},C7=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=k7[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let rC=class{constructor(e){this.name=e,this._logLevel=w7,this._logHandler=C7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?b7[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xt.DEBUG,...e),this._logHandler(this,xt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xt.VERBOSE,...e),this._logHandler(this,xt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xt.INFO,...e),this._logHandler(this,xt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xt.WARN,...e),this._logHandler(this,xt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xt.ERROR,...e),this._logHandler(this,xt.ERROR,...e)}};const S7=(t,e)=>e.some(n=>t instanceof n);let L2,V2;function I7(){return L2||(L2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function T7(){return V2||(V2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iO=new WeakMap,Dw=new WeakMap,oO=new WeakMap,zv=new WeakMap,iC=new WeakMap;function N7(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(ra(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&iO.set(n,t)}).catch(()=>{}),iC.set(e,t),e}function E7(t){if(Dw.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Dw.set(t,e)}let Pw={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Dw.get(t);if(e==="objectStoreNames")return t.objectStoreNames||oO.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ra(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function $7(t){Pw=t(Pw)}function _7(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(Uv(this),e,...n);return oO.set(s,e.sort?e.sort():[e]),ra(s)}:T7().includes(t)?function(...e){return t.apply(Uv(this),e),ra(iO.get(this))}:function(...e){return ra(t.apply(Uv(this),e))}}function A7(t){return typeof t=="function"?_7(t):(t instanceof IDBTransaction&&E7(t),S7(t,I7())?new Proxy(t,Pw):t)}function ra(t){if(t instanceof IDBRequest)return N7(t);if(zv.has(t))return zv.get(t);const e=A7(t);return e!==t&&(zv.set(t,e),iC.set(e,t)),e}const Uv=t=>iC.get(t);function aO(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),a=ra(o);return s&&o.addEventListener("upgradeneeded",l=>{s(ra(o.result),l.oldVersion,l.newVersion,ra(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const R7=["get","getKey","getAll","getAllKeys","count"],D7=["put","add","delete","clear"],jv=new Map;function B2(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(jv.get(e))return jv.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=D7.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||R7.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let c=l.store;return s&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),r&&l.done]))[0]};return jv.set(e,i),i}$7(t=>({...t,get:(e,n,s)=>B2(e,n)||t.get(e,n,s),has:(e,n)=>!!B2(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(O7(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function O7(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ow="@firebase/app",z2="0.12.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oo=new rC("@firebase/app"),F7="@firebase/app-compat",M7="@firebase/analytics-compat",L7="@firebase/analytics",V7="@firebase/app-check-compat",B7="@firebase/app-check",z7="@firebase/auth",U7="@firebase/auth-compat",j7="@firebase/database",W7="@firebase/data-connect",G7="@firebase/database-compat",H7="@firebase/functions",q7="@firebase/functions-compat",K7="@firebase/installations",X7="@firebase/installations-compat",Y7="@firebase/messaging",Z7="@firebase/messaging-compat",J7="@firebase/performance",Q7="@firebase/performance-compat",eK="@firebase/remote-config",tK="@firebase/remote-config-compat",nK="@firebase/storage",sK="@firebase/storage-compat",rK="@firebase/firestore",iK="@firebase/vertexai",oK="@firebase/firestore-compat",aK="firebase",lK="11.7.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw="[DEFAULT]",cK={[Ow]:"fire-core",[F7]:"fire-core-compat",[L7]:"fire-analytics",[M7]:"fire-analytics-compat",[B7]:"fire-app-check",[V7]:"fire-app-check-compat",[z7]:"fire-auth",[U7]:"fire-auth-compat",[j7]:"fire-rtdb",[W7]:"fire-data-connect",[G7]:"fire-rtdb-compat",[H7]:"fire-fn",[q7]:"fire-fn-compat",[K7]:"fire-iid",[X7]:"fire-iid-compat",[Y7]:"fire-fcm",[Z7]:"fire-fcm-compat",[J7]:"fire-perf",[Q7]:"fire-perf-compat",[eK]:"fire-rc",[tK]:"fire-rc-compat",[nK]:"fire-gcs",[sK]:"fire-gcs-compat",[rK]:"fire-fst",[oK]:"fire-fst-compat",[iK]:"fire-vertex","fire-js":"fire-js",[aK]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kg=new Map,uK=new Map,Mw=new Map;function U2(t,e){try{t.container.addComponent(e)}catch(n){oo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ao(t){const e=t.name;if(Mw.has(e))return oo.debug(`There were multiple attempts to register component ${e}.`),!1;Mw.set(e,t);for(const n of Kg.values())U2(n,t);for(const n of uK.values())U2(n,t);return!0}function Uu(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ci(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dK={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ia=new tc("app","Firebase",dK);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hK{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Ni("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ia.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const If=lK;function lO(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Fw,automaticDataCollectionEnabled:!1},e),r=s.name;if(typeof r!="string"||!r)throw ia.create("bad-app-name",{appName:String(r)});if(n||(n=QP()),!n)throw ia.create("no-options");const i=Kg.get(r);if(i){if(_l(n,i.options)&&_l(s,i.config))return i;throw ia.create("duplicate-app",{appName:r})}const o=new v7(r);for(const l of Mw.values())o.addComponent(l);const a=new hK(n,s,o);return Kg.set(r,a),a}function cO(t=Fw){const e=Kg.get(t);if(!e&&t===Fw&&QP())return lO();if(!e)throw ia.create("no-app",{appName:t});return e}function mi(t,e,n){var s;let r=(s=cK[t])!==null&&s!==void 0?s:t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),oo.warn(a.join(" "));return}ao(new Ni(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fK="firebase-heartbeat-database",pK=1,qh="firebase-heartbeat-store";let Wv=null;function uO(){return Wv||(Wv=aO(fK,pK,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(qh)}catch(n){console.warn(n)}}}}).catch(t=>{throw ia.create("idb-open",{originalErrorMessage:t.message})})),Wv}async function mK(t){try{const n=(await uO()).transaction(qh),s=await n.objectStore(qh).get(dO(t));return await n.done,s}catch(e){if(e instanceof Di)oo.warn(e.message);else{const n=ia.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});oo.warn(n.message)}}}async function j2(t,e){try{const s=(await uO()).transaction(qh,"readwrite");await s.objectStore(qh).put(e,dO(t)),await s.done}catch(n){if(n instanceof Di)oo.warn(n.message);else{const s=ia.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});oo.warn(s.message)}}}function dO(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gK=1024,yK=30;class xK{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new bK(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=W2();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>yK){const o=wK(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){oo.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=W2(),{heartbeatsToSend:s,unsentEntries:r}=vK(this._heartbeatsCache.heartbeats),i=ZP(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return oo.warn(n),""}}}function W2(){return new Date().toISOString().substring(0,10)}function vK(t,e=gK){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),G2(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),G2(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class bK{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sO()?rO().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await mK(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return j2(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return j2(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function G2(t){return ZP(JSON.stringify({version:2,heartbeats:t})).length}function wK(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kK(t){ao(new Ni("platform-logger",e=>new P7(e),"PRIVATE")),ao(new Ni("heartbeat",e=>new xK(e),"PRIVATE")),mi(Ow,z2,t),mi(Ow,z2,"esm2017"),mi("fire-js","")}kK("");function oC(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}function hO(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const CK=hO,fO=new tc("auth","Firebase",hO());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg=new rC("@firebase/auth");function SK(t,...e){Xg.logLevel<=xt.WARN&&Xg.warn(`Auth (${If}): ${t}`,...e)}function Jm(t,...e){Xg.logLevel<=xt.ERROR&&Xg.error(`Auth (${If}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lo(t,...e){throw aC(t,...e)}function gi(t,...e){return aC(t,...e)}function pO(t,e,n){const s=Object.assign(Object.assign({},CK()),{[e]:n});return new tc("auth","Firebase",s).create(e,{appName:t.name})}function oa(t){return pO(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function aC(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return fO.create(t,...e)}function Fe(t,e,...n){if(!t)throw aC(e,...n)}function qi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Jm(e),new Error(e)}function co(t,e){t||qi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lw(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function IK(){return H2()==="http:"||H2()==="https:"}function H2(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TK(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(IK()||nO()||"connection"in navigator)?navigator.onLine:!0}function NK(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e,n){this.shortDelay=e,this.longDelay=n,co(n>e,"Short delay should be less than long delay!"),this.isMobile=e7()||n7()}get(){return TK()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lC(t,e){co(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EK={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $K=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],_K=new Tf(3e4,6e4);function Nf(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Aa(t,e,n,s,r={}){return gO(t,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const a=Sf(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},i);return t7()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&sC(t.emulatorConfig.host)&&(c.credentials="include"),mO.fetch()(await xO(t,t.config.apiHost,n,a),c)})}async function gO(t,e,n){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},EK),e);try{const r=new RK(t),i=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw bm(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw bm(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw bm(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw bm(t,"user-disabled",o);const u=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw pO(t,u,c);lo(t,u)}}catch(r){if(r instanceof Di)throw r;lo(t,"network-request-failed",{message:String(r)})}}async function yO(t,e,n,s,r={}){const i=await Aa(t,e,n,s,r);return"mfaPendingCredential"in i&&lo(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function xO(t,e,n,s){const r=`${e}${n}?${s}`,i=t,o=i.config.emulator?lC(t.config,r):`${t.config.apiScheme}://${r}`;return $K.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function AK(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class RK{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(gi(this.auth,"network-request-failed")),_K.get())})}}function bm(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=gi(t,e,s);return r.customData._tokenResponse=n,r}function q2(t){return t!==void 0&&t.enterprise!==void 0}class DK{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return AK(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function PK(t,e){return Aa(t,"GET","/v2/recaptchaConfig",Nf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OK(t,e){return Aa(t,"POST","/v1/accounts:delete",e)}async function Yg(t,e){return Aa(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oh(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function FK(t,e=!1){const n=yo(t),s=await n.getIdToken(e),r=cC(s);Fe(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:oh(Gv(r.auth_time)),issuedAtTime:oh(Gv(r.iat)),expirationTime:oh(Gv(r.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Gv(t){return Number(t)*1e3}function cC(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return Jm("JWT malformed, contained fewer than 3 sections"),null;try{const r=JP(n);return r?JSON.parse(r):(Jm("Failed to decode base64 JWT payload"),null)}catch(r){return Jm("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function K2(t){const e=cC(t);return Fe(e,"internal-error"),Fe(typeof e.exp<"u","internal-error"),Fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xu(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof Di&&MK(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function MK({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LK{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=oh(this.lastLoginAt),this.creationTime=oh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zg(t){var e;const n=t.auth,s=await t.getIdToken(),r=await xu(t,Yg(n,{idToken:s}));Fe(r==null?void 0:r.users.length,n,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?vO(i.providerUserInfo):[],a=BK(t.providerData,o),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),u=l?c:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Vw(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,d)}async function VK(t){const e=yo(t);await Zg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function BK(t,e){return[...t.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function vO(t){return t.map(e=>{var{providerId:n}=e,s=oC(e,["providerId"]);return{providerId:n,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zK(t,e){const n=await gO(t,{},async()=>{const s=Sf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,o=await xO(t,r,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",mO.fetch()(o,{method:"POST",headers:a,body:s})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function UK(t,e){return Aa(t,"POST","/v2/accounts:revokeToken",Nf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Fe(e.idToken,"internal-error"),Fe(typeof e.idToken<"u","internal-error"),Fe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):K2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Fe(e.length!==0,"internal-error");const n=K2(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:i}=await zK(e,n);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:i}=n,o=new Qc;return s&&(Fe(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(Fe(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(Fe(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qc,this.toJSON())}_performRefresh(){return qi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eo(t,e){Fe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Fr{constructor(e){var{uid:n,auth:s,stsTokenManager:r}=e,i=oC(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new LK(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=s,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Vw(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await xu(this,this.stsTokenManager.getToken(this.auth,e));return Fe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return FK(this,e)}reload(){return VK(this)}_assign(e){this!==e&&(Fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Fr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await Zg(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ci(this.auth.app))return Promise.reject(oa(this.auth));const e=await this.getIdToken();return await xu(this,OK(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var s,r,i,o,a,l,c,u;const d=(s=n.displayName)!==null&&s!==void 0?s:void 0,h=(r=n.email)!==null&&r!==void 0?r:void 0,f=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,p=(o=n.photoURL)!==null&&o!==void 0?o:void 0,m=(a=n.tenantId)!==null&&a!==void 0?a:void 0,y=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,g=(c=n.createdAt)!==null&&c!==void 0?c:void 0,x=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:v,emailVerified:b,isAnonymous:k,providerData:C,stsTokenManager:S}=n;Fe(v&&S,e,"internal-error");const I=Qc.fromJSON(this.name,S);Fe(typeof v=="string",e,"internal-error"),Eo(d,e.name),Eo(h,e.name),Fe(typeof b=="boolean",e,"internal-error"),Fe(typeof k=="boolean",e,"internal-error"),Eo(f,e.name),Eo(p,e.name),Eo(m,e.name),Eo(y,e.name),Eo(g,e.name),Eo(x,e.name);const N=new Fr({uid:v,auth:e,email:h,emailVerified:b,displayName:d,isAnonymous:k,photoURL:p,phoneNumber:f,tenantId:m,stsTokenManager:I,createdAt:g,lastLoginAt:x});return C&&Array.isArray(C)&&(N.providerData=C.map(E=>Object.assign({},E))),y&&(N._redirectEventId=y),N}static async _fromIdTokenResponse(e,n,s=!1){const r=new Qc;r.updateFromServerResponse(n);const i=new Fr({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await Zg(i),i}static async _fromGetAccountInfoResponse(e,n,s){const r=n.users[0];Fe(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?vO(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(i!=null&&i.length),a=new Qc;a.updateFromIdToken(s);const l=new Fr({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Vw(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X2=new Map;function Ki(t){co(t instanceof Function,"Expected a class definition");let e=X2.get(t);return e?(co(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,X2.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}bO.type="NONE";const Y2=bO;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qm(t,e,n){return`firebase:${t}:${e}:${n}`}class eu{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=Qm(this.userKey,r.apiKey,i),this.fullPersistenceKey=Qm("persistence",r.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Yg(this.auth,{idToken:e}).catch(()=>{});return n?Fr._fromGetAccountInfoResponse(this.auth,n,e):null}return Fr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new eu(Ki(Y2),e,s);const r=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=r[0]||Ki(Y2);const o=Qm(s,e.config.apiKey,e.name);let a=null;for(const c of n)try{const u=await c._get(o);if(u){let d;if(typeof u=="string"){const h=await Yg(e,{idToken:u}).catch(()=>{});if(!h)break;d=await Fr._fromGetAccountInfoResponse(e,h,u)}else d=Fr._fromJSON(e,u);c!==i&&(a=d),i=c;break}}catch{}const l=r.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new eu(i,e,s):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new eu(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z2(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(SO(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(wO(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(TO(e))return"Blackberry";if(NO(e))return"Webos";if(kO(e))return"Safari";if((e.includes("chrome/")||CO(e))&&!e.includes("edge/"))return"Chrome";if(IO(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function wO(t=ps()){return/firefox\//i.test(t)}function kO(t=ps()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function CO(t=ps()){return/crios\//i.test(t)}function SO(t=ps()){return/iemobile/i.test(t)}function IO(t=ps()){return/android/i.test(t)}function TO(t=ps()){return/blackberry/i.test(t)}function NO(t=ps()){return/webos/i.test(t)}function uC(t=ps()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function jK(t=ps()){var e;return uC(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function WK(){return s7()&&document.documentMode===10}function EO(t=ps()){return uC(t)||IO(t)||NO(t)||TO(t)||/windows phone/i.test(t)||SO(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $O(t,e=[]){let n;switch(t){case"Browser":n=Z2(ps());break;case"Worker":n=`${Z2(ps())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${If}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GK{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HK(t,e={}){return Aa(t,"GET","/v2/passwordPolicy",Nf(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qK=6;class KK{constructor(e){var n,s,r,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:qK,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,s,r,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XK{constructor(e,n,s,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new J2(this),this.idTokenSubscription=new J2(this),this.beforeStateQueue=new GK(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fO,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ki(n)),this._initializationPromise=this.queue(async()=>{var s,r,i;if(!this._deleted&&(this.persistenceManager=await eu.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Yg(this,{idToken:e}),s=await Fr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(ci(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let r=s,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Zg(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=NK()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ci(this.app))return Promise.reject(oa(this));const n=e?yo(e):null;return n&&Fe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ci(this.app)?Promise.reject(oa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ci(this.app)?Promise.reject(oa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ki(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await HK(this),n=new KK(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new tc("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await UK(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ki(e)||this._popupRedirectResolver;Fe(n,this,"argument-error"),this.redirectPersistenceManager=await eu.create(this,[Ki(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Fe(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,s,r);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$O(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(n["X-Firebase-Client"]=s);const r=await this._getAppCheckToken();return r&&(n["X-Firebase-AppCheck"]=r),n}async _getAppCheckToken(){var e;if(ci(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&SK(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function ju(t){return yo(t)}class J2{constructor(e){this.auth=e,this.observer=null,this.addObserver=c7(n=>this.observer=n)}get next(){return Fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ux={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function YK(t){ux=t}function _O(t){return ux.loadJS(t)}function ZK(){return ux.recaptchaEnterpriseScript}function JK(){return ux.gapiScript}function QK(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class e9{constructor(){this.enterprise=new t9}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class t9{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const n9="recaptcha-enterprise",AO="NO_RECAPTCHA";class s9{constructor(e){this.type=n9,this.auth=ju(e)}async verify(e="verify",n=!1){async function s(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{PK(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new DK(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function r(i,o,a){const l=window.grecaptcha;q2(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(AO)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new e9().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{s(this.auth).then(a=>{if(!n&&q2(window.grecaptcha))r(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=ZK();l.length!==0&&(l+=a),_O(l).then(()=>{r(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function Q2(t,e,n,s=!1,r=!1){const i=new s9(t);let o;if(r)o=AO;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a=Object.assign({},e);return s?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function r9(t,e,n,s,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Q2(t,e,n,n==="getOobCode");return s(t,o)}else return s(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Q2(t,e,n,n==="getOobCode");return s(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i9(t,e){const n=Uu(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),i=n.getOptions();if(_l(i,e??{}))return r;lo(r,"already-initialized")}return n.initialize({options:e})}function o9(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(Ki);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function a9(t,e,n){const s=ju(t);Fe(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,i=RO(e),{host:o,port:a}=l9(e),l=a===null?"":`:${a}`,c={url:`${i}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator){Fe(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Fe(_l(c,s.config.emulator)&&_l(u,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=c,s.emulatorConfig=u,s.settings.appVerificationDisabledForTesting=!0,sC(o)?(tO("Auth",!0),Zq(`${i}//${o}${l}`)):c9()}function RO(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function l9(t){const e=RO(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:eE(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:eE(o)}}}function eE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function c9(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DO{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return qi("not implemented")}_getIdTokenResponse(e){return qi("not implemented")}_linkToIdToken(e,n){return qi("not implemented")}_getReauthenticationResolver(e){return qi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tu(t,e){return yO(t,"POST","/v1/accounts:signInWithIdp",Nf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u9="http://localhost";class Al extends DO{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Al(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):lo("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r}=n,i=oC(n,["providerId","signInMethod"]);if(!s||!r)return null;const o=new Al(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return tu(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,tu(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,tu(e,n)}buildRequest(){const e={requestUri:u9,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Sf(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef extends PO{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo extends Ef{constructor(){super("facebook.com")}static credential(e){return Al._fromParams({providerId:Vo.PROVIDER_ID,signInMethod:Vo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vo.credentialFromTaggedObject(e)}static credentialFromError(e){return Vo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vo.credential(e.oauthAccessToken)}catch{return null}}}Vo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Vo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo extends Ef{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Al._fromParams({providerId:Bo.PROVIDER_ID,signInMethod:Bo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Bo.credentialFromTaggedObject(e)}static credentialFromError(e){return Bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return Bo.credential(n,s)}catch{return null}}}Bo.GOOGLE_SIGN_IN_METHOD="google.com";Bo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo extends Ef{constructor(){super("github.com")}static credential(e){return Al._fromParams({providerId:zo.PROVIDER_ID,signInMethod:zo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zo.credentialFromTaggedObject(e)}static credentialFromError(e){return zo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zo.credential(e.oauthAccessToken)}catch{return null}}}zo.GITHUB_SIGN_IN_METHOD="github.com";zo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo extends Ef{constructor(){super("twitter.com")}static credential(e,n){return Al._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return Uo.credential(n,s)}catch{return null}}}Uo.TWITTER_SIGN_IN_METHOD="twitter.com";Uo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d9(t,e){return yO(t,"POST","/v1/accounts:signUp",Nf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const i=await Fr._fromIdTokenResponse(e,s,r),o=tE(s);return new Rl({user:i,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=tE(s);return new Rl({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function tE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg extends Di{constructor(e,n,s,r){var i;super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,Jg.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new Jg(e,n,s,r)}}function OO(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Jg._fromErrorAndOperation(t,i,e,s):i})}async function h9(t,e,n=!1){const s=await xu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Rl._forOperation(t,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f9(t,e,n=!1){const{auth:s}=t;if(ci(s.app))return Promise.reject(oa(s));const r="reauthenticate";try{const i=await xu(t,OO(s,r,e,t),n);Fe(i.idToken,s,"internal-error");const o=cC(i.idToken);Fe(o,s,"internal-error");const{sub:a}=o;return Fe(t.uid===a,s,"user-mismatch"),Rl._forOperation(t,r,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&lo(s,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p9(t,e,n=!1){if(ci(t.app))return Promise.reject(oa(t));const s="signIn",r=await OO(t,s,e),i=await Rl._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m9(t){const e=ju(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function g9(t,e,n){if(ci(t.app))return Promise.reject(oa(t));const s=ju(t),o=await r9(s,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",d9).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&m9(t),l}),a=await Rl._fromIdTokenResponse(s,"signIn",o);return await s._updateCurrentUser(a.user),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y9(t,e){return Aa(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x9(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const s=yo(t),i={idToken:await s.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await xu(s,y9(s.auth,i));s.displayName=o.displayName||null,s.photoURL=o.photoUrl||null;const a=s.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=s.displayName,a.photoURL=s.photoURL),await s._updateTokensIfNecessary(o)}function v9(t,e,n,s){return yo(t).onIdTokenChanged(e,n,s)}function b9(t,e,n){return yo(t).beforeAuthStateChanged(e,n)}const Qg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FO{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Qg,"1"),this.storage.removeItem(Qg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w9=1e3,k9=10;class MO extends FO{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=EO(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const s=e.key;n?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);WK()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,k9):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},w9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}MO.type="LOCAL";const C9=MO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LO extends FO{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}LO.type="SESSION";const VO=LO;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S9(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new dx(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:i}=n.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const a=Array.from(o).map(async c=>c(n.origin,i)),l=await S9(a);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}dx.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dC(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I9{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=dC("",20);r.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(d){const h=d;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(h.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yi(){return window}function T9(t){yi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BO(){return typeof yi().WorkerGlobalScope<"u"&&typeof yi().importScripts=="function"}async function N9(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function E9(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function $9(){return BO()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zO="firebaseLocalStorageDb",_9=1,ey="firebaseLocalStorage",UO="fbase_key";class $f{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function hx(t,e){return t.transaction([ey],e?"readwrite":"readonly").objectStore(ey)}function A9(){const t=indexedDB.deleteDatabase(zO);return new $f(t).toPromise()}function Bw(){const t=indexedDB.open(zO,_9);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(ey,{keyPath:UO})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(ey)?e(s):(s.close(),await A9(),e(await Bw()))})})}async function nE(t,e,n){const s=hx(t,!0).put({[UO]:e,value:n});return new $f(s).toPromise()}async function R9(t,e){const n=hx(t,!1).get(e),s=await new $f(n).toPromise();return s===void 0?null:s.value}function sE(t,e){const n=hx(t,!0).delete(e);return new $f(n).toPromise()}const D9=800,P9=3;class jO{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Bw(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>P9)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return BO()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=dx._getInstance($9()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await N9(),!this.activeServiceWorker)return;this.sender=new I9(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((n=s[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||E9()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Bw();return await nE(e,Qg,"1"),await sE(e,Qg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>nE(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>R9(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>sE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=hx(r,!1).getAll();return new $f(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),D9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}jO.type="LOCAL";const O9=jO;new Tf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F9(t,e){return e?Ki(e):(Fe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC extends DO{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return tu(e,this._buildIdpRequest())}_linkToIdToken(e,n){return tu(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return tu(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function M9(t){return p9(t.auth,new hC(t),t.bypassAuthState)}function L9(t){const{auth:e,user:n}=t;return Fe(n,e,"internal-error"),f9(n,new hC(t),t.bypassAuthState)}async function V9(t){const{auth:e,user:n}=t;return Fe(n,e,"internal-error"),h9(n,new hC(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO{constructor(e,n,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return M9;case"linkViaPopup":case"linkViaRedirect":return V9;case"reauthViaPopup":case"reauthViaRedirect":return L9;default:lo(this.auth,"internal-error")}}resolve(e){co(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){co(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B9=new Tf(2e3,1e4);class Lc extends WO{constructor(e,n,s,r,i){super(e,n,r,i),this.provider=s,this.authWindow=null,this.pollId=null,Lc.currentPopupAction&&Lc.currentPopupAction.cancel(),Lc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Fe(e,this.auth,"internal-error"),e}async onExecution(){co(this.filter.length===1,"Popup operations only handle one event");const e=dC();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(gi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(gi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Lc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if(!((s=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(gi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,B9.get())};e()}}Lc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z9="pendingRedirect",eg=new Map;class U9 extends WO{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=eg.get(this.auth._key());if(!e){try{const s=await j9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}eg.set(this.auth._key(),e)}return this.bypassAuthState||eg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function j9(t,e){const n=H9(e),s=G9(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}function W9(t,e){eg.set(t._key(),e)}function G9(t){return Ki(t._redirectPersistence)}function H9(t){return Qm(z9,t.config.apiKey,t.name)}async function q9(t,e,n=!1){if(ci(t.app))return Promise.reject(oa(t));const s=ju(t),r=F9(s,e),o=await new U9(s,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K9=10*60*1e3;class X9{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Y9(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!GO(e)){const r=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";n.onError(gi(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=K9&&this.cachedEventUids.clear(),this.cachedEventUids.has(rE(e))}saveEventToCache(e){this.cachedEventUids.add(rE(e)),this.lastProcessedEventTime=Date.now()}}function rE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function GO({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Y9(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return GO(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z9(t,e={}){return Aa(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Q9=/^https?/;async function eX(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Z9(t);for(const n of e)try{if(tX(n))return}catch{}lo(t,"unauthorized-domain")}function tX(t){const e=Lw(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===s}if(!Q9.test(n))return!1;if(J9.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nX=new Tf(3e4,6e4);function iE(){const t=yi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function sX(t){return new Promise((e,n)=>{var s,r,i;function o(){iE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iE(),n(gi(t,"network-request-failed"))},timeout:nX.get()})}if(!((r=(s=yi().gapi)===null||s===void 0?void 0:s.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((i=yi().gapi)===null||i===void 0)&&i.load)o();else{const a=QK("iframefcb");return yi()[a]=()=>{gapi.load?o():n(gi(t,"network-request-failed"))},_O(`${JK()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw tg=null,e})}let tg=null;function rX(t){return tg=tg||sX(t),tg}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iX=new Tf(5e3,15e3),oX="__/auth/iframe",aX="emulator/auth/iframe",lX={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cX=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function uX(t){const e=t.config;Fe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?lC(e,aX):`https://${t.config.authDomain}/${oX}`,s={apiKey:e.apiKey,appName:t.name,v:If},r=cX.get(t.config.apiHost);r&&(s.eid=r);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${Sf(s).slice(1)}`}async function dX(t){const e=await rX(t),n=yi().gapi;return Fe(n,t,"internal-error"),e.open({where:document.body,url:uX(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:lX,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=gi(t,"network-request-failed"),a=yi().setTimeout(()=>{i(o)},iX.get());function l(){yi().clearTimeout(a),r(s)}s.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hX={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},fX=500,pX=600,mX="_blank",gX="http://localhost";class oE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function yX(t,e,n,s=fX,r=pX){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const l=Object.assign(Object.assign({},hX),{width:s.toString(),height:r.toString(),top:i,left:o}),c=ps().toLowerCase();n&&(a=CO(c)?mX:n),wO(c)&&(e=e||gX,l.scrollbars="yes");const u=Object.entries(l).reduce((h,[f,p])=>`${h}${f}=${p},`,"");if(jK(c)&&a!=="_self")return xX(e||"",a),new oE(null);const d=window.open(e||"",a,u);Fe(d,t,"popup-blocked");try{d.focus()}catch{}return new oE(d)}function xX(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vX="__/auth/handler",bX="emulator/auth/handler",wX=encodeURIComponent("fac");async function aE(t,e,n,s,r,i){Fe(t.config.authDomain,t,"auth-domain-config-required"),Fe(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:If,eventId:r};if(e instanceof PO){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",l7(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,d]of Object.entries({}))o[u]=d}if(e instanceof Ef){const u=e.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${wX}=${encodeURIComponent(l)}`:"";return`${kX(t)}?${Sf(a).slice(1)}${c}`}function kX({config:t}){return t.emulator?lC(t,bX):`https://${t.authDomain}/${vX}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hv="webStorageSupport";class CX{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=VO,this._completeRedirectFn=q9,this._overrideRedirectResult=W9}async _openPopup(e,n,s,r){var i;co((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await aE(e,n,s,Lw(),r);return yX(e,o,dC())}async _openRedirect(e,n,s,r){await this._originValidation(e);const i=await aE(e,n,s,Lw(),r);return T9(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:i}=this.eventManagers[n];return r?Promise.resolve(r):(co(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await dX(e),s=new X9(e);return n.register("authEvent",r=>(Fe(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Hv,{type:Hv},r=>{var i;const o=(i=r==null?void 0:r[0])===null||i===void 0?void 0:i[Hv];o!==void 0&&n(!!o),lo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=eX(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return EO()||kO()||uC()}}const SX=CX;var lE="@firebase/auth",cE="1.10.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IX{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TX(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function NX(t){ao(new Ni("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;Fe(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$O(t)},c=new XK(s,r,i,l);return o9(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),ao(new Ni("auth-internal",e=>{const n=ju(e.getProvider("auth").getImmediate());return(s=>new IX(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),mi(lE,cE,TX(t)),mi(lE,cE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EX=5*60,$X=eO("authIdTokenMaxAge")||EX;let uE=null;const _X=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>$X)return;const r=n==null?void 0:n.token;uE!==r&&(uE=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function AX(t=cO()){const e=Uu(t,"auth");if(e.isInitialized())return e.getImmediate();const n=i9(t,{popupRedirectResolver:SX,persistence:[O9,C9,VO]}),s=eO("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const o=_X(i.toString());b9(n,o,()=>o(n.currentUser)),v9(n,a=>o(a))}}const r=Xq("auth");return r?a9(n,`http://${r}`):tO("Auth",!1),n}function RX(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}YK({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const i=gi("internal-error");i.customData=r,n(i)},s.type="text/javascript",s.charset="UTF-8",RX().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});NX("Browser");var DX="firebase",PX="11.7.3";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mi(DX,PX,"app");const HO="@firebase/installations",fC="0.6.16";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qO=1e4,KO=`w:${fC}`,XO="FIS_v2",OX="https://firebaseinstallations.googleapis.com/v1",FX=60*60*1e3,MX="installations",LX="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VX={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Dl=new tc(MX,LX,VX);function YO(t){return t instanceof Di&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZO({projectId:t}){return`${OX}/projects/${t}/installations`}function JO(t){return{token:t.token,requestStatus:2,expiresIn:zX(t.expiresIn),creationTime:Date.now()}}async function QO(t,e){const s=(await e.json()).error;return Dl.create("request-failed",{requestName:t,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function eF({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function BX(t,{refreshToken:e}){const n=eF(t);return n.append("Authorization",UX(e)),n}async function tF(t){const e=await t();return e.status>=500&&e.status<600?t():e}function zX(t){return Number(t.replace("s","000"))}function UX(t){return`${XO} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jX({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const s=ZO(t),r=eF(t),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&r.append("x-firebase-client",c)}const o={fid:n,authVersion:XO,appId:t.appId,sdkVersion:KO},a={method:"POST",headers:r,body:JSON.stringify(o)},l=await tF(()=>fetch(s,a));if(l.ok){const c=await l.json();return{fid:c.fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:JO(c.authToken)}}else throw await QO("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nF(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WX(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GX=/^[cdef][\w-]{21}$/,zw="";function HX(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=qX(t);return GX.test(n)?n:zw}catch{return zw}}function qX(t){return WX(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fx(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sF=new Map;function rF(t,e){const n=fx(t);iF(n,e),KX(n,e)}function iF(t,e){const n=sF.get(t);if(n)for(const s of n)s(e)}function KX(t,e){const n=XX();n&&n.postMessage({key:t,fid:e}),YX()}let ll=null;function XX(){return!ll&&"BroadcastChannel"in self&&(ll=new BroadcastChannel("[Firebase] FID Change"),ll.onmessage=t=>{iF(t.data.key,t.data.fid)}),ll}function YX(){sF.size===0&&ll&&(ll.close(),ll=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZX="firebase-installations-database",JX=1,Pl="firebase-installations-store";let qv=null;function pC(){return qv||(qv=aO(ZX,JX,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Pl)}}})),qv}async function ty(t,e){const n=fx(t),r=(await pC()).transaction(Pl,"readwrite"),i=r.objectStore(Pl),o=await i.get(n);return await i.put(e,n),await r.done,(!o||o.fid!==e.fid)&&rF(t,e.fid),e}async function oF(t){const e=fx(t),s=(await pC()).transaction(Pl,"readwrite");await s.objectStore(Pl).delete(e),await s.done}async function px(t,e){const n=fx(t),r=(await pC()).transaction(Pl,"readwrite"),i=r.objectStore(Pl),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await r.done,a&&(!o||o.fid!==a.fid)&&rF(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mC(t){let e;const n=await px(t.appConfig,s=>{const r=QX(s),i=eY(t,r);return e=i.registrationPromise,i.installationEntry});return n.fid===zw?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function QX(t){const e=t||{fid:HX(),registrationStatus:0};return aF(e)}function eY(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(Dl.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=tY(t,n);return{installationEntry:n,registrationPromise:s}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:nY(t)}:{installationEntry:e}}async function tY(t,e){try{const n=await jX(t,e);return ty(t.appConfig,n)}catch(n){throw YO(n)&&n.customData.serverCode===409?await oF(t.appConfig):await ty(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function nY(t){let e=await dE(t.appConfig);for(;e.registrationStatus===1;)await nF(100),e=await dE(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:s}=await mC(t);return s||n}return e}function dE(t){return px(t,e=>{if(!e)throw Dl.create("installation-not-found");return aF(e)})}function aF(t){return sY(t)?{fid:t.fid,registrationStatus:0}:t}function sY(t){return t.registrationStatus===1&&t.registrationTime+qO<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rY({appConfig:t,heartbeatServiceProvider:e},n){const s=iY(t,n),r=BX(t,n),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&r.append("x-firebase-client",c)}const o={installation:{sdkVersion:KO,appId:t.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},l=await tF(()=>fetch(s,a));if(l.ok){const c=await l.json();return JO(c)}else throw await QO("Generate Auth Token",l)}function iY(t,{fid:e}){return`${ZO(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gC(t,e=!1){let n;const s=await px(t.appConfig,i=>{if(!lF(i))throw Dl.create("not-registered");const o=i.authToken;if(!e&&lY(o))return i;if(o.requestStatus===1)return n=oY(t,e),i;{if(!navigator.onLine)throw Dl.create("app-offline");const a=uY(i);return n=aY(t,a),a}});return n?await n:s.authToken}async function oY(t,e){let n=await hE(t.appConfig);for(;n.authToken.requestStatus===1;)await nF(100),n=await hE(t.appConfig);const s=n.authToken;return s.requestStatus===0?gC(t,e):s}function hE(t){return px(t,e=>{if(!lF(e))throw Dl.create("not-registered");const n=e.authToken;return dY(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function aY(t,e){try{const n=await rY(t,e),s=Object.assign(Object.assign({},e),{authToken:n});return await ty(t.appConfig,s),n}catch(n){if(YO(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await oF(t.appConfig);else{const s=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await ty(t.appConfig,s)}throw n}}function lF(t){return t!==void 0&&t.registrationStatus===2}function lY(t){return t.requestStatus===2&&!cY(t)}function cY(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+FX}function uY(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function dY(t){return t.requestStatus===1&&t.requestTime+qO<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hY(t){const e=t,{installationEntry:n,registrationPromise:s}=await mC(e);return s?s.catch(console.error):gC(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fY(t,e=!1){const n=t;return await pY(n),(await gC(n,e)).token}async function pY(t){const{registrationPromise:e}=await mC(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mY(t){if(!t||!t.options)throw Kv("App Configuration");if(!t.name)throw Kv("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Kv(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Kv(t){return Dl.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF="installations",gY="installations-internal",yY=t=>{const e=t.getProvider("app").getImmediate(),n=mY(e),s=Uu(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:s,_delete:()=>Promise.resolve()}},xY=t=>{const e=t.getProvider("app").getImmediate(),n=Uu(e,cF).getImmediate();return{getId:()=>hY(n),getToken:r=>fY(n,r)}};function vY(){ao(new Ni(cF,yY,"PUBLIC")),ao(new Ni(gY,xY,"PRIVATE"))}vY();mi(HO,fC);mi(HO,fC,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ny="analytics",bY="firebase_id",wY="origin",kY=60*1e3,CY="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",yC="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s=new rC("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SY={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Us=new tc("analytics","Analytics",SY);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IY(t){if(!t.startsWith(yC)){const e=Us.create("invalid-gtag-resource",{gtagURL:t});return $s.warn(e.message),""}return t}function uF(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function TY(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function NY(t,e){const n=TY("firebase-js-sdk-policy",{createScriptURL:IY}),s=document.createElement("script"),r=`${yC}?l=${t}&id=${e}`;s.src=n?n==null?void 0:n.createScriptURL(r):r,s.async=!0,document.head.appendChild(s)}function EY(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function $Y(t,e,n,s,r,i){const o=s[r];try{if(o)await e[o];else{const l=(await uF(n)).find(c=>c.measurementId===r);l&&await e[l.appId]}}catch(a){$s.error(a)}t("config",r,i)}async function _Y(t,e,n,s,r){try{let i=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);const a=await uF(n);for(const l of o){const c=a.find(d=>d.measurementId===l),u=c&&e[c.appId];if(u)i.push(u);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",s,r||{})}catch(i){$s.error(i)}}function AY(t,e,n,s){async function r(i,...o){try{if(i==="event"){const[a,l]=o;await _Y(t,e,n,a,l)}else if(i==="config"){const[a,l]=o;await $Y(t,e,n,s,a,l)}else if(i==="consent"){const[a,l]=o;t("consent",a,l)}else if(i==="get"){const[a,l,c]=o;t("get",a,l,c)}else if(i==="set"){const[a]=o;t("set",a)}else t(i,...o)}catch(a){$s.error(a)}}return r}function RY(t,e,n,s,r){let i=function(...o){window[s].push(arguments)};return window[r]&&typeof window[r]=="function"&&(i=window[r]),window[r]=AY(i,t,e,n),{gtagCore:i,wrappedGtag:window[r]}}function DY(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(yC)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PY=30,OY=1e3;class FY{constructor(e={},n=OY){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const dF=new FY;function MY(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function LY(t){var e;const{appId:n,apiKey:s}=t,r={method:"GET",headers:MY(s)},i=CY.replace("{app-id}",n),o=await fetch(i,r);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw Us.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function VY(t,e=dF,n){const{appId:s,apiKey:r,measurementId:i}=t.options;if(!s)throw Us.create("no-app-id");if(!r){if(i)return{measurementId:i,appId:s};throw Us.create("no-api-key")}const o=e.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new UY;return setTimeout(async()=>{a.abort()},kY),hF({appId:s,apiKey:r,measurementId:i},o,a,e)}async function hF(t,{throttleEndTimeMillis:e,backoffCount:n},s,r=dF){var i;const{appId:o,measurementId:a}=t;try{await BY(s,e)}catch(l){if(a)return $s.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await LY(t);return r.deleteThrottleMetadata(o),l}catch(l){const c=l;if(!zY(c)){if(r.deleteThrottleMetadata(o),a)return $s.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:a};throw l}const u=Number((i=c==null?void 0:c.customData)===null||i===void 0?void 0:i.httpStatus)===503?M2(n,r.intervalMillis,PY):M2(n,r.intervalMillis),d={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return r.setThrottleMetadata(o,d),$s.debug(`Calling attemptFetch again in ${u} millis`),hF(t,d,s,r)}}function BY(t,e){return new Promise((n,s)=>{const r=Math.max(e-Date.now(),0),i=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(i),s(Us.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function zY(t){if(!(t instanceof Di)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class UY{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function jY(t,e,n,s,r){if(r&&r.global){t("event",n,s);return}else{const i=await e,o=Object.assign(Object.assign({},s),{send_to:i});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WY(){if(sO())try{await rO()}catch(t){return $s.warn(Us.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return $s.warn(Us.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function GY(t,e,n,s,r,i,o){var a;const l=VY(t);l.then(f=>{n[f.measurementId]=f.appId,t.options.measurementId&&f.measurementId!==t.options.measurementId&&$s.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>$s.error(f)),e.push(l);const c=WY().then(f=>{if(f)return s.getId()}),[u,d]=await Promise.all([l,c]);DY(i)||NY(i,u.measurementId),r("js",new Date);const h=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return h[wY]="firebase",h.update=!0,d!=null&&(h[bY]=d),r("config",u.measurementId,h),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HY{constructor(e){this.app=e}_delete(){return delete ah[this.app.options.appId],Promise.resolve()}}let ah={},fE=[];const pE={};let Xv="dataLayer",qY="gtag",mE,fF,gE=!1;function KY(){const t=[];if(nO()&&t.push("This is a browser extension environment."),r7()||t.push("Cookies are not available."),t.length>0){const e=t.map((s,r)=>`(${r+1}) ${s}`).join(" "),n=Us.create("invalid-analytics-context",{errorInfo:e});$s.warn(n.message)}}function XY(t,e,n){KY();const s=t.options.appId;if(!s)throw Us.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)$s.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Us.create("no-api-key");if(ah[s]!=null)throw Us.create("already-exists",{id:s});if(!gE){EY(Xv);const{wrappedGtag:i,gtagCore:o}=RY(ah,fE,pE,Xv,qY);fF=i,mE=o,gE=!0}return ah[s]=GY(t,fE,pE,e,mE,Xv,n),new HY(t)}function YY(t=cO()){t=yo(t);const e=Uu(t,ny);return e.isInitialized()?e.getImmediate():ZY(t)}function ZY(t,e={}){const n=Uu(t,ny);if(n.isInitialized()){const r=n.getImmediate();if(_l(e,n.getOptions()))return r;throw Us.create("already-initialized")}return n.initialize({options:e})}function JY(t,e,n,s){t=yo(t),jY(fF,ah[t.app.options.appId],e,n,s).catch(r=>$s.error(r))}const yE="@firebase/analytics",xE="0.10.15";function QY(){ao(new Ni(ny,(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return XY(s,r,n)},"PUBLIC")),ao(new Ni("analytics-internal",t,"PRIVATE")),mi(yE,xE),mi(yE,xE,"esm2017");function t(e){try{const n=e.getProvider(ny).getImmediate();return{logEvent:(s,r,i)=>JY(n,s,r,i)}}catch(n){throw Us.create("interop-component-reg-failed",{reason:n})}}}QY();const eZ={apiKey:"AIzaSyC6CjWCnJOMw3v7ICI9S0QJA5XIpsi5zxE",authDomain:"telecure-cf7e8.firebaseapp.com",projectId:"telecure-cf7e8",storageBucket:"telecure-cf7e8.firebasestorage.app",messagingSenderId:"628046517543",appId:"1:628046517543:web:19fa419cac5085266bc502",measurementId:"G-W2NWWZF0QB"},pF=lO(eZ);YY(pF);const tZ=AX(pF),nZ=Pn.object({name:Pn.string().min(2,"Name must be at least 2 characters"),email:Pn.string().email("Invalid email address"),phone:Pn.string().min(10,"Invalid phone number"),password:Pn.string().min(8,"Password must be at least 8 characters"),confirmPassword:Pn.string()}).refine(t=>t.password===t.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function sZ(){const t=Bu(),{register:e,handleSubmit:n,formState:{errors:s}}=Qk({resolver:eC(nZ)}),r=async i=>{try{const o=await g9(tZ,i.email,i.password);await x9(o.user,{displayName:i.name}),zt.success("Registration successful! Please sign in."),t("/login")}catch(o){zt.error(o.message||"Registration failed. Please try again.")}};return w.jsxs("div",{className:"flex min-h-screen",children:[w.jsx("div",{className:"hidden md:flex w-1/2 items-center justify-center bg-gray-100",children:w.jsx("img",{src:"https://i.postimg.cc/52xmw83B/rtyu.jpg",alt:"Healthcare",className:"object-cover w-full h-full"})}),w.jsx("div",{className:"flex w-full md:w-1/2 items-center justify-center bg-white",children:w.jsxs("div",{className:"w-full max-w-md space-y-8 rounded-xl p-8 shadow-lg",children:[w.jsxs("div",{className:"text-center",children:[w.jsx("h2",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Create an Account"}),w.jsx("p",{className:"mt-2 text-xl text-gray-600",children:"Join teleCure for personalized healthcare and mental wellness support."})]}),w.jsxs("form",{className:"mt-8 space-y-6",onSubmit:n(r),children:[w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),w.jsxs("div",{className:"relative mt-1",children:[w.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:w.jsx(ox,{className:"h-5 w-5 text-gray-400"})}),w.jsx("input",{...e("name"),type:"text",className:"block w-full rounded-md border border-gray-300 pl-10 py-2 text-gray-900 placeholder-gray-500 focus:border-red-500 focus:ring-blue-500",placeholder:"kipngeno"})]}),s.name&&w.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.name.message})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),w.jsxs("div",{className:"relative mt-1",children:[w.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:w.jsx(pP,{className:"h-5 w-5 text-gray-400"})}),w.jsx("input",{...e("email"),type:"email",className:"block w-full rounded-md border border-gray-300 pl-10 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500",placeholder:"kipngenogregory@gmail.com"})]}),s.email&&w.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.email.message})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),w.jsxs("div",{className:"relative mt-1",children:[w.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:w.jsx(gP,{className:"h-5 w-5 text-gray-400"})}),w.jsx("input",{...e("phone"),type:"tel",className:"block w-full rounded-md border border-gray-300 pl-10 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500",placeholder:"+254712345678"})]}),s.phone&&w.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.phone.message})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),w.jsxs("div",{className:"relative mt-1",children:[w.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:w.jsx(Mg,{className:"h-5 w-5 text-gray-400"})}),w.jsx("input",{...e("password"),type:"password",className:"block w-full rounded-md border border-gray-300 pl-10 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500",placeholder:"••••••••"})]}),s.password&&w.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.password.message})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),w.jsxs("div",{className:"relative mt-1",children:[w.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:w.jsx(Mg,{className:"h-5 w-5 text-gray-400"})}),w.jsx("input",{...e("confirmPassword"),type:"password",className:"block w-full rounded-md border border-gray-300 pl-10 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500",placeholder:"••••••••"})]}),s.confirmPassword&&w.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.confirmPassword.message})]})]}),w.jsx(In,{type:"submit",className:"w-full",children:"Create Account 🙂"}),w.jsxs("p",{className:"text-center text-sm text-gray-600",children:["Already have an account?"," ",w.jsx("a",{href:"/login",className:"font-medium text-red-600 hover:text-blue-500",children:"Sign in"})]})]})]})})]})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rZ=1e-7,iZ=1e-4;class mF{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class xC{refCount(e){return bs("refCount")}incRef(e){return bs("incRef")}timerAvailable(){return!0}time(e){return bs("time")}read(e){return bs("read")}readSync(e){return bs("readSync")}readToGPU(e,n){return bs("readToGPU")}numDataIds(){return bs("numDataIds")}disposeData(e,n){return bs("disposeData")}write(e,n,s){return bs("write")}move(e,n,s,r,i){return bs("move")}createTensorFromGPUData(e,n,s){return bs("createTensorFromGPUData")}memory(){return bs("memory")}floatPrecision(){return bs("floatPrecision")}epsilon(){return this.floatPrecision()===32?rZ:iZ}dispose(){return bs("dispose")}}function bs(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oZ(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,kc(t,e,n)}function Ol(t,e,n){return Math.max(t,Math.min(e,n))}function vC(t){return t%2===0?t:t+1}function kc(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function aZ(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function T(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function bC(t,e,n=""){T(at(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function gF(t){T(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Q(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function at(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function vu(t){return t%1===0}function Uw(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function nu(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function vE(t,e=r=>0,n,s){return new Promise((r,i)=>{let o=0;const a=()=>{if(t()){r();return}o++;const l=e(o);if(n!=null&&o>=n){i();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function yF(t,e){let n=1,s=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${i}`);s=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function qe(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),T(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),T(t.every(s=>vu(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function Ra(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||r?null:qe(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[o]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[o]==null||i[o]>a)&&t[a]===1&&(n.push(t[a]),s.push(a)),i[o]<=a&&o++}t[a]!==1&&(n.push(t[a]),s.push(a))}return{newShape:n,keptDims:s}}function Mn(t,e){return qt(t,e)}function qt(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function lZ(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function cZ(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function xF(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function sy(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function uZ(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function _f(t){return typeof t=="string"||t instanceof String}function dZ(t){return typeof t=="boolean"}function jw(t){return typeof t=="number"}function Wu(t){return Array.isArray(t)?Wu(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":jw(t)?"float32":_f(t)?"string":dZ(t)?"bool":"float32"}function Ww(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Gw(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Ne(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function vF(t,e,n,s=!1){const r=new Array;if(e.length===1){const i=e[0]*(s?2:1);for(let o=0;o<i;o++)r[o]=n[t+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<i;l++)r[l]=vF(t+l*a,o,n,s)}return r}function zr(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,i)=>r*i)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return vF(0,t,e,n)}function hZ(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function wC(t,e){const n=Ln(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function Ln(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function bF(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return zr(t,new Float32Array(n));if(e==="int32")return zr(t,new Int32Array(n));if(e==="bool")return zr(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function xo(t){t.forEach(e=>{T(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function xi(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function Gu(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function kC(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bE="tfjsflags";class fZ{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=pZ,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(Y().getBool("IS_TEST")||Y().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];Y().getBool("IS_TEST")||Y().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(kC(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);bE in e&&e[bE].split(",").forEach(s=>{const[r,i]=s.split(":");this.urlFlags[r]=gZ(r,i)})}}function pZ(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(mZ(e,s[0],s[1]),s.join("="))),e}function mZ(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function gZ(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function Y(){return wF}let wF=null;function yZ(t){wF=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Yv;function kF(){if(Yv==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");Yv=t}return Yv}function xZ(){const t=kF();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function CC(t,e){const n=xZ();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const mx="Abs",Af="Acos",Rf="Acosh",Hu="Add",SC="AddN",IC="All",TC="Any",gx="ArgMax",yx="ArgMin",Df="Asin",Pf="Asinh",Of="Atan",Ff="Atanh",Mf="Atan2",xx="AvgPool",NC="AvgPoolGrad",vx="AvgPool3D",EC="AvgPool3DGrad",bx="BatchMatMul",wx="BatchToSpaceND",$C="Bincount",_C="BitwiseAnd",vZ="BroadcastTo",CF="BroadcastArgs",Lf="Cast",Vf="Ceil",Bf="ClipByValue",AC="Complex",kx="ComplexAbs",Cx="Concat",Sx="Conv2D",RC="Conv2DBackpropFilter",Ix="Conv2DBackpropInput",Tx="Conv3D",DC="Conv3DBackpropFilterV2",PC="Conv3DBackpropInputV2",zf="Cos",Uf="Cosh",OC="Cumprod",Nx="Cumsum",FC="CropAndResize",MC="DenseBincount",LC="DepthToSpace",Ex="DepthwiseConv2dNative",VC="DepthwiseConv2dNativeBackpropFilter",BC="DepthwiseConv2dNativeBackpropInput",SF="Diag",$x="Dilation2D",Hw="Dilation2DBackpropInput",qw="Dilation2DBackpropFilter",bZ="Draw",jf="RealDiv",zC="Einsum",Wf="Elu",UC="EluGrad",Gf="Erf",_x="Equal",Hf="Exp",Ax="ExpandDims",qf="Expm1",jC="FFT",WC="Fill",GC="FlipLeftRight",Kf="Floor",Xf="FloorDiv",Rx="FusedBatchNorm",Dx="GatherV2",IF="GatherNd",Px="Greater",Yf="GreaterEqual",Zf="Identity",HC="IFFT",qC="Imag",Jf="IsFinite",Qf="IsInf",ep="IsNan",Ox="LeakyRelu",Fx="Less",Mx="LessEqual",TF="LinSpace",tp="Log",np="Log1p",Lx="LogicalAnd",Vx="LogicalNot",Bx="LogicalOr",wZ="LogSoftmax",zx="LRN",KC="LRNGrad",Ux="Max",sp="Maximum",jx="MaxPool",XC="MaxPoolGrad",Wx="MaxPool3D",YC="MaxPool3DGrad",NF="MaxPoolWithArgmax",Gx="Mean",Hx="Min",rp="Minimum",qx="MirrorPad",ip="Mod",EF="Multinomial",op="Multiply",Kx="Neg",Xx="NotEqual",ZC="NonMaxSuppressionV3",JC="NonMaxSuppressionV4",QC="NonMaxSuppressionV5",Yx="OnesLike",Zx="OneHot",Jx="Pack",Qx="PadV2",ap="Pow",e0="Prelu",t0="Prod",$F="RaggedGather",_F="RaggedRange",AF="RaggedTensorToTensor",eS="Range",tS="Real",lp="Reciprocal",cp="Relu",n0="Reshape",s0="ResizeNearestNeighbor",nS="ResizeNearestNeighborGrad",r0="ResizeBilinear",sS="ResizeBilinearGrad",up="Relu6",i0="Reverse",dp="Round",hp="Rsqrt",RF="ScatterNd",DF="TensorScatterUpdate",PF="SearchSorted",o0="Select",fp="Selu",a0="Slice",pp="Sin",mp="Sinh",gp="Sign",yp="Sigmoid",xp="Softplus",vp="Sqrt",l0="Sum",c0="SpaceToBatchND",u0="SplitV",d0="Softmax",OF="SparseFillEmptyRows",FF="SparseReshape",MF="SparseSegmentMean",LF="SparseSegmentSum",VF="SparseToDense",bp="SquaredDifference",rS="Square",iS="StaticRegexReplace",oS="StridedSlice",BF="StringNGrams",zF="StringSplit",UF="StringToHashBucketFast",wp="Sub",kp="Tan",Cp="Tanh",Sp="Tile",aS="TopK",lS="Transform",su="Transpose",cS="Unique",h0="Unpack",f0="UnsortedSegmentSum",p0="ZerosLike",Ip="Step",kZ="FromPixels",uS="RotateWithOffset",ry="_FusedMatMul",iy="FusedConv2D",jF="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ms(...t){Y().getBool("IS_TEST")||Y().getBool("PROD")||console.warn(...t)}function CZ(...t){Y().getBool("IS_TEST")||Y().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oy=CC("kernelRegistry",()=>new Map),Kw=CC("gradRegistry",()=>new Map);function wE(t,e){const n=GF(t,e);return oy.get(n)}function kE(t){return Kw.get(t)}function CE(t){const e=oy.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[i,o]=r,[a]=i.split("_");a===t&&n.push(o)}return n}function WF(t){const{kernelName:e,backendName:n}=t,s=GF(e,n);oy.has(s)&&Ms(`The kernel '${e}' for backend '${n}' is already registered`),oy.set(s,t)}function SZ(t){const{kernelName:e}=t;Kw.has(e)&&Y().getBool("DEBUG")&&Ms(`Overriding the gradient for '${e}'`),Kw.set(e,t)}function GF(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HF(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var qF=Nt,ur=null;try{ur=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Nt(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Nt.prototype.__isLong__;Object.defineProperty(Nt.prototype,"__isLong__",{value:!0});function Os(t){return(t&&t.__isLong__)===!0}Nt.isLong=Os;var SE={},IE={};function nc(t,e){var n,s,r;return e?(t>>>=0,(r=0<=t&&t<256)&&(s=IE[t],s)?s:(n=Et(t,(t|0)<0?-1:0,!0),r&&(IE[t]=n),n)):(t|=0,(r=-128<=t&&t<128)&&(s=SE[t],s)?s:(n=Et(t,t<0?-1:0,!1),r&&(SE[t]=n),n))}Nt.fromInt=nc;function dr(t,e){if(isNaN(t))return e?cl:hr;if(e){if(t<0)return cl;if(t>=KF)return ZF}else{if(t<=-9223372036854776e3)return Ss;if(t+1>=TZ)return YF}return t<0?dr(-t,e).neg():Et(t%bu|0,t/bu|0,e)}Nt.fromNumber=dr;function Et(t,e,n){return new Nt(t,e,n)}Nt.fromBits=Et;var ay=Math.pow;function dS(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return hr;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return dS(t.substring(1),e,n).neg();for(var r=dr(ay(n,8)),i=hr,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+a),n);if(a<8){var c=dr(ay(n,a));i=i.mul(c).add(dr(l))}else i=i.mul(r),i=i.add(dr(l))}return i.unsigned=e,i}Nt.fromString=dS;function Xr(t,e){return typeof t=="number"?dr(t,e):typeof t=="string"?dS(t,e):Et(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Nt.fromValue=Xr;var TE=65536,IZ=1<<24,bu=TE*TE,KF=bu*bu,TZ=KF/2,NE=nc(IZ),hr=nc(0);Nt.ZERO=hr;var cl=nc(0,!0);Nt.UZERO=cl;var Vc=nc(1);Nt.ONE=Vc;var XF=nc(1,!0);Nt.UONE=XF;var Xw=nc(-1);Nt.NEG_ONE=Xw;var YF=Et(-1,2147483647,!1);Nt.MAX_VALUE=YF;var ZF=Et(-1,-1,!0);Nt.MAX_UNSIGNED_VALUE=ZF;var Ss=Et(0,-2147483648,!1);Nt.MIN_VALUE=Ss;var fe=Nt.prototype;fe.toInt=function(){return this.unsigned?this.low>>>0:this.low};fe.toNumber=function(){return this.unsigned?(this.high>>>0)*bu+(this.low>>>0):this.high*bu+(this.low>>>0)};fe.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Ss)){var n=dr(e),s=this.div(n),r=s.mul(n).sub(this);return s.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=dr(ay(e,6),this.unsigned),o=this,a="";;){var l=o.div(i),c=o.sub(l.mul(i)).toInt()>>>0,u=c.toString(e);if(o=l,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};fe.getHighBits=function(){return this.high};fe.getHighBitsUnsigned=function(){return this.high>>>0};fe.getLowBits=function(){return this.low};fe.getLowBitsUnsigned=function(){return this.low>>>0};fe.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Ss)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};fe.isZero=function(){return this.high===0&&this.low===0};fe.eqz=fe.isZero;fe.isNegative=function(){return!this.unsigned&&this.high<0};fe.isPositive=function(){return this.unsigned||this.high>=0};fe.isOdd=function(){return(this.low&1)===1};fe.isEven=function(){return(this.low&1)===0};fe.equals=function(e){return Os(e)||(e=Xr(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};fe.eq=fe.equals;fe.notEquals=function(e){return!this.eq(e)};fe.neq=fe.notEquals;fe.ne=fe.notEquals;fe.lessThan=function(e){return this.comp(e)<0};fe.lt=fe.lessThan;fe.lessThanOrEqual=function(e){return this.comp(e)<=0};fe.lte=fe.lessThanOrEqual;fe.le=fe.lessThanOrEqual;fe.greaterThan=function(e){return this.comp(e)>0};fe.gt=fe.greaterThan;fe.greaterThanOrEqual=function(e){return this.comp(e)>=0};fe.gte=fe.greaterThanOrEqual;fe.ge=fe.greaterThanOrEqual;fe.compare=function(e){if(Os(e)||(e=Xr(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};fe.comp=fe.compare;fe.negate=function(){return!this.unsigned&&this.eq(Ss)?Ss:this.not().add(Vc)};fe.neg=fe.negate;fe.add=function(e){Os(e)||(e=Xr(e));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,d=0,h=0,f=0;return f+=i+c,h+=f>>>16,f&=65535,h+=r+l,d+=h>>>16,h&=65535,d+=s+a,u+=d>>>16,d&=65535,u+=n+o,u&=65535,Et(h<<16|f,u<<16|d,this.unsigned)};fe.subtract=function(e){return Os(e)||(e=Xr(e)),this.add(e.neg())};fe.sub=fe.subtract;fe.multiply=function(e){if(this.isZero())return hr;if(Os(e)||(e=Xr(e)),ur){var n=ur.mul(this.low,this.high,e.low,e.high);return Et(n,ur.get_high(),this.unsigned)}if(e.isZero())return hr;if(this.eq(Ss))return e.isOdd()?Ss:hr;if(e.eq(Ss))return this.isOdd()?Ss:hr;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(NE)&&e.lt(NE))return dr(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,d=0,h=0,f=0,p=0;return p+=o*u,f+=p>>>16,p&=65535,f+=i*u,h+=f>>>16,f&=65535,f+=o*c,h+=f>>>16,f&=65535,h+=r*u,d+=h>>>16,h&=65535,h+=i*c,d+=h>>>16,h&=65535,h+=o*l,d+=h>>>16,h&=65535,d+=s*u+r*c+i*l+o*a,d&=65535,Et(f<<16|p,d<<16|h,this.unsigned)};fe.mul=fe.multiply;fe.divide=function(e){if(Os(e)||(e=Xr(e)),e.isZero())throw Error("division by zero");if(ur){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?ur.div_u:ur.div_s)(this.low,this.high,e.low,e.high);return Et(n,ur.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?cl:hr;var s,r,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return cl;if(e.gt(this.shru(1)))return XF;i=cl}else{if(this.eq(Ss)){if(e.eq(Vc)||e.eq(Xw))return Ss;if(e.eq(Ss))return Vc;var o=this.shr(1);return s=o.div(e).shl(1),s.eq(hr)?e.isNegative()?Vc:Xw:(r=this.sub(e.mul(s)),i=s.add(r.div(e)),i)}else if(e.eq(Ss))return this.unsigned?cl:hr;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=hr}for(r=this;r.gte(e);){s=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:ay(2,a-48),c=dr(s),u=c.mul(e);u.isNegative()||u.gt(r);)s-=l,c=dr(s,this.unsigned),u=c.mul(e);c.isZero()&&(c=Vc),i=i.add(c),r=r.sub(u)}return i};fe.div=fe.divide;fe.modulo=function(e){if(Os(e)||(e=Xr(e)),ur){var n=(this.unsigned?ur.rem_u:ur.rem_s)(this.low,this.high,e.low,e.high);return Et(n,ur.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};fe.mod=fe.modulo;fe.rem=fe.modulo;fe.not=function(){return Et(~this.low,~this.high,this.unsigned)};fe.and=function(e){return Os(e)||(e=Xr(e)),Et(this.low&e.low,this.high&e.high,this.unsigned)};fe.or=function(e){return Os(e)||(e=Xr(e)),Et(this.low|e.low,this.high|e.high,this.unsigned)};fe.xor=function(e){return Os(e)||(e=Xr(e)),Et(this.low^e.low,this.high^e.high,this.unsigned)};fe.shiftLeft=function(e){return Os(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Et(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Et(0,this.low<<e-32,this.unsigned)};fe.shl=fe.shiftLeft;fe.shiftRight=function(e){return Os(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Et(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Et(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};fe.shr=fe.shiftRight;fe.shiftRightUnsigned=function(e){if(Os(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return Et(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?Et(n,0,this.unsigned):Et(n>>>e-32,0,this.unsigned)};fe.shru=fe.shiftRightUnsigned;fe.shr_u=fe.shiftRightUnsigned;fe.toSigned=function(){return this.unsigned?Et(this.low,this.high,!1):this};fe.toUnsigned=function(){return this.unsigned?this:Et(this.low,this.high,!0)};fe.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};fe.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};fe.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Nt.fromBytes=function(e,n,s){return s?Nt.fromBytesLE(e,n):Nt.fromBytesBE(e,n)};Nt.fromBytesLE=function(e,n){return new Nt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Nt.fromBytesBE=function(e,n){return new Nt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const JF=K1(qF),NZ=BA({__proto__:null,default:JF},[qF]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const el=JF||NZ;function m0(t){return el.fromString(t,!0,16)}const QF=m0("c3a5c85c97cb3127"),Xa=m0("b492b66fbe98f273"),Yn=m0("9ae16a3b2f90404f");function Yw(t){return t.xor(t.shru(47))}function eM(t,e,n){const s=t.slice(e,e+n);return el.fromBytes(Array.from(s),!0,!0)}function vt(t,e){return eM(t,e,8)}function EE(t,e){return eM(t,e,4)}function xn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function aa(t,e,n=m0("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function EZ(t,e,n,s,r,i){r=r.add(t),i=xn(i.add(r).add(s),21);const o=r;return r=r.add(e),r=r.add(n),i=i.add(xn(r,44)),[r.add(s),i.add(o)]}function wm(t,e,n,s){return EZ(vt(t,e),vt(t,e+8),vt(t,e+16),vt(t,e+24),n,s)}function $Z(t,e=t.length){if(e>=8){const n=Yn.add(e*2),s=vt(t,0).add(Yn),r=vt(t,e-8),i=xn(r,37).mul(n).add(s),o=xn(s,25).add(r).mul(n);return aa(i,o,n)}if(e>=4){const n=Yn.add(e*2),s=EE(t,0);return aa(s.shl(3).add(e),EE(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],i=n+(s<<8),o=e+(r<<2);return Yw(Yn.mul(i).xor(QF.mul(o))).mul(Yn)}return Yn}function _Z(t,e=t.length){const n=Yn.add(e*2),s=vt(t,0).mul(Xa),r=vt(t,8),i=vt(t,e-8).mul(n),o=vt(t,e-16).mul(Yn);return aa(xn(s.add(r),43).add(xn(i,30)).add(o),s.add(xn(r.add(Yn),18)).add(i),n)}function AZ(t,e=t.length){const n=Yn.add(e*2),s=vt(t,0).mul(Yn),r=vt(t,8),i=vt(t,e-8).mul(n),o=vt(t,e-16).mul(Yn),a=xn(s.add(r),43).add(xn(i,30)).add(o),l=aa(a,s.add(xn(r.add(Yn),18)).add(i),n),c=vt(t,16).mul(n),u=vt(t,24),d=a.add(vt(t,e-32)).mul(n),h=l.add(vt(t,e-24)).mul(n);return aa(xn(c.add(u),43).add(xn(d,30)).add(h),c.add(xn(u.add(s),18)).add(d),n)}function RZ(t,e=t.length){const n=el.fromNumber(81,!0);if(e<=32)return e<=16?$Z(t,e):_Z(t,e);if(e<=64)return AZ(t,e);let s=n,r=n.mul(Xa).add(113),i=Yw(r.mul(Yn).add(113)).mul(Yn),o=[el.UZERO,el.UZERO],a=[el.UZERO,el.UZERO];s=s.mul(Yn).add(vt(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do s=xn(s.add(r).add(o[0]).add(vt(t,l+8)),37).mul(Xa),r=xn(r.add(o[1]).add(vt(t,l+48)),42).mul(Xa),s=s.xor(a[1]),r=r.add(o[0]).add(vt(t,l+40)),i=xn(i.add(a[0]),33).mul(Xa),o=wm(t,l,o[1].mul(Xa),s.add(a[0])),a=wm(t,l+32,i.add(a[1]),r.add(vt(t,l+16))),[i,s]=[s,i],l+=64;while(l!==c);const d=Xa.add(i.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),s=xn(s.add(r).add(o[0]).add(vt(t,l+8)),37).mul(d),r=xn(r.add(o[1]).add(vt(t,l+48)),42).mul(d),s=s.xor(a[1].mul(9)),r=r.add(o[0].mul(9).add(vt(t,l+40))),i=xn(i.add(a[0]),33).mul(d),o=wm(t,l,o[1].mul(d),s.add(a[0])),a=wm(t,l+32,i.add(a[1]),r.add(vt(t,l+16))),[i,s]=[s,i],aa(aa(o[0],a[0],d).add(Yw(r).mul(QF)).add(i),aa(o[1],a[1],d).add(s),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Da(t,e){return e==="string"?la(t):sc([t],e)}function DZ(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function sc(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Fl(t)),Y().getBool("DEBUG")&&lZ(t,e),DZ(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function ls(){return Y().platform.now()}function la(t,e="utf-8"){return e=e||"utf-8",Y().platform.encode(t,e)}function ya(t,e="utf-8"){return e=e||"utf-8",Y().platform.decode(t,e)}function xr(t){return Y().platform.isTypedArray!=null?Y().platform.isTypedArray(t):HF(t)}function Fl(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||kC(t)||t==null||xr(t)&&n)e.push(t);else if(Array.isArray(t)||xr(t))for(let s=0;s<t.length;++s)Fl(t[s],e,n);else{let s=-1;for(const r of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Fl(t[r],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PZ{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new FZ)}profileKernel(e,n,s){let r;const i=()=>{r=s()};let o;const a=ls();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const c of r)c.dataSync();o=Promise.resolve({kernelMs:ls()-a})}if(Y().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const u=r[c];u.data().then(d=>{OZ(d,u.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:i,extraInfo:o}=e;s.forEach(a=>{Promise.all([a.data(),r,o]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],i,l[2])})})}}function OZ(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class FZ{logKernelProfile(e,n,s,r,i,o){const a=typeof r=="number"?nu(`${r}ms`,9):r.error,l=nu(e,25),c=n.rank,u=n.size,d=nu(n.shape.toString(),14);let h="";for(const f in i){const p=i[f];if(p!=null){const m=p.shape||n.shape,y=m.length;h+=`${f}: ${y}D ${y>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${d}	%c${u}	%c${h}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MZ(t,e,n){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const d in u){const h=u[d];let f=!1;for(let p=0;p<e.length;p++)if(s[h.id]){c.outputs.forEach(m=>s[m.id]=!0),f=!0,r[c.id]=!0;break}if(f)break}}const i={};i[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(i[c.outputs[d].id]){for(const h in u)i[u[h].id]=!0,o[c.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const c=t[l];if(r[c.id]&&o[c.id]){const u={};for(const h in c.inputs){const f=c.inputs[h];s[f.id]&&(u[h]=f)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,a.push(d)}}return a}function LZ(t,e,n,s){for(let r=e.length-1;r>=0;r--){const i=e[r],o=[];if(i.outputs.forEach(l=>{const c=t[l.id];c!=null?o.push(c):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=i.inputs[l];if(!at(c.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const d=t[u.id];t[u.id]=s(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $E=20,Sd=3,Zv=7;function VZ(t,e,n,s){const r=Ne(e),i=BZ(t,e,n,r),o=e.length,a=ng(t,e,n,r,i),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function BZ(t,e,n,s){const r=Q(e),i=s[s.length-1],o=new Array(i).fill(0),a=e.length,l=n==="complex64"?Vd(t):t;if(a>1)for(let c=0;c<r/i;c++){const u=c*i;for(let d=0;d<i;d++)o[d]=Math.max(o[d],Ld(l[u+d],0,n).length)}return o}function Ld(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(Zv))} + ${parseFloat(t[1].toFixed(Zv))}j`:_f(t)?s=`'${t}'`:n==="bool"?s=tM(t):s=parseFloat(t.toFixed(Zv)).toString(),nu(s,e)}function tM(t){return t===0?"false":"true"}function ng(t,e,n,s,r,i=!0){const o=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=Vd(t);return[Ld(m[0],0,n)]}return n==="bool"?[tM(t[0])]:[t[0].toString()]}if(l===1){if(a>$E){const y=Sd*o;let g=Array.from(t.slice(0,y)),x=Array.from(t.slice((a-Sd)*o,a*o));return n==="complex64"&&(g=Vd(g),x=Vd(x)),["["+g.map((v,b)=>Ld(v,r[b],n)).join(", ")+", ..., "+x.map((v,b)=>Ld(v,r[a-Sd+b],n)).join(", ")+"]"]}return["["+(n==="complex64"?Vd(t):Array.from(t)).map((y,g)=>Ld(y,r[g],n)).join(", ")+"]"]}const c=e.slice(1),u=s.slice(1),d=s[0]*o,h=[];if(a>$E){for(let m=0;m<Sd;m++){const y=m*d,g=y+d;h.push(...ng(t.slice(y,g),c,n,u,r,!1))}h.push("...");for(let m=a-Sd;m<a;m++){const y=m*d,g=y+d;h.push(...ng(t.slice(y,g),c,n,u,r,m===a-1))}}else for(let m=0;m<a;m++){const y=m*d,g=y+d;h.push(...ng(t.slice(y,g),c,n,u,r,m===a-1))}const f=l===2?",":"";h[0]="["+(a>0?h[0]+f:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+f;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(i?"":p),h}function Vd(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class En{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=Q(e),s!=null){const r=s.length;T(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||qt(n,this.size),this.strides=Ne(e)}set(e,...n){n.length===0&&(n=[0]),T(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Ar().makeTensor(this.values,this.shape,this.dtype)}}let Ar=null,Cc=null;function zZ(t){Ar=t}function UZ(t){Cc=t}class ln{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=Q(e),this.strides=Ne(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Cc.buffer(this.shape,this.dtype,e)}bufferSync(){return Cc.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return zr(this.shape,e,this.dtype==="complex64")}arraySync(){return zr(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Ar().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>ya(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Ar().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Ar().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>ya(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Ar().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Ar().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Cc.print(this,e)}clone(){return this.throwIfDisposed(),Cc.clone(this)}toString(e=!1){const n=this.dataSync();return VZ(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Cc.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),Ar().makeVariable(this,e,n,s)}}Object.defineProperty(ln,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function Z(){return CC("Tensor",()=>ln)}Z();class ly extends ln{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!at(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Ar().disposeTensor(this),this.dataId=e.dataId,Ar().incRef(this,null)}dispose(){Ar().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(ly,Symbol.hasInstance,{value:t=>t instanceof ln&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var _E;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(_E||(_E={}));var Zw;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Zw||(Zw={}));var Jw;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(Jw||(Jw={}));var Qw;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(Qw||(Qw={}));var e1;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(e1||(e1={}));const jZ={float32:Qw,int32:Zw,bool:Jw,complex64:e1};function Rs(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return jZ[t][e]}function hS(t){return Rs(t,"int32")}function nM(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function sM(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xt(t,e){if(t.dtype===e.dtype)return[t,e];const n=Rs(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function rM(t){const e=[];return iM(t,e,new Set),e}function iM(t,e,n){if(t==null)return;if(t instanceof ln){e.push(t);return}if(!WZ(t))return;const s=t;for(const r in s){const i=s[r];n.has(i)||(n.add(i),iM(i,e,n))}}function WZ(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jv(t){return t.kernelName!=null}class AE{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class wu{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new AE}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(Ms(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new PZ(this.backendInstance),!0}setupRegisteredKernels(){CE(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){CE(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof xC)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,i=s.then(o=>r<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Ms(`Initialization of backend ${e} failed`),Ms(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return Ms(`Initialization of backend ${e} failed`),Ms(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:i}=this.initializeBackend(s);if(i||r)return{name:s,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,i=this.readSync(n),o=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,i,s.shape,s.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return wu.nextTensorId++}nextVariableId(){return wu.nextVariableId++}clone(e){const n=V.runKernel(Zf,{x:e}),s={x:e},r=o=>({x:()=>{const a="float32",l={x:o},c={dtype:a};return V.runKernel(Lf,l,c)}}),i=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,i,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(wE(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let i=0;s.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=Jv(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Jv(e)){const{kernelName:p,inputs:m,attrs:y}=e;this.backendName==null&&this.backend;const g=wE(p,this.backendName);T(g!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const x=this.backend.numDataIds();l=g.kernelFunc({inputs:m,attrs:y,backend:this.backend});const v=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,x,v);const b=v.map(k=>k.rank!=null?k:this.makeTensorFromTensorInfo(k));if(r){const k=this.getTensorsForGradient(p,m,b);s=this.saveTensorsForBackwardMode(k)}return b}}else{const{forwardFunc:p}=e,m=y=>{r&&(s=y.map(g=>this.keep(this.clone(g))))};a=()=>{const y=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const g=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,y,g),g}}const{inputs:u,attrs:d}=e,h=Jv(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),r&&this.addTapeNode(c,u,n,h,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=kE(e);if(r!=null){const i=r.inputsToSave||[],o=r.outputsToSave||[];let a;r.saveAllInputs?(T(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=i.map(c=>n[c]);const l=s.filter((c,u)=>o[u]);return a.concat(l)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let i=e;s==="string"&&_f(e[0])&&(i=e.map(l=>la(l)));const o=r.write(i,n,s),a=new ln(n,s,o,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(o),c=uZ(i);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,n,s,r){s=s||"float32";const i={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:i}=e,o=new ln(r,i,s,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const i=new ly(e,n,s,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*sy(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof ly||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*sy(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:i},l=kE(e);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=c=>(c=c.map((u,d)=>{if(u==null){const h=s[d],f=Ln(h.size,h.dtype);return this.makeTensor(f,h.shape,h.dtype)}return u}),r(c.length>1?c:c[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=rM(e),s=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!s.has(o.id)&&o.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===r.id&&this.track(i)})}gradients(e,n,s,r=!1){if(T(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));T(i instanceof ln,()=>"The result y returned by f() must be a tensor.");const o=MZ(this.state.activeTape,n,i);if(!r&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=s??GZ(i.shape),LZ(a,o,c=>this.tidy(c),HZ);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return T(Ww(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{T(n.every(a=>a instanceof ln),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((a,l)=>{r[l]=a});const i=(a,l)=>(s=e(...n,l),T(s.value instanceof ln,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),T(Ww(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),o=(a,l)=>{const c=s.gradFunc(a,l),u=Array.isArray(c)?c:[c];T(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),T(u.every(h=>h instanceof ln),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((h,f)=>{d[f]=()=>h}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=ls(),s=await this.backend.time(e);return s.wallMs=ls()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new AE;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}wu.nextTensorId=0;wu.nextVariableId=0;function GZ(t){const e=wC(Q(t),"float32");return V.makeTensor(e,t,"float32")}function oM(){const t=kF();if(t._tfengine==null){const e=new fZ(t);t._tfengine=new wu(e)}return yZ(t._tfengine.ENV),zZ(()=>t._tfengine),t._tfengine}const V=oM();function HZ(t,e){const n={a:t,b:e};return V.runKernel(Hu,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qZ(){return typeof navigator<"u"&&navigator!=null}function aM(t){if(t||qZ()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function lM(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ms=Y();ms.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ms.registerFlag("IS_BROWSER",()=>lM());ms.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ms.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ms.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ms.registerFlag("PROD",()=>!1);ms.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ms.getBool("DEBUG"));ms.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ms.registerFlag("IS_TEST",()=>!1);ms.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ms.getBool("DEBUG"));ms.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ms.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ms.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g0(t,e){let n=t;if(xr(t))return e==="string"?[]:[t.length];if(nM(t)){const r=t.channels||"RGBA";return[t.height,t.width*r.length]}else if(sM(t))return[t.buffer.size/(e==null?4:sy(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||xr(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&Y().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&cM(t,s,[]),s}function cM(t,e,n){if(n=n||[],!Array.isArray(t)&&!xr(t)){T(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}T(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),T(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)cM(t[r],s,n.concat(r))}function RE(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function $(t,e,n,s="numeric"){if(t instanceof Z())return RE(s,t.dtype,e,n),t;let r=Wu(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),RE(s,r,e,n),t==null||!xr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const i=g0(t,r);!xr(t)&&!Array.isArray(t)&&(t=[t]);const a=r!=="string"?sc(t,r):Fl(t,[],!0);return V.makeTensor(a,i,r)}function uM(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,o)=>$(i,`${e}[${o}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KZ="__op";function j(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+KZ;const r=(...i)=>{V.startScope(n);try{const o=s(...i);return kC(o)&&console.error("Cannot return a Promise inside of tidy."),V.endScope(o),o}catch(o){throw V.endScope(null),o}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XZ(t,e){const n=$(t,"real","complex"),s=$(e,"imag","complex");bC(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return V.runKernel(AC,r)}const ku=j({complex_:XZ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y0(t,e,n,s){if(s==null)s=Wu(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(sM(t)||nM(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return V.backend.createTensorFromGPUData(t,e||n,s)}if(!xr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){xo(e);const r=Q(e),i=Q(n);T(r===i,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],l=o===n.length-1?a!==Q(e.slice(o)):!0;T(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!xr(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?sc(t,s):Fl(t,[],!0),V.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dM(t,e,n){const s=g0(t,n);return y0(t,e,s,n)}class qu{static join(e){return new qu(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>xr(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+r.byteLength;this.shards.push({buffer:r,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=n-e,i=new ArrayBuffer(r),o=new Uint8Array(i);let a=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],d=e+a-c.start,h=a,p=Math.min(n,c.end)-c.start,m=new Uint8Array(c.buffer,d,p-d);if(o.set(m,h),a+=m.length,n<c.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(r){return e<r.start?-1:e>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=YZ(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function YZ(t,e){let n=0,s=t.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,i=e(t[r]);if(i===0)return r;i<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ni(){return V}function DE(){return V.memory()}function H(t,e){return V.tidy(t,e)}function We(t){rM(t).forEach(n=>n.dispose())}function vi(t){return V.keep(t)}function hM(t,e,n=1){return V.registerBackend(t,e,n)}function ZZ(){return V.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PE=4;async function OE(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<r.length;++o){const a=r[o],l=Array.isArray(t)?t[o].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async d=>{const h=await l.bytes(),f=h.reduce((y,g)=>y+g.length,0)+PE*h.length,p=new Uint8Array(f);let m=0;for(let y=0;y<h.length;y++){const g=h[y],x=new Uint8Array(new Uint32Array([g.length]).buffer);p.set(x,m),m+=PE,p.set(g,m),m+=g.length}d(p)});s.push(u)}else s.push(l.data());e!=null&&(c.group=e),n.push(c)}const i=await Promise.all(s);return{data:JZ(i),specs:n}}function JZ(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(i=>{s.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),s.buffer}const fS=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function FE(t){return fS?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function QZ(t){if(fS)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function eJ(t){if(fS){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function tJ(t){return qu.join(t)}function fM(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:FE(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:FE(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new qu(t.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Hn.instance==null&&(Hn.instance=new Hn),Hn.instance}static registerSaveRouter(e){Hn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Hn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Hn.getHandlers(e,"save")}static getLoadHandlers(e,n){return Hn.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?Hn.getInstance().loadRouters:Hn.getInstance().saveRouters).forEach(o=>{const a=o(e,s);a!==null&&r.push(a)}),r}}const nJ=t=>Hn.getSaveHandlers(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t1="tensorflowjs",n1=1,ul="models_store",Ho="model_info_store";function pM(){if(!Y().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function s1(t){const e=t.result;e.createObjectStore(ul,{keyPath:"modelPath"}),e.createObjectStore(Ho,{keyPath:"modelPath"})}class Ml{constructor(e){if(this.indexedDB=pM(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const i=this.indexedDB.open(t1,n1);i.onupgradeneeded=()=>s1(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction(ul,"readonly"),c=a.objectStore(ul).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=u=>(o.close(),r(c.error)),a.oncomplete=()=>o.close()}else{n.weightData=qu.join(n.weightData);const a=fM(n),l=o.transaction(Ho,"readwrite");let c=l.objectStore(Ho),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return r(h)}let d;u.onsuccess=()=>{d=o.transaction(ul,"readwrite");const h=d.objectStore(ul);let f;try{f=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return r(p)}f.onsuccess=()=>s({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(Ho);const m=c.delete(this.modelPath);m.onsuccess=()=>(o.close(),r(f.error)),m.onerror=y=>(o.close(),r(f.error))}},u.onerror=h=>(o.close(),r(u.error)),l.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},i.onerror=o=>r(i.error)})}}Ml.URL_SCHEME="indexeddb://";const mM=t=>Y().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ml.URL_SCHEME)?sJ(t.slice(Ml.URL_SCHEME.length)):null;Hn.registerSaveRouter(mM);Hn.registerLoadRouter(mM);function sJ(t){return new Ml(t)}function rJ(t){return t.startsWith(Ml.URL_SCHEME)?t.slice(Ml.URL_SCHEME.length):t}class iJ{constructor(){this.indexedDB=pM()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(t1,n1);s.onupgradeneeded=()=>s1(s),s.onsuccess=()=>{const r=s.result,i=r.transaction(Ho,"readonly"),a=i.objectStore(Ho).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(r.close(),n(a.error)),i.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=rJ(e),new Promise((n,s)=>{const r=this.indexedDB.open(t1,n1);r.onupgradeneeded=()=>s1(r),r.onsuccess=()=>{const i=r.result,o=i.transaction(Ho,"readwrite"),a=o.objectStore(Ho),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return i.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),d=()=>{c=i.transaction(ul,"readwrite");const f=c.objectStore(ul).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>s(l.error)};u.onsuccess=d,u.onerror=h=>(d(),i.close(),s(l.error))}},l.onerror=u=>(i.close(),s(l.error)),o.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},r.onerror=i=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wi="/",Sc="tensorflowjs_models",gM="info",oJ="model_topology",aJ="weight_specs",lJ="weight_data",cJ="model_metadata";function yM(t){return{info:[Sc,t,gM].join(Wi),topology:[Sc,t,oJ].join(Wi),weightSpecs:[Sc,t,aJ].join(Wi),weightData:[Sc,t,lJ].join(Wi),modelMetadata:[Sc,t,cJ].join(Wi)}}function xM(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function uJ(t){const e=t.split(Wi);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Wi)}function dJ(t){return t.startsWith(Ll.URL_SCHEME)?t.slice(Ll.URL_SCHEME.length):t}class Ll{constructor(e){if(!Y().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=yM(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=fM(e),i=qu.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,QZ(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch{throw xM(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=eJ(o),n}}Ll.URL_SCHEME="localstorage://";const vM=t=>Y().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ll.URL_SCHEME)?hJ(t.slice(Ll.URL_SCHEME.length)):null;Hn.registerSaveRouter(vM);Hn.registerLoadRouter(vM);function hJ(t){return new Ll(t)}class fJ{constructor(){T(Y().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),T(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Sc+Wi,s=Wi+gM;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(n)&&i.endsWith(s)){const o=uJ(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=dJ(e);const n=yM(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return xM(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ME="://";class ri{constructor(){this.managers={}}static getInstance(){return ri.instance==null&&(ri.instance=new ri),ri.instance}static registerManager(e,n){T(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(ME)&&(e=e.slice(0,e.indexOf(ME))),T(e.length>0,()=>"scheme must not be an empty string.");const s=ri.getInstance();T(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=ri.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(ri.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pJ{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!Y().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return HF(e)}}if(Y().get("IS_BROWSER")){Y().setPlatform("browser",new pJ);try{ri.registerManager(Ll.URL_SCHEME,new fJ)}catch{}try{ri.registerManager(Ml.URL_SCHEME,new iJ)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mJ={importFetch:()=>require("node-fetch")};let Qv;class gJ{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return Y().global.fetch!=null?Y().global.fetch(e,n):(Qv==null&&(Qv=mJ.importFetch()),Qv(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}Y().get("IS_NODE")&&!Y().get("IS_BROWSER")&&Y().setPlatform("node",new gJ);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function He(t,e="float32",n){return e=e||"float32",xo(t),new En(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yJ(t,e){const n=$(t,"x","cast");if(!cZ(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return V.runKernel(Lf,s,r)}const xe=j({cast_:yJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xJ(t){const n={x:$(t,"x","clone","string_or_numeric")};return V.runKernel(Zf,n)}const yl=j({clone_:xJ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vJ(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */oM();const bJ={buffer:He,cast:xe,clone:yl,print:vJ};UZ(bJ);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wJ(t,e){let n=$(t,"a","add"),s=$(e,"b","add");[n,s]=Xt(n,s);const r={a:n,b:s};return V.runKernel(Hu,r)}const re=j({add_:wJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kJ(t,e){let n=$(t,"a","floorDiv"),s=$(e,"b","floorDiv");[n,s]=Xt(n,s);const r={a:n,b:s};return V.runKernel(Xf,r)}const bM=j({floorDiv_:kJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CJ(t,e){let n=$(t,"a","div"),s=$(e,"b","div");if([n,s]=Xt(n,s),n.dtype==="int32"&&s.dtype==="int32")return bM(n,s);const r={a:n,b:s},i={};return V.runKernel(jf,r,i)}const _e=j({div_:CJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SJ(t,e){let n=$(t,"a","mul"),s=$(e,"b","mul");[n,s]=Xt(n,s);const r={a:n,b:s};return V.runKernel(op,r)}const F=j({mul_:SJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJ(t){const e=$(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return V.runKernel(kx,n)}else{const n={x:e};return V.runKernel(mx,n)}}const Kn=j({abs_:IJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TJ(t){const n={x:$(t,"x","acos")};return V.runKernel(Af,n)}const NJ=j({acos_:TJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EJ(t){const n={x:$(t,"x","acosh")};return V.runKernel(Rf,n)}const $J=j({acosh_:EJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _J(t,e=null,n=!1){const r={x:$(t,"x","all","bool")},i={axis:e,keepDims:n};return V.runKernel(IC,r,i)}const wM=j({all_:_J});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AJ(t,e=null,n=!1){const r={x:$(t,"x","any","bool")},i={axis:e,keepDims:n};return V.runKernel(TC,r,i)}const r1=j({any_:AJ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RJ(t,e=0){const s={x:$(t,"x","argMax")},r={axis:e};return V.runKernel(gx,s,r)}const Kh=j({argMax_:RJ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DJ(t,e=0){const s={x:$(t,"x","argMin")},r={axis:e};return V.runKernel(yx,s,r)}const PJ=j({argMin_:DJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OJ(t){const n={x:$(t,"x","asin")};return V.runKernel(Df,n)}const FJ=j({asin_:OJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MJ(t){const n={x:$(t,"x","asinh")};return V.runKernel(Pf,n)}const LJ=j({asinh_:MJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VJ(t){const n={x:$(t,"x","atan")};return V.runKernel(Of,n)}const BJ=j({atan_:VJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zJ(t,e){let n=$(t,"a","atan2"),s=$(e,"b","atan2");[n,s]=Xt(n,s);const r={a:n,b:s};return V.runKernel(Mf,r)}const UJ=j({atan2_:zJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jJ(t){const n={x:$(t,"x","atanh")};return V.runKernel(Ff,n)}const WJ=j({atanh_:jJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tp(t,e,n,s,r="NHWC",i){const o=t[3],a=[...e,o],l=bo(r);return $n(t,a,n,i,s,null,null,l)}function br(t,e,n,s,r,i,o="channelsLast"){const[a,l]=Xh(e);let c;if(o==="channelsLast")c=[a,l,t[3],t[3]];else if(o==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return $n(t,c,n,s,r,i,!1,o)}function vo(t,e,n,s,r,i,o="NDHWC"){const[a,l,c]=i1(e);let u,d;if(o==="NDHWC")d="channelsLast",u=[a,l,c,t[4],t[4]];else if(o==="NCDHW")d="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Pa(t,u,n,s,r,!1,d,i)}function $n(t,e,n,s,r,i,o=!1,a="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,d]=t;else if(a==="channelsFirst")[l,d,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,f,,p]=e,[m,y]=Xh(n),[g,x]=Xh(s),v=ru(h,g),b=ru(f,x),{padInfo:k,outHeight:C,outWidth:S}=qJ(r,c,u,m,y,v,b,i,a),I=o?p*d:p;let N;return a==="channelsFirst"?N=[l,I,C,S]:a==="channelsLast"&&(N=[l,C,S,I]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:d,outHeight:C,outWidth:S,outChannels:I,padInfo:k,strideHeight:m,strideWidth:y,filterHeight:h,filterWidth:f,effectiveFilterHeight:v,effectiveFilterWidth:b,dilationHeight:g,dilationWidth:x,inShape:t,outShape:N,filterShape:e}}function Pa(t,e,n,s,r,i=!1,o="channelsLast",a){let[l,c,u,d,h]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,d,h]=t;else if(o==="channelsFirst")[l,h,c,u,d]=t;else throw new Error(`Unknown dataFormat ${o}`);const[f,p,m,,y]=e,[g,x,v]=i1(n),[b,k,C]=i1(s),S=ru(f,b),I=ru(p,k),N=ru(m,C),{padInfo:E,outDepth:D,outHeight:R,outWidth:L}=KJ(r,c,u,d,g,x,v,S,I,N,a),B=i?y*h:y;let W;return o==="channelsFirst"?W=[l,B,D,R,L]:o==="channelsLast"&&(W=[l,D,R,L,B]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:u,inWidth:d,inChannels:h,outDepth:D,outHeight:R,outWidth:L,outChannels:B,padInfo:E,strideDepth:g,strideHeight:x,strideWidth:v,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:S,effectiveFilterHeight:I,effectiveFilterWidth:N,dilationDepth:b,dilationHeight:k,dilationWidth:C,inShape:t,outShape:W,filterShape:e}}function GJ(t,e,n,s,r){s==null&&(s=pS(t,e,n));const i=t[0],o=t[1],a=Yh((i-e+2*s)/n+1,r),l=Yh((o-e+2*s)/n+1,r);return[a,l]}function HJ(t,e,n,s,r,i){r==null&&(r=pS(t,e[0],s[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*r>=e[a]&&(o[a]=Yh((t[a]-e[a]+2*r)/s[a]+1,i));return o}function pS(t,e,n,s=1){const r=ru(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function Xh(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function i1(t){return typeof t=="number"?[t,t,t]:t}function ru(t,e){return e<=1?t:t+(t-1)*(e-1)}function qJ(t,e,n,s,r,i,o,a,l){let c,u,d;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=GJ([e,n],i,s,t,a);u=f[0],d=f[1]}else if(t==="same"){u=Math.ceil(e/s),d=Math.ceil(n/r);const h=Math.max(0,(u-1)*s+i-e),f=Math.max(0,(d-1)*r+o-n),p=Math.floor(h/2),m=h-p,y=Math.floor(f/2),g=f-y;c={top:p,bottom:m,left:y,right:g,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-i+1)/s),d=Math.ceil((n-o+1)/r);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];c={top:h,bottom:f,left:p,right:m,type:h===0&&f===0&&p===0&&m===0?"VALID":"EXPLICIT"},u=Yh((e-i+h+f)/s+1,a),d=Yh((n-o+p+m)/r+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:d}}function KJ(t,e,n,s,r,i,o,a,l,c,u){let d,h,f,p;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const y=HJ([e,n,s,1],[a,l,c],1,[r,i,o],t,u);h=y[0],f=y[1],p=y[2]}else if(t==="same"){h=Math.ceil(e/r),f=Math.ceil(n/i),p=Math.ceil(s/o);const m=(h-1)*r+a-e,y=(f-1)*i+l-n,g=(p-1)*o+c-s,x=Math.floor(m/2),v=m-x,b=Math.floor(y/2),k=y-b,C=Math.floor(g/2),S=g-C;d={top:b,bottom:k,left:C,right:S,front:x,back:v,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:f,outWidth:p}}function Yh(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Vl(t){const[e,n,s]=Xh(t);return e===1&&n===1&&s===1}function Bn(t,e){return Vl(t)||Vl(e)}function Bl(t){return Xh(t).every(e=>e>0)}function bo(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function vs(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")T(vu(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{T(vu(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XJ(t,e){const s={x:$(t,"x","reshape","string_or_numeric")},r={shape:e};return V.runKernel(n0,s,r)}const U=j({reshape_:XJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YJ(t,e,n,s,r){const i=$(t,"x","avgPool","float32"),o=1;T(Bn(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=U(i,[1,i.shape[0],i.shape[1],i.shape[2]])),T(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),vs("avgPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let d=V.runKernel(xx,c,u);return d=xe(d,i.dtype),l?U(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const mS=j({avgPool_:YJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZJ(t,e,n,s,r,i="NDHWC"){const o=$(t,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),T(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),T(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),T(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),vs("avgPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i};let d=V.runKernel(vx,c,u);return d=xe(d,a.dtype),l?U(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const JJ=j({avgPool3d_:ZJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QJ(t,e=0){T(t.length>=1,()=>"Pass at least one tensor to concat");const n=uM(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return yl(n[0]);const s=n,r={axis:e};return V.runKernel(Cx,s,r)}const hs=j({concat_:QJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eQ(t,e,n=!1,s=!1){let r=$(t,"a","matMul"),i=$(e,"b","matMul");[r,i]=Xt(r,i);const o={a:r,b:i},a={transposeA:n,transposeB:s};return V.runKernel(bx,o,a)}const it=j({matMul_:eQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tQ(t){const n={x:$(t,"x","sigmoid","float32")};return V.runKernel(yp,n)}const Ku=j({sigmoid_:tQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nQ(t,e,n){const s=$(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},i={begin:e,size:n};return V.runKernel(a0,r,i)}const bt=j({slice_:nQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sQ(t){const n={x:$(t,"x","tanh","float32")};return V.runKernel(Cp,n)}const x0=j({tanh_:sQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rQ(t,e,n){const s=$(t,"x","batchToSpaceND"),r=e.reduce((a,l)=>a*l);T(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),T(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),T(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const i={x:s},o={blockShape:e,crops:n};return V.runKernel(wx,i,o)}const gS=j({batchToSpaceND_:rQ});function iQ(t){let e;return t.rank===0||t.rank===1?e=U(t,[1,1,1,t.size]):t.rank===2?e=U(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oQ(t,e,n,s,r,i){i==null&&(i=.001);const o=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let c;r!=null&&(c=$(r,"scale","batchNorm"));let u;s!=null&&(u=$(s,"offset","batchNorm")),T(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:iQ(o),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:i},p=V.runKernel(Rx,h,f);return U(p,o.shape)}const v0=j({batchNorm_:oQ});function aQ(t,e,n,s,r,i){const o=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let c;r!=null&&(c=$(r,"scale","batchNorm"));let u;return s!=null&&(u=$(s,"offset","batchNorm")),T(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),T(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),T(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),v0(o,a,l,u,c,i)}const lQ=j({batchNorm2d_:aQ});function cQ(t,e,n,s,r,i){const o=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let c;r!=null&&(c=$(r,"scale","batchNorm"));let u;return s!=null&&(u=$(s,"offset","batchNorm")),T(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),T(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),T(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),v0(o,a,l,u,c,i)}const uQ=j({batchNorm3d_:cQ});function dQ(t,e,n,s,r,i){const o=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let c;r!=null&&(c=$(r,"scale","batchNorm"));let u;return s!=null&&(u=$(s,"offset","batchNorm")),T(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),T(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),T(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),v0(o,a,l,u,c,i)}const hQ=j({batchNorm4d_:dQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fQ(t,e,n){const s=$(t,"x","bincount"),r=$(e,"weights","bincount");T(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const i={x:s,weights:r},o={size:n};return V.runKernel($C,i,o)}const pQ=j({bincount_:fQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mQ(t,e){let n=$(t,"broadcastTo","x");const s=n.shape;if(xo(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=U(n,c)}const r=n.shape,i=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])i[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(i.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return yl(n);const a={x:n},l={reps:i};return V.runKernel(Sp,a,l)}const lh=j({broadcastTo_:mQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gQ(t){const n={x:$(t,"x","ceil","float32")};return V.runKernel(Vf,n)}const yQ=j({ceil_:gQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b0(t,e,n){xo(t),n=n||Wu(e);const s={shape:t,value:e,dtype:n};return V.runKernel(WC,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xQ(t,e,n){const s=$(t,"x","clipByValue");if(T(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return b0(s.shape,e,s.dtype);const r={x:s},i={clipValueMin:e,clipValueMax:n};return V.runKernel(Bf,r,i)}const Hs=j({clipByValue_:xQ});function vQ(t){return hs(t,0)}const bQ=j({concat1d_:vQ});function wQ(t,e){return hs(t,e)}const kQ=j({concat2d_:wQ});function CQ(t,e){return hs(t,e)}const SQ=j({concat3d_:CQ});function IQ(t,e){return hs(t,e)}const TQ=j({concat4d_:IQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NQ(t,e,n,s,r="NHWC",i=[1,1],o){const a=$(t,"x","conv2d","float32"),l=$(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),vs("conv2d",s,o);const d=r==="NHWC"?c.shape[3]:c.shape[1];T(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),T(Bn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),T(Bl(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),T(Bl(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=V.runKernel(Sx,h,f);return u?U(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const zl=j({conv2d_:NQ});function EQ(t,e,n,s,r="NWC",i=1,o){const a=$(t,"x","conv1d"),l=$(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=U(a,[1,a.shape[0],a.shape[1]])),T(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),T(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),vs("conv1d",s,o),T(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),T(Bn(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),T(Bl(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),T(Bl(n),()=>"Error in conv1D: Stride should be larger than 0."),T(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const d=U(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=U(c,[c.shape[0],1,c.shape[1],c.shape[2]]),y=zl(h,d,[1,n],s,"NHWC",[1,i],o);return u?U(y,[y.shape[2],y.shape[3]]):U(y,[y.shape[0],y.shape[2],y.shape[3]])}const kM=j({conv1d_:EQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Q(t,e,n,s,r,i="NHWC",o){T(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,c=!1;e.rank===3&&(c=!0,l=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),T(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),T(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),T(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=i==="NHWC"?a[3]:a[1],d=i==="NHWC"?l.shape[3]:l.shape[1];T(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),T(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),vs("conv2dDerInput",r,o);const h={dy:l,filter:n},f={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,inputShape:a},p=V.runKernel(Ix,h,f);return c?U(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const yS=j({conv2DBackpropInput_:$Q});function _Q(t,e,n,s,r,i){const o=$(t,"x","conv2dTranspose"),a=$(e,"filter","conv2dTranspose");return yS(n,o,a,s,r,"NHWC",i)}const CM=j({conv2dTranspose_:_Q});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AQ(t,e,n,s,r="NDHWC",i=[1,1,1]){const o=$(t,"x","conv3d"),a=$(e,"filter","conv3d");let l=o,c=!1;o.rank===4&&(c=!0,l=U(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),T(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),T(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),T(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),T(Bn(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),T(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),T(Bl(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),T(Bl(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:a},d={strides:n,pad:s,dataFormat:r,dilations:i},h=V.runKernel(Tx,u,d);return c?U(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const RQ=j({conv3d_:AQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DQ(t,e,n,s,r){T(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,a=!1;e.rank===4&&(a=!0,o=U(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],c=o.shape[4];T(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),T(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),T(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),T(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),T(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:o,filter:n},d={pad:r,strides:s,inputShape:i},h=V.runKernel(PC,u,d);return a?U(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const SM=j({conv3DBackpropInput_:DQ});function PQ(t,e,n,s,r){const i=$(t,"x","conv3dTranspose"),o=$(e,"filter","conv3dTranspose");return SM(n,i,o,s,r)}const OQ=j({conv3dTranspose_:PQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FQ(t){const n={x:$(t,"x","cos","float32")};return V.runKernel(zf,n)}const xS=j({cos_:FQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MQ(t){const n={x:$(t,"x","cosh","float32")};return V.runKernel(Uf,n)}const IM=j({cosh_:MQ});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LQ(t,e=0,n=!1,s=!1){const i={x:$(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:s};return V.runKernel(OC,i,o)}const o1=j({cumprod_:LQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VQ(t,e=0,n=!1,s=!1){const i={x:$(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:s};return V.runKernel(Nx,i,o)}const TM=j({cumsum_:VQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BQ(t,e,n,s=!1){const r=$(t,"x","denseBincount"),i=$(e,"weights","denseBincount");T(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),T(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(i.size===r.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${i.shape}.`);const o={x:r,weights:i},a={size:n,binaryOutput:s};return V.runKernel(MC,o,a)}const LE=j({denseBincount_:BQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zQ(t,e,n="NHWC"){const s=$(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],i=n==="NHWC"?s.shape[2]:s.shape[3],o=n==="NHWC"?s.shape[3]:s.shape[1];T(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),T(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),T(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${s.shape}`),T(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:n};return V.runKernel(LC,a,l)}const UQ=j({depthToSpace_:zQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jQ(t,e,n,s,r="NHWC",i=[1,1],o){const a=$(t,"x","depthwiseConv2d","float32"),l=$(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=r==="NHWC"?c.shape[3]:c.shape[1];T(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),vs("depthwiseConv2d",s,o);const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},p=V.runKernel(Ex,h,f);return u?U(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const vS=j({depthwiseConv2d_:jQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WQ(t,e,n,s,r=[1,1],i="NHWC"){const o=$(t,"x","dilation2d"),a=$(e,"filter","dilation2d");T(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),T(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),T(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,c=!1;o.rank===3&&(l=U(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),T(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const u={x:l,filter:a},d={strides:n,pad:s,dilations:r},h=V.runKernel($x,u,d);return c?U(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const GQ=j({dilation2d_:WQ});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cu(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const i=n-1-r,o=t[i]||1;(e[e.length-1-r]||1)>1&&o===1&&s.unshift(i)}return s}function pn(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],i=e.length-s-1,o=e[i];(r==null||r===1&&o>1)&&n.unshift(i)}return n}function Le(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let r=0;r<n;r++){let i=t[t.length-r-1];i==null&&(i=1);let o=e[e.length-r-1];if(o==null&&(o=1),i===1)s[n-r-1]=o;else if(o===1)s[n-r-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else s[n-r-1]=i}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HQ(t,e){let n=$(t,"a","equal","string_or_numeric"),s=$(e,"b","equal","string_or_numeric");[n,s]=Xt(n,s),Le(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(_x,r)}const Ei=j({equal_:HQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qQ(t,e,n){const s=$(e,"a","where"),r=$(n,"b","where"),i=$(t,"condition","where","bool"),o=Le(Le(i.shape,s.shape),r.shape),a=lh(i,o),l=lh(s,o),c=lh(r,o),u={condition:a,t:l,e:c};return V.runKernel(o0,u)}const es=j({where_:qQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KQ(t){const n={x:$(t,"x","zerosLike")};return V.runKernel(p0,n)}const Qe=j({zerosLike_:KQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XQ(t,e){let n=$(t,"a","div"),s=$(e,"b","div");[n,s]=Xt(n,s);const r=_e(n,s),i=Qe(r),o=Ei(s,i);return es(o,i,r)}const YQ=j({divNoNan_:XQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZQ(t,e){const n=$(t,"t1","dot"),s=$(e,"t2","dot");T((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],i=s.rank===1?s.size:s.shape[0];if(T(r===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${i}.`),n.rank===1&&s.rank===1){const o=U(n,[1,-1]),a=U(s,[-1,1]),l=it(o,a);return U(l,[])}else if(n.rank===1&&s.rank===2){const o=U(n,[1,-1]),a=U(s,[s.shape[0],s.shape[1]]),l=it(o,a);return U(l,[l.size])}else if(n.rank===2&&s.rank===1){const o=U(s,[-1,1]),a=it(n,o);return U(a,[a.size])}else{const o=U(s,[s.shape[0],s.shape[1]]);return it(n,o)}}const JQ=j({dot_:ZQ});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QQ(t,...e){const n=e.map((r,i)=>$(r,`tensors${i}`,"einsum")),s={equation:t};return V.runKernel(zC,n,s)}const Id=j({einsum_:QQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eee(t){const n={x:$(t,"x","elu","float32")};return V.runKernel(Wf,n)}const w0=j({elu_:eee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tee(t){let e=$(t,"x","erf");T(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=xe(e,"float32"));const n={x:e};return V.runKernel(Gf,n)}const NM=j({erf_:tee});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bS(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function EM(t,e,n){const s=t.length+e.length,r=[];let i=0,o=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?r.push(t[i++]):r.push(e[o++]);return r}function kn(t,e){const n=[],s=t.length;for(let i=0;i<s;i++)e.indexOf(i)===-1&&n.push(t[i]);const r=e.map(i=>t[i]);return[n,r]}function on(t,e){const n=e.map(s=>1);return EM(t,n,e)}function _n(t,e,n){T(bS(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Lt(t,e){if(bS(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function Oa(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Zt(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nee(t,e=null,n=!1){const r={x:$(t,"x","max")},i={reductionIndices:e,keepDims:n};return V.runKernel(Ux,r,i)}const Ur=j({max_:nee});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function see(t,e=null,n=!1){const r={x:$(t,"x","min")},i={axis:e,keepDims:n};return V.runKernel(Hx,r,i)}const cy=j({min_:see});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ree(t,e){let n=$(t,"base","pow"),s=$(e,"exp","pow");[n,s]=Xt(n,s);const r={a:n,b:s};return V.runKernel(ap,r)}const Ul=j({pow_:ree});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ot(t,e){if((xr(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&xr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return y0(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iee(t){const n={x:$(t,"x","sqrt","float32")};return V.runKernel(vp,n)}const Vn=j({sqrt_:iee});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oee(t){const e=$(t,"x","square"),n={};return V.runKernel("Square",{x:e},n)}const Tt=j({square_:oee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aee(t,e=null,n=!1){let s=$(t,"x","sum");s.dtype==="bool"&&(s=xe(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return V.runKernel(l0,r,i)}const $e=j({sum_:aee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lee(t,e="euclidean",n=null,s=!1){t=$(t,"x","norm");const r=$M(t,e,n);let i=r.shape;if(s){const o=qe(n,t.shape);i=on(r.shape,o)}return U(r,i)}function $M(t,e,n=null){if(t.rank===0)return Kn(t);if(t.rank!==1&&n===null)return $M(U(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return $e(Kn(t),n);if(e===1/0)return Ur(Kn(t),n);if(e===-1/0)return cy(Kn(t),n);if(e==="euclidean"||e===2)return Vn($e(Ul(Kn(t),ot(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Ur($e(Kn(t),n[0]),n[1]-1);if(e===1/0)return Ur($e(Kn(t),n[1]),n[0]);if(e===-1/0)return cy($e(Kn(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Vn($e(Tt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const k0=j({norm_:lee});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cee(t,e=null,n=!1){return k0(t,"euclidean",e,n)}const uee=j({euclideanNorm_:cee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dee(t){const n={x:$(t,"x","exp")};return V.runKernel(Hf,n)}const $i=j({exp_:dee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hee(t,e=0){const n=$(t,"x","expandDims","string_or_numeric");T(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return V.runKernel(Ax,s,r)}const cs=j({expandDims_:hee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fee(t){const n={x:$(t,"x","expm1")};return V.runKernel(qf,n)}const pee=j({expm1_:fee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mee(t,e){const n=$(t,"x","tile","string_or_numeric");T(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return V.runKernel(Sp,s,r)}const Mr=j({tile_:mee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gee(t,e,n,s="float32"){e==null&&(e=t);const r=He([t,e],s),i=t<=e?t:e;for(let a=0;a<i;++a)r.set(1,a,a);const o=U(r.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return Mr(cs(o,0),[n[0],1,1]);if(n.length===2)return Mr(cs(cs(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Mr(cs(cs(cs(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const _M=j({eye_:gee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yee(t){const n={x:$(t,"x","floor","float32")};return V.runKernel(Kf,n)}const C0=j({floor_:yee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xee(t,e,n=0,s=0){const r=$(t,"x","gather"),i=$(e,"indices","gather","int32"),o={x:r,indices:i},a={axis:n,batchDims:s};return V.runKernel(Dx,o,a)}const wS=j({gather_:xee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vee(t,e){let n=$(t,"a","greater","string_or_numeric"),s=$(e,"b","greater","string_or_numeric");[n,s]=Xt(n,s),Le(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Px,r)}const Ys=j({greater_:vee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bee(t,e){let n=$(t,"a","greaterEqual","string_or_numeric"),s=$(e,"b","greaterEqual","string_or_numeric");[n,s]=Xt(n,s),Le(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Yf,r)}const rc=j({greaterEqual_:bee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wee(t){const n={input:$(t,"input","imag")};return V.runKernel(qC,n)}const kS=j({imag_:wee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kee(t){const n={x:$(t,"x","isFinite")};return V.runKernel(Jf,n)}const Cee=j({isFinite_:kee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function See(t){const n={x:$(t,"x","isInf")};return V.runKernel(Qf,n)}const Iee=j({isInf_:See});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tee(t){const n={x:$(t,"x","isNaN")};return V.runKernel(ep,n)}const Nee=j({isNaN_:Tee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eee(t,e=.2){const s={x:$(t,"x","leakyRelu")},r={alpha:e};return V.runKernel(Ox,s,r)}const CS=j({leakyRelu_:Eee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ee(t,e){let n=$(t,"a","less","string_or_numeric"),s=$(e,"b","less","string_or_numeric");[n,s]=Xt(n,s),Le(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Fx,r)}const uy=j({less_:$ee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ee(t,e){let n=$(t,"a","lessEqual","string_or_numeric"),s=$(e,"b","lessEqual","string_or_numeric");[n,s]=Xt(n,s),Le(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Mx,r)}const Xu=j({lessEqual_:_ee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aee(t,e=5,n=1,s=1,r=.5){const i=$(t,"x","localResponseNormalization");T(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),T(vu(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=U(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},c={depthRadius:e,bias:n,alpha:s,beta:r},u=V.runKernel(zx,l,c);return a?U(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Ree=j({localResponseNormalization_:Aee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dee(t){const n={x:$(t,"x","log","float32")};return V.runKernel(tp,n)}const _i=j({log_:Dee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pee(t){const n={x:$(t,"x","log1p")};return V.runKernel(np,n)}const AM=j({log1p_:Pee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oee(t,e){T(Ww(t),()=>"The f passed in variableGrads(f) must be a function"),T(e==null||Array.isArray(e)&&e.every(c=>c instanceof ly),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in V.registeredVariables)e.push(V.registeredVariables[c])}const s=n?e.filter(c=>!c.trainable):null,r=e.length;e=e.filter(c=>c.trainable),T(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const i=!0,{value:o,grads:a}=V.gradients(t,e,null,i);T(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),T(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:o,grads:l}}function Su(t){return V.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fee(t){const n={x:$(t,"x","neg")};return V.runKernel(Kx,n)}const Kt=j({neg_:Fee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mee(t){const n={x:$(t,"x","softplus")};return V.runKernel(xp,n)}const Np=j({softplus_:Mee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lee(t){const e=$(t,"x","logSigmoid");return Su(s=>({value:Kt(Np(Kt(s))),gradFunc:o=>F(o,Ku(Kt(s)))}))(e)}const Vee=j({logSigmoid_:Lee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bee(t,e){let n=$(t,"a","sub"),s=$(e,"b","sub");[n,s]=Xt(n,s);const r={a:n,b:s};return V.runKernel(wp,r)}const Ae=j({sub_:Bee});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zee(t,e=-1){const n=$(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Su((r,i)=>{const a=Ur(r,e,!0),l=Ae(r,a),c=Ae(xe(l,"float32"),_i($e($i(l),e,!0)));return i([c]),{value:c,gradFunc:(d,h)=>{const[f]=h,p=!0,m=$i(f);return Ae(d,F($e(d,e,p),m))}}})(n)}const RM=j({logSoftmax_:zee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uee(t,e=null,n=!1){const s=$(t,"x","logSumExp"),r=qe(e,s.shape),i=Ur(s,r,!0),o=Ae(s,i),a=$i(o),l=$e(a,r),c=_i(l),u=re(U(i,c.shape),c);if(n){const d=on(u.shape,r);return U(u,d)}return u}const DM=j({logSumExp_:Uee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jee(t,e){const n=$(t,"a","logicalAnd","bool"),s=$(e,"b","logicalAnd","bool");Le(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Lx,r)}const uo=j({logicalAnd_:jee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wee(t){const n={x:$(t,"x","logicalNot","bool")};return V.runKernel(Vx,n)}const SS=j({logicalNot_:Wee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gee(t,e){const n=$(t,"a","logicalOr","bool"),s=$(e,"b","logicalOr","bool");Le(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Bx,r)}const PM=j({logicalOr_:Gee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hee(t,e){const n=$(t,"a","logicalXor","bool"),s=$(e,"b","logicalXor","bool");return Le(n.shape,s.shape),uo(PM(t,e),SS(uo(t,e)))}const qee=j({logicalXor_:Hee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kee(t,e,n,s,r){const i=$(t,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=U(i,[1,i.shape[0],i.shape[1],i.shape[2]])),T(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),T(Bn(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),vs("maxPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r},d=V.runKernel(jx,c,u);return l?U(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const IS=j({maxPool_:Kee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xee(t,e=[1,1,1],n,s,r,i="NDHWC"){const o=$(t,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),T(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),T(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),vs("maxPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i},d=V.runKernel(Wx,c,u);return l?U(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Yee=j({maxPool3d_:Xee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zee(t,e){let n=$(t,"a","maximum"),s=$(e,"b","maximum");[n,s]=Xt(n,s),n.dtype==="bool"&&(n=xe(n,"int32"),s=xe(s,"int32")),Le(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(sp,r)}const Fa=j({maximum_:Zee});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jee(t,e=null,n=!1){const r={x:$(t,"x","mean")},i={axis:e,keepDims:n};return V.runKernel(Gx,r,i)}const nn=j({mean_:Jee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vn(t,e="float32"){if(xo(t),e==="complex64"){const s=vn(t,"float32"),r=vn(t,"float32");return ku(s,r)}const n=Ln(Q(t),e);return V.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ma(t,e="float32"){if(xo(t),e==="complex64"){const s=Ma(t,"float32"),r=vn(t,"float32");return ku(s,r)}const n=wC(Q(t),e);return V.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qee(t,e){let n=$(t,"a","minimum"),s=$(e,"b","minimum");[n,s]=Xt(n,s),n.dtype==="bool"&&(n=xe(n,"int32"),s=xe(s,"int32")),Le(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(rp,r)}const Zh=j({minimum_:Qee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ete(t,e,n){T(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=$(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");T(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)T(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),T(e[a][0]>=0&&e[a][0]<=s.shape[a]-r&&e[a][1]>=0&&e[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const i={paddings:e,mode:n},o={x:s};return V.runKernel(qx,o,i)}const tte=j({mirrorPad_:ete});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nte(t,e){let n=$(t,"a","mod"),s=$(e,"b","mod");[n,s]=Xt(n,s);const r={a:n,b:s};return V.runKernel(ip,r)}const ste=j({mod_:nte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rte(t,e=null,n=!1){t=$(t,"x","moments");const s=qe(e,t.shape),r=nn(t,s,n);let i=r.shape;n||(i=on(r.shape,s));const o=Tt(Ae(xe(t,"float32"),U(r,i))),a=nn(o,s,n);return{mean:r,variance:a}}const TS=j({moments_:rte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ite(t,e){let n=$(t,"a","notEqual","string_or_numeric"),s=$(e,"b","notEqual","string_or_numeric");[n,s]=Xt(n,s),Le(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Xx,r)}const dy=j({notEqual_:ite});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ote(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:$(t,"indices","oneHot","int32")},a={dtype:r,depth:e,onValue:n,offValue:s};return V.runKernel(Zx,o,a)}const OM=j({oneHot_:ote});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ate(t){const n={x:$(t,"x","onesLike")};return V.runKernel(Yx,n)}const vr=j({onesLike_:ate});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lte(t,e,n=0){const s=$(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},i={x:s};return V.runKernel(Qx,i,r)}const NS=j({pad_:lte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cte(t,e,n){const s=$(t,"x","spaceToBatchND");T(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),T(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),T(s.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},i={blockShape:e,paddings:n};return V.runKernel(c0,r,i)}const ES=j({spaceToBatchND_:cte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ute(t,e,n,s,r,i,o){r==null&&(r=[1,1]),i==null&&(i=1),s===0&&(s="valid");const a=$(t,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(Bn(i,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${r}'`);const u=br(l.shape,e,i,r,s),d=[u.dilationHeight,u.dilationWidth];let h;s==="same"?h=hte([u.filterHeight,u.filterWidth],d):h=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[p,m]=dte([u.inHeight,u.inWidth],d,h),y=f?s:"valid",g=f?l:ES(l,d,p),v=(n==="avg"?()=>mS(g,e,i,y,o):()=>IS(g,e,i,y,o))(),b=f?v:gS(v,d,m);return c?U(b,[b.shape[1],b.shape[2],b.shape[3]]):b}function dte(t,e,n){const s=n.map(u=>u[0]),r=n.map(u=>u[1]),i=t.concat(s,r),o=e.map((u,d)=>(u-i[d]%u)%u),a=r.map((u,d)=>u+o[d]),l=e.map((u,d)=>[s[d],a[d]]),c=e.map((u,d)=>[0,o[d]]);return[l,c]}function hte(t,e){const s=t.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),r=s.map(o=>Math.floor(o/2)),i=s.map((o,a)=>o-r[a]);return s.map((o,a)=>[r[a],i[a]])}const fte=j({pool_:ute});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pte(t,e){const n=$(t,"x","prelu"),s=$(e,"alpha","prelu"),r={x:n,alpha:s};return V.runKernel(e0,r)}const $S=j({prelu_:pte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mte(t,e=null,n=!1){let s=$(t,"x","prod");s.dtype==="bool"&&(s=xe(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return V.runKernel(t0,r,i)}const gte=j({prod_:mte});var _S={exports:{}};_S.exports;(function(t){(function(e,n,s){function r(l){var c=this,u=a();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var u=new r(l),d=c&&c.state,h=u.next;return h.int32=function(){return u.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}function a(){var l=4022871197,c=function(u){u=String(u);for(var d=0;d<u.length;d++){l+=u.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:this.alea=o})(Zl,t)})(_S);var yte=_S.exports,AS={exports:{}};AS.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xor128=o})(Zl,t)})(AS);var xte=AS.exports,RS={exports:{}};RS.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xorwow=o})(Zl,t)})(RS);var vte=RS.exports,DS={exports:{}};DS.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.x,d=l.i,h,f;return h=u[d],h^=h>>>7,f=h^h<<24,h=u[d+1&7],f^=h^h>>>10,h=u[d+3&7],f^=h^h>>>3,h=u[d+4&7],f^=h^h<<7,h=u[d+7&7],h=h^h<<13,f^=h^h<<9,u[d]=f,l.i=d+1&7,f};function c(u,d){var h,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[h&7]=f[h&7]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],u.x=f,u.i=0,h=256;h>0;--h)u.next()}c(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.x&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xorshift7=o})(Zl,t)})(DS);var bte=DS.exports,PS={exports:{}};PS.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.w,d=l.X,h=l.i,f,p;return l.w=u=u+1640531527|0,p=d[h+34&127],f=d[h=h+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=d[h]=p^f,l.i=h,p+(u^u>>>16)|0};function c(u,d){var h,f,p,m,y,g=[],x=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,x=Math.max(x,d.length)),p=0,m=-32;m<x;++m)d&&(f^=d.charCodeAt((m+32)%d.length)),m===0&&(y=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(y=y+1640531527|0,h=g[m&127]^=f+y,p=h==0?p+1:0);for(p>=128&&(g[(d&&d.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=g[p+34&127],h=g[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,g[p]=f^h;u.w=y,u.X=g,u.i=p}c(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.X&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xor4096=o})(Zl,t)})(PS);var wte=PS.exports,OS={exports:{}};OS.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.b,h=l.c,f=l.d,p=l.a;return d=d<<25^d>>>7^h,h=h-f|0,f=f<<24^f>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-f|0,l.d=f<<16^h>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.tychei=o})(Zl,t)})(OS);var kte=OS.exports,FM={exports:{}};const Cte={},Ste=Object.freeze(Object.defineProperty({__proto__:null,default:Cte},Symbol.toStringTag,{value:"Module"})),Ite=uj(Ste);(function(t){(function(e,n,s){var r=256,i=6,o=52,a="random",l=s.pow(r,i),c=s.pow(2,o),u=c*2,d=r-1,h;function f(b,k,C){var S=[];k=k==!0?{entropy:!0}:k||{};var I=g(y(k.entropy?[b,v(n)]:b??x(),3),S),N=new p(S),E=function(){for(var D=N.g(i),R=l,L=0;D<c;)D=(D+L)*r,R*=r,L=N.g(1);for(;D>=u;)D/=2,R/=2,L>>>=1;return(D+L)/R};return E.int32=function(){return N.g(4)|0},E.quick=function(){return N.g(4)/4294967296},E.double=E,g(v(N.S),n),(k.pass||C||function(D,R,L,B){return B&&(B.S&&m(B,N),D.state=function(){return m(N,{})}),L?(s[a]=D,R):D})(E,I,"global"in k?k.global:this==s,k.state)}function p(b){var k,C=b.length,S=this,I=0,N=S.i=S.j=0,E=S.S=[];for(C||(b=[C++]);I<r;)E[I]=I++;for(I=0;I<r;I++)E[I]=E[N=d&N+b[I%C]+(k=E[I])],E[N]=k;(S.g=function(D){for(var R,L=0,B=S.i,W=S.j,G=S.S;D--;)R=G[B=d&B+1],L=L*r+G[d&(G[B]=G[W=d&W+R])+(G[W]=R)];return S.i=B,S.j=W,L})(r)}function m(b,k){return k.i=b.i,k.j=b.j,k.S=b.S.slice(),k}function y(b,k){var C=[],S=typeof b,I;if(k&&S=="object")for(I in b)try{C.push(y(b[I],k-1))}catch{}return C.length?C:S=="string"?b:b+"\0"}function g(b,k){for(var C=b+"",S,I=0;I<C.length;)k[d&I]=d&(S^=k[d&I]*19)+C.charCodeAt(I++);return v(k)}function x(){try{var b;return h&&(b=h.randomBytes)?b=b(r):(b=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(b)),v(b)}catch{var k=e.navigator,C=k&&k.plugins;return[+new Date,e,C,e.screen,v(n)]}}function v(b){return String.fromCharCode.apply(0,b)}if(g(s.random(),n),t.exports){t.exports=f;try{h=Ite}catch{}}else s["seed"+a]=f})(typeof self<"u"?self:Zl,[],Math)})(FM);var Tte=FM.exports,Nte=yte,Ete=xte,$te=vte,_te=bte,Ate=wte,Rte=kte,ic=Tte;ic.alea=Nte;ic.xor128=Ete;ic.xorwow=$te;ic.xorshift7=_te;ic.xor4096=Ate;ic.tychei=Rte;var FS=ic;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MM{constructor(e,n,s,r,i){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=FS.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,i,o;do r=2*this.random()-1,i=2*this.random()-1,o=r*r+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*r*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class Dte{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=FS.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pte(t,e=0,n=1,s,r){if(xo(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const i=new MM(e,n,s,!1,r),o=He(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const LM=j({randomNormal_:Pte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ote(t,e=0,n=1,s="float32",r){xo(t);const i=He(t,s),o=new Dte(e,n,null,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Ep=j({randomUniform_:Ote});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jh(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return V.runKernel(eS,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fte(t){const n={input:$(t,"input","real")};return V.runKernel(tS,n)}const hy=j({real_:Fte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mte(t){const n={x:$(t,"x","reciprocal")};return V.runKernel(lp,n)}const Lte=j({reciprocal_:Mte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vte(t){const n={x:$(t,"x","relu")};return V.runKernel(cp,n)}const oc=j({relu_:Vte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bte(t){const n={x:$(t,"x","relu6")};return V.runKernel(up,n)}const VM=j({relu6_:Bte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zte(t,e){const s={x:$(t,"x","reverse")},r={dims:e};return V.runKernel(i0,s,r)}const jl=j({reverse_:zte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ute(t){const n={x:$(t,"x","round")};return V.runKernel(dp,n)}const BM=j({round_:Ute});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jte(t){const n={x:$(t,"x","rsqrt","float32")};return V.runKernel(hp,n)}const zM=j({rsqrt_:jte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wte(t){const n={x:$(t,"x","selu")};return V.runKernel(fp,n)}const UM=j({selu_:Wte});function Gte(t,e,n,s,r,i=[1,1],o="NHWC"){const a=$(t,"x","separableConv2d"),l=$(e,"depthwiseFilter","separableConv2d"),c=$(n,"pointwiseFilter","separableConv2d");let u=a,d=!1;if(a.rank===3&&(d=!0,u=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");T(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),T(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),T(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),T(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),T(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const h=l.shape[2],f=l.shape[3];T(c.shape[2]===h*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*f}, but got ${c.shape[2]}.`);const p=vS(u,l,s,r,o,i),y=zl(p,c,1,"valid",o);return d?U(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const jM=j({separableConv2d_:Gte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hte(t){const n={x:$(t,"x","sign")};return V.runKernel(gp,n)}const qte=j({sign_:Hte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kte(t){const n={x:$(t,"x","sin","float32")};return V.runKernel(pp,n)}const WM=j({sin_:Kte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xte(t){const n={x:$(t,"x","sinh")};return V.runKernel(mp,n)}const GM=j({sinh_:Xte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yte(t,e,n){const s=$(t,"x","slice1d");return T(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),bt(s,[e],[n])}const MS=j({slice1d_:Yte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zte(t,e,n){const s=$(t,"x","slice2d");return T(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),bt(s,e,n)}const HM=j({slice2d_:Zte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jte(t,e,n){const s=$(t,"x","slice3d");return T(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),bt(s,e,n)}const LS=j({slice3d_:Jte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qte(t,e,n){const s=$(t,"x","slice4d");return T(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),bt(s,e,n)}const fy=j({slice4d_:Qte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ene(t,e=-1){const n=$(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return V.runKernel(d0,s,r)}const VS=j({softmax_:ene});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tne(t){T(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return V.runKernel(jC,e)}const qM=j({fft_:tne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nne(t){T(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return V.runKernel(HC,e)}const a1=j({ifft_:nne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sne(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=U(t,[n,e]);s=a1(r)}else{const r=[n,2*(e-1)],i=U(hy(t),[n,e]),o=U(kS(t),[n,e]),a=jl(bt(i,[0,1],[n,e-2]),1),l=F(jl(bt(o,[0,1],[n,e-2]),1),ot(-1)),c=hs([i,a],1),u=hs([o,l],1),d=U(ku(c,u),[r[0],r[1]]);s=a1(d)}if(s=hy(s),t.rank===3&&t.shape[0]!==0){const r=s,i=t.shape[0];s=U(s,[i,s.shape[0]/i,s.shape[1]]),r.dispose()}return s}const rne=j({irfft_:sne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ine(t,e,n=0){const r={x:$(t,"x","split")},i={numOrSizeSplits:e,axis:n};return V.runKernel(u0,r,i)}const js=j({split_:ine});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function one(t,e){T(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const p=t.shape.map(y=>0),m=t.shape.map(y=>y);m[t.shape.length-1]=e,r=bt(t,p,m),n=e}else if(e!=null&&e>n){const p=t.shape.map(m=>m);p[t.shape.length-1]=e-n,r=hs([t,vn(p)],t.shape.length-1),n=e}else r=t;const i=Qe(r),o=U(ku(r,i),[s,n]),a=qM(o),l=Math.floor(n/2)+1,c=hy(a),u=kS(a),d=js(c,[l,n-l],c.shape.length-1),h=js(u,[l,n-l],u.shape.length-1),f=r.shape.slice();return f[r.shape.length-1]=l,U(ku(d[0],h[0]),f)}const ane=j({rfft_:one});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lne(t,e){let n=$(t,"a","squaredDifference"),s=$(e,"b","squaredDifference");[n,s]=Xt(n,s),Le(n.shape,s.shape);const r={a:n,b:s},i={};return V.runKernel(bp,r,i)}const cne=j({squaredDifference_:lne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function une(t,e){const n=$(t,"x","squeeze","string_or_numeric");return U(n,Ra(n.shape,e).newShape)}const $p=j({squeeze_:une});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dne(t,e=0){const n=uM(t,"tensors","stack","string_or_numeric");T(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&T(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return V.runKernel(Jx,s,r)}const ho=j({stack_:dne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hne(t,e=0){const s={x:$(t,"x","step")},r={alpha:e};return V.runKernel(Ip,s,r)}const _p=j({step_:hne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fne(t,e,n,s,r=0,i=0,o=0,a=0,l=0){const u={x:$(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:s,beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return V.runKernel(oS,u,d)}const pne=j({stridedSlice_:fne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mne(t){const n={x:$(t,"x","tan","float32")};return V.runKernel(kp,n)}const gne=j({tan_:mne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Is(t,e){gF(t);const n=g0(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return y0(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sg(t,e,n){if(gF(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=g0(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return y0(t,e,s,n)}function KM(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(i+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(i+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(i+` update.rank != ${r+t.length-s}`);for(let o=0;o<r;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-r;++o)if(n.shape[o+r]!==t[o+s])throw new Error(i+` updates.shape[${o+r}] (${n.shape[o+r]}) != shape[${o+r}] (${t[o+r]})`)}function yne(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}KM(n,e,t)}function ac(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,i=n.length;let o=1;for(let d=r;d<i;++d)o*=n[d];const a=r<1?1:r,l=Q(e.shape)/a,c=[...Ne(n.slice(0,r)),1],u=Q(n);return{sliceRank:r,numUpdates:l,sliceSize:o,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xne(t,e=1,n=!0){const s=$(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const i={x:s},o={k:e,sorted:n},[a,l]=V.runKernel(aS,i,o);return{values:a,indices:l}}const vne=j({topk_:xne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bne(t,e=0,n=1,s,r){if(xo(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new MM(e,n,s,!0,r),o=He(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const XM=j({truncatedNormal_:bne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wne(t,e=0){const n=$(t,"x","unique","string_or_numeric");T(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[i,o]=V.runKernel(cS,s,r);return{values:i,indices:o}}const kne=j({unique_:wne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cne(t,e,n){const s=$(t,"x","unsortedSegmentSum"),r=$(e,"segmentIds","unsortedSegmentSum","int32");T(vu(n),()=>"numSegments must be of dtype int");const i={x:s,segmentIds:r},o={numSegments:n};return V.runKernel(f0,i,o)}const YM=j({unsortedSegmentSum_:Cne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sne(t,e=0){const n=$(t,"x","unstack","string_or_numeric");T(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return V.runKernel(h0,s,r)}const Wl=j({unstack_:Sne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ine(t,e=!0,n,s){return V.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZM(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const s=He(t,"int32"),r=He([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=s.indexToLoc(n[i]),a=i*t.length;r.values.set(o,a)}return r.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tne(t,e,n){const s=$(t,"x","transpose");if(e==null&&(e=s.shape.map((o,a)=>a).reverse()),T(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(o=>{T(o>=0&&o<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},i={perm:e};return s.dtype==="complex64"?H(()=>{let o=hy(s),a=kS(s);return o=V.runKernel(su,{x:o},i),a=V.runKernel(su,{x:a},i),n&&(a=Kt(a)),ku(o,a)}):V.runKernel(su,r,i)}const Je=j({transpose_:Tne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nne(t,e){if(e==null)return t.shape.slice();if(at(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ene(t,e,n,s){const r=$(t,"x","dropout");if(T(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),T(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof ln?r.clone():r;const i=Nne(r,n),o=1-e,a=_e(C0(re(Ep(i,0,1,"float32",s),o)),o);return F(r,a)}const $ne=j({dropout_:Ene});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ne(t,e,n,s,r,i="NHWC",o){let a=t;t.rank===3&&(a=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=U(e,[1,e.shape[0],e.shape[1],e.shape[2]])),T(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),T(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),T(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=i==="NHWC"?a.shape[3]:a.shape[1],u=i==="NHWC"?l.shape[3]:l.shape[1];T(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),T(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),vs("conv2dDerFilter",r,o);const d={x:a,dy:l},h={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,filterShape:n};return V.runKernel(RC,d,h)}const BS=j({conv2DBackpropFilter_:_ne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zS(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return F(t,_p(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function US(t,e){let n=e;const s=pn(t.shape,e.shape);return s.length>0&&(n=$e(n,s)),U(n,t.shape)}function jS(t,e,n,s){if(e==="linear")return t;if(e==="relu")return oc(t);if(e==="elu")return w0(t);if(e==="relu6")return VM(t);if(e==="prelu")return $S(t,n);if(e==="leakyrelu")return CS(t,s);if(e==="sigmoid")return Ku(t);throw new Error(`Unknown fused activation ${e}.`)}const WS=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ane({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",WS(V.state.gradientDepth,l)===!1){T(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let C=zl(t,e,n,s,r,i,o);return a!=null&&(C=re(C,a)),jS(C,l,c,u)}const d=$(t,"x","conv2d","float32"),h=$(e,"filter","conv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=U(d,[1,d.shape[0],d.shape[1],d.shape[2]])),T(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),T(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),vs("fused conv2d",s,o);const m=r==="NHWC"?f.shape[3]:f.shape[1];T(h.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`),T(Bn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const y=$n(f.shape,h.shape,n,i,s,o);let g;a!=null&&(g=$(a,"bias","fused conv2d"),[g]=Xt(g,d),r==="NHWC"?Le(y.outShape,g.shape):(T(g.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`),T(g.shape.length===0||g.shape[0]===y.outChannels||g.shape[0]===1,()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${y.outChannels})`)));let x;if(c!=null){const C=c.shape;if(T(C.length<=1||C.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${C.length}.`),C.length===1)T(C[0]===1||C[0]===y.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the number of output channels (${y.outChannels}).`);else if(C.length===3)try{Le(C,y.outShape)}catch{const I=`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(I)}x=$(c,"prelu weights","fused conv2d")}const v=(C,S)=>{T(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[I,N,E,D]=S,R=zS(C,E,l);T(Vl(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const L=yS(N.shape,R,I,n,s),B=BS(N,R,I.shape,n,s),W=[L,B];if(D!=null){const G=US(D,R);W.push(G)}return W},b={x:f,filter:h,bias:g,preluActivationWeights:x},k={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?Su((S,I,N)=>{let E=V.runKernel(iy,b,k);return N([I,S,E]),p&&(E=U(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:v}})(f,h):Su((S,I,N,E)=>{let D=V.runKernel(iy,b,k);return E([I,S,D,N]),p&&(D=U(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:v}})(f,h,g)}const Rne=j({fusedConv2d_:Ane});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dne(t,e,n,s,r,i=[1,1],o){let a=t;t.rank===3&&(a=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,filterShape:n};return V.runKernel(VC,c,u)}const Pne=j({depthwiseConv2dNativeBackpropFilter_:Dne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function One(t,e,n,s,r,i=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:n},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,inputShape:t},d=V.runKernel(BC,c,u);return l?U(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Fne=j({depthwiseConv2dNativeBackpropInput_:One});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mne({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(WS(V.state.gradientDepth,i)===!1){let D=it(t,e,n,s);return r!=null&&(D=re(D,r)),jS(D,i,o,a)}let l=$(t,"a","fused matMul"),c=$(e,"b","fused matMul");[l,c]=Xt(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=s?c.shape[c.rank-1]:c.shape[c.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=s?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),m=c.shape.slice(0,-2),y=Q(p),g=Q(m);T(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const v=Le(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([h,f]),b=n?U(l,[y,u,h]):U(l,[y,h,u]),k=s?U(c,[g,f,d]):U(c,[g,d,f]);let C;r!=null&&(C=$(r,"bias","fused matMul"),[C]=Xt(C,l),Le(v,C.shape));let S;o!=null&&(S=$(o,"prelu weights","fused matMul"));const I=(D,R)=>{const[L,B,W,G]=R,q=zS(U(D,W.shape),W,i);let A,z;if(!n&&!s?(A=it(q,B,!1,!0),z=it(L,q,!0,!1)):!n&&s?(A=it(q,B,!1,!1),z=it(q,L,!0,!1)):n&&!s?(A=it(B,q,!1,!0),z=it(L,q,!1,!1)):(A=it(B,q,!0,!0),z=it(q,L,!0,!0)),r!=null){const P=US(G,q);return[A,z,P]}else return[A,z]},N={a:b,b:k,bias:C,preluActivationWeights:S},E={transposeA:n,transposeB:s,activation:i,leakyreluAlpha:a};return r==null?Su((R,L,B)=>{const W=V.runKernel(ry,N,E);return B([R,L,W]),{value:U(W,v),gradFunc:I}})(b,k):Su((R,L,B,W)=>{const G=V.runKernel(ry,N,E);return W([R,L,G,B]),{value:U(G,v),gradFunc:I}})(b,k,C)}const VE=j({fusedMatMul_:Mne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lne(t,e,n,s,r="bilinear",i=0){const o=$(t,"image","cropAndResize"),a=$(e,"boxes","cropAndResize","float32"),l=$(n,"boxInd","cropAndResize","int32"),c=a.shape[0];T(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),T(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),T(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),T(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),T(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),T(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const u={image:o,boxes:a,boxInd:l},d={method:r,extrapolationValue:i,cropSize:s};return V.runKernel(FC,u,d)}const Vne=j({cropAndResize_:Lne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bne(t){const e=$(t,"image","flipLeftRight","float32");T(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return V.runKernel(GC,n,{})}const zne=j({flipLeftRight_:Bne});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Une(t){const e=$(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];T(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),T(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,Mr(e,r)}const jne=j({grayscaleToRGB_:Une});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wne(t){const e=$(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];T(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),T(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,i=xe(e,"float32"),o=Is([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Id("ij,j->i",i,o);break;case 3:a=Id("ijk,k->ij",i,o);break;case 4:a=Id("ijkl,l->ijk",i,o);break;case 5:a=Id("ijklm,m->ijkl",i,o);break;case 6:a=Id("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=cs(a,-1),xe(a,r)}const Gne=j({rgbToGrayscale_:Wne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hne(t,e,n=0,s=.5){const r=$(t,"image","rotateWithOffset","float32");T(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const i={image:r},o={radians:e,fillValue:n,center:s};return V.runKernel(uS,i,o)}const qne=j({rotateWithOffset_:Hne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yu(t,e,n,s,r,i){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),T(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),T(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),T(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),T(e.rank===1,()=>"scores must be a 1D tensor"),T(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),T(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kne(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=$(t,"boxes","nonMaxSuppression","float32"),o=$(e,"scores","nonMaxSuppression","float32"),a=Yu(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return V.runKernel(ZC,{boxes:i,scores:o},l)}const Xne=j({nonMaxSuppression_:Kne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yne(t,e,n){const s=Zne(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function Zne(t,e,n){return Qne(t,e,n||Jne)}function Jne(t,e){return t>e?1:t<e?-1:0}function Qne(t,e,n){let s=0,r=t.length,i=0,o=!1;for(;s<r;){i=s+(r-s>>>1);const a=n(e,t[i]);a>0?s=i+1:(r=i,o=!a)}return o?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GS(t,e,n,s,r){return KS(t,e,n,s,r,0)}function HS(t,e,n,s,r,i){return KS(t,e,n,s,r,0,!1,i,!0)}function qS(t,e,n,s,r,i){return KS(t,e,n,s,r,i,!0)}function KS(t,e,n,s,r,i,o=!1,a=!1,l=!1){const c=[];for(let y=0;y<e.length;y++)e[y]>r&&c.push({score:e[y],boxIndex:y,suppressBeginIndex:0});c.sort(BE);const u=i>0?-.5/i:0,d=[],h=[];for(;d.length<n&&c.length>0;){const y=c.pop(),{score:g,boxIndex:x,suppressBeginIndex:v}=y;if(g<r)break;let b=!1;for(let k=d.length-1;k>=v;--k){const C=ese(t,x,d[k]);if(C>=s){b=!0;break}if(y.score=y.score*tse(s,u,C),y.score<=r)break}y.suppressBeginIndex=d.length,b||(y.score===g?(d.push(x),h.push(y.score)):y.score>r&&Yne(c,y,BE))}const f=d.length,p=n-f;a&&p>0&&(d.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const m={selectedIndices:d};return o&&(m.selectedScores=h),l&&(m.validOutputs=f),m}function ese(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),i=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),h=Math.max(r[1],r[3]),f=(a-i)*(l-o),p=(d-c)*(h-u);if(f<=0||p<=0)return 0;const m=Math.max(i,c),y=Math.max(o,u),g=Math.min(a,d),x=Math.min(l,h),v=Math.max(g-m,0)*Math.max(x-y,0);return v/(f+p-v)}function tse(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function BE(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function nse(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=$(t,"boxes","nonMaxSuppressionAsync"),o=$(e,"scores","nonMaxSuppressionAsync"),a=Yu(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),c=l[0],u=l[1],{selectedIndices:d}=GS(c,u,n,s,r);return i!==t&&i.dispose(),o!==e&&o.dispose(),Is(d,"int32")}const sse=nse;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rse(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=$(t,"boxes","nonMaxSuppression"),a=$(e,"scores","nonMaxSuppression"),l=Yu(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:o,scores:a},u={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i},d=V.runKernel(QC,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}const ise=j({nonMaxSuppressionWithScore_:rse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function ose(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=$(t,"boxes","nonMaxSuppressionAsync"),a=$(e,"scores","nonMaxSuppressionAsync"),l=Yu(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([o.data(),a.data()]),u=c[0],d=c[1],{selectedIndices:h,selectedScores:f}=qS(u,d,n,s,r,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:Is(h,"int32"),selectedScores:Is(f)}}const ase=ose;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lse(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=$(t,"boxes","nonMaxSuppression"),a=$(e,"scores","nonMaxSuppression"),l=Yu(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h={boxes:o,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:i},p=V.runKernel(JC,h,f);return{selectedIndices:p[0],validOutputs:p[1]}}const cse=j({nonMaxSuppressionPadded_:lse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function use(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=$(t,"boxes","nonMaxSuppressionAsync"),a=$(e,"scores","nonMaxSuppressionAsync"),l=Yu(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[h,f]=await Promise.all([o.data(),a.data()]),{selectedIndices:p,validOutputs:m}=HS(h,f,c,u,d,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:Is(p,"int32"),validOutputs:ot(m,"int32")}}const dse=use;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hse(t,e,n=!1,s=!1){const r=$(t,"images","resizeBilinear");T(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),T(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),T(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=U(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=V.runKernel(r0,a,l);return o?U(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const JM=j({resizeBilinear_:hse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fse(t,e,n=!1,s=!1){const r=$(t,"images","resizeNearestNeighbor");T(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),T(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),T(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),T(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=U(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=V.runKernel(s0,a,l);return o?U(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const QM=j({resizeNearestNeighbor_:fse});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pse(t,e="binary",n=!1,s=.5){const r=$(t,"image","threshold"),i=.2989,o=.587,a=.114,l=r.shape[0]*r.shape[1];let c=F(Is([s]),255),u,d,h,f;if(T(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),T(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),T(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),T(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[u,d,h]=js(r,[1,1,1],-1);const y=F(u,i),g=F(d,o),x=F(h,a);f=re(re(y,g),x)}else f=t;if(e==="otsu"){const y=pQ(xe(BM(f),"int32"),dM([]),256);c=mse(y,l)}const p=n?Xu(f,c):Ys(f,c);return xe(F(p,255),"int32")}function mse(t,e){let n=Is([-1]),s=Is([0]),r=Is([0]),i,o,a,l,c,u;for(let d=0;d<t.size-1;d++){i=bt(t,0,d+1),o=bt(t,d+1),c=_e($e(i),e),u=_e($e(o),e);const h=$e(F(i,Jh(0,i.size)));a=_e(h,$e(i));const f=b0(o.shape,i.size),p=re(Jh(0,o.size),f),m=F(o,p);l=_e($e(m),$e(o));const y=Ae(a,l),g=Ae(a,l),x=F(c,u);r=F(F(x,y),g);const v=Ys(r,s);s=es(v,r,s),n=es(v,Is([d]),n)}return n}const gse=j({threshold_:pse});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yse(t,e,n="nearest",s="constant",r=0,i){const o=$(t,"image","transform","float32"),a=$(e,"transforms","transform","float32");T(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),T(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),T(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},c={interpolation:n,fillMode:s,fillValue:r,outputShape:i};return V.runKernel(lS,l,c)}const xse=j({transform_:yse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vse(t,e,n){const s=$(t,"a","bandPart");T(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[i,o]=s.shape.slice(-2);let a,l;typeof e=="number"?(T(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),T(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=$(e<0?i:e,"numLower","bandPart")):(T(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=es(uy(e,0),i,Zh(e,i))),typeof n=="number"?(T(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),T(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),l=$(n<0?o:n,"numUpper","bandPart")):(T(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=es(uy(n,0),o,Zh(n,o)));const c=U(Jh(0,i,1,"int32"),[-1,1]),u=Jh(0,o,1,"int32"),d=Ae(c,u),h=uo(Xu(d,a),rc(d,Kt(l))),f=vn([i,o],s.dtype);return U(ho(Wl(U(s,[-1,i,o])).map(p=>es(h,p,f))),r)}const bse=j({bandPart_:vse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wse(t){let e;if(Array.isArray(t)){e=!1,T(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let i=1;i<t.length;++i)T(t[i].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${r})`)}else e=!0,t=js(t,t.shape[0],0).map(r=>$p(r,[0]));T(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(V.tidy(()=>{let i=s[r];if(r>0)for(let o=0;o<r;++o){const a=F($e(F(n[o],i)),n[o]);i=Ae(i,a)}return _e(i,k0(i,"euclidean"))}));return e?ho(n,0):n}const kse=j({gramSchmidt_:wse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cse(t,e=!1){if(T(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return zE(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),s=Wl(U(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],i=[];s.forEach(l=>{const[c,u]=zE(l,e);r.push(c),i.push(u)});const o=U(ho(r,0),t.shape),a=U(ho(i,0),t.shape);return[o,a]}}function zE(t,e=!1){return V.tidy(()=>{T(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=_M(n),i=yl(t);const o=sg([[1]],[1,1]);let a=yl(o);const l=n>=s?s:n;for(let c=0;c<l;++c){const u=i,d=a,h=r;[a,i,r]=V.tidy(()=>{const f=bt(i,[c,c],[n-c,1]),p=k0(f),m=bt(i,[c,c],[1,1]),y=es(Ys(m,0),sg([[-1]]),sg([[1]])),g=Ae(m,F(y,p)),x=_e(f,g);x.shape[0]===1?a=yl(o):a=hs([o,bt(x,[1,0],[x.shape[0]-1,x.shape[1]])],0);const v=Kt(_e(it(y,g),p)),b=bt(i,[c,0],[n-c,s]),k=F(v,a),C=Je(a);if(c===0)i=Ae(b,it(k,it(C,b)));else{const N=Ae(b,it(k,it(C,b)));i=hs([bt(i,[0,0],[c,s]),N],0)}const S=Je(k),I=bt(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=Ae(I,it(it(I,a),S));else{const N=Ae(I,it(it(I,a),S));r=hs([bt(r,[0,0],[n,c]),N],1)}return[a,i,r]}),We([u,d,h])}return!e&&n>s&&(r=bt(r,[0,0],[n,s]),i=bt(i,[0,0],[s,s])),[r,i]})}const Sse=j({qr_:Cse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xi={flipLeftRight:zne,grayscaleToRGB:jne,resizeNearestNeighbor:QM,resizeBilinear:JM,rgbToGrayscale:Gne,rotateWithOffset:qne,cropAndResize:Vne,nonMaxSuppression:Xne,nonMaxSuppressionAsync:sse,nonMaxSuppressionWithScore:ise,nonMaxSuppressionWithScoreAsync:ase,nonMaxSuppressionPadded:cse,nonMaxSuppressionPaddedAsync:dse,threshold:gse,transform:xse},Ise={bandPart:bse,gramSchmidt:kse,qr:Sse};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tse=new Map,Nse=new Map;class Zu{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class lr{constructor(){this.classNameMap={}}static getMap(){return lr.instance==null&&(lr.instance=new lr),lr.instance}static register(e){lr.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function ne(t,e,n){T(t.className!=null,()=>"Class being registered does not have the static className property defined."),T(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),T(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,r=e+">"+s;return lr.register(t),Tse.set(r,t),Nse.set(t,r),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class La extends Zu{minimize(e,n=!1,s){const{value:r,grads:i}=this.computeGradients(e,s);if(s!=null){const o=s.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return We(i),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return Oee(e,n)}dispose(){this.iterations_!=null&&We(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:ot(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(La,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eL extends La{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=V.registeredVariables[s],o=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:H(()=>Qe(i).variable(o))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:H(()=>Qe(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;H(()=>{const u=re(F(l,this.rho),F(Tt(a),1-this.rho)),d=F(_e(Vn(re(c,this.epsilon)),Vn(re(l,this.epsilon))),a),h=re(F(c,this.rho),F(Tt(d),1-this.rho));l.assign(u),c.assign(h);const f=re(F(d,-this.learningRate),i);i.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(We(this.accumulatedGrads.map(e=>e.variable)),We(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tL extends La{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=V.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:H(()=>b0(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const a=this.accumulatedGrads[r].variable;H(()=>{const l=re(a,Tt(o));a.assign(l);const c=re(F(_e(o,Vn(re(l,V.backend.epsilon()))),-this.learningRate),i);i.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&We(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nL extends La{static get className(){return"Adam"}constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],H(()=>{this.accBeta1=ot(n).variable(),this.accBeta2=ot(s).variable()}),r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);H(()=>{const s=Ae(1,this.accBeta1),r=Ae(1,this.accBeta2);n.forEach((i,o)=>{const a=V.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:H(()=>Qe(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:H(()=>Qe(a).variable(l))});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,h=re(F(u,this.beta1),F(c,1-this.beta1)),f=re(F(d,this.beta2),F(Tt(c),1-this.beta2)),p=_e(h,s),m=_e(f,r);u.assign(h),d.assign(f);const y=re(F(_e(p,re(Vn(m),this.epsilon)),-this.learningRate),a);a.assign(y)}),this.accBeta1.assign(F(this.accBeta1,this.beta1)),this.accBeta2.assign(F(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&We(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&We(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),H(()=>{this.accBeta1.assign(Ul(this.beta1,this.iterations_+1)),this.accBeta2.assign(Ul(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sL extends La{static get className(){return"Adamax"}constructor(e,n,s,r=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],H(()=>{this.iteration=ot(0).variable(),this.accBeta1=ot(n).variable()}),r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);H(()=>{const s=Ae(1,this.accBeta1),r=_e(-this.learningRate,re(F(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=V.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:Qe(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:Qe(a).variable(l)});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,h=re(F(u,this.beta1),F(c,1-this.beta1)),f=F(d,this.beta2),p=Kn(c),m=Fa(f,p);u.assign(h),d.assign(m);const y=re(F(_e(r,s),_e(h,re(m,this.epsilon))),a);a.assign(y)}),this.iteration.assign(re(this.iteration,1)),this.accBeta1.assign(F(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&We(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&We(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XS extends La{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const o=V.registeredVariables[s];H(()=>{const a=re(F(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=vi(ot(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rL extends XS{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=ot(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=V.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:H(()=>Qe(i).variable(!1))});const o=this.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[s];a!=null&&H(()=>{let l;const c=re(F(this.m,o),a);this.useNesterov?l=re(F(this.c,re(a,F(c,this.m))),i):l=re(F(this.c,c),i),o.assign(c),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&We(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iL extends La{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,r==null&&(this.epsilon=V.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=V.registeredVariables[s],o=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:H(()=>Qe(i).variable(o))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:H(()=>Qe(i).variable(o))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:H(()=>Qe(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;H(()=>{const u=re(F(l,this.decay),F(Tt(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[r].variable,h=re(F(d,this.decay),F(a,1-this.decay)),f=_e(F(a,this.learningRate),Vn(Ae(u,re(Tt(h),this.epsilon)))),p=re(F(c,this.momentum),f);l.assign(u),d.assign(h),c.assign(p);const m=Ae(i,p);i.assign(m)}else{const d=re(F(l,this.decay),F(Tt(a),1-this.decay)),h=re(F(c,this.momentum),_e(F(a,this.learningRate),Vn(re(d,this.epsilon))));l.assign(d),c.assign(h);const f=Ae(i,h);i.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&We(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&We(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&We(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ese=[eL,tL,nL,sL,rL,iL,XS];function $se(){for(const t of Ese)ne(t)}function YS(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(Q(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,i=r[r.length-1];let o=1;for(let d=0;d<r.length-1;++d)o*=r[d];const a=t.shape,l=r.slice();l.pop();let c=1;for(let d=i;d<n;++d)c*=a[d],l.push(a[d]);const u=[...Ne(t.shape).map(d=>d/c),1].slice(0,i);return[l,o,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l1=-2,_se=-1;function ZS(t,e,n){const s=t.shape.length;T(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),T(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)T(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function Ase(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function JS(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function oL(t,e,n,s){const r=[...t];for(let i=r.length;i<s.length;i++)r.push(1);for(let i=0;i<n;i++)i===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function aL(t,e,n){return n<=t?n:n-(e-1)}function lL(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function Rse(t,e,n,s,r,i,o,a,l){const c=t.length;let u=new Array(c),d=new Array(c),h=new Array(c);if(e.length&&n>0){const f=e[0],p=n+1;u=cL(o,f,p,s,t),d=uL(a,f,p,r,t),h=oL(i,f,p,t)}else for(let f=0;f<c;f++)u[f]=hL(o,s,i,t,f,l),d[f]=fL(a,r,i,t,f,l),h[f]=dL(i,f,l);return{begin:u,end:d,strides:h}}function cL(t,e,n,s,r){const i=[...r],o=lL(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=aL(e,n,a);let c=s[l];t&1<<l&&(c=0),i[a]=c}return i}function uL(t,e,n,s,r){const i=[...r],o=lL(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=aL(e,n,a);let c=s[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[a]=c}for(let a=0;a<i.length;a++){const l=r[a];i[a]<0&&(i[a]+=l),i[a]=Ol(0,i[a],r[a])}return i}function dL(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function hL(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),o=Ol(0,o,l-1),o}function fL(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),a>0?o=Ol(0,o,l):o=Ol(-1,o,l-1),o}function QS(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function eI(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function S0(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(o=>{T(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(r).fill(-1):typeof n=="number"?i=[n,...new Array(r-1).fill(-1)]:n.length<r?i=n.concat(new Array(r-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(T(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),t.shape[a]-s[a])),[s,i]}function tI(t,e,n,s,r,i,o,a,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let v=0;v<d.dims;v++)u&&1<<v&a&&d.numAddAxisAfterEllipsis++,1<<v&o&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};Dse(d,h);let f=!0,p=!0,m=!0;const y=[],g=[];for(let v=0;v<t.length;++v){if(h.strides[v]===0)throw Error(`strides[${v}] must be non-zero`);const b=!!(h.shrinkAxisMask&1<<v),k=t[v];if(k===-1){y.push(b?1:-1);continue}const C=[h.beginMask&1<<v,h.endMask&1<<v],S=[h.strides[v]>0?0:-1,h.strides[v]>0?k:k-1];if(b&&h.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&h.strides[v]===1;const I=!!(h.beginMask&1<<v&&h.endMask&1<<v);if(h.beginValid&&h.endValid){if(b){const R=h.begin[v]<0?k+h.begin[v]:h.begin[v];if(h.begin[v]=R,h.end[v]=h.begin[v]+1,R<0||R>=k)throw Error(`slice index ${h.begin[v]} of dimension ${v} out of bounds.`)}else h.begin[v]=UE(h.begin[v],0,h.strides[v],k,C,S),h.end[v]=UE(h.end[v],1,h.strides[v],k,C,S);const D=h.strides[v]===1&&h.begin[v]===0&&h.end[v]===k;f=f&&D,p=p&&(v===0&&h.strides[v]===1||D)}else f=f&&h.strides[v]===1&&I,p=p&&(v===0&&h.strides[v]===1||I);let N,E=!1;if(h.beginValid&&h.endValid?(N=h.end[v]-h.begin[v],E=!0):b?(N=1,E=!0):I&&k>=0&&(h.strides[v]<0?N=-k:N=k,E=!0),E){let D;N===0||N<0!=h.strides[v]<0?D=0:D=Math.trunc(N/h.strides[v])+(N%h.strides[v]!==0?1:0),y.push(D)}else y.push(-1)}for(let v=0;v<h.finalShapeGatherIndices.length;++v){const b=h.finalShapeGatherIndices[v];b>=0?g.push(y[b]):b===l1&&g.push(1)}return{finalShapeSparse:g.filter((v,b)=>h.finalShapeGatherIndices[b]!==l1),finalShape:g,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function Dse(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(l1),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(_se),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function UE(t,e,n,s,r,i){if(r[e])return n>0?i[e]:i[e+1&1];{const o=t<0?s+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const Pse=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:ZS,computeFlatOffset:eI,computeOutShape:JS,getNormalizedAxes:Rse,isSliceContinous:QS,maskToAxes:Ase,parseSliceParams:S0,sliceInfo:tI,startForAxis:hL,startIndicesWithElidedDims:cL,stopForAxis:fL,stopIndicesWithElidedDims:uL,stridesForAxis:dL,stridesWithElidedDims:oL},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ose{static sgd(e){return new XS(e)}static momentum(e,n,s=!1){return new rL(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,i=!1){return new iL(e,n,s,r,i)}static adam(e=.001,n=.9,s=.999,r=null){return new nL(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new eL(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,i=0){return new sL(e,n,s,r,i)}static adagrad(e,n=.1){return new tL(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ya=Ose;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fse=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function pL(){return new Promise(t=>Fse(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nI(t,e){const n=t[0].length;t.forEach((r,i)=>{T(r.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),T(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,i)=>{for(let o=0;o<n;o++)T(o===e||r[o]===s[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${i}.`)})}function bi(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Rr;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Rr||(Rr={}));function mL(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const i=n[r],o=s[s.length-n.length+r],a=s[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${i} but shape[${r+t}] = ${a}`)}else s[o]=i}return s}function gL(t){const e={FIRST_DIM_SIZE:Rr.FIRST_DIM_SIZE,VALUE_ROWIDS:Rr.VALUE_ROWIDS,ROW_LENGTHS:Rr.ROW_LENGTHS,ROW_SPLITS:Rr.ROW_SPLITS,ROW_LIMITS:Rr.ROW_LIMITS,ROW_STARTS:Rr.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function yL(t){return t.length===0?0:t[0]===Rr.FIRST_DIM_SIZE?t.length-1:t.length}function xL(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const i=t[r],o=e[r+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${i} but ragged tensor input.flatValues.shape[${r-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sI=30;function I0(t){return t<=sI?t:Gw(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rI(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ap(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)r=r.concat([t[o+1]/e[o],e[o]]);r=r.concat(t.slice(i+1))}return r}function Rp(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):r.push(o);s.push(...r),s.push(0),s.push(...i)}return s}function Dp(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?s?r.push(e[i-1]*t[i]):r.push(t[i]/e[i-1]):r.push(t[i]);return r}function iI(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function oI(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T0=1.7580993408473768,N0=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aI=.3275911,lI=.254829592,cI=-.284496736,uI=1.421413741,dI=-1.453152027,hI=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fo(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function vL(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function bL(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function wL(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function fI(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function kL(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function CL(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const i=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(i),s[r]=Math.sin(i)}return{real:n,imag:s}}function SL(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),i=Math.sin(s);return{real:r,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eb="->",Mse=/->/g,jE=",",WE="...";function pI(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(Mse,"").length)/eb.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${eb}").`);const[s,r]=t.split(eb);T(s.indexOf(WE)===-1,()=>`The ellipsis notation ("${WE}") is not supported yet.`);const i=s.split(jE),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<r.length;++h){const f=r[h];if(!i.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let h=0;h<s.length;++h){const f=s[h];a.indexOf(f)===-1&&f!==jE&&a.push(f)}const l=new Array(i.length);for(let h=0;h<o;++h){if(new Set(i[h].split("")).size!==i[h].length)throw new Error(`Found duplicate axes in input component ${i[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let f=0;f<i[h].length;++f)l[h].push(a.indexOf(i[h][f]))}const c=a.length,u=r.length,d=[];for(let h=u;h<c;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function mI(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function gI(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const i=n[r].shape;for(let o=0;o<e[r].length;++o)s[e[r][o]]===void 0?s[e[r][o]]=i[o]:T(s[e[r][o]]===i[o],()=>`Expected dimension ${s[e[r][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function yI(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let o=0;o<r;++o)s.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],l=Lse(e,a);for(const c of l)i.indexOf(c)===-1&&(s[o].push(c),i.push(c))}return{path:n,steps:s}}function xI(t){return t.every((e,n)=>e===n)}function Lse(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function vI(t,e,n=0){let s=[];if(typeof e=="number")T(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);T(r<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[i]=t.shape[n]-o}T(t.shape[n]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IL(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function TL(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function NL(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EL(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function $L(t,e){return`size ${t} must be non-negative, not ${e}`}function _L(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function AL(t,e){const n=Q(t),s=Q(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function RL(t,e){const n=Q(t),s=Q(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c1(){return"segment ids must be >= 0"}function DL(){return"segment ids are not increasing"}function PL(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function OL(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FL(t,e){let n=!1,s;for(t<=sI?(s=t,n=!0):s=Gw(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=Gw(t,s+1);return s}function ML(t,e,n){const s=[],r=t.length;for(let i=0;i<r;i++)i!==e?s.push(t[i]):s.push(n);return s}function bI(t,e,n,s){const r=e.shape.length,i=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>i)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${i}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let d=0;d<s;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],a=[];let l=1,c=1,u=1;for(let d=0;d<s;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=s;d<n;d++)a.push(t.shape[d]),c*=t.shape[d];for(let d=s;d<r;d++)a.push(e.shape[d]);for(let d=n+1;d<i;d++)a.push(t.shape[d]),u*=t.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:o,outputShape:a}}const Vse=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:bI,computeOutShape:ML,segOpComputeOptimalWindowSize:FL},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function po(t){try{return t.map(e=>ya(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function LL(t){return t.map(e=>la(e))}const Bse=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:lI,ERF_A2:cI,ERF_A3:uI,ERF_A4:dI,ERF_A5:hI,ERF_P:aI,PARALLELIZE_THRESHOLD:sI,get RowPartitionType(){return Rr},SELU_SCALE:N0,SELU_SCALEALPHA:T0,applyActivation:jS,assertAndGetBroadcastShape:Le,assertAxesAreInnerMostDims:_n,assertParamsConsistent:nI,assignToTypedArray:kL,axesAreInnerMostDims:bS,calculateShapes:ac,checkEinsumDimSizes:gI,checkPadOnDimRoundingMode:vs,combineLocations:EM,combineRaggedTensorToTensorShapes:mL,complexWithEvenIndex:bL,complexWithOddIndex:wL,computeConv2DInfo:$n,computeConv3DInfo:Pa,computeDefaultPad:pS,computeDilation2DInfo:Tp,computeOptimalWindowSize:I0,computeOutAndReduceShapes:kn,computeOutShape:bi,computePool2DInfo:br,computePool3DInfo:vo,convertConv2DDataFormat:bo,decodeEinsumEquation:pI,eitherStridesOrDilationsAreOne:Bn,expandShapeToKeepDim:on,exponent:SL,exponents:CL,fromStringArrayToUint8:LL,fromUint8ToStringArray:po,getAxesPermutation:Lt,getBroadcastDims:Cu,getComplexWithIndex:fI,getEinsumComputePath:yI,getEinsumPermutation:mI,getFusedBiasGradient:US,getFusedDyActivation:zS,getImageCenter:rI,getInnerMostAxes:Zt,getPermuted:Rp,getRaggedRank:yL,getReductionAxes:pn,getReshaped:Ap,getReshapedPermuted:Dp,getRowPartitionTypesHelper:gL,getSliceBeginCoords:iI,getSliceSize:oI,getSparseFillEmptyRowsIndicesDenseShapeMismatch:IL,getSparseFillEmptyRowsNegativeIndexErrorMessage:TL,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:NL,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:_L,getSparseReshapeInputOutputMismatchErrorMessage:RL,getSparseReshapeInputOutputMultipleErrorMessage:AL,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:EL,getSparseReshapeNegativeOutputDimErrorMessage:$L,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:OL,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:c1,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:DL,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:PL,getUndoAxesPermutation:Oa,isIdentityPermutation:xI,log:CZ,mergeRealAndImagArrays:fo,prepareAndValidate:YS,prepareSplitSize:vI,segment_util:Vse,shouldFuse:WS,slice_util:Pse,splitRealAndImagArrays:vL,stridesOrDilationsArePositive:Bl,tupleValuesAreOne:Vl,upcastType:Rs,validateDefaultValueShape:xL,validateInput:yne,validateUpdateShape:KM,warn:Ms},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */$se();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VL={kernelName:mx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>F(t,_p(xe(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zse={kernelName:Af,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Tt(xe(n,"float32")),r=Vn(Ae(ot(1),s));return Kt(_e(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Use={kernelName:Rf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Vn(Ae(Tt(xe(n,"float32")),1));return _e(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jse={kernelName:Hu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Le(n.shape,s.shape);return{a:()=>{let a=t;const l=pn(n.shape,r);return l.length>0&&(a=$e(a,l)),U(a,n.shape)},b:()=>{let a=t;const l=pn(s.shape,r);return l.length>0&&(a=$e(a,l)),U(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wse={kernelName:SC,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gse={kernelName:gx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Qe(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hse={kernelName:yx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Qe(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qse={kernelName:Df,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,Vn(Ae(ot(1),Tt(xe(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kse={kernelName:Pf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Vn(re(ot(1),Tt(xe(n,"float32"))));return _e(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xse={kernelName:Mf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Le(n.shape,s.shape);return{a:()=>{const a=re(Tt(n),Tt(s));let l=F(t,_e(s,a));const c=pn(n.shape,r);return c.length>0&&(l=$e(l,c)),U(l,n.shape)},b:()=>{const a=re(Tt(n),Tt(s));let l=Kt(F(t,_e(n,a)));const c=pn(s.shape,r);return c.length>0&&(l=$e(l,c)),U(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yse={kernelName:Of,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,re(Tt(xe(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zse={kernelName:Ff,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,Ae(ot(1),Tt(xe(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jse(t,e,n,s,r,i){const o=$(t,"dy","avgPool3dGrad"),a=$(e,"input","avgPool3dGrad");let l=o,c=a,u=!1;a.rank===4&&(u=!0,l=U(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=U(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),T(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),T(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),vs("avgPool3dGrad",r,i);const d={dy:l,input:c},h={filterSize:n,strides:s,pad:r,dimRoundingMode:i},f=V.runKernel(EC,d,h);return u?U(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const Qse=j({avgPool3dGrad_:Jse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ere={kernelName:vx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:a}=n;return{x:()=>Qse(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tre(t,e,n,s,r){const i=$(t,"dy","avgPoolGrad"),o=$(e,"input","avgPoolGrad");T(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,c=!1;o.rank===3&&(c=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=U(i,[1,i.shape[0],i.shape[1],i.shape[2]])),T(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),T(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},d={filterSize:n,strides:s,pad:r},h=V.runKernel(NC,u,d);return c?U(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const nre=j({avgPoolGrad_:tre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sre={kernelName:xx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o}=n;return{x:()=>nre(t,s,r,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rre={kernelName:bx,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:i,transposeB:o}=n;return!i&&!o?{a:()=>it(t,r,!1,!0),b:()=>it(s,t,!0,!1)}:!i&&o?{a:()=>it(t,r,!1,!1),b:()=>it(t,s,!0,!1)}:i&&!o?{a:()=>it(r,t,!1,!0),b:()=>it(s,t,!1,!1)}:{a:()=>it(r,t,!0,!0),b:()=>it(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ire={kernelName:wx,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>ES(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ore={kernelName:vZ,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,i=s.shape,o=Array.from(i);for(let l=r.length-1;l>=0;l--)if(r[l]===i[l])o[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>$e(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const are={kernelName:Lf,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lre={kernelName:Vf,gradFunc:t=>({x:()=>Qe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cre={kernelName:Bf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:i}=n;return{x:()=>es(uo(rc(s,r),Xu(s,i)),t,Qe(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ure={kernelName:kx,inputsToSave:["x"],gradFunc:VL.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dre={kernelName:Cx,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:r}=n,i=qe(r,e[0].shape)[0],o=s.map(l=>l[i]);return js(t,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hre={kernelName:Sx,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:i,strides:o,pad:a,dataFormat:l}=n;return T(Vl(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>yS(s.shape,t,r,o,a,l),filter:()=>BS(s,t,r.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fre={kernelName:Ix,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>zl(t,r,i,o,a,1,l),filter:()=>BS(t,s,r.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pre(t,e,n,s,r){let i=t;t.rank===4&&(i=U(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;o.rank===4&&(o=U(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),T(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),T(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),T(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),T(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),T(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:o},l={strides:s,pad:r,filterShape:n};return V.runKernel(DC,a,l)}const mre=j({conv3DBackpropFilter_:pre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gre={kernelName:Tx,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i}=n;T(Vl(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[o,a]=e;return{x:()=>SM(o.shape,t,a,r,i),filter:()=>mre(o,t,a.shape,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yre={kernelName:zf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>F(Kt(WM(xe(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xre={kernelName:Uf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>F(GM(xe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vre={kernelName:Nx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:i,reverse:o}=n;return{x:()=>{const a=Lt([r],s.rank);let l=TM(t,r,i,!o);return a!=null&&(l=Je(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bre={kernelName:Ex,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i,dimRoundingMode:o}=n,a=s??[1,1];T(Vl(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return T(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),T(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),T(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),T(Bn(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),vs("depthwiseConv2d",i,o),{x:()=>Fne(l.shape,t,c,r,i,a,o),filter:()=>Pne(l,t,c.shape,r,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wre={kernelName:$x,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,i={x:s,filter:r,dy:t},o={x:s,filter:r,dy:t};return{x:()=>V.runKernel(Hw,i,n),filter:()=>V.runKernel(qw,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kre={kernelName:Wf,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>V.runKernel(UC,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cre={kernelName:Gf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=F($i(Kt(Tt(n))),2/Math.sqrt(Math.PI));return{x:()=>F(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sre={kernelName:Hf,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>F(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ire={kernelName:Ax,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>U(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tre={kernelName:qf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>F(t,$i(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nre={kernelName:Kf,gradFunc:t=>({x:()=>Qe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ere={kernelName:Xf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Le(n.shape,s.shape);return{a:()=>{const a=_e(t,xe(s,"float32")),l=pn(n.shape,r);return l.length>0?U($e(a,l),n.shape):a},b:()=>{let a=F(t,xe(n,"float32"));const l=pn(s.shape,r);l.length>0&&(a=U($e(a,l),s.shape));const c=Tt(s);return Kt(_e(a,xe(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $re={kernelName:Rx,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,i,o,a]=e,l=a??ot(1),c=pn(i.shape,r.shape),u=[];if(i.rank===1){for(let b=0;b<r.shape.length-1;++b)u.push(r.shape[b]);u.push(1)}const d=Ae(r,i),h=F(t,l),f=zM(re(o,ot(s))),p=F(F(F(f,f),f),ot(-.5));return{x:()=>i.rank===1?U(F(F(t,Mr(U(f,[1,1,1,i.shape[0]]),u)),l),r.shape):U(F(F(t,f),l),r.shape),mean:()=>{let b=F(F(f,ot(-1)),h);return i.rank===1&&(b=$e(b,c)),U(b,i.shape)},variance:()=>{let b=F(F(p,d),h);return i.rank===1&&(b=$e(b,c)),U(b,i.shape)},scale:()=>{const b=F(d,f);let k=F(t,b);return i.rank===1&&(k=$e(k,c)),U(k,i.shape)},offset:()=>{let b=t;return i.rank===1&&(b=$e(b,c)),U(b,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _re={kernelName:Dx,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:i,batchDims:o}=n,a=qe(i,s.shape)[0],l=(c,u,d)=>()=>{const h=c.shape,f=u.size,p=h.slice(0,a),m=p.length,y=h.slice(i,h.length).slice(1),g=y.length,x=GE(0,m),v=GE(m+1,m+1+g),b=HE([p,[f],y]),k=U(d,b),C=U(u,[f]),S=HE([[m],x,v]),I=Je(k,S);let N=YM(I,C,c.shape[a]);const E=Oa(S);return N=Je(N,E),N};if(o===1){const c=s.shape[0],u=s.split(c,0);return{x:()=>ho(u.map((f,p)=>l(f,r.slice(p,1),t.slice(p,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,t),indices:()=>r}}};function GE(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function HE(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Are={kernelName:Yf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>Qe(n),b:()=>Qe(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rre={kernelName:Zf,gradFunc:t=>({x:()=>xe(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dre={kernelName:Jf,gradFunc:t=>({x:()=>Qe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pre={kernelName:Qf,gradFunc:t=>({x:()=>Qe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ore={kernelName:ep,gradFunc:t=>({x:()=>Qe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fre={kernelName:Ox,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,i=Ys(s,0);return{x:()=>es(i,t,F(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mre={kernelName:np,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,re(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lre={kernelName:tp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,xe(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vre={kernelName:wZ,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const o=$i(s);return Ae(t,F($e(t,r,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bre(t,e,n,s=5,r=1,i=1,o=.5){const a={x:t,y:e,dy:n},l={depthRadius:s,bias:r,alpha:i,beta:o};return V.runKernel(KC,a,l)}const zre=j({localResponseNormalizationBackprop_:Bre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ure={kernelName:zx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:i,bias:o,alpha:a,beta:l}=n;return{x:()=>zre(s,r,t,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BL(t,e,n,s){return e.rank<n.rank&&(e=U(e,on(e.shape,s))),t.rank<n.rank&&(t=U(t,on(t.shape,s))),{x:()=>F(t,xe(Ei(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qE={kernelName:Ux,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,i=e[0],o=e[1],a=qe(r,i.shape),l=BL(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jre={kernelName:sp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>F(t,xe(rc(n,s),"float32")),b:()=>F(t,xe(uy(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wre(t,e,n,s,r,i,o){const a=$(t,"dy","maxPool3dGrad"),l=$(e,"input","maxPool3dGrad"),c=$(n,"output","maxPool3dGrad");let u=a,d=l,h=c,f=!1;l.rank===4&&(f=!0,u=U(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=U(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=U(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),T(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),T(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),T(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),vs("maxPool3dGrad",i,o);const p={dy:u,input:d,output:h},m={filterSize:s,strides:r,pad:i,dimRoundingMode:o},y=V.runKernel(YC,p,m);return f?U(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}const Gre=j({maxPool3dGrad_:Wre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hre={kernelName:Wx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=n;return{x:()=>Gre(t,s,r,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qre(t,e,n,s,r,i,o){const a=$(t,"dy","maxPoolGrad"),l=$(e,"input","maxPoolGrad"),c=$(n,"output","maxPoolGrad");T(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),T(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),T(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),vs("maxPoolGrad",i,o);const u={dy:a,input:l,output:c},d={filterSize:s,strides:r,pad:i,dimRoundingMode:o};return V.runKernel(XC,u,d)}const Kre=j({maxPoolGrad_:qre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xre={kernelName:jx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a}=n;return{x:()=>Kre(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yre={kernelName:Gx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,i=qe(r,s.shape),a=kn(s.shape,i)[1],l=Q(a);return{x:()=>{const u=s.shape.slice();i.forEach(f=>{u[f]=1});const d=U(t,u);return _e(F(d,Ma(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zre={kernelName:Hx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[i,o]=e,a=qe(r,i.shape),l=BL(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jre={kernelName:rp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>F(t,xe(Xu(n,s),"float32")),b:()=>F(t,xe(Ys(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qre={kernelName:qx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>bt(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eie={kernelName:ip,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Le(n.shape,s.shape);return{a:()=>{const a=pn(n.shape,r);return a.length>0?U($e(t,a),n.shape):t},b:()=>{const a=F(t,Kt(C0(_e(n,s)))),l=pn(s.shape,r);return l.length>0?U($e(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tie={kernelName:op,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Le(n.shape,s.shape);return{a:()=>{const a=F(t,xe(s,"float32")),l=pn(n.shape,r);return l.length>0?U($e(a,l),n.shape):a},b:()=>{const a=F(t,xe(n,"float32")),l=pn(s.shape,r);return l.length>0?U($e(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nie={kernelName:Kx,gradFunc:t=>({x:()=>Kt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sie={kernelName:Zx,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>vn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rie={kernelName:Yx,gradFunc:t=>({x:()=>Qe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iie={kernelName:Jx,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return Wl(t,s).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KE={kernelName:Qx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>bt(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oie={kernelName:ap,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,i=n,o=s,a=Le(i.shape,o.shape);return{a:()=>{const u=xe(o,"float32");let d=F(t,F(u,Ul(i,Ae(u,ot(1)))));const h=pn(i.shape,a);return h.length>0&&(d=$e(d,h)),U(d,i.shape)},b:()=>{const u=Ys(i,0),d=es(u,_i(i),Qe(i));let h=F(t,F(r,d));const f=pn(o.shape,a);return f.length>0&&(h=$e(h,f)),U(h,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aie={kernelName:e0,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=Ys(n,0);return{x:()=>es(r,t,F(t,s)),alpha:()=>{let i=es(r,Qe(t),F(t,n));const o=pn(s.shape,t.shape);return o.length>0&&(i=$e(i,o)),U(i,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lie(t,e,n){const s=t.shape.slice();s[n]=1;const r=U(e,s),i=o1(t,n,!0,!1),o=o1(t,n,!0,!0),a=F(i,o);return F(r,a)}function cie(t,e,n){const s=t.shape.length,r=s-n.length,i=Lt(n,s);let o=t;i!=null&&(o=Je(t,i));const a=o.shape.slice(),c=a.splice(s-n.length,n.length).reduce((h,f)=>h*f,1);a.push(c);const u=o.reshape(a);let d=lie(u,e,r);if(d=d.reshape(o.shape),i!=null){const h=Oa(i);d=Je(d,h)}return d}const uie={kernelName:t0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let i=[];return r==null?i=s.shape.map((o,a)=>a):typeof r=="number"?i=[r]:i=r,{x:()=>cie(s,t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const die={kernelName:jf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Le(n.shape,s.shape);return{a:()=>{const a=_e(t,xe(s,"float32")),l=pn(n.shape,r);return l.length>0?U($e(a,l),n.shape):a},b:()=>{let a=F(t,xe(n,"float32"));const l=pn(s.shape,r);l.length>0&&(a=U($e(a,l),s.shape));const c=Tt(s);return Kt(_e(a,xe(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hie={kernelName:lp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,Kt(Tt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fie={kernelName:up,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=F(Xu(n,6),_p(n));return{x:()=>F(t,xe(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pie={kernelName:cp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>F(t,xe(_p(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mie={kernelName:n0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>U(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gie={kernelName:r0,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>V.runKernel(sS,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yie={kernelName:s0,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>V.runKernel(nS,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xie={kernelName:i0,gradFunc:(t,e,n)=>{const{dims:s}=n,r=qe(s,t.shape);return{x:()=>jl(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vie={kernelName:dp,gradFunc:t=>({x:()=>Qe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bie={kernelName:hp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Kt(_e(t,F(Ul(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wie={kernelName:o0,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>xe(Qe(n),"float32"),t:()=>F(t,xe(n,t.dtype)),e:()=>F(t,xe(SS(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kie={kernelName:fp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Ys(n,ot(0)),r=ot(T0),i=ot(N0),o=F(t,i),a=F(F(t,r),$i(xe(n,"float32")));return es(s,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cie={kernelName:yp,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>F(t,F(n,Ae(ot(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sie={kernelName:gp,gradFunc:t=>({x:()=>Qe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iie={kernelName:pp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>F(xS(xe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tie={kernelName:mp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>F(IM(xe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nie={kernelName:a0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:i}=n,o=s.shape,[a,l]=S0(s,r,i),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],o[u]-a[u]-l[u]]);return{x:()=>NS(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eie={kernelName:d0,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,i=!0,o=F(t,s);return{logits:()=>Ae(o,F($e(o,[r],i),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ie={kernelName:xp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>F(t,Ku(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XE={kernelName:c0,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>gS(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YE={kernelName:u0,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>hs(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ie={kernelName:vp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,F(Vn(xe(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aie={kernelName:rS,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>F(t,F(xe(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rie={kernelName:bp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ot(2);return{a:()=>F(t,F(r,Ae(n,s))),b:()=>F(t,F(r,Ae(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Die={kernelName:Ip,gradFunc:t=>({x:()=>Qe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pie={kernelName:wp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Le(n.shape,s.shape);return{a:()=>{let a=t;const l=pn(n.shape,r);return l.length>0&&(a=$e(a,l)),U(a,n.shape)},b:()=>{let a=t;const l=pn(s.shape,r);return l.length>0&&(a=$e(a,l)),U(Kt(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oie={kernelName:l0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:i}=n;qe(i,s.shape).forEach(c=>{r[c]=1});const a=U(t,r),l=F(a,Ma(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fie={kernelName:kp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_e(t,Tt(xS(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mie={kernelName:Cp,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>F(Ae(ot(1),Tt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lie={kernelName:Sp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let o=Qe(s);if(s.rank===1)for(let a=0;a<r[0];++a)o=re(o,bt(t,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)o=re(o,bt(t,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)o=re(o,bt(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let u=0;u<r[3];++u)o=re(o,bt(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2],u*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vie={kernelName:su,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,i=Oa(r);return{x:()=>Je(t,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bie={kernelName:h0,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>ho(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zie={kernelName:f0,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Uie(t,n)}}};function Uie(t,e){const n=Fa(e,Qe(e)),s=wS(t,n);let r=rc(e,ot(0,"int32"));const i=s.rank-r.rank;for(let a=0;a<i;++a)r=cs(r,a+1);r=uo(r,Ma(s.shape,"bool"));const o=Qe(s);return es(r,s,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jie={kernelName:p0,gradFunc:t=>({x:()=>Qe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wie=[VL,zse,Use,jse,Wse,Gse,Hse,qse,Kse,Xse,Yse,Zse,ere,sre,rre,ire,ore,are,lre,cre,ure,dre,fre,hre,gre,yre,xre,vre,bre,wre,die,kre,Cre,Sre,Ire,Tre,Ere,Nre,$re,_re,Are,Rre,Dre,Pre,Ore,Fre,Mre,Lre,Vre,Ure,qE,qE,jre,Hre,Xre,Yre,Zre,Jre,Qre,eie,tie,nie,sie,rie,iie,KE,KE,oie,aie,uie,hie,fie,pie,mie,gie,yie,xie,vie,bie,wie,kie,Cie,Sie,Iie,Tie,Nie,Eie,$ie,XE,XE,YE,YE,_ie,Rie,Aie,Die,Pie,Oie,Fie,Mie,Lie,Vie,Bie,zie,jie];for(const t of Wie)SZ(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.abs=function(){return this.throwIfDisposed(),Kn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.acos=function(){return this.throwIfDisposed(),NJ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.acosh=function(){return this.throwIfDisposed(),$J(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.add=function(t){return this.throwIfDisposed(),re(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.all=function(t,e){return this.throwIfDisposed(),wM(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.any=function(t,e){return this.throwIfDisposed(),r1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.argMax=function(t){return this.throwIfDisposed(),Kh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.argMin=function(t){return this.throwIfDisposed(),PJ(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.asScalar=function(){return this.throwIfDisposed(),T(this.size===1,()=>"The array must have only 1 element."),U(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.asType=function(t){return this.throwIfDisposed(),xe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.as1D=function(){return this.throwIfDisposed(),U(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.as2D=function(t,e){return this.throwIfDisposed(),U(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),U(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),U(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),U(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.asin=function(){return this.throwIfDisposed(),FJ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.asinh=function(){return this.throwIfDisposed(),LJ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.atan=function(){return this.throwIfDisposed(),BJ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.atan2=function(t){return this.throwIfDisposed(),UJ(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.atanh=function(){return this.throwIfDisposed(),WJ(this)};Z().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),mS(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),gS(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),v0(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.broadcastTo=function(t){return this.throwIfDisposed(),lh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.cast=function(t){return this.throwIfDisposed(),xe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.ceil=function(){return this.throwIfDisposed(),yQ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Hs(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof ln&&(t=[t]),hs([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.conv1d=function(t,e,n,s,r,i){return this.throwIfDisposed(),kM(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),CM(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.conv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),zl(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.cos=function(){return this.throwIfDisposed(),xS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.cosh=function(){return this.throwIfDisposed(),IM(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),o1(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),TM(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),UQ(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.depthwiseConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),vS(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),GQ(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.divNoNan=function(t){return this.throwIfDisposed(),YQ(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.div=function(t){return this.throwIfDisposed(),_e(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.dot=function(t){return this.throwIfDisposed(),JQ(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.elu=function(){return this.throwIfDisposed(),w0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.equal=function(t){return this.throwIfDisposed(),Ei(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.erf=function(){return this.throwIfDisposed(),NM(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),uee(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.exp=function(){return this.throwIfDisposed(),$i(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.expandDims=function(t){return this.throwIfDisposed(),cs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.expm1=function(){return this.throwIfDisposed(),pee(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.fft=function(){return this.throwIfDisposed(),qM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.flatten=function(){return this.throwIfDisposed(),U(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.floor=function(){return this.throwIfDisposed(),C0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.floorDiv=function(t){return this.throwIfDisposed(),bM(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.gather=function(t,e,n){return this.throwIfDisposed(),wS(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.greaterEqual=function(t){return this.throwIfDisposed(),rc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.greater=function(t){return this.throwIfDisposed(),Ys(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.ifft=function(){return this.throwIfDisposed(),a1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.irfft=function(){return this.throwIfDisposed(),rne(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.isFinite=function(){return this.throwIfDisposed(),Cee(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.isInf=function(){return this.throwIfDisposed(),Iee(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.isNaN=function(){return this.throwIfDisposed(),Nee(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.leakyRelu=function(t){return this.throwIfDisposed(),CS(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.lessEqual=function(t){return this.throwIfDisposed(),Xu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.less=function(t){return this.throwIfDisposed(),uy(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),Ree(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.logSigmoid=function(){return this.throwIfDisposed(),Vee(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.logSoftmax=function(t){return this.throwIfDisposed(),RM(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),DM(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.log=function(){return this.throwIfDisposed(),_i(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.log1p=function(){return this.throwIfDisposed(),AM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.logicalAnd=function(t){return this.throwIfDisposed(),uo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.logicalNot=function(){return this.throwIfDisposed(),SS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.logicalOr=function(t){return this.throwIfDisposed(),PM(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.logicalXor=function(t){return this.throwIfDisposed(),qee(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),it(this,t,e,n)};Z().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),IS(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.max=function(t,e){return this.throwIfDisposed(),Ur(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.maximum=function(t){return this.throwIfDisposed(),Fa(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.mean=function(t,e){return this.throwIfDisposed(),nn(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.min=function(t,e){return this.throwIfDisposed(),cy(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.minimum=function(t){return this.throwIfDisposed(),Zh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),tte(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.mod=function(t){return this.throwIfDisposed(),ste(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.mul=function(t){return this.throwIfDisposed(),F(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.neg=function(){return this.throwIfDisposed(),Kt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.norm=function(t,e,n){return this.throwIfDisposed(),k0(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.notEqual=function(t){return this.throwIfDisposed(),dy(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),OM(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.onesLike=function(){return this.throwIfDisposed(),vr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.pad=function(t,e){return this.throwIfDisposed(),NS(this,t,e)};Z().prototype.pool=function(t,e,n,s,r,i){return this.throwIfDisposed(),fte(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.pow=function(t){return this.throwIfDisposed(),Ul(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.prelu=function(t){return this.throwIfDisposed(),$S(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.prod=function(t,e){return this.throwIfDisposed(),gte(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.reciprocal=function(){return this.throwIfDisposed(),Lte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.relu=function(){return this.throwIfDisposed(),oc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.relu6=function(){return this.throwIfDisposed(),VM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.reshapeAs=function(t){return this.throwIfDisposed(),U(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.reshape=function(t){return this.throwIfDisposed(),U(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),JM(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),QM(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.reverse=function(t){return this.throwIfDisposed(),jl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.rfft=function(){return this.throwIfDisposed(),ane(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.round=function(){return this.throwIfDisposed(),BM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.rsqrt=function(){return this.throwIfDisposed(),zM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.selu=function(){return this.throwIfDisposed(),UM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.separableConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),jM(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.sigmoid=function(){return this.throwIfDisposed(),Ku(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.sign=function(){return this.throwIfDisposed(),qte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.sin=function(){return this.throwIfDisposed(),WM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.sinh=function(){return this.throwIfDisposed(),GM(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.slice=function(t,e){return this.throwIfDisposed(),bt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.softmax=function(t){return this.throwIfDisposed(),VS(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.softplus=function(){return this.throwIfDisposed(),Np(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),ES(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.split=function(t,e){return this.throwIfDisposed(),js(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.sqrt=function(){return this.throwIfDisposed(),Vn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.square=function(){return this.throwIfDisposed(),Tt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.squaredDifference=function(t){return this.throwIfDisposed(),cne(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.squeeze=function(t){return this.throwIfDisposed(),$p(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof ln?[this,t]:[this,...t];return ho(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.step=function(t){return this.throwIfDisposed(),_p(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.stridedSlice=function(t,e,n,s,r,i,o,a){return this.throwIfDisposed(),pne(this,t,e,n,s,r,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.sub=function(t){return this.throwIfDisposed(),Ae(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.sum=function(t,e){return this.throwIfDisposed(),$e(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.tan=function(){return this.throwIfDisposed(),gne(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.tanh=function(){return this.throwIfDisposed(),x0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.tile=function(t){return this.throwIfDisposed(),Mr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.toBool=function(){return this.throwIfDisposed(),xe(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.toFloat=function(){return this.throwIfDisposed(),xe(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.toInt=function(){return this.throwIfDisposed(),xe(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.topk=function(t,e){return this.throwIfDisposed(),vne(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.transpose=function(t){return this.throwIfDisposed(),Je(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.unique=function(t){return this.throwIfDisposed(),kne(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),YM(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.unstack=function(t){return this.throwIfDisposed(),Wl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.where=function(t,e){return this.throwIfDisposed(),es(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z().prototype.zerosLike=function(){return this.throwIfDisposed(),Qe(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ii extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ii.prototype)}}class fr extends Error{constructor(e){super(e),Object.setPrototypeOf(this,fr.prototype)}}class O extends Error{constructor(e){super(e),Object.setPrototypeOf(this,O.prototype)}}class ze extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ze.prototype)}}class wI extends Error{constructor(e){super(e),Object.setPrototypeOf(this,wI.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class zL{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Gl(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function oi(t,e){if(!t)throw new wI(e)}function ZE(t,e){let n=0;for(const s of t)s===e&&n++;return n}function us(t){return t.length===1?t[0]:t}function ut(t){return Array.isArray(t)?t:[t]}function ji(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function tl(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let er={};function kI(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function u1(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>u1(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:u1(s))}}}function Pp(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const i=t;let o;if(i in n)o=n[i];else if(i in er)o=er[i];else if(o=e[i],o==null)throw new O(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=t;if(i.className==null||i.config==null)throw new O(`${s}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in n?[a,l]=n[o]:o in er?[a,l]=er.className:o in e&&([a,l]=e[o]),a==null)throw new O(`Unknown ${s}: ${o}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(er))c[f]=er[f];for(const f of Object.keys(n))c[f]=n[f];const u=i.config;u.customObjects=c;const d=Object.assign({},er);for(const f of Object.keys(n))er[f]=n[f];u1(i.config);const h=l(a,i.config,n,r);return er=Object.assign({},d),h}else{const c=Object.assign({},er);for(const d of Object.keys(n))er[d]=n[d];const u=new a(i.config);return er=Object.assign({},c),u}}}function Gie(t,e){return t<e?-1:t>e?1:0}function km(t,e){return-1*Gie(t,e)}function ca(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function Hie(t){if(t==null)throw new O(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function lc(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new O(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function CI(t,e,n=0,s=1/0){return oi(n>=0),oi(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function wn(t,e){Array.isArray(t)?(T(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>wn(n,`element ${s+1} of ${e}`))):T(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${UL(t)}.`)}function UL(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>UL(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function qie(t,e,n){let s=n!=null?n():ls(),r;return(...o)=>{const a=n!=null?n():ls();return a-s<e||(s=a,r=t(...o)),r}}function jL(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Kie=0;function WL(){return Kie++}const Cm={};function E0(t=""){return t in Cm||(Cm[t]=0),Cm[t]+=1,t+Cm[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Xie=["channelsFirst","channelsLast"],Yie=["nearest","bilinear"],Zie=["valid","same","causal"],Jie=["max","avg"],Qie=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const yc=new Map;function Jt(t){lc(Xie,"DataFormat",t)}function eoe(t){lc(Yie,"InterpolationFormat",t)}function Zs(t){lc(Zie,"PaddingMode",t)}function GL(t){lc(Jie,"PoolMode",t)}const ch=[],JE="/";function xl(t,e){ch.push(t);try{const n=e();return ch.pop(),n}catch(n){throw ch.pop(),n}}function toe(){return ch.length===0?"":ch.join(JE)+JE}function HL(t){if(!KL(t))throw new Error("Not a valid tensor name: '"+t+"'");return toe()+t}function qL(t){if(!KL(t))throw new Error("Not a valid tensor name: '"+t+"'");yc.has(t)||yc.set(t,0);const e=yc.get(t);if(yc.set(t,yc.get(t)+1),e>0){const n=`${t}_${e}`;return yc.set(n,1),n}else return t}const noe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function KL(t){return!!t.match(noe)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function soe(t){return t===parseInt(t.toString(),10)}function ua(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function Iu(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function xa(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function Hr(t,e){if(e<t)throw new O(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let tb;function un(){return tb==null&&(tb=ZZ().epsilon()),tb}function qr(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wi(t,e){return xe(t,e)}function Op(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),U(t,n)}function roe(t,e){return H(()=>{if(t.shape.length!==2)throw new O(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=Op(t,1);return d1(n,[1,e,1])})}function ioe(t){const e=[ua(t.shape)];return U(t,e)}function ooe(t){if(t.rank<=1)throw new O(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],ua(t.shape,1)];return U(t,e)}function vl(t,e,n){return H(()=>{switch(t.rank){case 1:return MS(t,e,n);case 2:return HM(t,[e,0],[n,t.shape[1]]);case 3:return LS(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return fy(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return bt(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return bt(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new O(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function nb(t,e,n){return H(()=>{switch(t.rank){case 1:return MS(t,e,n);case 2:return HM(t,[0,e],[t.shape[0],n]);case 3:return LS(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return fy(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new O(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Sm(t,e,n,s){return H(()=>{switch(t.rank){case 1:return MS(t,e,n);case 2:switch(s){case 1:return vl(t,e,n);case 2:return nb(t,e,n);default:throw new O(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return vl(t,e,n);case 2:return LS(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return nb(t,e,n);default:throw new O(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return vl(t,e,n);case 2:return fy(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return fy(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return nb(t,e,n);default:throw new O(`The axis is not within the rank of the tensor ${s}`)}default:throw new O(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function SI(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),hs(t,e)}function QE(t,e){switch(t.rank){case 1:return bQ([t,e]);case 2:return kQ([t,e],0);case 3:return SQ([t,e],0);case 4:return TQ([t,e],0);default:throw new O(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function d1(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new O(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Mr(t,e)}function $0(t,e=0,n=1,s,r){return LM(t,e,n,s,r)}function ki(t,e,n,s){if(t.rank<2||e.rank<2)throw new ze(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(r!==i)throw new ze(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return VE({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?h1(t.rank,s,qr()):null,activation:n});{const r=t.shape.slice(),i=r.pop();t=U(t,[-1,i]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),c=[...o,a],u=Array.from({length:e.rank},(p,m)=>m===0?e.rank-2:m<=e.rank-2?m-1:m);e=U(Je(e,u),[l,-1]);const d=[...r,...c];return U(VE({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?h1(t.rank,s,qr()):null,activation:n}),d)}}function XL(t,e,n){return H(()=>(Array.isArray(e)?e=Is(e,"int32"):e=xe(e,"int32"),wS(t,e,n)))}function Fp(t){return F(t,t)}function h1(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new O(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?U(e,[1,s[0],1,1,1]):U(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?U(e,[1,1,1,1,s[0]]):U(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?U(e,[1,s[0],1,1]):U(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?U(e,[1,1,1,s[0]]):U(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?U(e,[1,s[0],1]):U(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?U(e,[1,1,s[0]]):U(e,[1].concat(s))}else if(t<3)return e;throw new O(`Unsupported input rank by biasAdd: ${e.rank}`)}function Yr(t,e,n){return H(()=>(n==null&&(n=qr()),Jt(n),re(t,h1(t.rank,e,n))))}function aoe(t,e=1){if(e!==1)throw new ze(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return w0(t)}function loe(t){return H(()=>_e(t,re(Kn(t),1)))}function YL(t,e,n,s){return H(()=>$ne(t,e,n,s))}function coe(t){return H(()=>{const e=re(.5,F(.2,t));return Hs(e,0,1)})}function Mp(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const uoe=["fanIn","fanOut","fanAvg"],doe=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hoe(t){lc(uoe,"FanMode",t)}function foe(t){lc(doe,"Distribution",t)}class wr extends Zu{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class ZL extends wr{apply(e,n){return vn(e,n)}}ZL.className="Zeros";ne(ZL);class II extends wr{apply(e,n){return Ma(e,n)}}II.className="Ones";ne(II);class JL extends wr{constructor(e){if(super(),typeof e!="object")throw new O(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new O(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return H(()=>F(ot(this.value),Ma(e,n)))}getConfig(){return{value:this.value}}}JL.className="Constant";ne(JL);class QL extends wr{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return Ep(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}QL.className="RandomUniform";ne(QL);class e3 extends wr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ze(`randomNormal does not support dType ${n}.`);return $0(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}e3.className="RandomNormal";ne(e3);class t3 extends wr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ze(`truncatedNormal does not support dType ${n}.`);return XM(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}t3.className="TruncatedNormal";ne(t3);class n3 extends wr{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return H(()=>{if(e.length!==2||e[0]!==e[1])throw new O("Identity matrix initializer can only be used for 2D square matrices.");return F(this.gain,_M(e[0]))})}getConfig(){return{gain:this.gain}}}n3.className="Identity";ne(n3);function poe(t,e="channelsLast"){let n,s;if(Jt(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=ua(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=ua(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=ua(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class Ds extends wr{constructor(e){if(super(),e.scale<0)throw new O(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,hoe(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,foe(this.distribution),this.seed=e.seed}apply(e,n){const s=poe(e),r=s[0],i=s[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,r):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(r+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new ze(`${this.getClassName()} does not support dType ${n}.`);return XM(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return Ep(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Ds.className="VarianceScaling";ne(Ds);class TI extends Ds{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Ds.className}}TI.className="GlorotUniform";ne(TI);class NI extends Ds{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Ds.className}}NI.className="GlorotNormal";ne(NI);class EI extends Ds{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Ds.className}}EI.className="HeNormal";ne(EI);class $I extends Ds{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Ds.className}}$I.className="HeUniform";ne($I);class _I extends Ds{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Ds.className}}_I.className="LeCunNormal";ne(_I);class AI extends Ds{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Ds.className}}AI.className="LeCunUniform";ne(AI);class s3 extends wr{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return H(()=>{if(e.length<2)throw new ze("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=Q(e.slice(0,-1)),r=e[e.length-1],i=s*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(r,s),Math.min(r,s)],a=$0(o,0,1,n,this.seed),l=Ise.qr(a,!1);let c=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=F(c,d.sign()),s<r&&(c=c.transpose()),F(ot(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}s3.className="Orthogonal";ne(s3);const e$={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function t$(t,e={}){return Pp(t,lr.getMap().classNameMap,e,"initializer")}function Mt(t){return kI(t)}function Dt(t){if(typeof t=="string"){const e=t in e$?e$[t]:t;if(e==="GlorotNormal")return new NI;if(e==="GlorotUniform")return new TI;if(e==="HeNormal")return new EI;if(e==="HeUniform")return new $I;if(e==="LeCunNormal")return new _I;if(e==="LeCunUniform")return new AI;{const n={};return n.className=e,n.config={},t$(n)}}else return t instanceof wr?t:t$(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function f1(t){return Array.isArray(t)&&Array.isArray(t[0])}function py(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function De(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new O(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function nt(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new O(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function my(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const n$="Variable";class moe{constructor(e,n="float32",s=n$,r=!0,i=null){this.dtype=n??"float32",this.shape=e.shape,this.id=WL(),s=s??n$,this.originalName=HL(s),this.name=qL(this.originalName),this.trainable_=r,this.constraint=i,this.val=Ine(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),goe(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function goe(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function p1(t){return t.map(e=>e.read())}function RI(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class dn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Ai{constructor(e,n,s,r,i,o,a){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=i,this.outputTensorIndex=a,this.id=WL(),o!=null&&(this.originalName=HL(o),this.name=qL(this.originalName)),this.rank=n.length}}let yoe=0;class _0{constructor(e,n){this.callArgs=n,this.id=yoe++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let xoe=0;class Ke extends Zu{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=xoe++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=ji(s)+"_"+E0(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),s=[i].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new fr(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new O(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return us(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return us(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new ii(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new ii(`Layer ${this.name} is not connected, no input to return.`);return us(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new ii(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new ii(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return us(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=ut(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=ut(this.inputSpec);if(n.length!==s.length)throw new O(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let r=0;r<n.length;r++){const i=n[r],o=s[r];if(o==null)continue;const a=i.rank;if(o.ndim!=null&&a!==o.ndim)throw new O(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new O(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new O(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&i.dtype!==o.dtype)throw new O(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${i.dtype}.`);if(o.axes){const l=i.shape;for(const c in o.axes){const u=Number(c),d=o.axes[c],h=u>=0?l[u]:l[l.length+u];if(d!=null&&[d,null].indexOf(h)===-1)throw new O(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${d} but got shape ${l}.`)}}if(o.shape!=null)for(let l=0;l<o.shape.length;++l){const c=o.shape[l],u=i.shape[l];if(c!=null&&u!=null&&c!==u)throw new O(`Input ${r} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${i.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=ut(e),r=woe(e),i=koe(e);if(r===i)throw new O("Arguments to apply() must be all SymbolicTensors or all Tensors");return xl(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of ut(e))o.push(a.shape);this.build(us(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,o);const a=ut(o),l=[];for(let c of a)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(o=us(l),this.activityRegularizer!=null)throw new ze("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=voe(e),a=this.computeOutputShape(o);let l;const c=boe(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,d)=>new Ai(c,u,this,ut(e),n,this.name,d)):l=new Ai(c,a,this,ut(e),n,this.name),this.addInboundNode(e,l,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new ze("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new ii(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new ii(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new fr(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return my(this.weights)}build(e){this.built=!0}getWeights(e=!1){return p1(e?this.trainableWeights:this.weights)}setWeights(e){H(()=>{const n=this.weights;if(n.length!==e.length)throw new O(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=p1(n);for(let i=0;i<r.length;++i){const o=r[i],a=n[i],l=e[i];if(!at(o.shape,l.shape))throw new O(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}RI(s)})}addWeight(e,n,s,r,i,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new O(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():Dt("zeros"));const c=r.apply(n,s),u=new moe(c,s,e,o,a);return c.dispose(),i!=null&&this.addLoss(()=>i.apply(u.read())),o==null&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=ut(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),i=ut(n),o=ut(r);if(i.length!==o.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let a=0;a<i.length;a++)i[a].kerasMask=o[a]}addInboundNode(e,n,s,r,i,o,a=null){const l=ut(e);n=ut(n),s=ut(s),r=ut(r),i=py(i),o=py(o);const c=[],u=[],d=[];for(const h of l)c.push(h.sourceLayer),u.push(h.nodeIndex),d.push(h.tensorIndex);new _0({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:i,outputShapes:o},a);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function voe(t){t=ut(t);const e=[];for(const n of t)e.push(n.shape);return us(e)}function boe(t){return"float32"}function r3(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let i=0;i<s.inboundLayers.length;i++){const o=s.inputTensors[i],a=s.inboundLayers[i],l=s.nodeIndices[i],c=r3(o,a,l);for(const u of c)r.indexOf(u)===-1&&r.push(u)}return r}}}function woe(t){let e=!0;for(const n of ut(t))if(!(n instanceof Ai)){e=!1;break}return e}function koe(t){let e=!0;for(const n of ut(t))if(n instanceof Ai){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Lp extends Ke{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:E0("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new O("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new O("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new O("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new Ai(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new _0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new O(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Lp.className="InputLayer";ne(Lp);function Coe(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new O("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new Lp({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Soe(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return xe(e,t.dtype)}catch{throw new O(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class qo{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof qo)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=Soe(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new O(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Ai){if(this.id2Value[e.id]==null)throw new O(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new O(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof Ai){if(this.id2Value[e.id]==null)throw new O(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new O(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&We(this.id2Mask)}}const gy=new zL,yy=new zL;function Ioe(t){gy!=null&&gy.setMaxEntries(t),yy!=null&&yy.setMaxEntries(t)}function Bd(t,e,n,s){const r=n==null?!1:n.training,i=Array.isArray(t),o=i?t:[t],a=o.map(p=>p.name),l=[],c=e.names();for(const p of a)c.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);const u=a.join(",")+"|"+e.names().sort().join(",");let d=gy.get(u),h;if(d==null){const p=Toe(o,e);d=p.sorted,h=p.recipientCounts,gy.put(u,d),yy.put(u,h)}h={},r||Object.assign(h,yy.get(u));const f=new qo(e);for(let p=0;p<d.length;++p){const m=d[p],y=m.sourceLayer;if(y instanceof Lp)continue;const g=[],x=[],v=[];let b=!1;for(const N of m.inputs){const E=f.getValue(N),D=f.getMask(N);g.push(E),x.push(D),D!=null&&(b=!0),r||(h[N.name]--,h[N.name]===0&&!e.hasKey(N)&&a.indexOf(N.name)===-1&&!E.isDisposed&&N.sourceLayer.stateful!==!0&&v.push(E))}b&&(n=n||{},n.mask=x[0]);const k=ut(y.apply(g,n));let C=null;y.supportsMasking&&(C=y.computeMask(g,x));const S=Eoe(m),I=Array.isArray(S)?S:[S];for(let N=0;N<I.length;++N){f.hasKey(I[N])||f.add(I[N],k[N],Array.isArray(C)?C[0]:C);const E=a.indexOf(I[N].name);E!==-1&&(l[E]=k[N])}r||We(v)}return f.disposeMasks(),i?l:l[0]}function Toe(t,e){T(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=s$(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const i of t){const{sorted:o,recipientMap:a}=s$(i,e);for(const l of o)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:Noe(s)}}function Noe(t){const e={};for(const n in t)e[n]=t[n].size;return e}function s$(t,e){const n=new Set,s=[],r={};for(const a of e.names())n.add(a);const i=[],o=[];for(i.push(t);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),s.push(a),n.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const c of a.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(a.name),!n.has(c.name)&&i.push(c)}}return{sorted:s,recipientMap:r}}function Eoe(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $oe=Y();$oe.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,Ioe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function DI(t,e){return H(()=>Vn($e(F(t,t),e,!0)))}class Vp extends Zu{getConfig(){return{}}}class i3 extends Vp{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return H(()=>{const n=DI(e,this.axis),s=Hs(n,0,this.maxValue);return F(e,_e(s,re(un(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}i3.className="MaxNorm";ne(i3);class o3 extends Vp{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return H(()=>_e(e,re(un(),DI(e,this.axis))))}getConfig(){return{axis:this.axis}}}o3.className="UnitNorm";ne(o3);class a3 extends Vp{apply(e){return oc(e)}}a3.className="NonNeg";ne(a3);class l3 extends Vp{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return H(()=>{const n=DI(e,this.axis),s=re(F(this.rate,Hs(n,this.minValue,this.maxValue)),F(1-this.rate,n));return F(e,_e(s,re(un(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}l3.className="MinMaxNorm";ne(l3);const r$={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function hn(t){return kI(t)}function i$(t,e={}){return Pp(t,lr.getMap().classNameMap,e,"constraint")}function fn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in r$?r$[t]:t,config:{}};return i$(n)}else return t instanceof Vp?t:i$(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function ja(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const i=t[r];if(typeof i!="number"){const o=i;e.push(o.data()),n.push(r),s.push(o)}}if(e.length>0){const r=await Promise.all(e);for(let i=0;i<r.length;++i)t[n[i]]=r[i][0];We(s)}}function c3(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var o$;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(o$||(o$={}));const _oe=125;class Qh{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class Aoe{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class Roe extends Qh{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const i=n[r];if(typeof i=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+i*s;else{let o;r in this.totals?o=this.totals[r]:this.totals[r]=0;const a=H(()=>re(this.totals[r],F(i,s)));this.totals[r]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:H(()=>{const r=F(_e(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),vi(n[s])}))}}class Doe extends Qh{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),n.push(i),s.push(a)}}const r=await Promise.all(e);for(let i=0;i<r.length;++i)this.history[n[i]][s[i]].dispose(),this.history[n[i]][s[i]]=r[i][0]}}class Poe extends Qh{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||pL,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=_oe),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");jw(this.yieldEvery)&&(this.maybeWait=qie(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await ja(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await ja(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await ja(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await ja(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await ja(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):jw(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await ja(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await ja(e),await this.trainEnd(e))}}function u3(t,e){return t==null&&(t={}),t instanceof Qh?[t]:Array.isArray(t)&&t[0]instanceof Qh?t:ut(t).map(s=>new Poe(s,e))}class ir{constructor(){}static registerCallbackConstructor(e,n){T(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),ir.checkForDuplicate(n),ir.constructors[e]==null&&(ir.constructors[e]=[]),ir.constructors[e].push(n)}static checkForDuplicate(e){for(const n in ir.constructors)ir.constructors[+n].forEach(r=>{if(r===e)throw new O("Duplicate callback constructor.")})}static clear(){ir.constructors={}}static createCallbacks(e){const n=[];for(const s in ir.constructors){const r=+s;e>=r&&n.push(...ir.constructors[r])}return n.map(s=>new s)}}ir.constructors={};function d3(t,e,n,s,r,i,o,a,l){const c=new Doe,u=[new Roe,...ir.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const d=new Aoe(u);return d.setParams({epochs:n,initialEpoch:s,samples:r,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:d,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zi(t,e={},n=!1){return Pp(t,lr.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xy(t,e){return H(()=>{t.dtype!=="float32"&&(t=xe(t,"float32"));const n=$e(Fp(t),e,!0),s=b0(n.shape,un()),r=Vn(Fa(n,s));return _e(t,r)})}function A0(t,e){return H(()=>nn(Fp(Ae(e,t)),-1))}function PI(t,e){return H(()=>nn(Kn(Ae(e,t)),-1))}function OI(t,e){return H(()=>{const n=Ae(t,e),s=Hs(Kn(t),un(),Number.MAX_VALUE),r=Kn(_e(n,s));return F(100,nn(r,-1))})}function Ooe(t,e){return H(()=>{const n=Hs(e,un(),Number.MAX_VALUE),s=_i(re(1,n)),r=Hs(t,un(),Number.MAX_VALUE),i=_i(re(1,r));return nn(Fp(Ae(s,i)),-1)})}function Foe(t,e){return H(()=>{const n=Fa(0,Ae(1,F(t,e)));return nn(Fp(n),-1)})}function Moe(t,e){return H(()=>{const n=Fa(0,Ae(1,F(t,e)));return nn(n,-1)})}function Loe(t,e){return H(()=>{const n=$e(F(t,e),-1),s=Ur(F(Ae(1,t),e),-1);return Fa(0,re(1,Ae(s,n)))})}function Voe(t,e){return H(()=>{const n=Math.log(2),s=Ae(e,t),r=Ae(re(s,Np(F(-2,s))),n);return nn(r,-1)})}function ef(t,e,n=!1){return H(()=>{if(n)e=VS(e);else{const s=$e(e,e.shape.length-1,!0);e=_e(e,s)}return e=Hs(e,un(),1-un()),Kt($e(F(xe(t,"float32"),_i(e)),e.shape.length-1))})}function vy(t,e,n=!1){return H(()=>{const s=xe(C0(ioe(t)),"int32");e=Hs(e,un(),1-un());const r=e.shape,i=U(OM(s,r[r.length-1]),r);return ef(i,e,n)})}function Boe(t,e){if(!at(t.shape,e.shape))throw new O(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return H(()=>{const n=oc(e),s=Kt(Kn(e));return re(Ae(n,F(e,t)),AM($i(s)))})}function R0(t,e){return H(()=>{let n;return n=Hs(e,un(),1-un()),n=_i(_e(n,Ae(1,n))),nn(Boe(t,n),-1)})}function zoe(t,e){return H(()=>{const n=Hs(t,un(),1),s=Hs(e,un(),1);return $e(F(t,_i(_e(n,s))),-1)})}function Uoe(t,e){return H(()=>{const n=_i(re(un(),e));return nn(Ae(e,F(t,n)),-1)})}function h3(t,e){return H(()=>{const n=xy(t,-1),s=xy(e,-1),r=F(n,s);return Kt($e(r,-1))})}const by={meanSquaredError:A0,meanAbsoluteError:PI,meanAbsolutePercentageError:OI,meanSquaredLogarithmicError:Ooe,squaredHinge:Foe,hinge:Moe,categoricalHinge:Loe,logcosh:Voe,categoricalCrossentropy:ef,sparseCategoricalCrossentropy:vy,binaryCrossentropy:R0,kullbackLeiblerDivergence:zoe,poisson:Uoe,cosineProximity:h3};function sb(t){if(typeof t=="string"){if(t in by)return by[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new O(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function f3(t,e){return H(()=>{const n=F(.5,vr(e)),s=wi(Ys(e,n),t.dtype);return nn(Ei(t,s),-1)})}function p3(t,e){return H(()=>wi(Ei(Kh(t,-1),Kh(e,-1)),"float32"))}function joe(t,e){return H(()=>xe($e(uo(Ei(t,1),Ei(e,1))),"float32"))}function Woe(t,e){return H(()=>xe($e(uo(Ei(t,0),Ei(e,1))),"float32"))}function Goe(t,e){return H(()=>{const n=joe(t,e),s=Woe(t,e),r=re(n,s);return xe(es(Ys(r,0),_e(n,r),0),"float32")})}function Hoe(t,e){return R0(t,e)}function qoe(t,e){return t.rank===e.rank&&(t=$p(t,[t.rank-1])),e=Kh(e,-1),e.dtype!==t.dtype&&(e=xe(e,t.dtype)),xe(Ei(t,e),"float32")}const Koe=A0,Xoe=A0,Yoe=PI,Zoe=PI,Joe=OI,Qoe=OI,m3=ef,eae=h3,g3=vy,wy={binaryAccuracy:f3,categoricalAccuracy:p3,precision:Goe,categoricalCrossentropy:m3,sparseCategoricalCrossentropy:g3,mse:Koe,MSE:Xoe,mae:Yoe,MAE:Zoe,mape:Joe,MAPE:Qoe,cosine:eae};function tae(t){if(typeof t=="string"&&t in wy)return wy[t];if(typeof t!="string"&&t!=null)return t;throw new O(`Unknown metric ${t}`)}function Im(t){if(oi(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(by))if(by[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(wy))if(wy[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nae(t){const e={Adagrad:()=>Ya.adagrad(.01),Adadelta:()=>Ya.adadelta(1,.95,un()),Adam:()=>Ya.adam(.001,.9,.999,un()),Adamax:()=>Ya.adamax(.002,.9,.999,un(),0),RMSProp:()=>Ya.rmsprop(.001,.9,0,un()),SGD:()=>Ya.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new O(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const a$=1*1024*1024;function l$(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!m1(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>a$&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${a$}.`)}}function m1(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!m1(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!m1(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sae(t,e,n,s=console.log){const r=iae(t),i=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let o;if(!r){i.push("Receives inputs"),o=[];for(const u in t.nodesByDepth)o.push(...t.nodesByDepth[u])}s("_".repeat(e)),ky(i,n,s),s("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)r?oae(a[u],n,s):aae(a[u],n,o,s),s((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=rae(t),c=my(t.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function rae(t){let e;return t.collectedTrainableWeights!=null?e=my(t.collectedTrainableWeights):e=my(t.trainableWeights),e}function iae(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let i=!1;for(const o of r.inboundNodes)if(s.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function ky(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function oae(t,e,n){let s,r;try{r=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const i=t.name,o=t.getClassName(),a=[`${i} (${o})`,r,s,t.countParams().toString()];ky(a,e,n)}function aae(t,e,n,s){let r,i;try{i=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const o=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const f=d.inboundLayers[h].name,p=d.nodeIndices[h],m=d.tensorIndices[h];o.push(`${f}[${p}][${m}]`)}const a=t.name,l=t.getClassName(),c=o.length===0?"":o[0],u=[`${a} (${l})`,i,r,t.countParams().toString(),c];ky(u,e,s);for(let d=1;d<o.length;++d)ky(["","","","",o[d]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function y3(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function g1(t,e){if(t===null)return null;if(typeof t=="string")return tl(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];y3(e,r,i)?n.push(i):n.push(g1(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const i=tl(s);n[i]=g1(r,i)}}return n}}function y1(t,e){if(t==null)return null;if(typeof t=="string")return ji(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];y3(e,r,i)?n.push(i):n.push(y1(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],i=ji(s);(s==="name"||s==="className")&&typeof r=="string"?n[i]=r:n[i]=y1(r,s)}return n}}/** @license See the LICENSE file. */const x3="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const lae=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Tr extends Ke{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const x=this.getClassName().toLowerCase();this.name=E0(x)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],ca(this.inputs).length!==this.inputs.length)throw new O(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(x=>x.name)}`);ca(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(x=>x.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const x of this.outputs){const v=x.sourceLayer,b=x.nodeIndex,k=x.tensorIndex;this.outputLayers.push(v),this.outputLayersNodeIndices.push(b),this.outputLayersTensorIndices.push(k)}for(const x of this.inputs){const v=x.sourceLayer,b=x.nodeIndex,k=x.tensorIndex;oi(b===0,"input layer has >1 nodes"),oi(k===0,"input layer has >1 tensors"),this.inputLayers.push(v),this.inputLayersNodeIndices.push(b),this.inputLayersTensorIndices.push(k)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let x=0;x<this.inputLayers.length;x++){const v=this.inputLayers[x];if(!(v instanceof Lp))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${x} (0-based) originates from layer type ${v.getClassName()}.`);this.inputNames.push(v.name),this.feedInputShapes.push(v.batchInputShape),this.feedInputNames.push(v.name)}for(const x of this.outputLayers)this.outputNames.push(x.name);this.internalInputShapes=this.inputs.map(x=>x.shape),this.internalOutputShapes=this.outputs.map(x=>x.shape);const n={},s={},r={},i={},o={},a=[],l=(x,v,b,k,C,S)=>{(k==null||C==null||S==null)&&(k=x.sourceLayer,C=x.nodeIndex,S=x.tensorIndex);const I=k.inboundNodes[C];if(b.indexOf(I)!==-1)throw new fr(`The tensor ${x.name} at layer "${k.name}" is part of a cycle.`);if(v.indexOf(I)!==-1)return;this.containerNodes.add(Tr.nodeKey(k,C)),k.id in o||(o[k.id]=Object.keys(o).length),b.indexOf(I)===-1&&b.push(I);const N=I.inboundLayers.length;for(let E=0;E<N;E++){const D=I.inputTensors[E],R=I.inboundLayers[E],L=I.nodeIndices[E],B=I.tensorIndices[E];l(D,v,b,R,L,B)}for(v.push(I);b.indexOf(I)>=0;)b.splice(b.indexOf(I),1);a.push(I)},c=[],u=[];for(const x of this.outputs)l(x,c,u);const d=a.slice().reverse();for(const x of d){s[x.id]=x,x.id in n||(n[x.id]=0);let v=n[x.id];const b=r[x.outboundLayer.id]==null?0:r[x.outboundLayer.id];v=Math.max(v,b),r[x.outboundLayer.id]=v,i[x.outboundLayer.id]=x.outboundLayer,n[x.id]=v;for(let k=0;k<x.inboundLayers.length;k++){const C=x.inboundLayers[k],S=x.nodeIndices[k],I=C.inboundNodes[S],N=n[I.id]==null?0:n[I.id];n[I.id]=Math.max(v+1,N),s[I.id]=I}}const h={};for(const x in n){const v=n[x];v in h||(h[v]=[]),h[v].push(s[x])}const f={};for(const x in r){const v=r[x];v in f||(f[v]=[]),f[v].push(i[x])}let p=Object.keys(f).map(x=>parseInt(x,10)).sort(km);this.layers=[];for(const x of p){const v=f[x];v.sort((b,k)=>{const C=o[b.id],S=o[k.id];return C<S?-1:C>S?1:0});for(const b of v)b instanceof Tr&&this.internalContainerRefs.push(b),this.layers.push(b)}this.layersByDepth=f,p=Object.keys(h).map(x=>parseInt(x,10)).sort(km);const m=this.inputs.slice(),y=[];for(const x of p)for(const v of h[x]){const b=v.outboundLayer;if(b!=null){for(const k of v.inputTensors)if(m.indexOf(k)===-1)throw new fr(`Graph disconnected: cannot obtain value for tensor ${k} at layer "${b.name}". The following previous layers were accessed without issue: ${y}`);for(const k of v.outputTensors)m.push(k);y.push(b.name)}}this.nodesByDepth=h;const g=this.layers.map(x=>x.name);for(const x of g){const v=g.filter(b=>b===x).length;if(v!==1)throw new fr(`The name "${x}" is used ${v} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new _0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(x=>null),outputMasks:this.outputs.map(x=>null),inputShapes:this.inputs.map(x=>x.shape),outputShapes:this.outputs.map(x=>x.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new O("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;const i=lae(e);i&&this.parseWeights(e);for(const a of this.layers)for(const[l,c]of a.weights.entries()){const u=i?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[u]!=null)throw new O(`Duplicate weight name: ${u}`);s[u]=c,r++}const o=[];for(const a in e){let l=a;if(s[a]==null){const c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)o.push([s[l],e[a]]);else if(n)throw new O(`Provided weight data has no target variable: ${a}`);delete s[l]}if(n){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new O(`${a.length} of ${r} weights are not set: ${a}`)}RI(o)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],i=s.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!r.includes(o)).join("/");i!==n&&(e[i]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${x3}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=y1(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return H(()=>{e=ut(e);const s=new qo;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return Bd(this.outputs,s,n)})}computeMask(e,n){return H(()=>{e=ut(e);let s;return n==null?s=Gl(null,e.length):s=ut(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=py(e);if(n.length!==this.inputLayers.length)throw new O(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";s[u]=c}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(km);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(u.id)!==-1)continue;const d=[];for(let m=0;m<c.inboundLayers.length;m++){const y=c.inboundLayers[m],g=c.nodeIndices[m],x=c.tensorIndices[m],v=`${y.name}_${g}_${x}`,b=s[v];d.push(b)}const h=u.computeOutputShape(us(d)),f=py(h),p=u.inboundNodes.indexOf(c);for(let m=0;m<f.length;m++){const y=`${u.name}_${p}_${m}`;s[y]=f[m]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],d=`${l.name}_${c}_${u}`;o.push(d)}for(let a=0;a<o.length;a++){const l=o[a];oi(l in s),i.push(s[l])}return us(i)}runInternalGraph(e,n){n==null&&(n=Gl(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],d=n[l];s[c.id]=[u,d]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(km);for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const d=u.outboundLayer,h=u.inputTensors,f=u.outputTensors,p=new Array;for(const m of h)m.id in s&&p.push(s[m.id]);if(p.length===h.length){let m={},y,g,x,v;if(u.callArgs!=null&&(m=u.callArgs),p.length===1){const[b,k]=p[0];m.mask==null&&(m.mask=k),x=ut(d.call(b,m)),v=ut(d.computeMask(b,k)),y=[b],g=[k]}else y=p.map(b=>b[0]),g=p.map(b=>b[1]),m.mask==null&&(m.mask=g),x=ut(d.call(y,m)),v=ut(d.computeMask(y,g));if(d.activityRegularizer)throw new ze("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let b=0;b<f.length;++b){const k=f[b],C=x[b],S=v[b];s[k.id]=[C,S]}}}}const i=[],o=[],a=[];for(const l of this.outputs){oi(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=s[l.id];a.push(c.shape),i.push(c),o.push(u)}return[i,o,a]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof Tr?1:0;for(let i=0;i<r.inboundNodes.length;i++){const o=Tr.nodeKey(r,i);this.containerNodes.has(o)&&(n[o]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new O("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new O(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new O(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return H(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=Tr.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),c=[];for(let d=0;d<o.inboundNodes.length;d++){const h=o.inboundNodes[d],f=Tr.nodeKey(o,d);let p={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(h.inboundLayers.length>0){const m=[];for(let y=0;y<h.inboundLayers.length;y++){const g=h.inboundLayers[y],x=h.nodeIndices[y],v=h.tensorIndices[y],b=Tr.nodeKey(g,x);let k=n[b];k==null&&(k=0),m.push([g.name,k,v,p])}c.push(m)}}}const u={};u.name=o.name,u.className=a,u.config=l,u.inboundNodes=c,s.push(u)}e.layers=s;const r=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],c=Tr.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.inputLayersTensorIndices[o];r.push([a.name,u,d])}e.inputLayers=r;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],c=Tr.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.outputLayersTensorIndices[o];i.push([a.name,u,d])}return e.outputLayers=i,e}static fromConfig(e,n,s={},r=!1){const i={},o={};function a(y,g){y.name in o?o[y.name].push(g):o[y.name]=[g]}function l(y,g){const x=[];let v;for(const b of g){const k=b[0],C=b[1],S=b[2];if(v=b[3]==null?{}:b[3],!(k in i)){a(y,g);return}const I=i[k];if(I.inboundNodes.length<=C){a(y,g);return}const N=I.inboundNodes[C];x.push(N.outputTensors[S])}x.length>0&&y.apply(us(x),v)}function c(y){const g=y.name,x=Zi(y,n.customObjects!=null?n.customObjects:{});x.setFastWeightInitDuringBuild(r),i[g]=x,y.inboundNodes.forEach(b=>{if(!(b instanceof Array))throw new O(`Corrupted configuration, expected array for nodeData: ${b}`);a(x,b)})}const u=n.name,d=n.layers;for(const y of d)c(y);for(;!Hie(o);)for(const y of d){const g=i[y.name];if(g.name in o){const x=o[g.name];delete o[g.name];for(const v of x)l(g,v)}}const h=[],f=[],p=n.inputLayers;for(const y of p){const g=y[0],x=y[1],v=y[2];oi(g in i);const k=i[g].inboundNodes[x].outputTensors;h.push(k[v])}const m=n.outputLayers;for(const y of m){const g=y[0],x=y[1],v=y[2];oi(g in i);const k=i[g].inboundNodes[x].outputTensors;f.push(k[v])}return new e({inputs:h,outputs:f,name:u})}get stateful(){if(this._stateful)throw new O("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){H(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function cae(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(i=>{i in t?r.push(t[i]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function v3(t,e){return cae(t,e,"classWeight")}async function b3(t,e,n,s){if(n!=null){const r=H(()=>{if(t.shape.length===1)return yl(t);if(t.shape.length===2){if(t.shape[1]>1)return Kh(t,1);if(t.shape[1]===1)return U(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await r.data());We(r);const o=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),Is(o,"float32")}else return null}function uae(t,e){return F(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const dae=32;function w3(t,e){let n,s;const r=e;n=r.xs,s=r.ys,T(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=c$("input",t.inputNames,n),o=c$("output",t.outputNames,s),a=i[0].shape[0];T(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),T(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<i.length;l++)T(i[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<o.length;l++)T(o[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:i,ys:o}}function c$(t,e,n){if(n instanceof ln)return[n];if(Array.isArray(n))return T(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new O(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function hae(t){if(t.length===3)throw new ze("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function fae(t,e,n){const s=n.batchesPerEpoch!=null;if(T(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),T(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),T(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),T(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),T(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let i,o;if(r)if(u$(n.validationData))T(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const y=hae(n.validationData);i=y.xs,o=y.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(y=>"val_"+y)):c=l.slice();const u=u3(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:h,history:f}=d3(u,d,n.epochs,null,null,pae(e,n),null,r,c);h.setModel(t),t.history=f,await h.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,m=await e.iterator();for(;p<n.epochs;){const y={};await h.onEpochBegin(p);let g=0,x=0;for(s||(m=await e.iterator());!s||g<n.batchesPerEpoch;){const v=await m.next();if(s&&v.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${g} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(v.value!=null){const{xs:b,ys:k}=w3(t,v.value),C={};C.batch=x,C.size=b[0].shape[0],await h.onBatchBegin(x,C);const S=[];if(n.classWeight!=null){const E=v3(n.classWeight,t.outputNames);for(let D=0;D<E.length;++D)S.push(await b3(k[D],null,E[D]))}const I=b.concat(k).concat(S),N=a(I);We(I);for(let E=0;E<l.length;++E){const D=l[E],R=N[E];C[D]=R,vi(R)}await h.onBatchEnd(x,C),c3(C),x++,g++}if(s?g>=n.batchesPerEpoch:v.done){if(r){let b;u$(n.validationData)?b=ut(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):b=ut(t.evaluate(i,o,{batchSize:n.validationBatchSize==null?dae:n.validationBatchSize,verbose:0}));for(let k=0;k<t.metricsNames.length;++k)y[`val_${t.metricsNames[k]}`]=b[k]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(p,y),p++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function pae(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function u$(t){return typeof t.iterator=="function"}function mae(t){return typeof t.next=="function"}async function gae(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let i=[];if(n.verbose>0)throw new ze("Verbose mode is not implemented yet.");T(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=mae(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<n.batches;){const c=await o.next();if(i=H(()=>{if(c.value){const{xs:u,ys:d}=w3(t,c.value),h=u.concat(d),f=H(()=>r(h));if(We(h),l===0)for(let m=0;m<f.length;++m)i.push(ot(0));const p=h[0].shape[0];for(let m=0;m<f.length;++m){const y=f[m],g=i[m];i[m]=H(()=>re(i[m],F(p,y))),l>0&&We(g)}We(f),a+=p,++l}return i}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<i.length;++c){const u=i[c];i[c]=_e(i[c],a),We(u)}return us(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rb(t){T(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function Td(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>vl(s,e,n-e)):vl(t,e,n-e)}function x1(t,e){return H(()=>t==null?null:Array.isArray(t)?t.map(n=>x1(n,e)):XL(t,e.dtype==="int32"?e:xe(e,"int32")))}function ib(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}function k3(t){const e=[];t instanceof ln&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(Op(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Sr(t,e){if(t==null)return;const n=[];if(e instanceof ln)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const i=e[r];n.push(i.id)}const s=[];if(t instanceof ln)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const i=t[r];n.indexOf(i.id)===-1&&s.push(i)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yae(t){return t instanceof ln}function v1(t){return Array.isArray(t)}function d$(t){return!yae(t)&&!v1(t)}function h$(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let o=!1;if(v1(t)&&t.length>0)o=!0;else if(d$(t)){for(const a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new O(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(o=>null);let i;if(d$(t)){t=t,i=[];for(const o of e){if(t[o]==null)throw new O(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(t[o])}}else if(v1(t)){if(t=t,t.length!==e.length)throw new O(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);i=t}else{if(t=t,e.length>1)throw new O(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);i=[t]}if(i=k3(i),n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new O(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u>=0&&c!==u)throw new O(`${r} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function xae(t,e,n){const s=ca(t.map(i=>i.shape[0]));s.sort();const r=ca(e.map(i=>i.shape[0]));if(r.sort(),s.length>1)throw new O(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(r.length>1)throw new O(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(s.length>0&&r.length>0&&!at(s,r))throw new O(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function vae(t,e,n){const s=[A0,R0,ef];for(let r=0;r<t.length;++r){const i=t[r],o=e[r],a=n[r];if(o!=null){if(o===ef&&i.shape[i.shape.length-1]===1)throw new O(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(o)!==-1){const l=i.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const d=l[u],h=c[u];if(h!=null&&d!==h)throw new O(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function f$(t,e,n,s=!0,r=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new O(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new O(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);i=[t]}if(n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new O(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u!==c)throw new O(`Error when checking ${r}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function bae(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let i=n.hasOwnProperty(r)?n[r]:[];Array.isArray(i)||(i=[i]),s.push(i)}return s}}const wae="layers-model";class iu extends Tr{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new O("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");sae(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=nae(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof La))throw new O("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new O(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(sb(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new O(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>sb(a))}else{const o=sb(e.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],xl("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const r=bae(e.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};xl("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=r[o];(c=>{const u="";let d,h,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const y=this.internalOutputShapes[o];y[y.length-1]===1||this.lossFunctions[o]===R0?["accuracy","acc"].indexOf(p)!==-1?h=f3:["crossentropy","ce"].indexOf(p)!==-1&&(h=Hoe):this.lossFunctions[o]===vy?["accuracy","acc"].indexOf(p)!==-1?h=qoe:["crossentropy","ce"].indexOf(p)!==-1&&(h=g3):["accuracy","acc"].indexOf(p)!==-1?h=p3:["crossentropy","ce"].indexOf(p)!==-1&&(h=m3);let g;["accuracy","acc"].indexOf(p)!==-1?g="acc":["crossentropy","ce"].indexOf(p)!==-1&&(g="ce"),f=h,d=u+g}else f=tae(p),d=u+Im(p);let m;xl(d,()=>{m=f}),i(o,d,m)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;rb(r);const o=this.standardizeUserDataXY(e,n,!0,r);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,r,s.verbose,s.steps);return us(c)}finally{Sr(o[0],e),Sr(o[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),gae(this,e,n)}checkNumSamples(e,n,s,r="steps"){let i;if(s!=null){if(i=null,n!=null)throw new O(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new O(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return i}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new O("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],i=this.retrieveSymbolicTensors(r),o=new qo;if(e instanceof ln&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new O(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new O(`No value is provided for the model's input ${l.name}`);o.add(l,c)}const a=Bd(i,o);return s?a:a[0]}retrieveSymbolicTensors(e){const n=Gl(null,e.length);let s=e.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(n[a]=i[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((i,o)=>{i==null&&r.push(e[o])}),new O(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return H(()=>{const r=this.checkNumSamples(e);if(s)throw new ze("Verbose predictLoop() is not implemented yet.");const i=ib(r,n),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)H(()=>{const c=i[a][0],u=i[a][1],d=Td(e,c,u),h=[];if(Array.isArray(d))for(let p=0;p<d.length;++p)h.push({key:this.inputs[p],value:d[p]});else h.push({key:this.inputs[0],value:d});const f=new qo(h);return Bd(this.outputs,f)}).forEach((c,u)=>o[u].push(c));return us(o.map(a=>hs(a,0)))})}predict(e,n={}){const s=k3(e);f$(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return rb(r),this.predictLoop(s,r)}finally{Sr(s,e)}}predictOnBatch(e){f$(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new fr("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===vy?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=h$(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=h$(n,this.feedOutputNames,i,!1,"target"),xae(e,n),vae(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new O(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,i=!0,o){const[a,l]=this.standardizeUserDataXY(e,n,i,o);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const u=v3(r,this.outputNames);c=[];for(let d=0;d<u.length;++d)c.push(await b3(l[d],null,u[d]))}return[a,l,c]}testLoop(e,n,s,r=0,i){return H(()=>{const o=this.checkNumSamples(n,s,i,"steps"),a=[];if(r>0)throw new ze("Verbose mode is not implemented yet.");if(i!=null)throw new ze("steps mode in testLoop() is not implemented yet");{const l=ib(o,s),c=Is(Hr(0,o));for(let u=0;u<l.length;++u){const d=l[u][0],h=l[u][1],f=vl(c,d,h-d),p=x1(n,f),m=e(p);if(u===0)for(let y=0;y<m.length;++y)a.push(ot(0));for(let y=0;y<m.length;++y){const g=m[y];a[y]=re(a[y],F(h-d,g))}}for(let u=0;u<a.length;++u)a[u]=_e(a[u],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let i=r;if(ZE(e,r)>1){const o=ZE(e.slice(0,s),r);i+=`_${o}`}n.push(i)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const d=[];for(let m=0;m<this.inputs.length;++m)d.push({key:this.inputs[m],value:s[m]});const h=new qo(d),f=Bd(this.outputs,h,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const y=this.lossFunctions[m];let g=y(r[m],f[m]);i[m]!=null&&(g=uae(g,i[m]));const x=nn(g);n.push(x),m===0?p=g:p=re(p,g)}for(let m=0;m<this.metricsTensors.length;++m){let y;if(this.outputs.length>1&&m<this.outputs.length)y=n[m];else{const g=this.metricsTensors[m][0],x=this.metricsTensors[m][1];y=nn(g(r[x],f[x]))}vi(y),o.push(y)}return p=nn(p),this.calculateLosses().forEach(m=>{p=re(p,m)}),p},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(a,!0,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>H(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let c=0;c<this.inputs.length;++c)o.push({key:this.inputs[c],value:r[c]});const a=new qo(o),l=Bd(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],d=nn(u(i[c],l[c]));c===0?s=d:s=re(s,d),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],d=this.metricsTensors[c][1],h=nn(u(i[d],l[d]));n.push(h)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,i,o,a,l,c,u,d,h;try{const f=s.batchSize==null?32:s.batchSize;rb(f);const m=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,!1,f);r=m[0],i=m[1],h=m[2];let y=!1,g;if(s.validationData!=null&&s.validationData.length>0){if(y=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new ze("validationData including sample weights is not supported yet."):new O(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const E=await this.standardizeUserData(l,c,null,null,!0,f);u=E[0],d=E[1],g=u.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){y=!0;const N=Math.floor(r[0].shape[0]*(1-s.validationSplit)),E=r[0].shape[0];u=Td(r,N,E),o=r,r=Td(r,0,N),d=Td(i,N,E),a=i,i=Td(i,0,N),g=u.concat(d)}else s.validationSteps!=null&&(y=!0);const x=r.concat(i).concat(h);this.checkTrainableWeightsConsistency();const v=this.makeTrainFunction(),b=this.getDedupedMetricsNames();let k,C;y?(this.makeTestFunction(),k=this.testFunction,C=b.slice().concat(b.map(N=>"val_"+N))):(k=null,g=[],C=b.slice());const S=u3(s.callbacks,s.yieldEvery);return await this.fitLoop(v,x,b,f,s.epochs,s.verbose,S,k,g,s.shuffle,C,s.initialEpoch,null,null)}finally{this.isTraining=!1,Sr(r,e),Sr(i,n),Sr(o,e),Sr(a,n),Sr(u,l),Sr(d,c),h!=null&&We(h)}}async fitLoop(e,n,s,r,i,o,a,l,c,u,d,h,f,p){r==null&&(r=32),i==null&&(i=1),u==null&&(u=!0),h==null&&(h=0);let m=!1;if(l!=null&&c!=null&&(m=!0),p!=null&&(m=!0,f==null))throw new O("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const y=this.checkNumSamples(n,r,f,"steps_per_epoch");let g;y!=null&&(g=Hr(0,y)),o==null&&(o=1);const{callbackList:x,history:v}=d3(a,o,i,h,y,f,r,m,d);x.setModel(this),this.history=v,await x.onTrainBegin(),this.stopTraining_=!1;for(let b=h;b<i;++b){await x.onEpochBegin(b);const k={};if(f!=null)throw new ze("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new ze("batch shuffling is not implemneted yet");u&&oZ(g);const C=Is(g),S=ib(y,r);for(let I=0;I<S.length;++I){const N={};if(await x.onBatchBegin(I,N),H(()=>{const E=S[I][0],D=S[I][1],R=vl(C,E,D-E);N.batch=I,N.size=D-E;const L=x1(n,R),B=e(L);for(let W=0;W<s.length;++W){const G=s[W],q=B[W];N[G]=q,vi(q)}if(I===S.length-1&&m){const W=this.testLoop(l,c,r);for(let G=0;G<s.length;++G){const q=s[G],A=W[G];vi(A),k["val_"+q]=A}}}),await x.onBatchEnd(I,N),c3(N),this.stopTraining_)break}C.dispose()}if(await x.onEpochEnd(b,k),this.stopTraining_)break}return await x.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return fae(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],i=s[1],a=this.makeTrainFunction()(r.concat(i)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return We(a),Sr(s[0],e),Sr(s[1],n),us(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,i=this.getWeights(s);for(let o=0;o<r.length;++o)s&&!r[o].trainable||n.push({name:r[o].originalName,tensor:i[o]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=DE().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-DE().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=ji(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>ji(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=ji(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[ji(Im(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>ji(Im(e)));{const e={};for(const n in this.metrics)e[n]=ji(Im(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=g1(e.optimizer_config),s=Zi(n);let r;if(typeof e.loss=="string")r=tl(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(o=>tl(o));else if(e.loss!=null){r={};for(const o in e.loss)r[o]=tl(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>tl(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=tl(e.metrics[o])}this.compile({loss:r,metrics:i,optimizer:s})}async save(e,n){if(typeof e=="string"){const c=nJ(e);if(c.length===0)throw new O(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new O(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new O("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await OE(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:wae,generatedBy:`TensorFlow.js tfjs-layers v${x3}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:d}=await OE(await this.optimizer.getWeights(),c);s.specs.push(...d),s.data=tJ([s.data,u])}return this.userDefinedMetadata!=null&&(l$(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){l$(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}iu.className="Model";ne(iu);class C3 extends iu{}C3.className="Functional";ne(C3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Tu extends iu{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:E0("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new O(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof Tu||e instanceof iu;let s;if(n){if(s=e,s.outputs.length!==1)throw new O("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new O("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new O("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=Coe({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new O(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new O("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=r3(this.outputs[0])}this.inboundNodes=[],new _0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Gl(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(nt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new iu({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new fr("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new fr("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new fr("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new fr("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let i,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new O("Legacy serialization format not supported yet.");i=n}else T(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,o=n;const a=new e(o);if(!(a instanceof Tu))throw new ze(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const u=Zi(l,void 0,r);r&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new O("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new O("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}Tu.className="Sequential";ne(Tu);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kae(t){return new Tu(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let zn=class extends Zu{getConfig(){return{}}};class S3 extends zn{apply(e,n=1){return aoe(e,n)}}S3.className="elu";ne(S3);class I3 extends zn{apply(e){return UM(e)}}I3.className="selu";ne(I3);class T3 extends zn{apply(e){return oc(e)}}T3.className="relu";ne(T3);class N3 extends zn{apply(e){return H(()=>Zh(6,oc(e)))}}N3.className="relu6";ne(N3);class E3 extends zn{apply(e){return e}}E3.className="linear";ne(E3);class $3 extends zn{apply(e){return Ku(e)}}$3.className="sigmoid";ne($3);class _3 extends zn{apply(e){return coe(e)}}_3.className="hardSigmoid";ne(_3);class A3 extends zn{apply(e){return Np(e)}}A3.className="softplus";ne(A3);class R3 extends zn{apply(e){return loe(e)}}R3.className="softsign";ne(R3);class D3 extends zn{apply(e){return x0(e)}}D3.className="tanh";ne(D3);let FI=class extends zn{apply(e,n=-1){return VS(e,n)}};FI.className="softmax";ne(FI);class P3 extends zn{apply(e,n=-1){return RM(e,n)}}P3.className="logSoftmax";ne(P3);class O3 extends zn{apply(e){return H(()=>H(()=>{const n=Math.sqrt(2),s=F(.5,re(1,NM(_e(e,n))));return F(e,s)}))}}O3.className="gelu";ne(O3);class F3 extends zn{apply(e){return H(()=>F(.5,F(e,re(1,x0(F(Vn(_e(2,Math.PI)),re(e,F(.044715,Ul(e,3)))))))))}}F3.className="gelu_new";ne(F3);class M3 extends zn{apply(e){return H(()=>F(e,x0(Np(e))))}}M3.className="mish";ne(M3);class L3 extends zn{apply(e,n=1){return H(()=>F(Ku(F(e,n)),e))}}L3.className="swish";ne(L3);function va(t){return t.getClassName()}function ob(t,e={}){return Pp(t,lr.getMap().classNameMap,e,"activation")}function ba(t){if(t==null){const e={};return e.className="linear",e.config={},ob(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},ob(e)}else return t instanceof zn?t:ob(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Cae(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class V3 extends Zu{}class B3 extends V3{constructor(e){super(),Cae(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return H(()=>{let n=vn([1]);return this.hasL1&&(n=re(n,$e(F(this.l1,Kn(e))))),this.hasL2&&(n=re(n,$e(F(this.l2,Fp(e))))),U(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}B3.className="L1L2";ne(B3);const p$={l1l2:"L1L2"};function yt(t){return kI(t)}function m$(t,e={}){return Pp(t,lr.getMap().classNameMap,e,"regularizer")}function Pt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in p$?p$[t]:t,config:{}};return m$(n)}else return t instanceof V3?t:m$(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class z3 extends Ke{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=De(e);let s=oc(e);return this.maxValue!=null&&(s=Hs(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}z3.className="ReLU";ne(z3);class U3 extends Ke{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=De(e);return CS(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}U3.className="LeakyReLU";ne(U3);class j3 extends Ke{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Dt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Pt(e.alphaRegularizer),this.alphaConstraint=fn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new O(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=nt(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new dn({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=De(e),$S(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Mt(this.alphaInitializer),alphaRegularizer:yt(this.alphaRegularizer),alphaConstraint:hn(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}j3.className="PReLU";ne(j3);let W3=class extends Ke{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new ze(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=De(e);return w0(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};W3.className="ELU";ne(W3);class G3 extends Ke{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=De(e);return F(s,xe(Ys(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}G3.className="ThresholdedReLU";ne(G3);class H3 extends Ke{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new FI().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return H(()=>{let s=De(e);const r=n.mask;if(r!=null){const i=F(Ae(Ma(s.shape),xe(r,s.dtype)),ot(-1e9));s=re(s,i)}return this.axis instanceof Array?this.axis.length>1?$i(Ae(s,DM(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}H3.className="Softmax";ne(H3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ou(t,e,n){if(typeof t=="number")return Gl(t,e);if(t.length!==e)throw new O(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!soe(r))throw new O(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function jr(t,e,n,s,r=1){if(t==null)return t;const i=e+(e-1)*(r-1);let o;return n==="same"?o=t:o=t-i+1,Math.floor((o+s-1)/s)}function ai(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+xa([n-e,0]);else if(s==="same")t=t*e;else throw new O(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function MI(t,e){return H(()=>(Jt(e),e==="channelsFirst"?Je(t,[0,2,3,1]):t))}function q3(t,e){return H(()=>(Jt(e),e==="channelsFirst"?Je(t,[0,2,3,4,1]):t))}function Sae(t,e,n,s=1,r="valid",i,o=1){return H(()=>{if(i==null&&(i=qr()),Jt(i),t.shape.length!==3)throw new O(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new O(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new O(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(i==="channelsFirst"&&(t=Je(t,[0,2,1])),r==="causal")throw new ze("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=kM(t,e,s,r==="same"?"same":"valid","NWC",o);return n!=null&&(a=Yr(a,n)),a})}function g$(t,e,n,s=[1,1],r="valid",i,o,a=null){return H(()=>{if(i==null&&(i=qr()),Jt(i),t.rank!==3&&t.rank!==4)throw new O(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new O(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=MI(t,i);if(r==="causal")throw new ze("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=Rne({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(l=Je(l,[0,3,1,2])),l})}function Iae(t,e,n,s=[1,1,1],r="valid",i,o){return H(()=>{if(i==null&&(i=qr()),Jt(i),t.rank!==4&&t.rank!==5)throw new O(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new O(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=q3(t,i);if(r==="causal")throw new ze("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=RQ(a,e,s,r==="same"?"same":"valid","NDHWC",o),n!=null&&(a=Yr(a,n)),i==="channelsFirst"&&(a=Je(a,[0,4,1,2,3])),a})}class D0 extends Ke{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",D0.verifyArgs(n),this.rank=e,wn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new ze(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=ou(n.kernelSize,e,"kernelSize"),this.strides=ou(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Zs(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Jt(this.dataFormat),this.activation=ba(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=Dt(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=fn(n.biasConstraint),this.biasRegularizer=Pt(n.biasRegularizer),this.activityRegularizer=Pt(n.activityRegularizer),this.dilationRate=ou(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new O(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new O(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new O(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(oi("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!CI(e.kernelSize,"number",1,3))throw new O(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:va(this.activation),useBias:this.useBias,biasInitializer:Mt(this.biasInitializer),biasRegularizer:yt(this.biasRegularizer),activityRegularizer:yt(this.activityRegularizer),biasConstraint:hn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Ju extends D0{constructor(e,n){super(e,n),this.kernel=null,Ju.verifyArgs(n),this.filters=n.filters,wn(this.filters,"filters"),this.kernelInitializer=Dt(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=fn(n.kernelConstraint),this.kernelRegularizer=Pt(n.kernelRegularizer)}build(e){e=nt(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new O(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return H(()=>{e=De(e);let s;const r=this.bias==null?null:this.bias.read(),i=jL(this.activation.getClassName());if(i!=null&&this.rank===2)s=g$(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)s=Sae(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=g$(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=Iae(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new ze("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=nt(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<s.length;++i){const o=jr(s[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(o)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:Mt(this.kernelInitializer),kernelRegularizer:yt(this.kernelRegularizer),kernelConstraint:hn(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new O(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Bp extends Ju{constructor(e){super(2,e),Bp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!CI(e.kernelSize,"number",1,2))throw new O(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Bp.className="Conv2D";ne(Bp);class zp extends Ju{constructor(e){super(3,e),zp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new O(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}zp.className="Conv3D";ne(zp);class K3 extends Bp{constructor(e){if(super(e),this.inputSpec=[new dn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new O(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=nt(e),e.length!==4)throw new O("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new O("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new dn({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return H(()=>{let s=De(e);if(s.shape.length!==4)throw new O(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=r[o],c=r[a],u=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],f=this.strides[1],p=ai(l,h,u,this.padding),m=ai(c,f,d,this.padding),y=[i,p,m,this.filters];this.dataFormat!=="channelsLast"&&(s=Je(s,[0,2,3,1]));let g=CM(s,this.kernel.read(),y,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(g=Je(g,[0,3,1,2])),this.bias!=null&&(g=Yr(g,this.bias.read(),this.dataFormat)),this.activation!=null&&(g=this.activation.apply(g)),g})}computeOutputShape(e){e=nt(e);const n=e.slice();let s,r,i;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3):(s=3,r=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[r]=ai(n[r],l,o,this.padding),n[i]=ai(n[i],c,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}K3.className="Conv2DTranspose";ne(K3);class X3 extends zp{constructor(e){if(super(e),this.inputSpec=[new dn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new O(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=nt(e),e.length!==5)throw new O("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new O("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new dn({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return H(()=>{let s=De(e);if(s.shape.length!==5)throw new O(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const c=r[l],u=r[o],d=r[a],h=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],y=this.strides[1],g=this.strides[2],x=ai(c,m,h,this.padding),v=ai(u,y,f,this.padding),b=ai(d,g,p,this.padding),k=[i,x,v,b,this.filters];this.dataFormat!=="channelsLast"&&(s=Je(s,[0,2,3,4,1]));let C=OQ(s,this.kernel.read(),k,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(C=Je(C,[0,4,1,2,3])),this.bias!==null&&(C=Yr(C,this.bias.read(),this.dataFormat)),this.activation!==null&&(C=this.activation.apply(C)),C})}computeOutputShape(e){e=nt(e);const n=e.slice();let s,r,i,o;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3,o=4):(s=4,r=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],d=this.strides[1],h=this.strides[2];return n[s]=this.filters,n[r]=ai(n[r],u,a,this.padding),n[i]=ai(n[i],d,l,this.padding),n[o]=ai(n[o],h,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}X3.className="Conv3DTranspose";ne(X3);class Y3 extends Ju{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new O("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new O("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new O(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=Dt(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Pt(n.depthwiseRegularizer),this.depthwiseConstraint=fn(n.depthwiseConstraint),this.pointwiseInitializer=Dt(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Pt(n.pointwiseRegularizer),this.pointwiseConstraint=fn(n.pointwiseConstraint)}build(e){if(e=nt(e),e.length<this.rank+2)throw new O(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new O(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(s*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new dn({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return H(()=>{e=De(e);let s;if(this.rank===1)throw new ze("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Je(e,[0,2,3,1])),s=jM(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Yr(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=Je(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Mt(this.depthwiseInitializer),e.pointwiseInitializer=Mt(this.pointwiseInitializer),e.depthwiseRegularizer=yt(this.depthwiseRegularizer),e.pointwiseRegularizer=yt(this.pointwiseRegularizer),e.depthwiseConstraint=hn(this.depthwiseConstraint),e.pointwiseConstraint=hn(this.pointwiseConstraint),e}}Y3.className="SeparableConv";class Z3 extends Y3{constructor(e){super(2,e)}}Z3.className="SeparableConv2D";ne(Z3);class P0 extends Ju{constructor(e){super(1,e),P0.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!CI(e.kernelSize,"number",1,1))throw new O(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}P0.className="Conv1D";ne(P0);class J3 extends Ke{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return H(()=>{if(e=De(e),this.dataFormat==="channelsLast"){const s=Sm(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Sm(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=Sm(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Sm(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}J3.className="Cropping2D";ne(J3);class Q3 extends Ke{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Jt(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,eoe(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return H(()=>{let s=De(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=Je(s,[0,2,3,1]);const i=this.size[0]*r[2],o=this.size[1]*r[3],a=this.interpolation==="nearest"?Xi.resizeNearestNeighbor(s,[i,o]):Xi.resizeBilinear(s,[i,o]);return Je(a,[0,3,1,2])}else{const i=this.size[0]*r[1],o=this.size[1]*r[2];return this.interpolation==="nearest"?Xi.resizeNearestNeighbor(s,[i,o]):Xi.resizeBilinear(s,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}Q3.className="UpSampling2D";ne(Q3);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Tae(t,e,n=[1,1],s="valid",r,i){return H(()=>{r==null&&(r=qr()),Jt(r);let o=MI(t,r);if(t.rank!==4)throw new O(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new O(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=vS(o,e,n,s==="same"?"same":"valid","NHWC",i),r==="channelsFirst"&&(o=Je(o,[0,3,1,2])),o})}class e4 extends D0{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Dt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=fn(e.depthwiseConstraint),this.depthwiseRegularizer=Pt(e.depthwiseRegularizer)}build(e){if(e=nt(e),e.length<4)throw new O(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new O(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return H(()=>{e=De(e);let s=Tae(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Yr(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=nt(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=jr(n,this.kernelSize[0],this.padding,this.strides[0]),o=jr(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,i,o]:[e[0],i,o,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Mt(this.depthwiseInitializer),e.depthwiseRegularizer=yt(this.depthwiseRegularizer),e.depthwiseConstraint=hn(this.depthwiseRegularizer),e}}e4.className="DepthwiseConv2D";ne(e4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function t4(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new O("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(i){return i==null||Array.isArray(i)?i:[i]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function n4(t,e,n,s=!1,r,i,o=!1,a=!1){return H(()=>{const l=e.shape.length;if(l<3)throw new O(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(Hr(2,l));e=Je(e,c),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=xe(xe(r,"bool"),"float32"),r.rank===l-1&&(r=cs(r,-1)),r=Je(r,c)),s&&(e=jl(e,0),r!=null&&(r=jl(r,0)));const u=[];let d,h=n;const f=e.shape[0],p=Wl(e);let m;r!=null&&(m=Wl(r));for(let g=0;g<f;++g){const x=p[g],v=H(()=>t(x,h));if(r==null)d=v[0],h=v[1];else{const b=H(()=>{const k=m[g],C=Ae(vr(k),k),S=re(F(v[0],k),F(h[0],C)),I=h.map((N,E)=>re(F(v[1][E],k),F(N,C)));return{output:S,newStates:I}});d=b.output,h=b.newStates}a&&u.push(d)}let y;return a&&(y=ho(u,1)),[d,y,h]})}class Va extends Ke{constructor(e){super(e);let n;if(e.cell==null)throw new O("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new BI({cells:e.cell}):n=e.cell,n.stateSize==null)throw new O("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new dn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Hr(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){f1(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const i=[];for(const o of n)i.push([e[0],o]);return[r].concat(i)}else return r}computeMask(e,n){return H(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(i=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new ze("Constants support is not implemented in RNN yet.");f1(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new dn({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!at(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new O(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new dn({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){H(()=>{if(!this.stateful)throw new ii("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new O("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>vn([s,r])):this.states_=[vn([s,this.cell.stateSize])];else if(e==null)We(this.states_),this.keptStates!=null&&(We(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>vn([s,r])):this.states_[0]=vn([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new O(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):We(this.states_);for(let r=0;r<this.states_.length;++r){const i=e[r],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,o];if(!at(i.shape,a))throw new O(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[r]=i}}this.states_=this.states_.map(r=>vi(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=t4(e,s,r,this.numConstants);e=i.inputs,s=i.initialState,r=i.constants;let o=[],a=[];if(s!=null){n.initialState=s,o=o.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new dn({shape:c.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(n.constants=r,o=o.concat(r),this.numConstants=r.length),o[0]instanceof Ai){const c=[e].concat(o),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return H(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let i=n==null?null:n.initialState;e=De(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new O(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},c=n4((p,m)=>{const y=this.cell.call([p].concat(m),a);return[y[0],y.slice(1)]},e,i,this.goBackwards,s,null,this.unroll,this.returnSequences),u=c[0],d=c[1],h=c[2];this.stateful&&this.resetStates(h,r);const f=this.returnSequences?d:u;return this.returnState?[f].concat(h):f})}getInitialState(e){return H(()=>{let n=vn(e.shape);return n=$e(n,[1,2]),n=Op(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?d1(n,[1,s]):n):this.cell.stateSize>1?[d1(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===Va.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const r=n.cell,i=Zi(r,s);return new e(Object.assign(n,{cell:i}))}}Va.className="RNN";ne(Va);class O0 extends Ke{}class LI extends O0{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,wn(this.units,"units"),this.activation=ba(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Dt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Dt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Dt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Pt(e.kernelRegularizer),this.recurrentRegularizer=Pt(e.recurrentRegularizer),this.biasRegularizer=Pt(e.biasRegularizer),this.kernelConstraint=fn(e.kernelConstraint),this.recurrentConstraint=fn(e.recurrentConstraint),this.biasConstraint=fn(e.biasConstraint),this.dropout=Iu([1,xa([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Iu([1,xa([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=nt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return H(()=>{if(e=e,e.length!==2)throw new O(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=wa({ones:()=>vr(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=wa({ones:()=>vr(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=ki(F(e,o),this.kernel.read()):i=ki(e,this.kernel.read()),this.bias!=null&&(i=Yr(i,this.bias.read())),a!=null&&(s=F(s,a));let l=re(i,ki(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:va(this.activation),useBias:this.useBias,kernelInitializer:Mt(this.kernelInitializer),recurrentInitializer:Mt(this.recurrentInitializer),biasInitializer:Mt(this.biasInitializer),kernelRegularizer:yt(this.kernelRegularizer),recurrentRegularizer:yt(this.recurrentRegularizer),biasRegularizer:yt(this.biasRegularizer),activityRegularizer:yt(this.activityRegularizer),kernelConstraint:hn(this.kernelConstraint),recurrentConstraint:hn(this.recurrentConstraint),biasConstraint:hn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}LI.className="SimpleRNNCell";ne(LI);class s4 extends Va{constructor(e){e.cell=new LI(e),super(e)}call(e,n){return H(()=>{this.cell.dropoutMask!=null&&(We(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(We(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return new e(n)}}s4.className="SimpleRNN";ne(s4);class VI extends O0{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new O("GRUCell does not support reset_after parameter set to true.");this.units=e.units,wn(this.units,"units"),this.activation=ba(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ba(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Dt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Dt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Dt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Pt(e.kernelRegularizer),this.recurrentRegularizer=Pt(e.recurrentRegularizer),this.biasRegularizer=Pt(e.biasRegularizer),this.kernelConstraint=fn(e.kernelConstraint),this.recurrentConstraint=fn(e.recurrentConstraint),this.biasConstraint=fn(e.biasConstraint),this.dropout=Iu([1,xa([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Iu([1,xa([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=nt(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return H(()=>{if(e=e,e.length!==2)throw new O(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=wa({ones:()=>vr(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=wa({ones:()=>vr(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=F(e,i[0]));let u=ki(e,this.kernel.read());this.useBias&&(u=Yr(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=F(r,o[0]));const d=this.recurrentKernel.read(),[h,f]=js(d,[2*this.units,this.units],d.rank-1),p=ki(r,h),[m,y,g]=js(u,3,u.rank-1),[x,v]=js(p,2,p.rank-1);a=this.recurrentActivation.apply(re(m,x)),l=this.recurrentActivation.apply(re(y,v));const b=ki(F(l,r),f);c=this.activation.apply(re(g,b));const k=re(F(a,r),F(re(1,Kt(a)),c));return[k,k]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:va(this.activation),recurrentActivation:va(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Mt(this.kernelInitializer),recurrentInitializer:Mt(this.recurrentInitializer),biasInitializer:Mt(this.biasInitializer),kernelRegularizer:yt(this.kernelRegularizer),recurrentRegularizer:yt(this.recurrentRegularizer),biasRegularizer:yt(this.biasRegularizer),activityRegularizer:yt(this.activityRegularizer),kernelConstraint:hn(this.kernelConstraint),recurrentConstraint:hn(this.recurrentConstraint),biasConstraint:hn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}VI.className="GRUCell";ne(VI);class r4 extends Va{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new VI(e),super(e)}call(e,n){return H(()=>{this.cell.dropoutMask!=null&&(We(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(We(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}r4.className="GRU";ne(r4);class F0 extends O0{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,wn(this.units,"units"),this.activation=ba(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ba(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Dt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Dt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Dt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Pt(e.kernelRegularizer),this.recurrentRegularizer=Pt(e.recurrentRegularizer),this.biasRegularizer=Pt(e.biasRegularizer),this.kernelConstraint=fn(e.kernelConstraint),this.recurrentConstraint=fn(e.recurrentConstraint),this.biasConstraint=fn(e.biasConstraint),this.dropout=Iu([1,xa([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Iu([1,xa([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=nt(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;r=new(n=class extends wr{apply(l,c){const u=i.apply([o]),d=new II().apply([o]),h=i.apply([o*2]);return QE(QE(u,d),h)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return H(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new O(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=wa({ones:()=>vr(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=wa({ones:()=>vr(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,d;0<this.dropout&&this.dropout<1&&(e=F(e,o[0]));let h=ki(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=F(r,a[0])),h=re(h,ki(r,this.recurrentKernel.read())),this.useBias&&(h=Yr(h,this.bias.read()));const[f,p,m,y]=js(h,4,h.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=re(F(c,i),F(l,this.activation.apply(m))),d=this.recurrentActivation.apply(y);const g=F(d,this.activation.apply(u));return[g,g,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:va(this.activation),recurrentActivation:va(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Mt(this.kernelInitializer),recurrentInitializer:Mt(this.recurrentInitializer),biasInitializer:Mt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:yt(this.kernelRegularizer),recurrentRegularizer:yt(this.recurrentRegularizer),biasRegularizer:yt(this.biasRegularizer),activityRegularizer:yt(this.activityRegularizer),kernelConstraint:hn(this.kernelConstraint),recurrentConstraint:hn(this.recurrentConstraint),biasConstraint:hn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}F0.className="LSTMCell";ne(F0);class i4 extends Va{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new F0(e),super(e)}call(e,n){return H(()=>{this.cell.dropoutMask!=null&&(We(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(We(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}i4.className="LSTM";ne(i4);class BI extends O0{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return H(()=>{e=e;let s=e.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?o=[e[0]].concat(s):o=[o[0]].concat(s),o=l.call(o,n),i.push(o.slice(1))}s=[];for(const a of i.slice().reverse())s.push(...a);return[o[0]].concat(s)})}build(e){f1(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{xl(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,n,s={}){const r=[];for(const i of n.cells)r.push(Zi(i,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return p1(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,i=e.splice(r);for(let o=0;o<s.weights.length;++o)n.push([s.weights[o],i[o]])}RI(n)}}BI.className="StackedRNNCells";ne(BI);function wa(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:i}=t,o=()=>i!=null?i(e(),n):YL(e(),n),a=()=>Mp(o,e,s);return!r||r<=1?vi(a().clone()):Array(r).fill(void 0).map(a).map(c=>vi(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Nae=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class o4 extends Va{constructor(e){if(e.unroll)throw new ze("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new ze("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new dn({ndim:5})]}call(e,n){return H(()=>{if(this.cell.dropoutMask!=null&&(We(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(We(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new O("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return H(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)],o=vn(i);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(e,n=!1){H(()=>{if(!this.stateful)throw new ii("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)];if(s[0]==null)throw new O("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>vn(i)):this.states_=[vn(i)];else if(e==null)We(this.states_),this.keptStates!=null&&(We(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>vn(i)):this.states_[0]=vn(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new O(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):We(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=i;if(!at(l.shape,c))throw new O(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>vi(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:i,strides:o,dilationRate:a}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],d=jr(c,r[0],i,o[0],a[0]),h=jr(u,r[1],i,o[1],a[1]);return[...e.slice(0,2),...l?[s,d,h]:[d,h,s]]}}o4.className="ConvRNN2D";class zI extends F0{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,wn(this.filters,"filters"),this.kernelSize=ou(s,2,"kernelSize"),this.kernelSize.forEach(l=>wn(l,"kernelSize")),this.strides=ou(r||1,2,"strides"),this.strides.forEach(l=>wn(l,"strides")),this.padding=i||"valid",Zs(this.padding),this.dataFormat=o||"channelsLast",Jt(this.dataFormat),this.dilationRate=ou(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>wn(l,"dilationRate"))}build(e){var n;e=nt(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new O(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],i=4,o=this.kernelSize.concat([r,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends wr{apply(h,f){const p=c.apply([u]),m=Ma([u]),y=c.apply([u*2]);return SI([p,m,y])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return H(()=>{if(e.length!==3)throw new O(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=wa({ones:()=>vr(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(P,X,te)=>!X||!X[te]?P:F(X[te],P);let u=c(r,l,0),d=c(r,l,1),h=c(r,l,2),f=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=wa({ones:()=>vr(i),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=c(i,p,0),y=c(i,p,1),g=c(i,p,2),x=c(i,p,3);const v=3,[b,k,C,S]=js(this.kernel.read(),a,v),[I,N,E,D]=this.useBias?js(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,b,I,this.padding),d=this.inputConv(d,k,N,this.padding),h=this.inputConv(h,C,E,this.padding),f=this.inputConv(f,S,D,this.padding);const[R,L,B,W]=js(this.recurrentKernel.read(),a,v);m=this.recurrentConv(m,R),y=this.recurrentConv(y,L),g=this.recurrentConv(g,B),x=this.recurrentConv(x,W);const G=this.recurrentActivation.apply(re(u,m)),q=this.recurrentActivation.apply(re(d,y)),A=re(F(q,o),F(G,this.activation.apply(re(h,g)))),z=F(this.recurrentActivation.apply(re(f,x)),this.activation.apply(A));return[z,z,A]})}getConfig(){const e=super.getConfig(),{units:n}=e,s=Nae(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},s),r)}inputConv(e,n,s,r){const i=zl(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?Yr(i,s,this.dataFormat):i}recurrentConv(e,n){return zl(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}zI.className="ConvLSTM2DCell";ne(zI);class a4 extends o4{constructor(e){const n=new zI(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}a4.className="ConvLSTM2D";ne(a4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class M0 extends Ke{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return H(()=>{this.invokeCallHook(e,n);const s=De(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,i=this.getNoiseShape(s);return Mp(()=>YL(s,this.rate,i,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}M0.className="Dropout";ne(M0);class l4 extends M0{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}l4.className="SpatialDropout1D";ne(l4);class UI extends Ke{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,wn(this.units,"units"),this.activation=ba(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Dt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Dt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=fn(e.kernelConstraint),this.biasConstraint=fn(e.biasConstraint),this.kernelRegularizer=Pt(e.kernelRegularizer),this.biasRegularizer=Pt(e.biasRegularizer),this.activityRegularizer=Pt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=nt(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=nt(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return H(()=>{this.invokeCallHook(e,n);const s=De(e),r=jL(this.activation.getClassName());let i;return r!=null?i=ki(s,this.kernel.read(),r,this.bias?this.bias.read():null):(i=ki(s,this.kernel.read()),this.bias!=null&&(i=Yr(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:va(this.activation),useBias:this.useBias,kernelInitializer:Mt(this.kernelInitializer),biasInitializer:Mt(this.biasInitializer),kernelRegularizer:yt(this.kernelRegularizer),biasRegularizer:yt(this.biasRegularizer),activityRegularizer:yt(this.activityRegularizer),kernelConstraint:hn(this.kernelConstraint),biasConstraint:hn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}UI.className="Dense";ne(UI);class c4 extends Ke{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=nt(e);for(const n of e.slice(1))if(n==null)throw new O(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],ua(e,1)]}call(e,n){return H(()=>{this.invokeCallHook(e,n);let s=De(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let i=2;i<s.rank;++i)r.push(i);r.push(1),s=Je(s,r)}return ooe(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}c4.className="Flatten";ne(c4);class u4 extends Ke{constructor(e){super(e),this.supportsMasking=!0,this.activation=ba(e.activation)}call(e,n){return H(()=>{this.invokeCallHook(e,n);const s=De(e);return this.activation.apply(s)})}getConfig(){const e={activation:va(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}u4.className="Activation";ne(u4);class d4 extends Ke{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return H(()=>(e=De(e),roe(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}d4.className="RepeatVector";ne(d4);class h4 extends Ke{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let i=1,o=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(o===null)o=l;else throw new O("Can only specifiy one unknown dimension.");else i*=c}const a=ua(e);if(o!==null){if(i===0||a%i!==0)throw new O(s);r[o]=a/i}else if(a!==i)throw new O(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return H(()=>{this.invokeCallHook(e,n);const s=De(e),r=s.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return U(s,i)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}h4.className="Reshape";ne(h4);class f4 extends Ke{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=Hr(1,e.dims.length+1);if(!at(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new dn({ndim:this.dims.length+1})]}computeOutputShape(e){e=nt(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return Je(De(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}f4.className="Permute";ne(f4);class p4 extends Ke{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=De(e);return r1(dy(s,this.maskValue),-1)}call(e,n){return H(()=>{this.invokeCallHook(e,n);const s=De(e),o=r1(dy(s,this.maskValue),-1,!0);return F(s,xe(o,s.dtype))})}}p4.className="Masking";ne(p4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class m4 extends Ke{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(ut(e.inputLength))}this.inputDim=e.inputDim,wn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,wn(this.outputDim,"outputDim"),this.embeddingsInitializer=Dt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Pt(e.embeddingsRegularizer),this.activityRegularizer=Pt(e.activityRegularizer),this.embeddingsConstraint=fn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return H(()=>this.maskZero?(e=De(e),dy(e,Qe(e))):null)}computeOutputShape(e){if(e=nt(e),this.inputLength==null)return[...e,this.outputDim];const n=ut(this.inputLength);if(n.length!==e.length-1)throw new O(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const i=n[r],o=e[r+1];if(i!=null&&o!=null&&i!==o)throw new O(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(n[s]=o),s++}}return[e[0],...n,this.outputDim]}call(e,n){return H(()=>{this.invokeCallHook(e,n);let s=De(e);s.dtype!=="int32"&&(s=wi(s,"int32"));const r=XL(this.embeddings.read(),U(s,[s.size]));return U(r,nt(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Mt(this.embeddingsInitializer),embeddingsRegularizer:yt(this.embeddingsRegularizer),activityRegularizer:yt(this.activityRegularizer),embeddingsConstraint:hn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}m4.className="Embedding";ne(m4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cc extends Ke{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new ze}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const i=e[e.length-n.length+r],o=n[r];if(i==null||o==null||i<0||o<0)s.push(null);else if(i===1)s.push(o);else if(o===1)s.push(i);else{if(i!==o)throw new O("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(i)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[nt(e)]),e=e,e.length<2)throw new O(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const i of e)i!=null&&i[0]!==null&&n.push(i[0]);if(n=ca(n),n.length>1)throw new O(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);s=this.computeElementwiseOpOutputShape(s,o)}const r=e.map(i=>i.length);e.indexOf(null)===-1&&ca(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return H(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(i=>i.rank);if(r.indexOf(null)===-1){const i=xa(r);for(let o of e){const a=o.rank;for(let l=0;l<i-a;++l)o=Op(o,1);s.push(o)}return this.mergeFunction(s)}else{let i=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,d=u[0],h=u.slice(1).concat([d]);let f=U(l,[d].concat(ua(u.slice(1))));f=Je(f,[1,0]),f=U(f,h),s.push(f),i=!0}else if(c>1){const u=Hr(1,c).concat([0]);s.push(Je(l,u)),i=!0}else s.push(l)}let o=this.mergeFunction(s);const a=o.rank;if(i){if(a==null){const l=o.shape,c=l.length,u=l[c-1],d=[u].concat(l.slice(0,l.length-1));o=U(Je(U(o,[-1,u]),[1,0]),d)}else if(a>1){const l=[a-1].concat(Hr(0,a-1));o=Je(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const i=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=ca(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return H(()=>{if(n==null)return null;if(!Array.isArray(n))throw new O("`mask` should be an Array");if(!Array.isArray(e))throw new O("`inputs` should be an Array");if(n.length!==e.length)throw new O(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:cs(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=uo(s,n[r]);return s})}}class g4 extends cc{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=re(n,e[s]);return n})}}g4.className="Add";ne(g4);class y4 extends cc{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=F(n,e[s]);return n})}}y4.className="Multiply";ne(y4);class x4 extends cc{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=re(n,e[s]);return F(1/e.length,n)})}}x4.className="Average";ne(x4);class v4 extends cc{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Fa(n,e[s]);return n})}}v4.className="Maximum";ne(v4);class b4 extends cc{constructor(e){super(e)}mergeFunction(e){return H(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Zh(n,e[s]);return n})}}b4.className="Minimum";ne(b4);class w4 extends cc{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new O("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const i=e[r].slice();i.splice(this.axis,1);let o=!1;for(const a of s)if(at(a,i)){o=!0;break}o||s.push(i)}if(s.length>1)throw new O("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return H(()=>SI(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new O("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const i of n.slice(1)){if(s[r]==null||i[r]==null){s[r]=null;break}s[r]+=i[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new O("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new O("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new O(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return H(()=>{let s=!0;if(n.forEach(o=>{if(o!=null){s=!1;return}}),s)return null;const r=[];for(let o=0;o<e.length;++o)n[o]==null?r.push(xe(vr(e[o]),"bool")):n[o].rank<e[o].rank?r.push(cs(n[o],-1)):r.push(n[o]);const i=hs(r,this.axis);return wM(i,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}w4.className="Concatenate";ne(w4);function Nd(t,e){for(;t<0;)t+=e;return t}function Eae(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new ze("batchDot is not implemented for tensors of 4D or higher rank yet");if(T(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),T(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new ze("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const i=n;return H(()=>{let o;if(s>r){o=s-r;const l=[];for(let c=0;c<o;++c)l.push(1);e=U(e,e.shape.concat(l))}else if(r>s){o=r-s;const l=[];for(let c=0;c<o;++c)l.push(1);t=U(t,t.shape.concat(l))}else o=0;let a;if(t.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=$e(F(t,e),i[0]):a=$e(F(Je(t,[1,0]),e),i[1]);else{const l=i[0]!==t.shape.length-1,c=i[1]===e.shape.length-1;a=it(t,e,l,c)}if(o>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let u=l;u<l+o;++u)c.push(u);a=$p(a,c)}return a.shape.length===1&&(a=cs(a,1)),a})}class k4 extends cc{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){T(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new ze("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new O(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new O(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((i,o)=>Nd(i,e[o].shape.length)):r=[Nd(this.axes,n.shape.length),Nd(this.axes,s.shape.length)],this.normalize&&(n=xy(n,r[0]),s=xy(s,r[1])),Eae(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[Nd(this.axes,e.length),Nd(this.axes,n.length)],s}computeOutputShape(e){T(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new ze("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const i=n.concat(s);return i.length===1&&i.push(1),i}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}k4.className="Dot";ne(k4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class C4 extends Ke{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return H(()=>{this.invokeCallHook(e,n);const s=De(e);return Mp(()=>re($0(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}C4.className="GaussianNoise";ne(C4);class S4 extends Ke{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return H(()=>{this.invokeCallHook(e,n);const s=De(e);return this.rate>0&&this.rate<1?Mp(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return F(s,$0(s.shape,1,i))},()=>s,n.training||!1):s})}}S4.className="GaussianDropout";ne(S4);class I4 extends Ke{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||De(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return H(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return Mp(()=>{const i=De(e),a=-1.6732632423543772*1.0507009873554805;let l=rc(Ep(s),this.rate);l=wi(l,"float32");const c=((1-this.rate)*(1+this.rate*a**2))**-.5,u=-c*a*this.rate,d=re(F(i,l),F(re(l,-1),a));return re(F(d,c),u)},()=>De(e),n.training||!1)}return e})}}I4.className="AlphaDropout";ne(I4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tf(t,e,n,s,r,i=.001){let o;if(t.rank===2)o=lQ(t,e,n,s,r,i);else if(t.rank===3)o=uQ(t,e,n,s,r,i);else if(t.rank===4)o=hQ(t,e,n,s,r,i);else throw new ze(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return o}function $ae(t,e,n,s,r=.001){return H(()=>{const i=TS(t,s),o=i.mean,a=i.variance;return[tf(t,o,a,n,e,r),o,a]})}function _ae(t,e,n,s,r=.001){return H(()=>{const i=TS(t,s),o=i.mean,a=i.variance,l=[];for(const p of Hr(0,t.rank))s.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const c=U(o,l),u=U(a,l),d=e==null?null:U(e,l),h=n==null?null:U(n,l);return[tf(t,c,u,h,d,r),o,a]})}function Aae(t,e,n,s,r=.001){return at(s.slice().sort(),Hr(0,t.rank-1))?$ae(t,e,n,s,r):_ae(t,e,n,s,r)}class T4 extends Ke{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Dt(e.betaInitializer||"zeros"),this.gammaInitializer=Dt(e.gammaInitializer||"ones"),this.movingMeanInitializer=Dt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Dt(e.movingVarianceInitializer||"ones"),this.betaConstraint=fn(e.betaConstraint),this.gammaConstraint=fn(e.gammaConstraint),this.betaRegularizer=Pt(e.betaRegularizer),this.gammaRegularizer=Pt(e.gammaRegularizer)}build(e){e=nt(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new O(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new dn({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return H(()=>{const s=n.training==null?!1:n.training,r=De(e),i=r.shape,o=i.length,a=Hr(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const c=Gl(1,o);c[l]=i[l];const u=a.slice();u.sort();const d=!at(u,Hr(0,o).slice(0,o-1)),h=()=>{if(d){const x=U(this.movingMean.read(),c),v=U(this.movingVariance.read(),c),b=this.center?U(this.beta.read(),c):null,k=this.scale?U(this.gamma.read(),c):null;return tf(r,x,v,b,k,this.epsilon)}else return tf(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return h();const[f,p,m]=Aae(r,this.gamma.read(),this.beta.read(),a,this.epsilon),y=(x,v,b)=>{H(()=>{const k=1-b,C=x.read(),S=F(Ae(C,v),k);x.write(Ae(C,S))})};return(()=>{y(this.movingMean,p,this.momentum),y(this.movingVariance,m,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Mt(this.betaInitializer),gammaInitializer:Mt(this.gammaInitializer),movingMeanInitializer:Mt(this.movingMeanInitializer),movingVarianceInitializer:Mt(this.movingVarianceInitializer),betaRegularizer:yt(this.betaRegularizer),gammaRegularizer:yt(this.gammaRegularizer),betaConstraint:hn(this.betaConstraint),gammaConstraint:hn(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}T4.className="BatchNormalization";ne(T4);class N4 extends Ke{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Dt(e.betaInitializer||"zeros"),this.gammaInitializer=Dt(e.gammaInitializer||"ones"),this.betaRegularizer=Pt(e.betaRegularizer),this.gammaRegularizer=Pt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=nt(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==ca(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(i=>e[i]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=De(e),r=s.shape,i=r.length;return H(()=>{let{mean:a,variance:l}=TS(s,this.axis,!0);const c=Gl(1,i);for(const m of this.axis)c[m]=r[m];const u=m=>m!=null&&m.shape.length!==i?U(m,c):m;let d=this.scale?u(this.gamma.read()):null,h=this.center?u(this.beta.read()):null;const f=[],p=[];for(let m=0;m<i;++m)this.axis.indexOf(m)!==-1?(f.push(r[m]),p.push(1)):(f.push(1),p.push(r[m]));return a=Mr(a,f),l=Mr(l,f),d!=null&&(d=Mr(d,p)),h!=null&&(h=Mr(h,p)),tf(s,a,l,h,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Mt(this.betaInitializer),gammaInitializer:Mt(this.gammaInitializer),betaRegularizer:yt(this.betaRegularizer),gammaRegularizer:yt(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}N4.className="LayerNormalization";ne(N4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rae(t,e,n){return H(()=>{if(t.rank!==4)throw new O(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new O("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=qr()),n!=="channelsLast"&&n!=="channelsFirst")throw new O(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],NS(t,s)})}class E4 extends Ke{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?qr():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new O(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new O(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new O(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new dn({ndim:4})]}computeOutputShape(e){e=nt(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return H(()=>Rae(De(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}E4.className="ZeroPadding2D";ne(E4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function L0(t,e,n,s,r,i){return H(()=>{Jt(r),GL(i),Zs(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=qr()),i==null&&(i="max"),t=MI(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=IS(t,e,n,a):o=mS(t,e,n,a),r==="channelsFirst"&&(o=Je(o,[0,3,1,2])),o})}function $4(t,e,n,s,r,i){return H(()=>{Jt(r),GL(i),Zs(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=qr()),i==null&&(i="max"),t=q3(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=Yee(t,e,n,a):o=JJ(t,e,n,a),r==="channelsFirst"&&(o=Je(o,[0,4,1,2,3])),o})}class _4 extends Ke{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new O(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(wn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new O(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);wn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Zs(this.padding),this.inputSpec=[new dn({ndim:3})]}computeOutputShape(e){e=nt(e);const n=jr(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return H(()=>{this.invokeCallHook(e,n),e=Op(De(e),2);const s=this.poolingFunction(De(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return $p(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class A4 extends _4{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Jt(i),Zs(r),L0(e,n,s,r,i,"max")}}A4.className="MaxPooling1D";ne(A4);class R4 extends _4{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Jt(i),Zs(r),L0(e,n,s,r,i,"avg")}}R4.className="AveragePooling1D";ne(R4);class D4 extends Ke{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new O(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];wn(this.poolSize,"poolSize"),wn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Jt(this.dataFormat),Zs(this.padding),this.inputSpec=[new dn({ndim:4})]}computeOutputShape(e){e=nt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=jr(n,this.poolSize[0],this.padding,this.strides[0]),s=jr(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return H(()=>(this.invokeCallHook(e,n),this.poolingFunction(De(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class P4 extends D4{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Jt(i),Zs(r),L0(e,n,s,r,i,"max")}}P4.className="MaxPooling2D";ne(P4);class O4 extends D4{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Jt(i),Zs(r),L0(e,n,s,r,i,"avg")}}O4.className="AveragePooling2D";ne(O4);class F4 extends Ke{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new O(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];wn(this.poolSize,"poolSize"),wn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Jt(this.dataFormat),Zs(this.padding),this.inputSpec=[new dn({ndim:5})]}computeOutputShape(e){e=nt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=jr(n,this.poolSize[0],this.padding,this.strides[0]),s=jr(s,this.poolSize[1],this.padding,this.strides[1]),r=jr(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return H(()=>(this.invokeCallHook(e,n),this.poolingFunction(De(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class M4 extends F4{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Jt(i),Zs(r),$4(e,n,s,r,i,"max")}}M4.className="MaxPooling3D";ne(M4);class L4 extends F4{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return Jt(i),Zs(r),$4(e,n,s,r,i,"avg")}}L4.className="AveragePooling3D";ne(L4);class V4 extends Ke{constructor(e){super(e),this.inputSpec=[new dn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new ze}}class B4 extends V4{constructor(e){super(e||{})}call(e,n){return H(()=>{const s=De(e);return nn(s,1)})}}B4.className="GlobalAveragePooling1D";ne(B4);class z4 extends V4{constructor(e){super(e||{})}call(e,n){return H(()=>{const s=De(e);return Ur(s,1)})}}z4.className="GlobalMaxPooling1D";ne(z4);class U4 extends Ke{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Jt(this.dataFormat),this.inputSpec=[new dn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new ze}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class j4 extends U4{call(e,n){return H(()=>{const s=De(e);return this.dataFormat==="channelsLast"?nn(s,[1,2]):nn(s,[2,3])})}}j4.className="GlobalAveragePooling2D";ne(j4);class W4 extends U4{call(e,n){return H(()=>{const s=De(e);return this.dataFormat==="channelsLast"?Ur(s,[1,2]):Ur(s,[2,3])})}}W4.className="GlobalMaxPooling2D";ne(W4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class G4 extends Ke{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,i=Zi(r,s);delete n.layer;const o={layer:i};return Object.assign(o,n),new e(o)}}class H4 extends G4{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=nt(e),e.length<3)throw new O(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=nt(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return H(()=>(e=De(e),n4((o,a)=>[De(this.layer.call(o,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}H4.className="TimeDistributed";ne(H4);function Dae(t){lc(Qie,"BidirectionalMergeMode",t)}const Pae="concat";class q4 extends G4{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=Zi(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=Zi(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?Pae:e.mergeMode,Dae(this.mergeMode),e.weights)throw new ze("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,i;return this.returnState&&(i=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(i).concat(i.slice()):[s].concat(i).concat(i.slice()):us(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=t4(e,s,r,this.numConstants);if(e=i.inputs,s=i.initialState,r=i.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const o=[],a=[];if(s!=null){const c=s.length;if(c%2>0)throw new O("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,o.push(...s);const u=s.map(d=>new dn({shape:d.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(r!=null)throw new ze("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof Ai;for(const c of o)if(c instanceof Ai!==l)throw new O("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(o),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return H(()=>{const s=n.initialState;let r,i;if(s==null)r=this.forwardLayer.call(e,n),i=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let o;this.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=jl(i,1));let a;return this.mergeMode==="concat"?a=SI([r,i]):this.mergeMode==="sum"?a=re(r,i):this.mergeMode==="ave"?a=F(.5,re(r,i)):this.mergeMode==="mul"?a=F(r,i):this.mergeMode==null&&(a=[r,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){xl(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),xl(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(s)?s.concat(i).concat(i):[s].concat(i).concat(i)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=Zi(n.layer);if(delete n.layer,n.numConstants!=null)throw new ze("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}q4.className="Bidirectional";ne(q4);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class K4 extends Ke{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return H(()=>(e=De(e),e.dtype!=="float32"&&(e=wi(e,"float32")),re(F(e,this.scale),this.offset)))}}K4.className="Rescaling";ne(K4);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:Oae,cropAndResize:Fae}=Xi;class X4 extends Ke{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,r,i,o,a,l){return H(()=>{let c,u=!1;const d=n/o,h=s/a,f=(r+n)/o,p=(i+s)/a,m=[d,h,f,p],y=[];e.rank===3?(u=!0,c=ho([e])):c=e;for(let k=0;k<c.shape[0];k++)y.push(m);const g=dM(y,[y.length,4]),x=Jh(0,y.length,1,"int32"),b=Fae(c,g,x,[r,i],"nearest");return wi(u?De(Wl(b)):b,l)})}upsize(e,n,s,r){return H(()=>{const i=Oae(e,[n,s]);return wi(i,r)})}call(e,n){return H(()=>{const s=De(e),r=s.dtype,i=s.shape,o=i[i.length-3],a=i[i.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,o,a,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=nt(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}X4.className="CenterCrop";ne(X4);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Mae(t,e,n,s){let r=De(t);if(r.dtype!=="int32"&&(r=wi(r,"int32")),e==="int")return r;const i=r.shape;if(r.rank===0&&(r=cs(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=cs(r,-1)),r.rank>2)throw new O(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${r.rank}.`);const o=["multiHot","oneHot"].includes(e),a=r;let l;if(typeof s<"u"&&e==="count"?l=LE(a,s,n,o):l=LE(a,[],n,o),e!=="tfIdf")return l;if(s)return F(l,s);throw new O("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Y4 extends Ke{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=nt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return H(()=>{e=De(e),e.dtype!=="int32"&&(e=wi(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new O(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=De(n.countWeights)}const r=Ur(e),i=cy(e),o=Ys(this.numTokens,r).bufferSync().get(0),a=rc(i,0).bufferSync().get(0);if(!(o&&a))throw new O(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return Mae(e,this.outputMode,this.numTokens,s)})}}Y4.className="CategoryEncoding";ne(Y4);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Lae=["bilinear","nearest"],y$=new Set(Lae);class Z4 extends Ke{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(y$.has(e.interpolation))this.interpolation=e.interpolation;else throw new O(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=nt(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return H(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Xi.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Xi.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...y$]} are supported`)})}}Z4.className="Resizing";ne(Z4);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class J4{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}J4.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Q4 extends Ke{constructor(e){super(e),this.randomGenerator=new J4(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}Q4.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Vae=["bilinear","nearest"],x$=new Set(Vae);class eV extends Q4{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new O(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new O(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new O(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(x$.has(s))this.interpolation=s;else throw new O(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=nt(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return H(()=>{const s=De(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=Ep([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*r;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return Xi.resizeBilinear(e,o);case"nearest":return Xi.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...x$]} are supported`)}})}}eV.className="RandomWidth";ne(eV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ab(t){return new UI(t)}function v$(t){return new M0(t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bae=Y();Bae.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var b$;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(b$||(b$={}));var w$;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(w$||(w$={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var k$;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(k$||(k$={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function we(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zae=ZM;class V0 extends xC{nextDataId(){return V0.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new mF(this,ni())}write(e,n,s){this.firstUse&&(this.firstUse=!1,Y().get("IS_NODE")&&Ms(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&_f(s[0])){const i=s.map(o=>la(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,i){this.data.set(e,{values:n,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),i=this.readSync(s.imag.dataId);return fo(r,i)}return hZ(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>ya(r));return He(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return He(e.shape,e.dtype,n)}makeOutput(e,n,s){return ni().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=ls();return e(),{kernelMs:ls()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){we([e],"where");const n=this.readSync(e.dataId);return zae(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}V0.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tV(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const Uae=t=>{const{x:e}=t.inputs,n=t.backend;we(e,"abs");let s=new Float32Array(Q(e.shape));const r=n.data.get(e.dataId).values;return s=tV(r),n.makeOutput(s,e.shape,e.dtype)},jae={kernelName:mx,backendName:"cpu",kernelFunc:Uae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qt(t){return(e,n,s,r,i)=>{const o=Le(e,n),a=o.length,l=Ne(o),c=Q(o),u=Mn(i,c),d=e.length,h=n.length,f=Ne(e),p=Ne(n),m=Cu(e,o),y=Cu(n,o);if(m.length+y.length===0)for(let g=0;g<u.length;++g)u[g]=t(s[g%s.length],r[g%r.length]);else for(let g=0;g<u.length;++g){const x=Gu(g,a,l),v=x.slice(-d);m.forEach(S=>v[S]=0);const b=xi(v,d,f),k=x.slice(-h);y.forEach(S=>k[S]=0);const C=xi(k,h,p);u[g]=t(s[b],r[C])}return[u,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ks(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",i),imag:n.makeTensorInfo(r.shape,"float32",o)},a}const Wae={kernelName:AC,backendName:"cpu",kernelFunc:ks};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cy(t,e,n="float32"){if(n==="complex64"){const r=Cy(t,e,"float32"),i=Cy(t,e,"float32");return ks({inputs:{real:r,imag:i},backend:t})}const s=Ln(Q(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ri(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Gae={kernelName:Zf,backendName:"cpu",kernelFunc:Ri};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hl(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const Hae={kernelName:tS,backendName:"cpu",kernelFunc:Hl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nV(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=sc([0],n),[i,o]=Qt((a,l)=>a!==l?1:0)(e,[],t,r,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function ka(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return Ri({inputs:{x:r},backend:n});const u=Cy(n,r.shape,r.dtype),d=ka({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),h=ks({inputs:{real:d,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),h}if(r.dtype==="complex64"){const u=Hl({inputs:{input:r},backend:n}),d=ka({inputs:{x:u},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(u),d}if(!xF(r.dtype,i)){const u=Ri({inputs:{x:r},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:i}}const o=n.data.get(r.dataId).values,[a,l,c]=nV(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}const qae={kernelName:Lf,backendName:"cpu",kernelFunc:ka};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mn(t,e,n,s){return n==null?({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;we([o,a],t);const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,d=o.dtype==="string"?po(c):c,h=o.dtype==="string"?po(u):u,f=s||o.dtype,[p,m]=e(o.shape,a.shape,d,h,f);return l.makeTensorInfo(m,f,p)}:({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const c=ka({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),d=u.complexTensorInfos.real,h=u.complexTensorInfos.imag,f=l.data.get(d.dataId).values,p=l.data.get(h.dataId).values,m=ka({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),y=l.data.get(m.dataId),g=y.complexTensorInfos.real,x=y.complexTensorInfos.imag,v=l.data.get(g.dataId).values,b=l.data.get(x.dataId).values,[k,C,S]=n(o.shape,a.shape,f,p,v,b),I=l.makeTensorInfo(S,"float32",k),N=l.makeTensorInfo(S,"float32",C),E=ks({inputs:{real:I,imag:N},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(I),l.disposeIntermediateTensorInfo(N),E}else{const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,d=s||o.dtype,[h,f]=e(o.shape,a.shape,c,u,d);return l.makeTensorInfo(f,d,h)}}}function jI(t){return(e,n,s,r,i,o)=>{const a=Le(e,n),l=Q(a),c=a.length,u=Ne(a),d=Mn("float32",l),h=Mn("float32",l),f=Cu(e,a),p=Cu(n,a),m=fo(s,r),y=fo(i,o),g=e.length,x=Ne(e),v=n.length,b=Ne(n);if(f.length+p.length===0)for(let k=0;k<d.length;k++){const C=k%m.length,S=k%y.length,I=t(m[C*2],m[C*2+1],y[S*2],y[S*2+1]);d[k]=I.real,h[k]=I.imag}else for(let k=0;k<d.length;k++){const C=Gu(k,c,u),S=C.slice(-g);f.forEach(R=>S[R]=0);const I=xi(S,g,x),N=C.slice(-v);p.forEach(R=>N[R]=0);const E=xi(N,v,b),D=t(m[I*2],m[I*2+1],y[E*2],y[E*2+1]);d[k]=D.real,h[k]=D.imag}return[d,h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sV=Qt((t,e)=>t+e),Kae=jI((t,e,n,s)=>({real:t+n,imag:e+s})),Nu=mn(Hu,sV,Kae),Xae={kernelName:Hu,backendName:"cpu",kernelFunc:Nu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WI(t,e,n,s,r){const i=Q(s),o=Ln(r,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(i>0?o[l]+=e[a]:o[l]+=1)}return o}function rV(t,e,n,s=!1){const r=t.shape[0],i=t.shape[1],o=He([r,n],e.dtype);for(let a=0;a<r;a++)for(let l=0;l<i;l++){const c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?o.set(1,a,c):e.size>0?o.set(o.get(a,c)+e.get(a,l),a,c):o.set(o.get(a,c)+1,a,c))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iV=Qt((t,e)=>t&e),Yae=mn(_C,iV),Zae={kernelName:_C,backendName:"cpu",kernelFunc:Yae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pi(t){return(e,n,s)=>{const r=qt(n,e.length);for(let i=0;i<e.length;++i)r[i]=t(e[i],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dt(t,e,n){const s=Pi(e);return Ba(t,s,n)}function Ba(t,e,n){return({inputs:s,attrs:r,backend:i})=>{const{x:o}=s;we(o,t);const a=i,l=a.data.get(o.dataId).values;let c;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=po(l)}else c=l;const u=n||o.dtype,d=e(c,u,r);return a.makeTensorInfo(o.shape,u,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oV=Pi(t=>Math.ceil(t)),Jae=Ba(Vf,oV),Qae={kernelName:Vf,backendName:"cpu",kernelFunc:Jae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aV(t,e,n,s){const r=qt(n,Q(e));if(s&&n!=="string"){let i=0;t.forEach(o=>{const a=Q(o.shape);r.set(o.vals,i),i+=a})}else{let i=0;t.forEach(o=>{const a=n==="string"?po(o.vals):o.vals;let l=0;for(let c=0;c<o.shape[0];++c){const u=c*e[1]+i;for(let d=0;d<o.shape[1];++d)r[u+d]=a[l++]}i+=o.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lV=Qt((t,e)=>t===e?1:0),cV=mn(_x,lV,null,"bool"),ele={kernelName:_x,backendName:"cpu",kernelFunc:cV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uV=Pi(t=>Math.exp(t)),dV=Ba(Hf,uV,"float32"),tle={kernelName:Hf,backendName:"cpu",kernelFunc:dV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hV=Pi(t=>Math.expm1(t)),nle=Ba(qf,hV),sle={kernelName:qf,backendName:"cpu",kernelFunc:nle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fV=Pi(t=>Math.floor(t)),rle=Ba(Kf,fV),ile={kernelName:Kf,backendName:"cpu",kernelFunc:rle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pV=Qt((t,e)=>Math.floor(t/e)),ole=mn(Xf,pV,null,"int32"),ale={kernelName:Xf,backendName:"cpu",kernelFunc:ole};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mV(t,e,n,s,r,i,o,a,l){const c=He([s,i],n);for(let u=0;u<s;u++){const d=[];let h=0;for(let f=0;f<r;f++){const p=t[u*r+f];h+=p*o[f],d.push(p)}if(h<0||h>=l/i)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let f=0;f<i;f++)c.values[u*i+f]=e.get(...e.indexToLoc(h*i+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gV(t,e,n){const s=He(n,t.dtype);for(let r=0;r<s.size;++r){const o=s.indexToLoc(r).slice(),a=o[0],l=o[2],c=e.locToIndex([a,l]);o[2]=e.values[c];const u=t.locToIndex(o);0<=u&&u<t.values.length&&(s.values[r]=t.values[u])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yV=Qt((t,e)=>t>e?1:0),lle=mn(Px,yV,null,"bool"),cle={kernelName:Px,backendName:"cpu",kernelFunc:lle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xV=Qt((t,e)=>t>=e?1:0),ule=mn(Yf,xV,null,"bool"),dle={kernelName:Yf,backendName:"cpu",kernelFunc:ule};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vV=Qt((t,e)=>t<e?1:0),hle=mn(Fx,vV,null,"bool"),fle={kernelName:Fx,backendName:"cpu",kernelFunc:hle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bV=Qt((t,e)=>t<=e?1:0),ple=mn(Mx,bV,null,"bool"),mle={kernelName:Mx,backendName:"cpu",kernelFunc:ple};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wV(t,e,n){const s=(e-t)/(n-1),r=Ln(n,"float32");r[0]=t;for(let i=1;i<r.length;i++)r[i]=r[i-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kV=Pi(t=>Math.log(t)),gle=Ba(tp,kV),yle={kernelName:tp,backendName:"cpu",kernelFunc:gle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CV(t,e,n,s){const r=Mn(s,Q(n));for(let i=0;i<r.length;++i){const o=i*e;let a=t[o];for(let l=0;l<e;++l){const c=t[o+l];(Number.isNaN(c)||c>a)&&(a=c)}r[i]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SV=Qt((t,e)=>Math.max(t,e)),xle=mn(sp,SV),vle={kernelName:sp,backendName:"cpu",kernelFunc:xle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IV=Qt((t,e)=>Math.min(t,e)),ble=mn(rp,IV),wle={kernelName:rp,backendName:"cpu",kernelFunc:ble};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GI=Qt((t,e)=>t*e),kle=jI((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),B0=mn(op,GI,kle),Cle={kernelName:op,backendName:"cpu",kernelFunc:B0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TV(t,e,n){const s=Da(-1,n);return GI([],e,s,t,n)}function Sle(t){const{inputs:e,backend:n}=t,{x:s}=e;we(s,"neg");const r=n.data.get(s.dataId).values,[i,o]=TV(r,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,i)}const Ile={kernelName:Kx,backendName:"cpu",kernelFunc:Sle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NV=Qt((t,e)=>t!==e?1:0),Tle=mn(Xx,NV,null,"bool"),Nle={kernelName:Xx,backendName:"cpu",kernelFunc:Tle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HI(t,e,n,s,r){const i=e.length,o=Q(e),a=Ne(e),l=Ne(r),c=Mn(n,Q(r));for(let u=0;u<o;++u){const d=Gu(u,i,a),h=new Array(d.length);for(let p=0;p<h.length;p++)h[p]=d[s[p]];const f=xi(h,i,l);c[f]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gs(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:i}=n;we(r,"transpose");const o=r.shape.length,a=new Array(o);for(let d=0;d<a.length;d++)a[d]=r.shape[i[d]];const l=s.data.get(r.dataId).values,c=HI(l,r.shape,r.dtype,i,a);return{dataId:s.write(c,a,r.dtype),shape:a,dtype:r.dtype}}const Ele={kernelName:su,backendName:"cpu",kernelFunc:gs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EV(t,e,n,s){const[r,i]=kn(t,s),o=Rs(e,"int32"),a=Ln(Q(r),o),l=Q(i);for(let c=0;c<a.length;++c){const u=c*l;let d=1;for(let h=0;h<l;++h)d*=n[u+h];a[c]=d}return{outVals:a,outShape:r,outDtype:o}}function $le(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;we(r,"prod");const a=r.shape.length,l=qe(i,r.shape),c=Lt(l,a);let u=l,d=r;const h=[];c!=null&&(d=gs({inputs:{x:r},backend:n,attrs:{perm:c}}),h.push(d),u=Zt(u.length,a));const f=n.data.get(d.dataId).values,{outVals:p,outShape:m,outDtype:y}=EV(d.shape,d.dtype,f,u);let g=m;return o&&(g=on(m,l)),h.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(g,y,p)}const _le={kernelName:t0,backendName:"cpu",kernelFunc:$le};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ale(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const i=Gu(r,e.length,Ne(e)).join(",");throw new Error(`indices[${i}] = ${s} is not in [0, ${n})`)}})}function Rle(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let i=1;i<s.length;++i)if(s[i-1]>s[i])throw new Error("Ragged splits must be sorted in ascending order")}}function Dle(t,e,n,s){const r=[];let i=0;const o=e.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);Rle(n,s);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let d=1;d<l+1;++d)a[c].push(d*u)}for(let c=0;c<t.length;++c){let u=t[c],d=t[c]+1;for(let h=0;h<n.length;++h){const f=n[h],p=h+e.length-1;if(p>=0){const m=a[p],y=m[m.length-1]-f[u];for(let g=u;g<d;++g)a[p].push(f[g+1]+y)}u=f[u],d=f[d]}d!==u&&(r.push([u,d]),i+=d-u)}return{outSplits:a,valueSlices:r,numValues:i}}function Ple(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=qt("int32",s);e.push(r),t[n].forEach((i,o)=>r[o]=i)}return e}function C$(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function Ole(t,e,n,s,r,i){const o=C$(e,2)[1],a=C$(i,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let d=0;d<s;++d)r[l*a+d]=t[u*o+d];++l}}function Fle(t,e,n,s,r){const i=e.slice();i[0]=r;const o=qt(n,Q(i)),a=t.length,l=a===0?0:a/e[0];return Ole(t,e,s,l,o,i),[o,i]}function $V(t,e,n,s,r,i,o,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(Ale(i,o,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:u,valueSlices:d,numValues:h}=Dle(i,o,t,c),f=Ple(u),p=Fle(n,s,r,d,h);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S$=2147483647;function _V(t,e,n,s,r,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=r.length===0,c=o.length===0,u=[];a||u.push(e[0]),l||u.push(r[0]),c||u.push(o[0]);for(let y=1;y<u.length;++y)if(u[y]!==u[y-1])throw new Error("starts, limits, and deltas must have the same shape");const d=u.length===0?1:u[0],h=qt("int32",d+1);h[0]=0;for(let y=0;y<d;++y){const g=a?t[0]:t[y],x=l?s[0]:s[y],v=c?i[0]:i[y];if(v===0)throw new Error("Requires delta != 0");let b;if(v>0&&x<g||v<0&&x>g)b=0;else if(b=Math.ceil(Math.abs((x-g)/v)),b>S$)throw new Error(`Requires ((limit - start) / delta) <= ${S$}`);h[y+1]=h[y]+b}const f=h[d],p=qt(n,f);let m=0;for(let y=0;y<d;++y){const g=h[y+1]-h[y];let x=a?t[0]:t[y];const v=c?i[0]:i[y];for(let b=0;b<g;++b)p[m++]=x,x+=v}return[h,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var tr=Rr;class Sy{constructor(e,n,s,r,i,o,a,l,c,u){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=gL(u),this.raggedRank=yL(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===tr.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===tr.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case tr.VALUE_ROWIDS:return Sy.getMaxWidthValueRowID(n);case tr.ROW_SPLITS:return Sy.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${tr[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const i=e[r+1]-e[r];i>s&&(s=i)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],i=0;for(let o=1;o<n;++o){const a=e[o];a!==r&&(r=a,i=Math.max(o-s,i),s=o)}return Math.max(n-s,i)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return T$(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;xL(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=mL(this.raggedRank,r,n);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),i=[];let o=0;for(let a=0;a<r;++a,o+=n)i.push(o);for(let a=r;a<e;++a)i.push(-1);return T(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,s,r){const i=e.length,o=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let c=Math.min(r,l),u=n[a];u===-1&&(c=0);for(let d=0;d<c;++d)o.push(u),u+=s;for(let d=0;d<l-c;++d)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,s,r){const i=e.length,o=[];if(i===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];o.push(c);for(let u=1;u<i;++u){const d=e[u];if(d===l)c>=0&&(++a,a<r?c+=s:c=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);c=n[d]}o.push(c)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,s,r){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case tr.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,s,r);case tr.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,s,r);default:throw new Error(`Unsupported partition type: ${tr[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case tr.FIRST_DIM_SIZE:return e[0];case tr.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case tr.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${tr[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const i=T$(s,!1),o=qt(this.valuesDType,Q(i));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(e,n,s,r){if(s.length===0)return;const i=this.values,o=s;let a=r.slice();a=a.slice(e+1);const l=Q(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;H(()=>{const m=U(u,p);u=lh(m,a).dataSync()})}let d=0,h=0,f=0;for(let p=0;p<=c;++p){let m=p<c?n[p]:-1;if(m===f){++f;continue}if(h<f){const y=i.subarray(d*l),g=o.subarray(h*l),x=(f-h)*l;I$(g,y,x)}if(p>=c){const y=s.length;m=Math.floor(y/l)}if(m>f)if(this.defaultValue.length===1)o.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){const y=o.slice(f*l);I$(y,u,l),++f}m<0?(d=p+1,h=f):(d=p,h=f,f=h+1)}}}function I$(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function T$(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function AV(t,e,n,s,r,i,o,a,l,c){return new Sy(t,e,n,s,r,i,o,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RV(t,e,n,s){const r=t===e,i=t<e&&n<0,o=e<t&&n>1;if(r||i||o)return Ln(0,s);const a=Math.abs(Math.ceil((e-t)/n)),l=Ln(a,s);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DV=Pi(t=>1/Math.sqrt(t)),Mle=Ba(hp,DV),Lle={kernelName:hp,backendName:"cpu",kernelFunc:Mle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dl(t,e,n,s,r,i,o,a,l,c){const u=[s/r,r],d=t.values,h=e.values;if(s===0)return He(n,e.dtype);const f=l instanceof En?l:He(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<i;p++){const m=[];let y=0;for(let g=0;g<o;g++){const x=d[p*o+g];m.push(x),y+=x*a[g]}if(y<0||y>=s/r)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let g=0;g<r;g++)c?f.values[y*r+g]+=h[p*r+g]:f.values[y*r+g]=e.rank===0?h[0]:h[p*r+g]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vle=Pi(t=>1/(1+Math.exp(-t))),PV=dt(yp,t=>1/(1+Math.exp(-t))),Ble={kernelName:yp,backendName:"cpu",kernelFunc:PV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OV(t,e,n,s,r){const i=QS(s,e,n),o=Q(n),a=Ne(s);if(i){const d=eI(e,a);return r==="string"?t.slice(d,d+o):t.subarray(d,d+o)}const l=r==="string"?po(t):t,c=He(s,r,l),u=He(n,r);for(let d=0;d<u.size;++d){const h=u.indexToLoc(d),f=h.map((p,m)=>p+e[m]);u.set(c.get(...f),...h)}return r==="string"?LL(u.values):u.values}function ql(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s;we(r,"slice");const[a,l]=S0(r,i,o);ZS(r,a,l);const c=n.data.get(r.dataId).values,u=OV(c,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,u)}const zle={kernelName:a0,backendName:"cpu",kernelFunc:ql};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FV(t,e,n,s,r,i,o){const a=e[0],l=i[0],c=new Array(l),u=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(IL(a));const y=qt(n,0),g=qt(r,0);return[y,[0,d],g,c,u]}let h=!0,f=0;const p=new Array(l).fill(0);for(let y=0;y<a;++y){const g=t[y*d];if(g<0)throw new Error(TL(y,g));if(g>=l)throw new Error(NL(y,g,l));++p[g],h=h&&g>=f,f=g}let m=!0;for(let y=0;y<l;++y){const g=p[y]===0;c[y]=g,m=m&&!g,p[y]=Math.max(p[y],1),y>0&&(p[y]+=p[y-1])}if(m&&h){const y=t,g=s;for(let x=0;x<a;++x)u[x]=x;return[y,[a,d],g,c,u]}else{const y=p[l-1],g=qt(n,y*d),x=qt(r,y),v=new Array(l).fill(0);for(let b=0;b<a;++b){const k=t[b*d],C=v[k],S=(k===0?0:p[k-1])+C;v[k]++;for(let I=0;I<d;++I)g[S*d+I]=t[b*d+I];x[S]=s[b],u[b]=S}for(let b=0;b<l;++b)if(v[b]===0){const C=b===0?0:p[b-1];g[C*d+0]=b;for(let S=1;S<d;++S)g[C*d+S]=0;x[C]=o}return[g,[y,d],x,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MV(t,e,n,s,r){const i=Q(s),o=e[0],a=r.length,l=[];let c=1,u=-1;for(let y=0;y<a;++y){const g=r[y];if(g===-1){if(u!==-1)throw new Error(EL(u,y));u=y,l.push(1)}else{if(g<0)throw new Error($L(y,g));c*=g,l.push(g)}}if(u!==-1){if(c<=0)throw new Error(_L());const y=Math.trunc(i/c);if(c*y!==i)throw new Error(AL(s,l));l[u]=y}if(Q(l)!==i)throw new Error(RL(s,l));const h=s.length,f=[];if(h>0){f[h-1]=1;for(let y=h-2;y>=0;--y)f[y]=f[y+1]*s[y+1]}const p=[];if(a>0){p[a-1]=1;for(let y=a-2;y>=0;--y)p[y]=p[y+1]*l[y+1]}const m=qt(n,o*a);for(let y=0;y<o;++y){let g=0;for(let x=0;x<h;++x)g+=t[y*h+x]*f[x];for(let x=0;x<a;++x)m[y*a+x]=Math.trunc(g/p[x]),g%=p[x]}return[m,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qI(t,e,n,s,r,i=!1,o=0){const a=s.length,l=[e[0],t.length/e[0]],c=l[1],d=a>0?r[a-1]+1:0;if(d<0)throw new Error(c1());const h=e.slice();h[0]=d;const f=h.reduce((v,b)=>v*b,1),p=qt(n,f);if(a===0)return d>0&&p.fill(o),[p,h];if(d<=0)throw new Error(c1());let m=0,y=1,g=0,x=r[m];for(;;){let v=0;if(y<a){if(v=r[y],x===v){++y;continue}if(x>=v)throw new Error(DL())}if(x<0||x>=d)throw new Error(PL(x,d));x>g&&p.fill(o,g*c,x*c);for(let b=m;b<y;++b){const k=s[b];if(k<0||k>=l[0])throw new Error(OL(b,s[b],l[0]));for(let C=0;C<c;C++)p[x*c+C]+=t[k*c+C]}if(i)for(let b=0;b<c;b++)p[x*c+b]/=y-m;if(m=y,++y,g=x+1,x=v,y>a)break}return g<d&&p.fill(o,g*c,d*c),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ule=Pi(t=>Math.sqrt(t)),jle=dt(vp,t=>Math.sqrt(t)),Wle={kernelName:vp,backendName:"cpu",kernelFunc:jle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LV=Qt((t,e)=>{const n=t-e;return n*n}),Gle=mn(bp,LV),Hle={kernelName:bp,backendName:"cpu",kernelFunc:Gle};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VV=Pi((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=e;return t.replace(new RegExp(n,s?"g":""),r)}),qle=Ba(iS,VV),Kle={kernelName:iS,backendName:"cpu",kernelFunc:qle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BV(t,e,n,s){const r=He(t,e.dtype);for(let i=0;i<r.size;i++){const o=r.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*n[l]+s[l];r.set(e.get(...a),...o)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xle{constructor(e,n,s,r,i,o){this.separator=la(e),this.nGramWidths=n,this.leftPad=la(s),this.rightPad=la(r),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),c=Math.max(0,l-a),u=Math.max(0,l-(i-(a+1))),d=o-(c+u),h=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let x=0;x<d;++x)f+=e[h+x].length;f+=u*this.rightPad.length;const p=c+u+d-1;f+=p*this.separator.length,s[r+a]=new Uint8Array(f);const m=s[r+a];let y=0;const g=x=>x.forEach(v=>m[y++]=v);for(let x=0;x<c;++x)g(this.leftPad),g(this.separator);for(let x=0;x<d-1;++x)g(e[h+x]),g(this.separator);if(d>0){g(e[h+d-1]);for(let x=0;x<u;++x)g(this.separator),g(this.rightPad)}else{for(let x=0;x<u-1;++x)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let u=n[c]>=l;if(u=u&&n[c]<=s,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const i=r-1,o=qt("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=i;++c)o[c]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&u===0&&(u=1),o[l]=o[l-1]+u}const a=new Array(o[i]);for(let l=0;l<i;++l){const c=n[l];let u=o[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],f=this.getNumNGrams(h,d);this.createNGrams(e,c,a,u,f,d),u+=f}),this.preserveShort&&u===o[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(e,c,a,u,1,h)}}return[a,o]}}function zV(t,e,n,s,r,i,o,a){return new Xle(n,s,r,i,o,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yle(t,e,n,s){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)s.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const a=t.subarray(0,o);(!n||a.length!==0)&&s.push(a),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(r,i);(!n||o.length!==0)&&s.push(o),r=i+1}}function UV(t,e,n){const s=t.length,r=[];let i=0,o=0;const a=new Array(s);for(let h=0;h<s;++h){const f=r.length;Yle(t[h],e,n,r);const p=r.length-f;a[h]=p,i+=p,o=Math.max(o,p)}const l=qt("int32",i*2),c=new Array(i),u=[s,o];let d=0;for(let h=0;h<s;++h)for(let f=0;f<a[h];++f)l[d*2]=h,l[d*2+1]=f,c[d]=r[d],++d;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jV(t,e){const n=qt("int32",t.length);for(let s=0;s<t.length;++s)n[s]=RZ(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WV=Qt((t,e)=>t-e),Zle=jI((t,e,n,s)=>({real:t-n,imag:e-s})),KI=mn(wp,WV,Zle),Jle={kernelName:wp,backendName:"cpu",kernelFunc:KI};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GV(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=He(n,t.dtype);for(let r=0;r<s.values.length;++r){const i=s.indexToLoc(r),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%t.shape[l];const a=t.locToIndex(o);s.values[r]=t.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zd=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function HV(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=e-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(e-l*u/a+d)),f=Math.min(s,Math.floor(e+(a-l)*u/a+d));HV(t,e,h,f)}const r=t[e];let i=n,o=s;for(kc(t,n,e),zd(t[s],r)>0&&kc(t,n,s);i<o;){for(kc(t,i,o),i++,o--;zd(t[i],r)<0;)i=i+1;for(;zd(t[o],r)>0;)o=o-1}zd(t[n],r)===0?kc(t,n,o):(o=o+1,kc(t,o,s)),o<=e&&(n=o+1),e<=o&&(s=o-1)}}function qV(t,e,n,s,r){const i=e[e.length-1],[o,a]=[t.length/i,i],l=Mn(n,o*s),c=Mn("int32",o*s);for(let d=0;d<o;d++){const h=d*a,f=t.subarray(h,h+a);let p=new Array(f.length);f.forEach((x,v)=>p[v]={value:x,index:v}),s<p.length&&(HV(p,s),p=p.slice(0,s)),r&&p.sort(zd);const m=d*s,y=l.subarray(m,m+s),g=c.subarray(m,m+s);for(let x=0;x<s;x++)y[x]=p[x].value,g[x]=p[x].index}const u=e.slice();return u[u.length-1]=s,[He(u,n,l),He(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KV(t,e,n,s){const r=qe(e,n)[0],i=[1,n[0],1];for(let p=0;p<r;p++)i[0]*=n[p];i[1]=n[r];for(let p=r+1;p<n.length;p++)i[2]*=n[p];const o=new Map,a=new Int32Array(n[r]),l=new En(i,s,t),c=[],u=i[0]===1&&i[2]===1;for(let p=0;p<n[r];p++){let m;if(u)m=t[p].toString();else{const g=[];for(let x=0;x<i[0];x++)for(let v=0;v<i[2];v++)g.push(l.get(x,p,v));m=g.join(",")}const y=o.get(m);if(y!=null)a[p]=y;else{const g=o.size;o.set(m,g),a[p]=g,c.push(p)}}const d=i.slice();d[1]=o.size;const h=new En(d,s);c.forEach((p,m)=>{for(let y=0;y<i[0];y++)for(let g=0;g<i[2];g++)h.set(l.get(y,p,g),y,m,g)});const f=n.slice();return f[r]=d[1],{outputValues:h.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qle=Object.freeze(Object.defineProperty({__proto__:null,addImpl:sV,bincountImpl:WI,bincountReduceImpl:rV,bitwiseAndImpl:iV,castImpl:nV,ceilImpl:oV,concatImpl:aV,equalImpl:lV,expImpl:uV,expm1Impl:hV,floorDivImpl:pV,floorImpl:fV,gatherNdImpl:mV,gatherV2Impl:gV,greaterEqualImpl:xV,greaterImpl:yV,lessEqualImpl:bV,lessImpl:vV,linSpaceImpl:wV,logImpl:kV,maxImpl:CV,maximumImpl:SV,minimumImpl:IV,multiplyImpl:GI,negImpl:TV,notEqualImpl:NV,prodImpl:EV,raggedGatherImpl:$V,raggedRangeImpl:_V,raggedTensorToTensorImpl:AV,rangeImpl:RV,rsqrtImpl:DV,scatterImpl:dl,sigmoidImpl:Vle,simpleAbsImpl:tV,sliceImpl:OV,sparseFillEmptyRowsImpl:FV,sparseReshapeImpl:MV,sparseSegmentReductionImpl:qI,sqrtImpl:Ule,squaredDifferenceImpl:LV,staticRegexReplaceImpl:VV,stridedSliceImpl:BV,stringNGramsImpl:zV,stringSplitImpl:UV,stringToHashBucketFastImpl:jV,subImpl:WV,tileImpl:GV,topKImpl:qV,transposeImpl:HI,uniqueImpl:KV},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */hM("cpu",()=>new V0,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XV=dt(Wf,t=>t>=0?t:Math.exp(t)-1),ece={kernelName:Wf,backendName:"cpu",kernelFunc:XV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YV(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s;we([r],"leakyRelu");const o=Q(r.shape),a=n.data.get(r.dataId).values,l=Mn("float32",o);for(let c=0;c<a.length;c++)l[c]=a[c]<0?i*a[c]:a[c];return n.makeTensorInfo(r.shape,"float32",l)}const tce={kernelName:Ox,backendName:"cpu",kernelFunc:YV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nce=Qt((t,e)=>t<0?e*t:t);function ZV(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;we([s,r],"prelu");const i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,[a,l]=nce(s.shape,r.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",a)}const sce={kernelName:e0,backendName:"cpu",kernelFunc:ZV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JV=dt(cp,t=>Math.max(0,t)),rce={kernelName:cp,backendName:"cpu",kernelFunc:JV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QV=dt(up,t=>Math.min(Math.max(0,t),6)),ice={kernelName:up,backendName:"cpu",kernelFunc:QV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iy(t,e,n,s,r){if(n==="linear")return Ri({inputs:{x:e},backend:t});if(n==="relu")return JV({inputs:{x:e},backend:t});if(n==="elu")return XV({inputs:{x:e},backend:t});if(n==="relu6")return QV({inputs:{x:e},backend:t});if(n==="prelu")return ZV({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return YV({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return PV({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wt(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=Q(r.shape),a=yF(i,o),l=Q(a);T(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;u.shape=a,d.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const oce={kernelName:n0,backendName:"cpu",kernelFunc:wt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eB(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;we([r,i],"matMul");const l=r.shape.length,c=i.shape.length,u=o?r.shape[l-2]:r.shape[l-1],d=a?i.shape[c-1]:i.shape[c-2],h=o?r.shape[l-1]:r.shape[l-2],f=a?i.shape[c-2]:i.shape[c-1],p=r.shape.slice(0,-2),m=i.shape.slice(0,-2),y=Q(p),g=Q(m),v=Le(r.shape.slice(0,-2),i.shape.slice(0,-2)).concat([h,f]);T(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${r.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const b=o?[y,u,h]:[y,h,u],k=a?[g,f,d]:[g,d,f],C=wt({inputs:{x:r},backend:n,attrs:{shape:b}}),S=wt({inputs:{x:i},backend:n,attrs:{shape:k}}),I=o?C.shape[1]:C.shape[2],N=o?C.shape[2]:C.shape[1],E=a?S.shape[1]:S.shape[2],D=Math.max(y,g),R=n.data.get(C.dataId).values,L=n.data.get(S.dataId).values,B=Ne(C.shape),W=Ne(S.shape),[G,q,A]=o?[B[0],1,B[1]]:[B[0],B[1],1],[z,P,X]=a?[1,W[1],W[0]]:[W[1],1,W[0]],te=N*E,se=He([D,N,E],C.dtype),ce=se.values,ie=n.blockSize;for(let de=0;de<D;de++){const ge=de%y,Ee=de%g;for(let Te=0;Te<N;Te+=ie){const Me=Math.min(Te+ie,N);for(let Ve=0;Ve<E;Ve+=ie){const st=Math.min(Ve+ie,E);for(let ht=0;ht<I;ht+=ie){const kt=Math.min(ht+ie,I);for(let ct=Te;ct<Me;ct++)for(let lt=Ve;lt<st;lt++){let Ct=0;for(let St=ht;St<kt;St++){const Js=R[ge*G+ct*q+St*A],_=L[St*z+lt*P+Ee*X];Ct+=Js*_}ce[de*te+(ct*E+lt)]+=Ct}}}}}return n.disposeIntermediateTensorInfo(C),n.disposeIntermediateTensorInfo(S),n.makeTensorInfo(v,se.dtype,se.values)}const ace={kernelName:bx,backendName:"cpu",kernelFunc:eB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lce(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;let h,f,p;const m=[];h=eB({inputs:{a:r,b:i},attrs:{transposeA:l,transposeB:c},backend:n}),o&&(f=Nu({inputs:{a:h,b:o},backend:n}),m.push(h),h=f),u&&(p=Iy(n,h,u,a,d),m.push(h),h=p);for(const g of m)n.disposeIntermediateTensorInfo(g);return h}const cce={kernelName:ry,backendName:"cpu",kernelFunc:lce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uce=dt(Af,t=>Math.acos(t)),dce={kernelName:Af,backendName:"cpu",kernelFunc:uce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hce=dt(Rf,t=>Math.acosh(t)),fce={kernelName:Rf,backendName:"cpu",kernelFunc:hce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pce(t){const{inputs:e,backend:n}=t,s=e;we(e,"addN");const r=s.map(a=>n.data.get(a.dataId).values),i=He(s[0].shape,s[0].dtype),o=i.values;for(let a=0;a<s.length;a++){const l=r[a];for(let c=0;c<o.length;c++)o[c]+=l[c]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const mce={kernelName:SC,backendName:"cpu",kernelFunc:pce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;we(r,"all");const a=qe(i,r.shape);let l=a;const c=Lt(l,r.shape.length);let u=r;c!=null&&(u=gs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Zt(l.length,r.shape.length)),_n("all",l,u.shape.length);const[d,h]=kn(u.shape,l),f=Q(h),p=Ln(Q(d),u.dtype),m=n.data.get(u.dataId).values;for(let g=0;g<p.length;++g){const x=g*f;let v=m[x];for(let b=0;b<f;++b){const k=m[x+b];v=v&&k}p[g]=v}c!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(d,u.dtype,p);if(o){const g=on(d,a),x=wt({inputs:{x:y},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(y),x}return y}const yce={kernelName:IC,backendName:"cpu",kernelFunc:gce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;we(r,"any");const a=qe(i,r.shape);let l=a;const c=Lt(l,r.shape.length);let u=r;c!=null&&(u=gs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Zt(l.length,r.shape.length)),_n("any",l,u.shape.length);const[d,h]=kn(u.shape,l),f=Q(h),p=Ln(Q(d),u.dtype),m=n.data.get(u.dataId).values;for(let g=0;g<p.length;++g){const x=g*f;let v=m[x];for(let b=0;b<f;++b){const k=m[x+b];v=v||k}p[g]=v}c!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(d,u.dtype,p);if(o){const g=on(d,a),x=wt({inputs:{x:y},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(y),x}return y}const vce={kernelName:TC,backendName:"cpu",kernelFunc:xce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;we(r,"argMax");let o=qe(i,r.shape);const a=Lt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=gs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Zt(o.length,l.shape.length)),o=[o[0]],_n("argMax",o,l.shape.length);const[u,d]=kn(l.shape,o),h=Q(u),f=Ln(h,"int32"),p=Q(d),m=n.data.get(l.dataId).values;for(let y=0;y<f.length;++y){const g=y*p;let x=m[g],v=0;for(let b=0;b<p;++b){const k=m[g+b];k>x&&(x=k,v=b)}f[y]=v}return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(u,"int32",f)}const wce={kernelName:gx,backendName:"cpu",kernelFunc:bce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;we(r,"argMin");let o=qe(i,r.shape);const a=Lt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=gs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Zt(o.length,l.shape.length)),o=[o[0]],_n("argMin",o,l.shape.length);const[u,d]=kn(l.shape,o),h=Q(u),f=Ln(h,"int32"),p=Q(d),m=n.data.get(l.dataId).values;for(let y=0;y<f.length;++y){const g=y*p;let x=m[g],v=0;for(let b=0;b<p;++b){const k=m[g+b];k<x&&(x=k,v=b)}f[y]=v}return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(u,"int32",f)}const Cce={kernelName:yx,backendName:"cpu",kernelFunc:kce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sce=dt(Df,t=>Math.asin(t)),Ice={kernelName:Df,backendName:"cpu",kernelFunc:Sce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tce=dt(Pf,t=>Math.asinh(t)),Nce={kernelName:Pf,backendName:"cpu",kernelFunc:Tce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ece=dt(Of,t=>Math.atan(t)),$ce={kernelName:Of,backendName:"cpu",kernelFunc:Ece};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ce=Qt((t,e)=>Math.atan2(t,e)),Ace=mn(Mf,_ce),Rce={kernelName:Mf,backendName:"cpu",kernelFunc:Ace};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dce=dt(Ff,t=>Math.atanh(t)),Pce={kernelName:Ff,backendName:"cpu",kernelFunc:Dce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XI(t,e,n,s,r,i){const o=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,p=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=He(r.outShape,n),y=m.values,g=r.outShape[1]*r.outShape[2]*r.outShape[3],x=r.outShape[2]*r.outShape[3],v=r.outShape[3];for(let b=0;b<r.batchSize;++b){const k=b*g,C=b*s[0];for(let S=0;S<r.inChannels;++S)for(let I=0;I<r.outHeight;++I){const N=I*o-h,E=Math.max(0,N),D=Math.min(r.inHeight,u+N),R=k+I*x;for(let L=0;L<r.outWidth;++L){const B=L*a-f,W=Math.max(0,B),G=Math.min(r.inWidth,d+B);let q=p,A=0,z=0;for(let X=E;X<D;X+=l){const te=C+X*s[1];for(let se=W;se<G;se+=c){const ce=te+se*s[2],ie=t[ce+S];i==="max"&&ie>q?q=ie:i==="avg"&&(A+=ie,z++)}if(isNaN(q))break}const P=R+L*v+S;y[P]=i==="avg"?A/z:q}}}return m}function tB(t,e,n,s,r=!1,i=!1){const o=He(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,u=s.dilationWidth,d=s.effectiveFilterHeight,h=s.effectiveFilterWidth,f=s.padInfo.top,p=s.padInfo.left,m=He(e,n,t);for(let y=0;y<s.batchSize;++y)for(let g=0;g<s.inChannels;++g)for(let x=0;x<s.outHeight;++x){const v=x*a-f;let b=v;for(;b<0;)b+=c;const k=Math.min(s.inHeight,d+v);for(let C=0;C<s.outWidth;++C){const S=C*l-p;let I=S;for(;I<0;)I+=u;const N=Math.min(s.inWidth,h+S);let E=Number.NEGATIVE_INFINITY,D=-1;for(let R=b;R<k;R+=c){const L=R-v;for(let B=I;B<N;B+=u){const W=B-S,G=m.get(y,R,B,g);G>E&&(E=G,r?D=i?((y*s.inHeight+R)*s.inWidth+B)*s.inChannels+g:(R*s.inWidth+B)*s.inChannels+g:D=L*h+W)}}o.set(D,y,x,C,g)}}return o}function nB(t,e,n,s,r,i){const o=r.strideDepth,a=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,m=r.padInfo.front,y=r.padInfo.top,g=r.padInfo.left,x=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=He(r.outShape,n),b=v.values,k=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[3]*r.outShape[4],I=r.outShape[4];for(let N=0;N<r.batchSize;++N){const E=N*k,D=N*s[0];for(let R=0;R<r.inChannels;++R)for(let L=0;L<r.outDepth;++L){const B=L*o-m;let W=B;for(;W<0;)W+=c;const G=Math.min(r.inDepth,h+B),q=E+L*C;for(let A=0;A<r.outHeight;++A){const z=A*a-y;let P=z;for(;P<0;)P+=u;const X=Math.min(r.inHeight,f+z),te=q+A*S;for(let se=0;se<r.outWidth;++se){const ce=se*l-g;let ie=ce;for(;ie<0;)ie+=d;const de=Math.min(r.inWidth,p+ce),ge=te+se*I;let Ee=x,Te=0,Me=0;for(let st=W;st<G;st+=c){const ht=D+st*s[1];for(let kt=P;kt<X;kt+=u){const ct=ht+kt*s[2];for(let lt=ie;lt<de;lt+=d){const Ct=ct+lt*s[3],St=t[Ct+R];if(i==="max"&&St>Ee?Ee=St:i==="avg"&&(Te+=St,Me++),isNaN(Ee))break}if(isNaN(Ee))break}if(isNaN(Ee))break}const Ve=ge+R;b[Ve]=i==="avg"?Te/Math.max(Me,1):Ee}}}}return v}function Oce(t,e){const n=He(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let y=0;y<e.inChannels;++y)for(let g=0;g<e.outDepth;++g){const x=g*s-h;let v=x;for(;v<0;)v+=o;const b=Math.min(e.inDepth,c+x);for(let k=0;k<e.outHeight;++k){const C=k*r-f;let S=C;for(;S<0;)S+=a;const I=Math.min(e.inHeight,u+C);for(let N=0;N<e.outWidth;++N){const E=N*i-p;let D=E;for(;D<0;)D+=l;const R=Math.min(e.inWidth,d+E);let L=Number.NEGATIVE_INFINITY,B=-1;for(let W=v;W<b;W+=o){const G=W-x;for(let q=S;q<I;q+=a){const A=q-C;for(let z=D;z<R;z+=l){const P=z-E,X=t.get(m,W,q,z,y);X>=L&&(L=X,B=G*u*d+A*u+P)}}}n.set(B,m,g,k,N,y)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;we(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;T(Bn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=br(r.shape,i,o,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&at(u.inShape,u.outShape))d=Ri({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=Ne(r.shape),p=XI(h,r.shape,r.dtype,f,u,"avg");d=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return d}const Mce={kernelName:xx,backendName:"cpu",kernelFunc:Fce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;we(r,"avgPool3d");const u=vo(r.shape,i,o,1,a,l,c),d=n.data.get(r.dataId).values,h=nB(d,r.shape,r.dtype,Ne(r.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const Vce={kernelName:vx,backendName:"cpu",kernelFunc:Lce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bce(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;we([r,i],"avgPool3DGrad");const u=vo(i.shape,o,a,1,l,c),d=u.strideDepth,h=u.strideHeight,f=u.strideWidth,p=u.filterDepth,m=u.filterHeight,y=u.filterWidth,g=u.dilationDepth,x=u.dilationHeight,v=u.dilationWidth,b=u.effectiveFilterDepth,k=u.effectiveFilterHeight,C=u.effectiveFilterWidth,S=b-1-u.padInfo.front,I=C-1-u.padInfo.left,N=k-1-u.padInfo.top,E=He(i.shape,"float32"),D=1/(p*m*y),R=n.bufferSync(r);for(let L=0;L<u.batchSize;++L)for(let B=0;B<u.inChannels;++B)for(let W=0;W<u.inDepth;++W)for(let G=0;G<u.inHeight;++G)for(let q=0;q<u.inWidth;++q){const A=W-S,z=G-N,P=q-I;let X=0;for(let te=0;te<b;te+=g){const se=(A+te)/d;if(!(se<0||se>=u.outDepth||Math.floor(se)!==se))for(let ce=0;ce<k;ce+=x){const ie=(z+ce)/h;if(!(ie<0||ie>=u.outHeight||Math.floor(ie)!==ie))for(let de=0;de<C;de+=v){const ge=(P+de)/f;if(ge<0||ge>=u.outWidth||Math.floor(ge)!==ge)continue;const Ee=R.get(L,se,ie,ge,B);X+=Ee}}}E.set(X*D,L,W,G,q,B)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const zce={kernelName:EC,backendName:"cpu",kernelFunc:Bce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uce(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;we([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=br(o.shape,a,l,1,c),d=u.strideHeight,h=u.strideWidth,f=u.filterHeight,p=u.filterWidth,m=u.dilationHeight,y=u.dilationWidth,g=u.effectiveFilterHeight,x=u.effectiveFilterWidth,v=x-1-u.padInfo.left,b=g-1-u.padInfo.top,k=He(o.shape,"float32"),C=1/(f*p),S=n.data.get(r.dataId).values,I=He(r.shape,"float32",S);for(let N=0;N<u.batchSize;++N)for(let E=0;E<u.inChannels;++E)for(let D=0;D<u.inHeight;++D)for(let R=0;R<u.inWidth;++R){const L=D-b,B=R-v;let W=0;for(let G=0;G<g;G+=m){const q=(L+G)/d;if(!(q<0||q>=u.outHeight||Math.floor(q)!==q))for(let A=0;A<x;A+=y){const z=(B+A)/h;if(z<0||z>=u.outWidth||Math.floor(z)!==z)continue;const P=I.get(N,q,z,E);W+=P}}k.set(W*C,N,D,R,E)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const jce={kernelName:NC,backendName:"cpu",kernelFunc:Uce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:i,offset:o,mean:a,variance:l}=e;T(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),we([r,a,l,i,o],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const u=n.data.get(r.dataId).values,d=n.data.get(a.dataId).values,h=n.data.get(l.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),y=p.length,g=f.length,x=h.length,v=d.length;let b=0,k=0,C=0,S=0;for(let I=0;I<u.length;++I)m[I]=p[b++]+(u[I]-d[k++])*f[C++]/Math.sqrt(h[S++]+c),b>=y&&(b=0),k>=v&&(k=0),C>=g&&(C=0),S>=x&&(S=0);return n.makeTensorInfo(r.shape,r.dtype,m)}const Gce={kernelName:Rx,backendName:"cpu",kernelFunc:Wce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;we([r],"batchToSpaceND");const a=i.reduce((g,x)=>g*x),l=Ap(r.shape,i,a),c=Rp(l.length,i.length),u=Dp(r.shape,i,a),d=iI(o,i.length),h=oI(u,o,i.length),f=wt({inputs:{x:r},backend:n,attrs:{shape:l}}),p=gs({inputs:{x:f},backend:n,attrs:{perm:c}}),m=wt({inputs:{x:p},backend:n,attrs:{shape:u}}),y=ql({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),y}const qce={kernelName:wx,backendName:"cpu",kernelFunc:Hce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=WI(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const Xce={kernelName:$C,backendName:"cpu",kernelFunc:Kce};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yce(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=Le(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Zce={kernelName:CF,backendName:"cpu",kernelFunc:Yce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jce=dt(Bf,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),Qce={kernelName:Bf,backendName:"cpu",kernelFunc:Jce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eue=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(Q(e.shape)),r=n.data.get(e.dataId),i=r.complexTensorInfos.real,o=r.complexTensorInfos.imag,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],d=l[c];s[c]=Math.hypot(u,d)}return n.makeOutput(s,e.shape,"float32")},tue={kernelName:kx,backendName:"cpu",kernelFunc:eue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eu(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const nue={kernelName:qC,backendName:"cpu",kernelFunc:Eu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $u(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=qe(r,e[0].shape)[0],o=e.map(m=>m.shape);nI(o,i);let a=bi(e.map(m=>m.shape),i);if(Q(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(m=>Q(m.shape)>0);if(l.length===1)return Ri({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const m=l.map(b=>Hl({inputs:{input:b},backend:n})),y=l.map(b=>Eu({inputs:{input:b},backend:n})),g=$u({inputs:m,backend:n,attrs:{axis:i}}),x=$u({inputs:y,backend:n,attrs:{axis:i}}),v=ks({inputs:{real:g,imag:x},backend:n});return m.forEach(b=>n.disposeIntermediateTensorInfo(b)),y.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),v}const c=l.map(m=>{const g=[-1,Q(m.shape.slice(i))];return wt({inputs:{x:m},backend:n,attrs:{shape:g}})}),u=c.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));a=bi(c.map(m=>m.shape),1);const d=c[0].shape[0]===1,h=aV(u,a,e[0].dtype,d),f=bi(l.map(m=>m.shape),i),p=n.makeTensorInfo(f,e[0].dtype,h);return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const sue={kernelName:Cx,backendName:"cpu",kernelFunc:$u};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sB(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s;we([r,i],"conv2d");const d=bo(l),h=$n(r.shape,i.shape,o,c,a,u,!1,d),f=h.filterHeight,p=h.filterWidth,m=h.dilationHeight,y=h.dilationWidth,g=h.padInfo.left,x=h.padInfo.top,v=h.dataFormat==="channelsLast",b=new En(h.outShape,r.dtype),k=Ne(r.shape),C=Ne(i.shape),S=k[0],I=v?k[1]:k[2],N=v?k[2]:1,E=v?1:k[1],D=b.strides[0],R=v?b.strides[1]:b.strides[2],L=v?b.strides[2]:1,B=v?1:b.strides[1],W=n.data.get(r.dataId).values,G=n.data.get(i.dataId).values,q=b.values;for(let A=0;A<h.batchSize;++A){const z=A*S,P=A*D;for(let X=0;X<h.outHeight;++X){const te=P+X*R,se=X*h.strideHeight-x;for(let ce=0;ce<f;++ce){const ie=se+ce*m;if(ie<0||ie>=h.inHeight)continue;const de=ce*C[0],ge=z+ie*I;for(let Ee=0;Ee<h.outWidth;++Ee){const Te=te+Ee*L,Me=Ee*h.strideWidth-g;for(let Ve=0;Ve<p;++Ve){const st=Me+Ve*y;if(st<0||st>=h.inWidth)continue;const ht=de+Ve*C[1],kt=ge+st*N;let ct=ht;for(let lt=0;lt<h.inChannels;++lt){const Ct=W[kt+lt*E];for(let St=0;St<h.outChannels;++St)q[Te+St*B]+=Ct*G[ct+St];ct+=h.outChannels}}}}}}return n.makeTensorInfo(b.shape,b.dtype,q)}const rue={kernelName:Sx,backendName:"cpu",kernelFunc:sB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s;we([r,i],"conv2dBackpropFilter");const d=bo(l),h=$n(r.shape,u,o,1,a,c,!1,d),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:y}=h,g=h.dataFormat==="channelsLast",x=new En(h.filterShape,"float32"),v=h.padInfo.left,b=h.padInfo.top,k=n.data.get(r.dataId).values,C=n.data.get(i.dataId).values,S=new En(r.shape,r.dtype,k),I=new En(i.shape,i.dtype,C);for(let N=0;N<m;++N){const E=Math.max(0,Math.ceil((b-N)/f)),D=Math.min(h.outHeight,(h.inHeight+b-N)/f);for(let R=0;R<y;++R){const L=Math.max(0,Math.ceil((v-R)/p)),B=Math.min(h.outWidth,(h.inWidth+v-R)/p);for(let W=0;W<h.inChannels;++W)for(let G=0;G<h.outChannels;++G){let q=0;for(let A=0;A<h.batchSize;++A)for(let z=E;z<D;++z){const P=N+z*f-b;for(let X=L;X<B;++X){const te=R+X*p-v;g?q+=S.get(A,P,te,W)*I.get(A,z,X,G):q+=S.get(A,W,P,te)*I.get(A,G,z,X)}}x.set(q,N,R,W,G)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const oue={kernelName:RC,backendName:"cpu",kernelFunc:iue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aue(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s;we([r,i],"conv2dBackpropInput");const d=Ne(i.shape),h=Ne(r.shape);let f=bo(c);const p=$n(o,i.shape,a,1,l,u,!1,f),m=new En(p.inShape,"float32"),y=m.values,g=n.data.get(r.dataId).values,x=n.data.get(i.dataId).values,[v,b,k]=d,{batchSize:C,filterHeight:S,filterWidth:I,inChannels:N,inHeight:E,inWidth:D,outChannels:R,outHeight:L,outWidth:B,strideHeight:W,strideWidth:G}=p;f=p.dataFormat;const q=S-1-p.padInfo.top,A=I-1-p.padInfo.left,z=f==="channelsLast",P=m.strides[0],X=z?m.strides[1]:m.strides[2],te=z?m.strides[2]:1,se=z?1:m.strides[1],ce=h[0],ie=z?h[1]:h[2],de=z?h[2]:1,ge=z?1:h[1];for(let Ee=0;Ee<C;++Ee)for(let Te=0;Te<N;++Te)for(let Me=0;Me<E;++Me){const Ve=Me-q,st=Math.max(0,Math.ceil(Ve/W)),ht=Math.min(L,(S+Ve)/W);for(let kt=0;kt<D;++kt){const ct=kt-A,lt=Math.max(0,Math.ceil(ct/G)),Ct=Math.min(B,(I+ct)/G);let St=0;for(let _=st;_<ht;++_){const K=_*W-Ve;for(let ee=lt;ee<Ct;++ee){const pe=ee*G-ct,ue=ce*Ee+ie*_+de*ee,ae=v*(S-1-K)+b*(I-1-pe)+k*Te;for(let Se=0;Se<R;++Se){const Xe=g[ue+ge*Se],Ze=x[ae+Se];St+=Xe*Ze}}}const Js=P*Ee+X*Me+te*kt+se*Te;y[Js]=St}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const lue={kernelName:Ix,backendName:"cpu",kernelFunc:aue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s;we([r,i],"conv3d");const c=Pa(r.shape,i.shape,o,l,a),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:f,dilationHeight:p,dilationWidth:m,padInfo:y}=c,g=y.front,x=y.left,v=y.top,b=new En(c.outShape,r.dtype),k=n.data.get(r.dataId).values,C=n.data.get(i.dataId).values,S=b.values,I=Ne(r.shape),N=Ne(i.shape);for(let E=0;E<c.batchSize;++E){const D=E*I[0],R=E*b.strides[0];for(let L=0;L<c.outDepth;++L){const B=R+L*b.strides[1],W=L*c.strideDepth-g;for(let G=0;G<u;++G){const q=W+G*f;if(q<0||q>=c.inDepth)continue;const A=G*N[0],z=D+q*I[1];for(let P=0;P<c.outHeight;++P){const X=B+P*b.strides[2],te=P*c.strideHeight-v;for(let se=0;se<d;++se){const ce=te+se*p;if(ce<0||ce>=c.inHeight)continue;const ie=A+se*N[1],de=z+ce*I[2];for(let ge=0;ge<c.outWidth;++ge){const Ee=X+ge*c.outChannels,Te=ge*c.strideWidth-x;for(let Me=0;Me<h;++Me){const Ve=Te+Me*m;if(Ve<0||Ve>=c.inWidth)continue;const st=ie+Me*N[2],ht=de+Ve*c.inChannels;let kt=st;for(let ct=0;ct<c.inChannels;++ct){const lt=k[ht+ct];for(let Ct=0;Ct<c.outChannels;++Ct)S[Ee+Ct]+=lt*C[kt+Ct];kt+=c.outChannels}}}}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const uue={kernelName:Tx,backendName:"cpu",kernelFunc:cue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function due(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s;we([r,i],"conv3dBackpropFilterV2");const c=Ne(r.shape),u=Ne(i.shape),d=Pa(r.shape,l,o,1,a),h=d.strideDepth,f=d.strideHeight,p=d.strideWidth,m=d.filterDepth,y=d.filterHeight,g=d.filterWidth,x=new En(d.filterShape,"float32"),v=x.values,[b,k,C,S]=x.strides,I=n.data.get(i.dataId).values,[N,E,D,R]=u,L=n.data.get(r.dataId).values,[B,W,G,q]=c,A=d.padInfo.front,z=d.padInfo.left,P=d.padInfo.top;for(let X=0;X<m;++X){const te=Math.max(0,Math.ceil((A-X)/h)),se=Math.min(d.outDepth,(d.inDepth+A-X)/h),ce=X*b;for(let ie=0;ie<y;++ie){const de=Math.max(0,Math.ceil((P-ie)/f)),ge=Math.min(d.outHeight,(d.inHeight+P-ie)/f),Ee=ie*k+ce;for(let Te=0;Te<g;++Te){const Me=Math.max(0,Math.ceil((z-Te)/p)),Ve=Math.min(d.outWidth,(d.inWidth+z-Te)/p),st=Te*C+Ee;for(let ht=0;ht<d.inChannels;++ht){const kt=ht*S+st;for(let ct=0;ct<d.outChannels;++ct){let lt=0;for(let Ct=0;Ct<d.batchSize;++Ct){const St=Ct*B,Js=Ct*N;for(let _=te;_<se;++_){const ee=(X+_*h-A)*W+St,pe=_*E+Js;for(let ue=de;ue<ge;++ue){const Se=(ie+ue*f-P)*G+ee,Xe=ue*D+pe;for(let Ze=Me;Ze<Ve;++Ze){const ko=(Te+Ze*p-z)*q+Se,Qs=Ze*R+Xe;lt+=L[ko+ht]*I[Qs+ct]}}}}v[kt+ct]=lt}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const hue={kernelName:DC,backendName:"cpu",kernelFunc:due};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fue(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s;we([r],"conv3dBackpropInputV2");const c=Ne(r.shape),u=Ne(i.shape),d=Pa(l,i.shape,a,1,o),h=new En(d.inShape,"float32"),f=h.values,[p,m,y,g]=h.strides,x=n.data.get(r.dataId).values,[v,b,k,C]=c,S=n.data.get(i.dataId).values,[I,N,E,D]=u,{batchSize:R,filterDepth:L,filterHeight:B,filterWidth:W,inChannels:G,inDepth:q,inHeight:A,inWidth:z,outChannels:P,outDepth:X,outHeight:te,outWidth:se,strideDepth:ce,strideHeight:ie,strideWidth:de}=d,ge=L-1-d.padInfo.front,Ee=B-1-d.padInfo.top,Te=W-1-d.padInfo.left;for(let Me=0;Me<R;++Me)for(let Ve=0;Ve<G;++Ve)for(let st=0;st<q;++st){const ht=st-ge,kt=Math.max(0,Math.ceil(ht/ce)),ct=Math.min(X,(L+ht)/ce);for(let lt=0;lt<A;++lt){const Ct=lt-Ee,St=Math.max(0,Math.ceil(Ct/ie)),Js=Math.min(te,(B+Ct)/ie);for(let _=0;_<z;++_){const K=_-Te,ee=Math.max(0,Math.ceil(K/de)),pe=Math.min(se,(W+K)/de);let ue=0;for(let ae=kt;ae<ct;++ae){const Se=ae*ce-ht;for(let Xe=St;Xe<Js;++Xe){const Ze=Xe*ie-Ct;for(let Cn=ee;Cn<pe;++Cn){const ko=Cn*de-K,Qs=v*Me+b*ae+k*Xe+C*Cn,av=I*(L-1-Se)+N*(B-1-Ze)+E*(W-1-ko)+D*Ve;for(let Co=0;Co<P;++Co){const dd=x[Qs+Co],lv=S[av+Co];ue+=dd*lv}}}}f[p*Me+m*st+y*lt+g*_+Ve]=ue}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const pue={kernelName:PC,backendName:"cpu",kernelFunc:fue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mue=dt(zf,t=>Math.cos(t)),gue={kernelName:zf,backendName:"cpu",kernelFunc:mue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yue=dt(Uf,t=>Math.cosh(t)),xue={kernelName:Uf,backendName:"cpu",kernelFunc:yue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vue(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,[u,d,h,f]=r.shape,p=i.shape[0],[m,y]=a,g=He([p,m,y,f],"float32"),x=n.data.get(i.dataId).values,v=n.data.get(o.dataId).values,b=n.data.get(r.dataId).values,k=Ne(r.shape),C=Ne(g.shape);for(let S=0;S<p;S++){const I=S*4,N=x[I],E=x[I+1],D=x[I+2],R=x[I+3],L=v[S];if(L>=u)continue;const B=m>1?(D-N)*(d-1)/(m-1):0,W=y>1?(R-E)*(h-1)/(y-1):0;for(let G=0;G<m;G++){const q=m>1?N*(d-1)+G*B:.5*(N+D)*(d-1);if(q<0||q>d-1){for(let A=0;A<y;A++)for(let z=0;z<f;z++){const P=z+A*C[2]+G*C[1]+S*C[0];g.values[P]=c}continue}if(l==="bilinear"){const A=Math.floor(q),z=Math.ceil(q),P=q-A;for(let X=0;X<y;X++){const te=y>1?E*(h-1)+X*W:.5*(E+R)*(h-1);if(te<0||te>h-1){for(let de=0;de<f;de++){const ge=de+X*C[2]+G*C[1]+S*C[0];g.values[ge]=c}continue}const se=Math.floor(te),ce=Math.ceil(te),ie=te-se;for(let de=0;de<f;de++){let ge=de+se*k[2]+A*k[1]+L*k[0];const Ee=b[ge];ge=de+ce*k[2]+A*k[1]+L*k[0];const Te=b[ge];ge=de+se*k[2]+z*k[1]+L*k[0];const Me=b[ge];ge=de+ce*k[2]+z*k[1]+L*k[0];const Ve=b[ge],st=Ee+(Te-Ee)*ie,ht=Me+(Ve-Me)*ie;ge=de+X*C[2]+G*C[1]+S*C[0],g.values[ge]=st+(ht-st)*P}}}else for(let A=0;A<y;++A){const z=y>1?E*(h-1)+A*W:.5*(E+R)*(h-1);if(z<0||z>h-1){for(let te=0;te<f;te++){const se=te+A*C[2]+G*C[1]+S*C[0];g.values[se]=c}continue}const P=Math.round(z),X=Math.round(q);for(let te=0;te<f;te++){const se=te+P*k[2]+X*k[1]+L*k[0],ce=te+A*C[2]+G*C[1]+S*C[0];g.values[ce]=b[se]}}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const bue={kernelName:FC,backendName:"cpu",kernelFunc:vue};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;we(r,"cumprod");const l=Lt([i],r.shape.length);let c=r;l!=null&&(c=gs({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=Zt(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=Rs(c.dtype,"int32"),h=wC(Q(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(g,x)=>g+p-x-1:(g,x)=>g+x;for(let g=0;g<f.length;g+=p)for(let x=0;x<p;x++){const v=m(g,x);if(x===0)h[v]=o?1:f[v];else{const b=m(g,x-1);h[v]=o?f[b]*h[b]:f[v]*h[b]}}const y=n.makeTensorInfo(c.shape,d,h);if(l!=null){const g=Oa(l),x=gs({inputs:{x:y},backend:n,attrs:{perm:g}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(c),x}return y}const kue={kernelName:OC,backendName:"cpu",kernelFunc:wue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;we(r,"cumsum");const l=Lt([i],r.shape.length);let c=r;l!=null&&(c=gs({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=Zt(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=Rs(c.dtype,"int32"),h=Ln(Q(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(g,x)=>g+p-x-1:(g,x)=>g+x;for(let g=0;g<f.length;g+=p)for(let x=0;x<p;x++){const v=m(g,x);if(x===0)h[v]=o?0:f[v];else{const b=m(g,x-1);h[v]=o?f[b]+h[b]:f[v]+h[b]}}const y=n.makeTensorInfo(c.shape,d,h);if(l!=null){const g=Oa(l),x=gs({inputs:{x:y},backend:n,attrs:{perm:g}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(c),x}return y}const Sue={kernelName:Nx,backendName:"cpu",kernelFunc:Cue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=WI(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=rV(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Tue={kernelName:MC,backendName:"cpu",kernelFunc:Iue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s;T(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],d=l*i,h=c*i,f=u/(i*i),p=n.data.get(r.dataId).values,m=new Float32Array(a*d*h*f);let y=0;for(let g=0;g<a;++g)for(let x=0;x<d;++x){const v=Math.floor(x/i),b=x%i;for(let k=0;k<h;++k){const C=Math.floor(k/i),S=k%i,I=(b*i+S)*f;for(let N=0;N<f;++N){const D=N+I+u*(C+c*(v+l*g));m[y++]=p[D]}}}return n.makeTensorInfo([a,d,h,f],r.dtype,m)}const Eue={kernelName:LC,backendName:"cpu",kernelFunc:Nue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rB(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;we([r,i],"depthwiseConv2DNative");const u=Ne(r.shape),d=Ne(i.shape);let h=l;h==null&&(h=[1,1]),T(Bn(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const f=$n(r.shape,i.shape,o,h,a,c,!0),{filterHeight:p,filterWidth:m,dilationHeight:y,dilationWidth:g,padInfo:x}=f,v=x.left,b=x.top,k=f.outChannels/f.inChannels,C=new En(f.outShape,r.dtype),S=n.data.get(r.dataId).values,I=n.data.get(i.dataId).values,N=C.values;for(let E=0;E<f.batchSize;++E){const D=E*u[0],R=E*C.strides[0];for(let L=0;L<f.outHeight;++L){const B=R+L*C.strides[1],W=L*f.strideHeight-b;for(let G=0;G<p;++G){const q=W+G*y;if(q<0||q>=f.inHeight)continue;const A=G*d[0],z=D+q*u[1];for(let P=0;P<f.outWidth;++P){const X=B+P*C.strides[2],te=P*f.strideWidth-v;for(let se=0;se<m;++se){const ce=te+se*g;if(ce<0||ce>=f.inWidth)continue;const ie=A+se*d[1],de=z+ce*f.inChannels;let ge=X,Ee=ie;for(let Te=0;Te<f.inChannels;++Te){const Me=S[de+Te];for(let Ve=0;Ve<k;++Ve)N[ge+Ve]+=Me*I[Ee+Ve];ge+=k,Ee+=k}}}}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const $ue={kernelName:Ex,backendName:"cpu",kernelFunc:rB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s;we([r,i],"depthwiseConv2dNativeBackpropFilter");const d=$n(r.shape,u,o,a,l,c,!0),{strideHeight:h,strideWidth:f,filterHeight:p,filterWidth:m}=d,y=new En(d.filterShape,"float32"),g=d.padInfo.left,x=d.padInfo.top,v=d.outChannels/d.inChannels,b=n.data.get(r.dataId).values,k=new En(r.shape,r.dtype,b),C=n.data.get(i.dataId).values,S=new En(i.shape,i.dtype,C);for(let I=0;I<p;++I){const N=Math.max(0,Math.ceil((x-I)/h)),E=Math.min(d.outHeight,(d.inHeight+x-I)/h);for(let D=0;D<m;++D){const R=Math.max(0,Math.ceil((g-D)/f)),L=Math.min(d.outWidth,(d.inWidth+g-D)/f);for(let B=0;B<d.outChannels;++B){const W=Math.trunc(B/v),G=B%v;let q=0;for(let A=0;A<d.batchSize;++A)for(let z=N;z<E;++z){const P=I+z*h-x;for(let X=R;X<L;++X){const te=D+X*f-g;q+=k.get(A,P,te,W)*S.get(A,z,X,B)}}y.set(q,I,D,W,G)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const Aue={kernelName:VC,backendName:"cpu",kernelFunc:_ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rue(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s;we([r,i],"depthwiseConv2DNativeBackpropInput");const d=Ne(r.shape),h=Ne(i.shape),f=$n(u,i.shape,o,a,l,c,!0),p=new En(f.inShape,"float32"),m=p.values,[y,g,x]=p.strides,v=n.data.get(r.dataId).values,[b,k,C]=d,S=n.data.get(i.dataId).values,[I,N,E]=h,{batchSize:D,filterHeight:R,filterWidth:L,inChannels:B,inHeight:W,inWidth:G,outChannels:q,outHeight:A,outWidth:z,strideHeight:P,strideWidth:X}=f,te=R-1-f.padInfo.top,se=L-1-f.padInfo.left,ce=q/B;for(let ie=0;ie<D;++ie)for(let de=0;de<B;++de)for(let ge=0;ge<W;++ge){const Ee=ge-te,Te=Math.max(0,Math.ceil(Ee/P)),Me=Math.min(A,(R+Ee)/P);for(let Ve=0;Ve<G;++Ve){const st=Ve-se,ht=Math.max(0,Math.ceil(st/X)),kt=Math.min(z,(L+st)/X);let ct=0;for(let lt=Te;lt<Me;++lt){const Ct=lt*P-Ee;for(let St=ht;St<kt;++St){const Js=St*X-st,_=b*ie+k*lt+C*St,K=I*(R-1-Ct)+N*(L-1-Js)+E*de;for(let ee=0;ee<ce;++ee){const pe=de*ce+ee,ue=v[_+pe],ae=S[K+ee];ct+=ue*ae}}}m[y*ie+g*ge+x*Ve+de]=ct}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const Due={kernelName:BC,backendName:"cpu",kernelFunc:Rue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pue(t){const{inputs:e,backend:n}=t,{x:s}=e,r=Q(s.shape),i=n.data.get(s.dataId).values,o=He([r,r],s.dtype),a=o.values;for(let c=0;c<i.length;c++)a[c*r+c]=i[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const Oue={kernelName:SF,backendName:"cpu",kernelFunc:Pue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fue={kernelName:$x,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:i,pad:o,dilations:a}=n,l=e,c=l.data.get(s.dataId).values,u=s.shape.length,d=l.data.get(r.dataId).values,h=r.shape.length,{batchSize:f,inHeight:p,inWidth:m,inChannels:y,outHeight:g,outWidth:x,padInfo:v,strideHeight:b,strideWidth:k,filterHeight:C,filterWidth:S,dilationHeight:I,dilationWidth:N,outShape:E}=Tp(s.shape,r.shape,i,o,"NHWC",a),D=Q(E),R=E.length,L=qt(s.dtype,D);for(let W=0;W<f;++W)for(let G=0;G<g;++G){const q=G*b-v.top;for(let A=0;A<x;++A){const z=A*k-v.left;for(let P=0;P<y;++P){let X=Number.MIN_SAFE_INTEGER;for(let se=0;se<C;++se){const ce=q+se*I;if(ce>=0&&ce<p)for(let ie=0;ie<S;++ie){const de=z+ie*N;if(de>=0&&de<m){const ge=xi([W,ce,de,P],u,Ne(s.shape)),Ee=xi([se,ie,P],h,Ne(r.shape)),Te=c[ge]+d[Ee];Te>X&&(X=Te)}}}const te=xi([W,G,A,P],R,Ne(E));L[te]=X}}}return{dataId:l.write(sc(L,s.dtype),E,s.dtype),shape:E,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mue={kernelName:qw,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=zr(s.shape,c.data.get(s.dataId).values),d=zr(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:y,outWidth:g,padInfo:x,strideHeight:v,strideWidth:b,filterHeight:k,filterWidth:C,dilationHeight:S,dilationWidth:I,outShape:N}=Tp(s.shape,r.shape,o,a,"NHWC",l);T(i.rank===N.length,()=>`Error in ${qw}, dy must have the same rank as output ${N.length}, but got ${i.rank}`);const E=zr(N,c.data.get(i.dataId).values),D=bF(r.shape,r.dtype);for(let L=0;L<h;++L)for(let B=0;B<y;++B){const W=B*v-x.top;for(let G=0;G<g;++G){const q=G*b-x.left;for(let A=0;A<m;++A){let z=Number.MIN_SAFE_INTEGER,P=0,X=0;for(let te=0;te<k;++te){const se=W+te*S;if(se>=0&&se<f)for(let ce=0;ce<C;++ce){const ie=q+ce*I;if(ie>=0&&ie<p){const de=u[L][se][ie][A]+d[te][ce][A];de>z&&(z=de,P=te,X=ce)}}}D[P][X][A]+=E[L][B][G][A]}}}return{dataId:c.write(sc(D,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lue={kernelName:Hw,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=zr(s.shape,c.data.get(s.dataId).values),d=zr(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:y,outWidth:g,padInfo:x,strideHeight:v,strideWidth:b,filterHeight:k,filterWidth:C,dilationHeight:S,dilationWidth:I,outShape:N}=Tp(s.shape,r.shape,o,a,"NHWC",l);T(i.rank===N.length,()=>`Error in ${Hw}, dy must have the same rank as output ${N.length}, but got ${i.rank}`);const E=zr(N,c.data.get(i.dataId).values),D=bF(s.shape,s.dtype);for(let L=0;L<h;++L)for(let B=0;B<y;++B){const W=B*v-x.top;for(let G=0;G<g;++G){const q=G*b-x.left;for(let A=0;A<m;++A){let z=Number.MIN_SAFE_INTEGER,P=W<0?0:W,X=q<0?0:q;for(let te=0;te<k;++te){const se=W+te*S;if(se>=0&&se<f)for(let ce=0;ce<C;++ce){const ie=q+ce*I;if(ie>=0&&ie<p){const de=u[L][se][ie][A]+d[te][ce][A];de>z&&(z=de,P=se,X=ie)}}}D[L][P][X][A]+=E[L][B][G][A]}}}return{dataId:c.write(sc(D,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vue(t){const{inputs:e,backend:n,attrs:s}=t,{image:r}=e,{canvas:i,options:o}=s,{contextOptions:a,imageOptions:l}=o||{},c=(l==null?void 0:l.alpha)||1,u=(a==null?void 0:a.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=i.getContext(u,(a==null?void 0:a.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${u} type.`);const[h,f]=r.shape.slice(0,2),p=r.shape.length===2?1:r.shape[2],m=n.data.get(r.dataId).values,y=r.dtype==="float32"?255:1,g=new Uint8ClampedArray(f*h*4);for(let v=0;v<h*f;++v){const b=[0,0,0,255*c];for(let C=0;C<p;C++){const S=m[v*p+C];if(r.dtype==="float32"){if(S<0||S>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${S}.`)}else if(r.dtype==="int32"&&(S<0||S>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${S}.`);p===1?(b[0]=S*y,b[1]=S*y,b[2]=S*y):b[C]=S*y}const k=v*4;g[k+0]=Math.round(b[0]),g[k+1]=Math.round(b[1]),g[k+2]=Math.round(b[2]),g[k+3]=Math.round(b[3])}i.width=f,i.height=h;const x=new ImageData(g,f,h);return d.putImageData(x,0,0),r}const Bue={kernelName:bZ,backendName:"cpu",kernelFunc:Vue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Up(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;we(r,"sum");let a;r.dtype==="bool"?a=ka({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):a=Ri({inputs:{x:r},backend:n});const l=a.shape.length,c=qe(i,a.shape),u=Lt(c,l);let d=c,h=a;u!=null&&(h=gs({inputs:{x:a},backend:n,attrs:{perm:u}}),d=Zt(d.length,l)),_n("sum",d,h.shape.length);const[f,p]=kn(h.shape,d),m=Rs(h.dtype,"int32");let y=Cy(n,f,m);const g=Q(p),x=n.data.get(y.dataId).values,v=n.data.get(h.dataId).values;for(let b=0;b<x.length;++b){const k=b*g;let C=0;for(let S=0;S<g;++S)C+=v[k+S];x[b]=C}if(o){const b=on(y.shape,c),k=y;y=wt({inputs:{x:y},backend:n,attrs:{shape:b}}),n.disposeIntermediateTensorInfo(k)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(h),y}const zue={kernelName:l0,backendName:"cpu",kernelFunc:Up};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uue(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=pI(r,i.length);gI(o.length,l,i);const{path:c,steps:u}=yI(a,l),d=u.length;let h=null,f=o.length;const p=[];for(let m=0;m<d;++m){for(const y of u[m]){const{permutationIndices:g,expandDims:x}=mI(f,l[y]);let v;xI(g)?v=i[y]:(v=gs({inputs:{x:i[y]},backend:n,attrs:{perm:g}}),p.push(v));const b=v.shape.slice();for(let k=0;k<x.length;++k)b.splice(x[k],0,1);at(v.shape,b)||(v=wt({inputs:{x:v},backend:n,attrs:{shape:b}}),p.push(v)),h===null?h=v:(h=B0({inputs:{a:v,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=Up({inputs:{x:h},backend:n,attrs:{axis:c[m]-(o.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const jue={kernelName:zC,backendName:"cpu",kernelFunc:Uue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wue(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;we([s,r],"eluGrad");const i=new Float32Array(Q(r.shape)),o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<o.length;++l){const c=o[l];c>=0?i[l]=a[l]:i[l]=a[l]*(c+1)}return n.makeTensorInfo(r.shape,"float32",i)}const Gue={kernelName:UC,backendName:"cpu",kernelFunc:Wue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hue=aI,que=lI,Kue=cI,Xue=uI,Yue=dI,Zue=hI,Jue=dt(Gf,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+Hue*n);return e*(1-((((Zue*s+Yue)*s+Xue)*s+Kue)*s+que)*s*Math.exp(-n*n))}),Que={kernelName:Gf,backendName:"cpu",kernelFunc:Jue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ty(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:i}=s,o=r.shape.length,a=r.shape.slice();let l=i;return i<0&&(T(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),wt({inputs:{x:r},backend:n,attrs:{shape:a}})}const ede={kernelName:Ax,backendName:"cpu",kernelFunc:Ty};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tde=Qt((t,e)=>t/e),YI=mn(jf,tde),b1={kernelName:jf,backendName:"cpu",kernelFunc:YI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iB(t,e,n){const s=t.shape,r=s[0],i=s[1],o=n.data.get(t.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,c=[r,i],u=Q(c),d=Mn("float32",u),h=Mn("float32",u);for(let y=0;y<r;y++){const g=ql({inputs:{x:a},backend:n,attrs:{begin:[y,0],size:[1,i]}}),x=ql({inputs:{x:l},backend:n,attrs:{begin:[y,0],size:[1,i]}}),v=ks({inputs:{real:g,imag:x},backend:n}),{real:b,imag:k}=nde(v,e,n),C=fo(b,k);for(let S=0;S<i;S++){const I=fI(C,S);d[y*i+S]=I.real,h[y*i+S]=I.imag}n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(v)}const f=n.makeTensorInfo(c,"float32",d),p=n.makeTensorInfo(c,"float32",h),m=ks({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}function nde(t,e,n){const s=Q(t.shape),r=n.data.get(t.dataId),i=n.data.get(r.complexTensorInfos.real.dataId).values,o=n.data.get(r.complexTensorInfos.imag.dataId).values;if(sde(s)){const a=w1(i,o,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",Da(s,"float32")),h=Ri({inputs:{x:d},backend:n}),f=b1.kernelFunc({inputs:{a:c,b:d},backend:n}),p=b1.kernelFunc({inputs:{a:u,b:h},backend:n}),m=n.data.get(f.dataId).values,y=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:m,imag:y}}return a}else{const a=fo(i,o),l=rde(a,s,e);return vL(l)}}function sde(t){return(t&t-1)===0}function w1(t,e,n,s,r){if(n===1)return{real:t,imag:e};const i=fo(t,e),o=n/2,a=bL(i),l=a.real,c=a.imag,u=[l.length],d=r.makeTensorInfo(u,"float32",l),h=r.makeTensorInfo(u,"float32",c),f=ks({inputs:{real:d,imag:h},backend:r}),p=wL(i),m=p.real,y=p.imag,g=[m.length],x=r.makeTensorInfo(g,"float32",m),v=r.makeTensorInfo(g,"float32",y),b=ks({inputs:{real:x,imag:v},backend:r}),k=w1(l,c,o,s,r),C=k.real,S=k.imag,I=[C.length],N=r.makeTensorInfo(I,"float32",C),E=r.makeTensorInfo(I,"float32",S),D=ks({inputs:{real:N,imag:E},backend:r}),R=w1(m,y,o,s,r),L=R.real,B=R.imag,W=[L.length],G=r.makeTensorInfo(W,"float32",L),q=r.makeTensorInfo(W,"float32",B),A=ks({inputs:{real:G,imag:q},backend:r}),z=CL(n,s),P=[z.real.length],X=r.makeTensorInfo(P,"float32",z.real),te=r.makeTensorInfo(P,"float32",z.imag),se=ks({inputs:{real:X,imag:te},backend:r}),ce=B0({inputs:{a:se,b:A},backend:r}),ie=Nu({inputs:{a:D,b:ce},backend:r}),de=KI({inputs:{a:D,b:ce},backend:r}),ge=Hl({inputs:{input:ie},backend:r}),Ee=Hl({inputs:{input:de},backend:r}),Te=Eu({inputs:{input:ie},backend:r}),Me=Eu({inputs:{input:de},backend:r}),Ve=$u({inputs:[ge,Ee],backend:r,attrs:{axis:0}}),st=$u({inputs:[Te,Me],backend:r,attrs:{axis:0}}),ht=r.data.get(Ve.dataId).values,kt=r.data.get(st.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(N),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(G),r.disposeIntermediateTensorInfo(q),r.disposeIntermediateTensorInfo(A),r.disposeIntermediateTensorInfo(X),r.disposeIntermediateTensorInfo(te),r.disposeIntermediateTensorInfo(se),r.disposeIntermediateTensorInfo(ce),r.disposeIntermediateTensorInfo(ie),r.disposeIntermediateTensorInfo(de),r.disposeIntermediateTensorInfo(ge),r.disposeIntermediateTensorInfo(Te),r.disposeIntermediateTensorInfo(Ee),r.disposeIntermediateTensorInfo(Me),r.disposeIntermediateTensorInfo(Ve),r.disposeIntermediateTensorInfo(st),{real:ht,imag:kt}}function rde(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let i=0,o=0;for(let a=0;a<e;a++){const l=SL(r*a,e,n),c=fI(t,a);i+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}n&&(i/=e,o/=e),kL(s,i,o,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ide(t){const{inputs:e,backend:n}=t,{input:s}=e,r=Q(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=wt({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=iB(a,!1,n),c=wt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const ode={kernelName:jC,backendName:"cpu",kernelFunc:ide};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZI(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:i}=n,o=i||Wu(r),a=qt(o,Q(s));return lde(a,r,o),e.makeTensorInfo(s,o,a)}const ade={kernelName:WC,backendName:"cpu",kernelFunc:ZI};function lde(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cde={kernelName:GC,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,i=Mn(s.dtype,Q(s.shape)),[o,a,l,c]=s.shape,u=r.data.get(s.dataId).values;for(let h=0;h<o;h++){const f=h*l*a*c;for(let p=0;p<a;p++){const m=p*(l*c);for(let y=0;y<l;y++){const g=y*c;for(let x=0;x<c;x++){const v=Math.round(l-y-1),b=f+m+g+x;let k=u[b];if(v>=0&&v<l){const C=v*c,S=f+m+C+x;k=u[S]}i[b]=k}}}}return{dataId:r.write(i,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ude(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s;let m=sB({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const y=m;if(u==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const g=wt({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=Nu({inputs:{a:m,b:g},backend:n}),n.disposeIntermediateTensorInfo(g)}else m=Nu({inputs:{a:m,b:o},backend:n});n.disposeIntermediateTensorInfo(y)}if(f){const y=m;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const g=wt({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=Iy(n,m,f,g,p),n.disposeIntermediateTensorInfo(g)}else m=Iy(n,m,f,a,p);n.disposeIntermediateTensorInfo(y)}return m}const dde={kernelName:iy,backendName:"cpu",kernelFunc:ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s;let m=rB({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const y=m;m=Nu({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(y)}if(f){const y=m;m=Iy(n,m,f,a,p),n.disposeIntermediateTensorInfo(y)}return m}const fde={kernelName:jF,backendName:"cpu",kernelFunc:hde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pde(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=Q(s.shape),o=r.shape,a=o[o.length-1],[l,c,u,d]=YS(s,r);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const h=n.data.get(r.dataId).values,f=n.bufferSync(s),p=mV(h,f,s.dtype,c,a,u,d,s.shape,i);return n.makeTensorInfo(l,s.dtype,p.values)}const mde={kernelName:IF,backendName:"cpu",kernelFunc:pde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s;we([r,i],"gatherV2");const l=qe(o,r.shape)[0],c=n.data.get(i.dataId).values,u=r.shape[l];for(let b=0;b<c.length;++b){const k=c[b];T(k<=u-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${u-1}]`)}let d=a;a==null&&(d=0);const h=Q(i.shape),f=bI(r,i,l,d),p=wt({inputs:{x:r},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=wt({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,h/f.batchSize]}}),y=[f.batchSize,f.outerSize,h/f.batchSize,f.sliceSize],g=n.bufferSync(m),x=n.bufferSync(p),v=gV(x,g,y);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(f.outputShape,v.dtype,v.values)}const yde={kernelName:Dx,backendName:"cpu",kernelFunc:gde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xde(t){const{inputs:e,backend:n}=t,{input:s}=e,r=Q(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=wt({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=iB(a,!0,n),c=wt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const vde={kernelName:HC,backendName:"cpu",kernelFunc:xde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bde=dt(Jf,t=>Number.isFinite(t)?1:0,"bool"),wde={kernelName:Jf,backendName:"cpu",kernelFunc:bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kde=dt(Qf,t=>Math.abs(t)===1/0?1:0,"bool"),Cde={kernelName:Qf,backendName:"cpu",kernelFunc:kde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sde=dt(ep,t=>Number.isNaN(t)?1:0,"bool"),Ide={kernelName:ep,backendName:"cpu",kernelFunc:Sde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tde(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=wV(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const Nde={kernelName:TF,backendName:"cpu",kernelFunc:Tde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ede=dt(np,t=>Math.log1p(t)),$de={kernelName:np,backendName:"cpu",kernelFunc:Ede};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _de=Qt((t,e)=>t&&e),Ade=mn(Lx,_de,null,"bool"),Rde={kernelName:Lx,backendName:"cpu",kernelFunc:Ade};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dde=dt(Vx,t=>t?0:1,"bool"),Pde={kernelName:Vx,backendName:"cpu",kernelFunc:Dde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ode=Qt((t,e)=>t||e),Fde=mn(Bx,Ode,null,"bool"),Mde={kernelName:Bx,backendName:"cpu",kernelFunc:Fde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s;we(r,"LRN");const c=r.shape[3],u=c-1,d=n.data.get(r.dataId).values,h=Q(r.shape),f=new Float32Array(h);function p(m){const y=m%c;let g=m-y+Math.max(0,y-i);const x=m-y+Math.min(y+i,u);let v=0;for(;g<=x;g++){const b=d[g];v+=b*b}return v}for(let m=0;m<h;m++){const y=p(m),g=d[m]*Math.pow(o+a*y,-l);f[m]=g}return n.makeTensorInfo(r.shape,r.dtype,f)}const Vde={kernelName:zx,backendName:"cpu",kernelFunc:Lde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s;we(o,"LRNGrad");const d=Q(o.shape),h=o.shape[3],f=n.data.get(o.dataId).values,p=n.data.get(r.dataId).values,m=n.data.get(i.dataId).values,y=new Float32Array(d),g=d;for(let x=0;x<g;x++){const v=x%h,b=x-v+Math.max(0,v-a),k=x-v+Math.min(h,v+a+1);let C=0;for(let S=b;S<k;S++)C+=Math.pow(p[S],2);C=c*C+l;for(let S=b;S<k;S++){let I=-2*c*u*p[S]*m[x]/C;x===S&&(I+=Math.pow(C,-u)),I*=f[x],y[S]+=I}}return n.makeTensorInfo(o.shape,r.dtype,y)}const zde={kernelName:KC,backendName:"cpu",kernelFunc:Bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oB(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=n;let l=r.shape;const c=l.length,u=qe(i,l);let d=u;const h=Lt(d,c);let f=a.data.get(r.dataId).values;if(h!=null){const b=new Array(c);for(let k=0;k<b.length;k++)b[k]=l[h[k]];f=HI(f,l,r.dtype,h,b),d=Zt(d.length,c),l=b}we(r,"max"),_n("max",d,c);const[p,m]=kn(l,d),y=Q(m),g=CV(f,y,p,r.dtype),x=a.write(g,p,r.dtype);let v=p;return o&&(v=on(p,u)),{dataId:x,shape:v,dtype:r.dtype}}const Ude={kernelName:Ux,backendName:"cpu",kernelFunc:oB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;we(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;T(Bn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=br(r.shape,i,o,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&at(u.inShape,u.outShape))d=Ri({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=Ne(r.shape),p=XI(h,r.shape,r.dtype,f,u,"max");d=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return d}const Wde={kernelName:jx,backendName:"cpu",kernelFunc:jde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;we(r,"maxPool3d");const u=vo(r.shape,i,o,1,a,l,c),d=n.data.get(r.dataId).values,h=nB(d,r.shape,r.dtype,Ne(r.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const Hde={kernelName:Wx,backendName:"cpu",kernelFunc:Gde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qde(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;we([r,i],"maxPool3DGrad");const u=vo(i.shape,o,a,1,l,c),d=n.bufferSync(i),h=Oce(d,u),f=u.strideDepth,p=u.strideHeight,m=u.strideWidth,y=u.dilationDepth,g=u.dilationHeight,x=u.dilationWidth,v=u.effectiveFilterDepth,b=u.effectiveFilterHeight,k=u.effectiveFilterWidth,C=v-1-u.padInfo.front,S=k-1-u.padInfo.left,I=b-1-u.padInfo.top,N=He(i.shape,"float32"),E=n.bufferSync(r);for(let D=0;D<u.batchSize;++D)for(let R=0;R<u.inChannels;++R)for(let L=0;L<u.inDepth;++L)for(let B=0;B<u.inHeight;++B)for(let W=0;W<u.inWidth;++W){const G=L-C,q=B-I,A=W-S;let z=0;for(let P=0;P<v;P+=y){const X=(G+P)/f;if(!(X<0||X>=u.outDepth||Math.floor(X)!==X))for(let te=0;te<b;te+=g){const se=(q+te)/p;if(!(se<0||se>=u.outHeight||Math.floor(se)!==se))for(let ce=0;ce<k;ce+=x){const ie=(A+ce)/m;if(ie<0||ie>=u.outWidth||Math.floor(ie)!==ie)continue;const de=v*b*k-1-h.get(D,X,se,ie,R),ge=P*b*k+te*k+ce,Ee=de===ge?1:0;if(Ee===0)continue;const Te=E.get(D,X,se,ie,R);z+=Te*Ee}}}N.set(z,D,L,B,W,R)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const Kde={kernelName:YC,backendName:"cpu",kernelFunc:qde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xde(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;we([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=br(a.shape,l,c,1,u,d),f=n.data.get(a.dataId).values,p=He(h.outShape,a.dtype,tB(f,a.shape,a.dtype,h).values),m=h.strideHeight,y=h.strideWidth,g=h.dilationHeight,x=h.dilationWidth,v=h.effectiveFilterHeight,b=h.effectiveFilterWidth,k=b-1-h.padInfo.left,C=v-1-h.padInfo.top,S=He(a.shape,"float32"),I=n.data.get(r.dataId).values,N=He(r.shape,"float32",I);for(let E=0;E<h.batchSize;++E)for(let D=0;D<h.inChannels;++D)for(let R=0;R<h.inHeight;++R)for(let L=0;L<h.inWidth;++L){const B=R-C,W=L-k;let G=0;for(let q=0;q<v;q+=g){const A=(B+q)/m;if(!(A<0||A>=h.outHeight||Math.floor(A)!==A))for(let z=0;z<b;z+=x){const P=(W+z)/y;if(P<0||P>=h.outWidth||Math.floor(P)!==P)continue;const X=v*b-1-p.get(E,A,P,D),te=q*b+z,se=X===te?1:0;if(se===0)continue;const ce=N.get(E,A,P,D);G+=ce*se}}S.set(G,E,R,L,D)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const Yde={kernelName:XC,backendName:"cpu",kernelFunc:Xde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zde(t,e,n,s,r){const i=Ne(e),o=XI(t,e,n,i,r,"max"),a=tB(t,e,n,r,!0,s);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jde={kernelName:NF,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;we(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,u=br(s.shape,r,i,[1,1],o),[d,h]=Zde(c,s.shape,s.dtype,a,u),f=l.write(d,u.outShape,s.dtype),p=l.write(h,u.outShape,s.dtype);return[{dataId:f,shape:u.outShape,dtype:s.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=qe(i,r.shape),c=kn(r.shape,a)[1],u=Q(c),d=[],h=n.makeTensorInfo([],"float32",new Float32Array([u]));d.push(h);const f=ka({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});d.push(f);const p=YI({inputs:{a:f,b:h},backend:n});d.push(p);const m=Up({inputs:{x:p},backend:n,attrs:{axis:i,keepDims:o}});return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),m}const ehe={kernelName:Gx,backendName:"cpu",kernelFunc:Qde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function the(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;we(r,"min");const a=qe(i,r.shape);let l=a;const c=Lt(l,r.shape.length);let u=r;c!=null&&(u=gs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=Zt(l.length,r.shape.length)),_n("min",l,u.shape.length);const[d,h]=kn(u.shape,l),f=Q(h),p=Ln(Q(d),u.dtype),m=n.data.get(u.dataId).values;for(let g=0;g<p.length;++g){const x=g*f;let v=m[x];for(let b=0;b<f;++b){const k=m[x+b];(Number.isNaN(k)||k<v)&&(v=k)}p[g]=v}c!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(d,u.dtype,p);if(o){const g=on(d,a),x=wt({inputs:{x:y},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(y),x}return y}const nhe={kernelName:Hx,backendName:"cpu",kernelFunc:the};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function she(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,mode:o}=s;we(r,"mirrorPad");const a=i.map((v,b)=>v[0]+r.shape[b]+v[1]),l=i.map(v=>v[0]),c=i.map((v,b)=>v[0]+r.shape[b]),u=o==="reflect"?0:1,d=n.data.get(r.dataId).values,h=r.shape.length,f=Ne(r.shape),p=Q(a),m=a.length,y=Ne(a),g=Mn(r.dtype,p);for(let v=0;v<p;v++){let b=Gu(v,m,y);for(let C=0;C<m;C++)b[C]<l[C]?b[C]=l[C]*2-b[C]-u:b[C]>=c[C]&&(b[C]=(c[C]-1)*2-b[C]+u);b=b.map((C,S)=>C-l[S]);const k=xi(b,h,f);g[v]=d[k]}return{dataId:n.write(g,a,r.dtype),shape:a,dtype:r.dtype}}const rhe={kernelName:qx,backendName:"cpu",kernelFunc:she};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ihe=Qt((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),ohe=mn(ip,ihe),ahe={kernelName:ip,backendName:"cpu",kernelFunc:ohe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aB(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=r.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=qe([a],r.shape),c=oB({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=on(c.shape,l),d=wt({inputs:{x:c},backend:n,attrs:{shape:u}}),h=KI({inputs:{a:r,b:d},backend:n}),f=dV({inputs:{x:h},backend:n}),p=Up({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),m=wt({inputs:{x:p},backend:n,attrs:{shape:u}}),y=YI({inputs:{a:f,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),y}const lhe={kernelName:d0,backendName:"cpu",kernelFunc:aB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function che(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s;we(r,"multinomial");const l=a?r:aB({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,h=[c,i],f=Ln(Q(h),"int32");for(let p=0;p<c;++p){const m=p*u,y=new Float32Array(u-1);y[0]=d[m];for(let v=1;v<y.length;++v)y[v]=y[v-1]+d[m+v];const g=FS.alea(o.toString()),x=p*i;for(let v=0;v<i;++v){const b=g();f[x+v]=y.length;for(let k=0;k<y.length;k++)if(b<y[k]){f[x+v]=k;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",f)}const uhe={kernelName:EF,backendName:"cpu",kernelFunc:che};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dhe=GS;function hhe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s;we(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:d}=dhe(c,u,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const fhe={kernelName:ZC,backendName:"cpu",kernelFunc:hhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const phe=HS;function mhe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s;we(r,"NonMaxSuppressionPadded");const u=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:h,validOutputs:f}=phe(u,d,o,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const ghe={kernelName:JC,backendName:"cpu",kernelFunc:mhe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yhe=qS;function xhe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s;we(r,"NonMaxSuppressionWithScore");const u=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,h=o,f=a,p=l,m=c,{selectedIndices:y,selectedScores:g}=yhe(u,d,h,f,p,m);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const vhe={kernelName:QC,backendName:"cpu",kernelFunc:xhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bhe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s;we(r,"oneHot");const c=Q(r.shape),u=new Float32Array(c*o);u.fill(l);const d=n.data.get(r.dataId).values;for(let h=0;h<c;++h)d[h]>=0&&d[h]<o&&(u[h*o+d[h]]=a);return n.makeTensorInfo([...r.shape,o],i,u)}const whe={kernelName:Zx,backendName:"cpu",kernelFunc:bhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ny(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Hl({inputs:{input:s},backend:n}),i=Ny({inputs:{x:r},backend:n}),o=Eu({inputs:{input:s},backend:n}),a=Ny({inputs:{x:o},backend:n}),l=ks({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return ZI({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const khe={kernelName:p0,backendName:"cpu",kernelFunc:Ny};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lB(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Hl({inputs:{input:s},backend:n}),i=lB({inputs:{x:r},backend:n}),o=Eu({inputs:{input:s},backend:n}),a=Ny({inputs:{x:o},backend:n}),l=ks({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return ZI({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const Che={kernelName:Yx,backendName:"cpu",kernelFunc:lB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cB(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return Ty({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{bC(i,u.shape,"All tensors passed to stack must have matching shapes"),T(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=Ty({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=$u({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const She={kernelName:Jx,backendName:"cpu",kernelFunc:cB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ihe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;we(r,"pad");const a=i.map((x,v)=>x[0]+r.shape[v]+x[1]),l=i.map(x=>x[0]),c=n.data.get(r.dataId).values,u=Q(r.shape),d=r.shape.length,h=Ne(r.shape),f=Q(a),p=a.length,m=Ne(a),y=Mn(r.dtype,f);o!==0&&y.fill(o);for(let x=0;x<u;x++){const b=Gu(x,d,h).map((C,S)=>C+l[S]),k=xi(b,p,m);y[k]=c[x]}return{dataId:n.write(y,a,r.dtype),shape:a,dtype:r.dtype}}const uB={kernelName:Qx,backendName:"cpu",kernelFunc:Ihe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const The=Qt((t,e)=>Math.pow(t,e)),Nhe=mn(ap,The),Ehe={kernelName:ap,backendName:"cpu",kernelFunc:Nhe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $he(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=s,l=r.map(g=>n.data.get(g.dataId).values),c=r.map(g=>g.shape),u=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,[h,f,p]=$V(l,c,u,i.shape,i.dtype,d,o.shape),m=h.map(g=>n.makeTensorInfo([g.length],"int32",g)),y=n.makeTensorInfo(p,i.dtype,f);return m.concat([y])}const _he={kernelName:$F,backendName:"cpu",kernelFunc:$he};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ahe(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:i}=e,o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=_V(o,s.shape,s.dtype,a,r.shape,l,i.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],s.dtype,u);return[d,h]}const Rhe={kernelName:_F,backendName:"cpu",kernelFunc:Ahe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dhe(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,h=a.map(y=>n.data.get(y.dataId).values),f=a.map(y=>y.shape),[p,m]=AV(c,r.shape,u,i.shape,i.dtype,d,o.shape,h,f,l);return n.makeTensorInfo(p,i.dtype,m)}const Phe={kernelName:AF,backendName:"cpu",kernelFunc:Dhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ohe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:i,step:o}=n,a=RV(s,r,o,i);return e.makeTensorInfo([a.length],i,a)}const Fhe={kernelName:eS,backendName:"cpu",kernelFunc:Ohe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mhe=dt(lp,t=>1/t),Lhe={kernelName:lp,backendName:"cpu",kernelFunc:Mhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vhe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;we(r,"resizeBilinear");const l=Ne(r.shape),[c,u]=a,[d,h,f,p]=r.shape,m=n.data.get(r.dataId).values,y=new Float32Array(Q([d,c,u,p])),g=[i&&c>1?h-1:h,i&&u>1?f-1:f],x=[i&&c>1?c-1:c,i&&u>1?u-1:u];let v=0;const b=g[0]/x[0],k=g[1]/x[1];for(let C=0;C<d;C++)for(let S=0;S<c;S++){let I;o?I=b*(S+.5)-.5:I=b*S;const N=Math.max(0,Math.floor(I)),E=I-N,D=Math.min(h-1,Math.ceil(I)),R=C*l[0]+N*l[1],L=C*l[0]+D*l[1];for(let B=0;B<u;B++){let W;o?W=k*(B+.5)-.5:W=k*B;const G=Math.max(0,Math.floor(W)),q=W-G,A=Math.min(f-1,Math.ceil(W)),z=R+G*l[2],P=L+G*l[2],X=R+A*l[2],te=L+A*l[2];for(let se=0;se<p;se++){const ce=m[z+se],ie=m[P+se],de=m[X+se],ge=m[te+se],Ee=ce+(de-ce)*q,Te=ie+(ge-ie)*q,Me=Ee+(Te-Ee)*E;y[v++]=Me}}}return n.makeTensorInfo([d,c,u,p],"float32",y)}const Bhe={kernelName:r0,backendName:"cpu",kernelFunc:Vhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zhe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;we([i,r],"resizeBilinearGrad");const a=Ne(r.shape),[l,c,u,d]=r.shape,[,h,f]=i.shape,p=new Float32Array(l*c*u*d),m=[o&&h>1?c-1:c,o&&f>1?u-1:u],y=[o&&h>1?h-1:h,o&&f>1?f-1:f],g=m[0]/y[0],x=m[1]/y[1],v=n.data.get(i.dataId).values;let b=0;for(let k=0;k<l;k++){const C=k*a[0];for(let S=0;S<h;S++){const I=S*g,N=Math.floor(I),E=Math.min(Math.ceil(I),c-1),D=C+N*a[1],R=C+E*a[1],L=I-N,B=1-L;for(let W=0;W<f;W++){const G=W*x,q=Math.floor(G),A=Math.min(Math.ceil(G),u-1),z=G-q,P=1-z,X=D+q*a[2],te=D+A*a[2],se=R+q*a[2],ce=R+A*a[2],ie=B*P,de=B*z,ge=L*P,Ee=L*z;for(let Te=0;Te<d;Te++){const Me=v[b++];p[X+Te]+=Me*ie,p[te+Te]+=Me*de,p[se+Te]+=Me*ge,p[ce+Te]+=Me*Ee}}}}return n.makeTensorInfo([l,u,c,d],"float32",p)}const Uhe={kernelName:sS,backendName:"cpu",kernelFunc:zhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jhe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;we(r,"resizeNearestNeighbor");const l=Ne(r.shape),[c,u]=a,[d,h,f,p]=r.shape,m=n.data.get(r.dataId).values,y=new Float32Array(d*c*u*p),g=[i&&c>1?h-1:h,i&&u>1?f-1:f],x=[i&&c>1?c-1:c,i&&u>1?u-1:u],v=g[0]/x[0],b=g[1]/x[1];let k=0;for(let C=0;C<d;C++){const S=C*l[0];for(let I=0;I<c;I++){const N=o?v*(I+.5):v*I;let E=Math.min(h-1,i?Math.round(N):Math.floor(N));o&&(E=Math.max(0,E));const D=S+E*l[1];for(let R=0;R<u;R++){const L=o?b*(R+.5):b*R;let B=Math.min(f-1,i?Math.round(L):Math.floor(L));o&&(B=Math.max(0,B));const W=D+B*l[2];for(let G=0;G<p;G++){const q=m[W+G];y[k++]=q}}}}return n.makeTensorInfo([d,c,u,p],r.dtype,y)}const Whe={kernelName:s0,backendName:"cpu",kernelFunc:jhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ghe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;we([i,r],"resizeNearestNeighborGrad");const a=Ne(r.shape),l=Ne(i.shape),[c,u,d,h]=r.shape,[,f,p]=i.shape,m=new Float32Array(c*u*d*h),y=n.data.get(i.dataId).values,g=[o&&f>1?u-1:u,o&&p>1?d-1:d],x=[o&&f>1?f-1:f,o&&p>1?p-1:p],v=g[0]/x[0],b=g[1]/x[1],k=1/v,C=1/b,S=Math.ceil(k)*2+2,I=Math.ceil(C)*2+2;for(let N=0;N<c;N++){const E=N*a[0];for(let D=0;D<u;D++){const R=E+D*a[1],L=Math.floor(D*k),B=Math.floor(L-S/2);for(let W=0;W<d;W++){const G=R+W*a[2],q=Math.floor(W*C),A=Math.floor(q-I/2);for(let z=0;z<h;z++){let P=0;for(let X=0;X<S;X++){const te=X+B;if(te<0||te>=f)continue;const se=E+te*l[1],ce=te*v,ie=Math.min(u-1,o?Math.round(ce):Math.floor(ce));if(D===ie)for(let de=0;de<I;de++){const ge=de+A;if(ge<0||ge>=p)continue;const Ee=se+ge*l[2],Te=ge*b,Me=Math.min(d-1,o?Math.round(Te):Math.floor(Te));W===Me&&(P+=y[Ee+z])}}m[G+z]=P}}}}return n.makeTensorInfo(r.shape,r.dtype,m)}const Hhe={kernelName:nS,backendName:"cpu",kernelFunc:Ghe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qhe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s;we(r,"reverse");const o=r.shape.length,a=qe(i,r.shape);if(o===0)return Ri({inputs:{x:r},backend:n});const l=new En(r.shape,r.dtype),c=n.bufferSync(r);for(let u=0;u<l.size;u++){const d=l.indexToLoc(u),h=d.slice();a.forEach(f=>h[f]=r.shape[f]-1-h[f]),l.set(c.get(...h),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const Khe={kernelName:i0,backendName:"cpu",kernelFunc:qhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xhe={kernelName:uS,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=Mn(s.dtype,Q(s.shape)),[c,u,d,h]=s.shape,[f,p]=rI(o,u,d),m=255,y=Math.sin(r),g=Math.cos(r),x=a.data.get(s.dataId).values;for(let b=0;b<c;b++){const k=b*d*u*h;for(let C=0;C<u;C++){const S=C*(d*h);for(let I=0;I<d;I++){const N=I*h;for(let E=0;E<h;E++){const D=[c,C,I,E],R=D[2],L=D[1];let B=(R-f)*g-(L-p)*y,W=(R-f)*y+(L-p)*g;B=Math.round(B+f),W=Math.round(W+p);let G=i;if(typeof i!="number"&&(E===3?G=m:G=i[E]),B>=0&&B<d&&W>=0&&W<u){const A=W*(d*h),z=B*h,P=k+A+z+E;G=x[P]}const q=k+S+N+E;l[q]=G}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yhe=dt(dp,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),Zhe={kernelName:dp,backendName:"cpu",kernelFunc:Yhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jhe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=ac(i,r,o),h=!0,f=n.bufferSync(r),p=n.bufferSync(i),m=dl(f,p,o,d,c,l,a,u,0,h);return n.makeTensorInfo(o,m.dtype,m.values)}const Qhe={kernelName:RF,backendName:"cpu",kernelFunc:Jhe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function efe(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function tfe(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function nfe(t,e,n,s,r,i){const o=qt("int32",n*r);for(let a=0;a<n;++a){const l=t.slice(a*s,(a+1)*s),c=a*r;for(let u=0;u<r;++u)o[c+u]=i==="left"?efe(l,e[u+c]):tfe(l,e[u+c])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sfe(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=nfe(a,l,r.shape[0],r.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",c)}const rfe={kernelName:PF,backendName:"cpu",kernelFunc:sfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ife(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e;we([s,r,i],"select");const o=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=Rs(r.dtype,i.dtype),d=Ln(Q(r.shape),u);let h=0;const f=o===0||o>1||r.shape.length===1?1:Q(r.shape.slice(1));for(let p=0;p<a.length;p++)for(let m=0;m<f;m++)a[p]===1?d[h++]=l[p]:d[h++]=c[p];return n.makeTensorInfo(r.shape,u,d)}const ofe={kernelName:o0,backendName:"cpu",kernelFunc:ife};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const afe=T0,lfe=N0,cfe=dt(fp,t=>t>=0?lfe*t:afe*(Math.exp(t)-1)),ufe={kernelName:fp,backendName:"cpu",kernelFunc:cfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dfe=dt(gp,t=>t<0?-1:t>0?1:0),hfe={kernelName:gp,backendName:"cpu",kernelFunc:dfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ffe=dt(pp,t=>Math.sin(t)),pfe={kernelName:pp,backendName:"cpu",kernelFunc:ffe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mfe=dt(mp,t=>Math.sinh(t)),gfe={kernelName:mp,backendName:"cpu",kernelFunc:mfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yfe=11920928955078125e-23,N$=Math.log(yfe)+2,xfe=dt(xp,t=>{const e=t>-N$,n=t<N$,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),vfe={kernelName:xp,backendName:"cpu",kernelFunc:xfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bfe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;we([r],"spaceToBatchND");const a=Q(i),l=[[0,0]];l.push(...o);for(let C=1+i.length;C<r.shape.length;++C)l.push([0,0]);const c=uB.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=Ap(c.shape,i,a,!1),d=Rp(u.length,i.length,!1),h=Dp(c.shape,i,a,!1),m=wt({inputs:{x:c},backend:n,attrs:{shape:u}}),x=gs({inputs:{x:m},backend:n,attrs:{perm:d}}),k=wt({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),k}const wfe={kernelName:c0,backendName:"cpu",kernelFunc:bfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kfe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[d,h,f,p,m]=FV(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(y=>Number(y)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const Cfe={kernelName:OF,backendName:"cpu",kernelFunc:kfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sfe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(r.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(i.dataId).values),[c,u,d]=MV(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const Ife={kernelName:FF,backendName:"cpu",kernelFunc:Sfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tfe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=qI(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const Nfe={kernelName:MF,backendName:"cpu",kernelFunc:Tfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Efe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=qI(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const $fe={kernelName:LF,backendName:"cpu",kernelFunc:Efe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _fe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=ac(i,r,a),f=!1,p=n.bufferSync(r);let m;switch(i.dtype){case"bool":{const y=n.bufferSync(i),g=!!n.data.get(o.dataId).values[0];m=dl(p,y,a,h,u,c,l,d,g,f);break}case"float32":{const y=n.bufferSync(i),g=n.data.get(o.dataId).values[0];m=dl(p,y,a,h,u,c,l,d,g,f);break}case"int32":{const y=n.bufferSync(i),g=n.data.get(o.dataId).values[0];m=dl(p,y,a,h,u,c,l,d,g,f);break}case"string":{const y=n.bufferSync(i),g=ya(n.data.get(o.dataId).values[0]);m=dl(p,y,a,h,u,c,l,d,g,f);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}const Afe={kernelName:VF,backendName:"cpu",kernelFunc:_fe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rfe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=qe(o,r.shape)[0],l=vI(r,i,a),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(d=>{const h=[...u];h[a]=d;const f=ql({inputs:{x:r},backend:n,attrs:{begin:c,size:h}});return c[a]+=d,f})}const Dfe={kernelName:u0,backendName:"cpu",kernelFunc:Rfe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pfe={kernelName:rS,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;we(n,"square");const r=s.data.get(n.dataId).values,i=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];i[a]=l*l}return{dataId:s.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ofe=dt(Ip,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),Ffe={kernelName:Ip,backendName:"cpu",kernelFunc:Ofe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mfe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s;we(r,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:y,isSimpleSlice:g,begin:x,end:v,strides:b}=tI(r.shape,i,o,a,l,c,u,d,h);let k;if(m)k=wt({inputs:{x:r},backend:n,attrs:{shape:p}});else if(y||g){T(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const C=JS(x,v,b),S=ql({inputs:{x:r},backend:n,attrs:{begin:x,size:C}});k=wt({inputs:{x:S},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(S)}else{const C=n.bufferSync(r),S=BV(f,C,b,x);k=n.makeTensorInfo(p,S.dtype,S.values)}return k}const Lfe={kernelName:oS,backendName:"cpu",kernelFunc:Mfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vfe(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=e,h=n.data.get(u.dataId).values,f=n.data.get(d.dataId).values,[p,m]=zV(h,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const Bfe={kernelName:BF,backendName:"cpu",kernelFunc:Vfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zfe(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[c,u,d]=UV(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Ufe={kernelName:zF,backendName:"cpu",kernelFunc:zfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jfe(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,a=jV(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const Wfe={kernelName:UF,backendName:"cpu",kernelFunc:jfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gfe=dt(kp,t=>Math.tan(t)),Hfe={kernelName:kp,backendName:"cpu",kernelFunc:Gfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qfe=dt(Cp,t=>Math.tanh(t)),Kfe={kernelName:Cp,backendName:"cpu",kernelFunc:qfe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xfe(t){const{inputs:e,backend:n}=t,{tensor:s,indices:r,updates:i}=e,{sliceRank:o,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=ac(i,r,s.shape),d=!1,h=n.bufferSync(r),f=n.bufferSync(i),p=n.bufferSync(s),m=dl(h,f,s.shape,u,l,a,o,c,p,d);return n.makeTensorInfo(s.shape,m.dtype,m.values)}const Yfe={kernelName:DF,backendName:"cpu",kernelFunc:Xfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zfe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;we(r,"tile");const o=GV(n.bufferSync(r),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const Jfe={kernelName:Sp,backendName:"cpu",kernelFunc:Zfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qfe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s;we(r,"topk");const a=n.data.get(r.dataId).values,[l,c]=qV(a,r.shape,r.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const epe={kernelName:aS,backendName:"cpu",kernelFunc:Qfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tpe(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=n,[u,d,h,f]=r.shape,[p,m]=c??[d,h],y=[u,p,m,f],g=Ne(r.shape),x=g[0],v=g[1],b=g[2],k=Ne(y),C=k[0],S=k[1],I=k[2],N=Mn(r.dtype,Q(y));N.fill(l);const E=s.data.get(r.dataId).values,D=s.data.get(i.dataId).values;for(let L=0;L<u;++L){const B=i.shape[0]===1?D:D.subarray(L*8,L*8+8);for(let W=0;W<p;++W)for(let G=0;G<m;++G)for(let q=0;q<f;++q){let A;const z=B[6]*G+B[7]*W+1;if(z===0)continue;const P=(B[0]*G+B[1]*W+B[2])/z,X=(B[3]*G+B[4]*W+B[5])/z,te=E$(P,h,a),se=E$(X,d,a);switch(o){case"nearest":A=ape(E,d,h,x,v,b,L,se,te,q,l);break;case"bilinear":A=lpe(E,d,h,x,v,b,L,se,te,q,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const ce=L*C+W*S+G*I+q;N[ce]=A}return s.makeTensorInfo(y,r.dtype,N)}return{dataId:s.write(N,y,r.dtype),shape:r.shape,dtype:r.dtype}}const npe={kernelName:lS,backendName:"cpu",kernelFunc:tpe};function E$(t,e,n){switch(n){case"reflect":return spe(t,e);case"wrap":return rpe(t,e);case"nearest":return ope(t,e);case"constant":default:return ipe(t)}}function spe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return Ol(0,n,e-1)}function rpe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return Ol(0,n,e-1)}function ipe(t,e){return t}function ope(t,e){return Ol(0,t,e-1)}function Ud(t,e,n,s,r,i,o,a,l,c,u){const d=o*s+a*r+l*i+c;return 0<=a&&a<e&&0<=l&&l<n?t[d]:u}function ape(t,e,n,s,r,i,o,a,l,c,u){const d=Math.round(a),h=Math.round(l);return Ud(t,e,n,s,r,i,o,d,h,c,u)}function lpe(t,e,n,s,r,i,o,a,l,c,u){const d=Math.floor(a),h=Math.floor(l),f=d+1,p=h+1,m=(p-l)*Ud(t,e,n,s,r,i,o,d,h,c,u)+(l-h)*Ud(t,e,n,s,r,i,o,d,p,c,u),y=(p-l)*Ud(t,e,n,s,r,i,o,f,h,c,u)+(l-h)*Ud(t,e,n,s,r,i,o,f,p,c,u);return(f-a)*m+(a-d)*y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cpe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;we(i,"unique");const o=s.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:c}=KV(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const upe={kernelName:cS,backendName:"cpu",kernelFunc:cpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dpe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r.shape.length,a=r.shape[i],l=new Array(o-1);let c=0;for(let f=0;f<o;f++)f!==i&&(l[c++]=r.shape[f]);const u=new Array(o).fill(0),d=r.shape.slice();d[i]=1;const h=new Array(a);for(let f=0;f<h.length;f++){u[i]=f;const p=ql({inputs:{x:r},backend:n,attrs:{begin:u,size:d}});h[f]=wt({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return h}const hpe={kernelName:h0,backendName:"cpu",kernelFunc:dpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s;we(r,"unsortedSegmentSum");const a=r.shape.length,l=i.shape.length,c=[],u=[],d=a-l;let h=i;for(let p=0;p<d;++p){const m=Ty({inputs:{input:h},backend:n,attrs:{dim:p+1}});h=m,u.push(m)}for(let p=0;p<o;++p){const m=Da(p,"int32"),y=n.makeTensorInfo([],"int32",m),g=cV({inputs:{a:y,b:h},backend:n}),x=ka({inputs:{x:g},backend:n,attrs:{dtype:"float32"}}),v=B0({inputs:{a:x,b:r},backend:n}),b=Up({inputs:{x:v},backend:n,attrs:{axis:0,keepDims:!1}});c.push(b),u.push(y),u.push(g),u.push(x),u.push(v),u.push(b)}const f=cB({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const ppe={kernelName:f0,backendName:"cpu",kernelFunc:fpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mpe=[cce,jae,dce,fce,Xae,mce,yce,vce,wce,Cce,Ice,Nce,$ce,Rce,Pce,Mce,Vce,zce,jce,ace,Gce,qce,Xce,Zae,Zce,qae,Qae,Qce,Wae,tue,sue,rue,oue,lue,uue,hue,pue,gue,xue,bue,kue,Sue,Tue,Eue,$ue,Aue,Due,Oue,Fue,Mue,Lue,Bue,jue,ece,Gue,ele,Que,tle,ede,sle,ode,ade,cde,ile,ale,dde,fde,mde,yde,cle,dle,Gae,vde,nue,wde,Cde,Ide,tce,fle,mle,Nde,yle,$de,Rde,Pde,Mde,Vde,zde,Ude,vle,Wde,Hde,Kde,Yde,Jde,ehe,nhe,wle,rhe,ahe,uhe,Cle,Ile,fhe,ghe,vhe,Nle,whe,Che,She,uB,Ehe,sce,_le,_he,Rhe,Phe,Fhe,Hae,b1,Lhe,rce,ice,oce,Bhe,Uhe,Whe,Hhe,Khe,Xhe,Zhe,Lle,Qhe,rfe,ofe,ufe,Ble,hfe,pfe,gfe,zle,lhe,vfe,wfe,Cfe,Ife,Nfe,$fe,Afe,Dfe,Wle,Pfe,Hle,Kle,Ffe,Lfe,Bfe,Ufe,Wfe,Jle,zue,Hfe,Kfe,Yfe,Jfe,epe,npe,Ele,upe,hpe,ppe,khe];for(const t of mpe)WF(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nl={},Tm={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function gpe(t,e){nl[t]=e}function Kr(t,e){if(!(t in nl)||e!=null){const s=xpe(t,e);if(s!==null)nl[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=nl[t];return n==null||n.isContextLost()?(delete nl[t],Kr(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),nl[t])}function ype(t){if(!Y().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function xpe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??ype(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete nl[t]},!1),Y().getBool("SOFTWARE_WEBGL_ENABLED")&&(Tm.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Tm)||n.getContext("experimental-webgl",Tm):n.getContext("webgl2",Tm)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var nf;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(nf||(nf={}));var Vs;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Vs||(Vs={}));var Tn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Tn||(Tn={}));function jp(t,e){return[e,t]}function vpe(t,e){return t*e}function Nm(t){const e=Q(t),n=Math.ceil(e/4);return Uw(n)}function Qu(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function bpe(t,e){const[n,s]=Qu(t,e);return n*s*4}function JI(t,e){const n=t;let s,r,i,o,a,l,c,u,d,h;return Y().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,c=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(s=t.RGBA,r=t.RGBA,i=t.RGBA,o=n.RGBA,a=t.RGBA,c=4,u=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ye(t,e){const n=e();return Y().getBool("DEBUG")&&wpe(t),n}function wpe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+Ipe(t,e))}const kpe=596e-10,Cpe=65504;function Spe(t){return!!(Y().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||kpe<Math.abs(t)&&Math.abs(t)<Cpe)}function Ipe(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Em(t,e){return wo(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function Tpe(t,e){const n=wo(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(ye(t,()=>t.shaderSource(n,e)),ye(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function Npe(t,e){const n=wo(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(ye(t,()=>t.shaderSource(n,e)),ye(t,()=>t.compileShader(n)),Y().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw dB(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const Epe=/ERROR: [0-9]+:([0-9]+):/g;function dB(t,e){const n=Epe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),i=r.length.toString().length+2,o=r.map((d,h)=>nu((h+1).toString(),i)+d);let a=0;for(let d=0;d<o.length;d++)a=Math.max(o[d].length,a);const l=o.slice(0,s-1),c=o.slice(s-1,s),u=o.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${nu(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function $pe(t){return wo(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function _pe(t,e){if(ye(t,()=>t.linkProgram(e)),!Y().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function lb(t,e){if(ye(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function Ape(t,e){const n=wo(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ye(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),ye(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Rpe(t,e){const n=wo(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ye(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),ye(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Dpe(t){return wo(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function Ppe(t,e){const n=Y().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function Ope(t){return wo(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function $$(t,e,n,s,r,i,o){const a=t.getAttribLocation(e,n);return a===-1?!1:(ye(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),ye(t,()=>t.vertexAttribPointer(a,r,t.FLOAT,!1,i,o)),ye(t,()=>t.enableVertexAttribArray(a)),!0)}function Fpe(t,e,n){zpe(t,n),ye(t,()=>t.activeTexture(t.TEXTURE0+n)),ye(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function Mpe(t,e,n){return wo(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function Lpe(t,e,n){return t.getUniformLocation(e,n)}function Vpe(t,e,n,s){ye(t,()=>Fpe(t,e,s)),ye(t,()=>t.uniform1i(n,s))}function cb(t,e,n){ye(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),ye(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function _$(t,e){ye(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),ye(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function $m(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Bpe(t,e))}function Bpe(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function wo(t,e,n){const s=ye(t,()=>e());if(s==null)throw new Error(n);return s}function zpe(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function _u(t,e=2){return Q(t.slice(0,t.length-e))}function Au(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function _m(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[_u(t),...Au(t)]),e}function Upe(t,e=!1){let n=Y().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=Y().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&Y().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((a,l)=>l>=t.length-2?vC(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Ra(t).newShape);let r=Q(t),i=null;t.length<=1&&r<=n?i=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>s&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=_u(t);let l=2,c=2;t.length&&([l,c]=Au(t)),r=a*(l/2)*(c/2),i=Uw(r).map(u=>u*2)}else i=Uw(r);return i}function Am(t){return t%2===0}function Ey(t,e){if(t=t.slice(-2),e=e.slice(-2),at(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||Am(n)&&Am(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Am(t[0])&&Am(e[0])}let ub,db;function jpe(t){if(ub==null){const e=Kr(t);ub=e.getParameter(e.MAX_TEXTURE_SIZE)}return ub}function Wpe(t){if(db==null){const e=Kr(t);db=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,db)}function Gpe(t){if(t===0)return 0;let e;const n=Kr(t);return pr(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:pr(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function pr(t,e){return t.getExtension(e)!=null}function A$(t){try{if(Kr(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Hpe(t){if(t===0)return!1;const e=Kr(t);if(t===1){if(!pr(e,"OES_texture_float"))return!1}else if(!pr(e,"EXT_color_buffer_float"))return!1;return k1(e)}function qpe(t){if(t===0)return!1;const e=Kr(t);if(t===1){if(!pr(e,"OES_texture_float")||!pr(e,"WEBGL_color_buffer_float"))return!1}else{if(pr(e,"EXT_color_buffer_float"))return k1(e);const s="EXT_color_buffer_half_float";if(pr(e,s)){const r=e.getExtension(s);return Kpe(e,r)}return!1}return k1(e)}function k1(t){const e=JI(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function Kpe(t,e){const n=JI(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(o),a}function Xpe(t){return t!==2?!1:Kr(t).fenceSync!=null}function Wp(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ce=Y();Ce.registerFlag("HAS_WEBGL",()=>Ce.getNumber("WEBGL_VERSION")>0);Ce.registerFlag("WEBGL_VERSION",()=>A$(2)?2:A$(1)?1:0);Ce.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ce.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ce.get("WEBGL_VERSION")===2);Ce.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ce.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ce.registerFlag("WEBGL_PACK",()=>Ce.getBool("HAS_WEBGL"));Ce.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ce.getBool("WEBGL_PACK"));Ce.registerFlag("WEBGL_PACK_CLIP",()=>Ce.getBool("WEBGL_PACK"));Ce.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ce.getBool("WEBGL_PACK"));Ce.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ce.getBool("WEBGL_PACK"));Ce.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ce.getBool("WEBGL_PACK"));Ce.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ce.getBool("WEBGL_PACK"));Ce.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ce.getBool("WEBGL_PACK"));Ce.registerFlag("WEBGL_PACK_REDUCE",()=>Ce.getBool("WEBGL_PACK"));Ce.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ce.getBool("WEBGL_PACK"));Ce.registerFlag("WEBGL_CONV_IM2COL",()=>Ce.getBool("WEBGL_PACK"));Ce.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Ce.getBool("WEBGL_PACK"));Ce.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>jpe(Ce.getNumber("WEBGL_VERSION")));Ce.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Wpe(Ce.getNumber("WEBGL_VERSION")));Ce.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Ce.getNumber("WEBGL_VERSION");return t===0?0:Gpe(t)});Ce.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ce.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!aM());Ce.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Hpe(Ce.getNumber("WEBGL_VERSION")));Ce.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ce.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ce.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ce.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>qpe(Ce.getNumber("WEBGL_VERSION")));Ce.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Xpe(Ce.getNumber("WEBGL_VERSION")));Ce.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ce.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ce.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Ce.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>aM()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Ce.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ce.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ce.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ce.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ce.registerFlag("WEBGL_EXP_CONV",()=>!1);Ce.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ce.getBool("IS_TEST"));Ce.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ce.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ce.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ce.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rs(){let t,e,n,s,r,i,o,a,l,c;return Y().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",i="outputColor",o="out vec4 outputColor;",a=Y().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uc(t,e,n="index"){const s=Ne(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / ${r}`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${r}`:`index -= ${t[i]} * ${r}`;return`${o}; ${a};`}).join("")}function z0(t,e,n="index"){const s=Ne(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function Ype(t,e){const n=t.length,s=t.map(i=>`${e}[${i}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let i=n-3;i>=0;--i)r[i]=`(${r[i+1]} * ${s[i+1]})`;return r}function Zpe(t,e,n="index"){const s=t.map((i,o)=>o),r=Ype(s,e);return r.map((i,o)=>{const a=`int ${t[o]} = ${n} / ${r[o]}`,l=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${r[o]}`:`index -= ${t[o]} * ${r[o]}`;return`${a}; ${l};`}).join("")}function QI(t){const e=Ne(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function eT(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const hB=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:fB}=Bse;function Jpe(t,e,n){const s=[];if(t.forEach(f=>{const p=Q(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?s.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(s.push(`uniform sampler2D ${f.name};`),s.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:m}=tT(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(m.length){case 1:s.push(`uniform int ${f.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${f.name}Shape;`);break}s.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{s.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const r=s.join(`
`),i=t.map(f=>Qpe(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,a=rs(),l=nme(a);let c,u,d=ime(a);return e.isPacked?(c=eme(e.logicalShape,o,n.enableShapeUniforms),u=rme(a)):(c=tme(e.logicalShape,o,n.enableShapeUniforms),u=sme(a)),n.packedInputs&&(d+=cme),[d,l,u,r,c,i,n.userCode].join(`
`)}function ed(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return wme(t,e);case 1:return Cme(t,e);case 2:return Ime(t,e);case 3:return Nme(t,e);case 4:return $me(t,e);case 5:return _me(t);case 6:return Ame(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function pB(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return bme(t);case 1:return kme(t,e);case 2:return Sme(t,e);case 3:return Tme(t,e);default:return Eme(t,e)}}function Qpe(t,e,n=!1,s){let r="";n?r+=pB(t,s):r+=ed(t,s);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?r+=Rme(t,e):r+=Dme(t,e)),r}function eme(t,e,n){switch(t.length){case 0:return mB();case 1:return ume(t,e,n);case 2:return xme(t,e,n);case 3:return hme(t,e,n);default:return pme(t,e,n)}}function tme(t,e,n){switch(t.length){case 0:return mB();case 1:return dme(t,e,n);case 2:return vme(t,e,n);case 3:return fme(t,e,n);case 4:return mme(t,e,n);case 5:return gme(t,e);case 6:return yme(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function nme(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function sme(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function rme(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function ime(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${ome}
    ${ame}
    ${lme}
  `}const ome=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ame=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,lme=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,cme=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function mB(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function ume(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function dme(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function hme(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),i=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function fme(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${z0(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=uc(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function pme(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2);let o=i,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)o*=t[t.length-c-1],a=`
      int b${c} = index / ${o};
      index -= b${c} * ${o};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${l});
    }
  `}function mme(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${z0(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=uc(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function gme(t,e){const n=uc(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function yme(t,e){const n=uc(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function xme(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(at(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function vme(t,e,n){return at(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function dc(t){return`offset${t}`}function bme(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=rs();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function wme(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,i]=t.shapeInfo.texShape;if(r===1&&i===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=dc(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function kme(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,i=rs();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function Cme(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${td(t)}
      }
    `;const r=t.shapeInfo.texShape,i=r[0],o=r[1];if(o===1&&i===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=dc(n);return o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function Sme(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],l=rs();if(i!=null&&at(n,i))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function Ime(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape;if(i!=null&&at(n,i)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const h=i[0],f=i[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:o,keptDims:a}=Ra(n),l=o;if(l.length<n.length){const h=nd(t,l),f=["row","col"];return`
      ${ed(h,e)}
      float ${r}(int row, int col) {
        return ${r}(${sd(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${td(t)}
      }
    `;const c=i[0],u=i[1],d=dc(s);return u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${s}, uv);
  }
`}function Tme(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const h=n.slice(1),f=[1,2],p=nd(t,h),m=["b","row","col"];return`
        ${pB(p,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${sd(m,f)});
        }
      `}const a=rs();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=o[0],c=o[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${u}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function Nme(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:l}=Ra(n),c=a;if(c.length<n.length){const m=nd(t,c),y=["row","col","depth"];return`
        ${ed(m,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${sd(y,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${td(t)}
      }
    `;const u=t.shapeInfo.texShape,d=u[0],h=u[1],f=t.shapeInfo.flatOffset;if(h===i&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(h===o&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const p=dc(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${s}, uv);
      }
  `}function Eme(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=rs();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],d=Math.ceil(i[o-1]/2);let h=d*Math.ceil(i[o-2]/2),f="int b, int row, int col",p=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<o-1;m++)f=`int b${m}, `+f,h*=i[o-m-1],p=`b${m} * ${h} + `+p;return`
    vec4 ${s}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${r.texture2D}(${n}, uv);
    }
  `}function $me(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:l,keptDims:c}=Ra(n);if(l.length<n.length){const x=nd(t,l),v=["row","col","depth","depth2"];return`
      ${ed(x,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${sd(v,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${td(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1],p=`int stride2 = ${s}Shape[3];`,m=`int stride1 = ${s}Shape[2] * stride2;`,y=`int stride0 = ${s}Shape[1] * stride1;`;if(f===a&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(f===i&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;const g=dc(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${y}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${g});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${h}, ${f}, index + ${g});
      return sampleTexture(${s}, uv);
    }
  `}function _me(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],i=e[3]*r,o=e[2]*i,a=e[1]*o,{newShape:l,keptDims:c}=Ra(e);if(l.length<e.length){const m=nd(t,l),y=["row","col","depth","depth2","depth3"];return`
      ${ed(m)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${sd(y,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${r})) +
          depth3;
        ${td(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1];if(f===a&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===r&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=dc(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${r} + depth3 + ${p};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Ame(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:i}=Ra(e);if(r.length<e.length){const y=nd(t,r),g=["row","col","depth","depth2","depth3","depth4"];return`
      ${ed(y)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${sd(g,i)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${td(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,f=h[0],p=h[1];if(p===u&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===o&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=dc(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function td(t){const e=t.name,n=Q(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function Rme(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=fB(t.shapeInfo.logicalShape,e.logicalShape),l=mt(o),c=o-i;let u;const d=["x","y","z","w","u","v"];i===0?u="":o<2&&a.length>=1?u="coords = 0;":u=a.map(x=>`coords.${d[x+c]} = 0;`).join(`
`);let h="";o<2&&i>0?h="coords":h=t.shapeInfo.logicalShape.map((x,v)=>`coords.${d[v+c]}`).join(", ");let f="return outputValue;";const m=Q(t.shapeInfo.logicalShape)===1,g=Q(e.logicalShape)===1;if(i===1&&!m&&!g)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!g)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const x=i-2,v=i-1;a.indexOf(x)>-1&&a.indexOf(v)>-1?f="return vec4(outputValue.x);":a.indexOf(x)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(v)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${s}(${h});
      ${f}
    }
  `}function Dme(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&at(o,i))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=mt(l),u=fB(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let h;const f=["x","y","z","w","u","v"];a===0?h="":l<2&&u.length>=1?h="coords = 0;":h=u.map(m=>`coords.${f[m+d]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((m,y)=>`coords.${f[y+d]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${h}
      return get${s}(${p});
    }
  `}function mt(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function tT(t,e,n){const{newShape:s,keptDims:r}=Ra(e),i=e.length,o=t&&i===3&&e[0]===1,a=o?e.slice(1):s,l=!t&&i>1&&!at(e,n)&&s.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:r}}function nd(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function sd(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pme(t,e,n,s){const r=n.map((u,d)=>{const h={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(h.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),i=r.map(u=>u.shapeInfo),o={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=Jpe(r,o,e),l=Npe(t.gl,a),c=t.createProgram(l);return Y().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},gB(t,e,c)))}function gB(t,e,n){const s=[],r=[];let i,o,a,l=null,c=null;c=t.getUniformLocation(n,"NAN",!1),Y().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const d of e.variableNames){const h={name:d,uniform:t.getUniformLocation(n,d,u),offset:t.getUniformLocation(n,`offset${d}`,u)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${d}Shape`,u),h.texShape=t.getUniformLocation(n,`${d}TexShape`,u)),s.push(h)}if(e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",u),a=t.getUniformLocation(n,"outShapeStrides",u),o=t.getUniformLocation(n,"outTexShape",u)),e.customUniforms)for(const d of e.customUniforms)r.push(t.getUniformLocation(n,d.name,u));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function R$(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,i=e[s],o=i.shape;if(!at(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!at(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function Ome(t,e,n,s,r){e.program.enableShapeUniforms||(R$(e.inShapeInfos,n),R$([e.outShapeInfo],[s]));const i=s.texData.texture,o=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),Y().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:u,offset:d,shape:h,texShape:f}=e.variablesLocations[l];if(h){const{uniformShape:p}=tT(e.program.packedInputs,c.shape,c.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(h,new Int32Array(p));break;case 2:t.gl.uniform2iv(h,new Int32Array(p));break;case 3:t.gl.uniform3iv(h,new Int32Array(p));break;case 4:t.gl.uniform4iv(h,new Int32Array(p));break}}if(f&&t.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(Q(c.shape)<2)t.gl.uniform1f(u,c.uniformValues[0]);else{let p=c.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(u,p)}continue}c.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Ne(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],u=e.customUniformLocations[l],d=r[l];if(c.type==="float")t.gl.uniform1fv(u,d);else if(c.type==="vec2")t.gl.uniform2fv(u,d);else if(c.type==="vec3")t.gl.uniform3fv(u,d);else if(c.type==="vec4")t.gl.uniform4fv(u,d);else if(c.type==="int")t.gl.uniform1iv(u,d);else if(c.type==="ivec2")t.gl.uniform2iv(u,d);else if(c.type==="ivec3")t.gl.uniform3iv(u,d);else if(c.type==="ivec4")t.gl.uniform4iv(u,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function Fme(t,e,n){let s="";e.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=tT(t.packedInputs,o.shape,l);let h="",f="",p="";if(u.length===1&&t.packedInputs){const k=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${k[0]>1}_${k[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const k=Ne(u);p=`${k[0]===l[1]}_${k[k.length-1]===l[1]}`}const m=o.shape.length,y=u.length===2&&at(o.shape,l),g=Q(o.shape)===1,x=Cu(o.shape,n.shape),v=!t.packedInputs&&m===n.shape.length&&at(l,n.texData.texShape),b=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${m}_${v}_${c?d:""}_${u.length}_${g}_${x}_${y}_${h}_${f}_${p}_${b}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;s+=`${o.shape}_${l}_${a}`}});const r=t.userCode;let i=t.constructor.name;return i+="_"+s+"_"+r+`${Y().getNumber("WEBGL_VERSION")}`,i}function Un(t){return Y().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mme{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=nf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=rs();this.outputShape=e,this.enableShapeUniforms=Un(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?z0(["r","c","d"],e):uc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lme{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=nf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=rs();this.outputShape=e,this.enableShapeUniforms=Un(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?z0(["r","c","d"],e):uc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vme{constructor(e){this.variableNames=["A"],this.outTexUsage=Vs.DOWNLOAD;const n=rs();this.outputShape=e,this.userCode=`
      ${hB}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bme{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Vs.DOWNLOAD;const n=rs();this.outputShape=e,this.userCode=`
      ${hB}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zme={R:0,G:1,B:2,A:3};class D${constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=rs();this.outputShape=e,this.enableShapeUniforms=Un(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<s.length;a++){const l=s[a];o+=`
          if(offset == ${a}) {
            result = values[${zme[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?eT():QI(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${o}
        }
        ${r.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ume{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=rs();this.outputShape=e,this.enableShapeUniforms=Un(this.outputShape.length);let r="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?eT():QI(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jme(t){const e=rs(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return Tpe(t,n)}function Wme(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Ape(t,e)}function Gme(t){const e=new Uint16Array([0,1,2,2,1,3]);return Rpe(t,e)}function Gp(t,e,n,s,r,i){Ppe(e,n);const o=Dpe(t),a=t.TEXTURE_2D;return ye(t,()=>t.bindTexture(a,o)),ye(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),ye(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),ye(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),ye(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),Y().getNumber("WEBGL_VERSION")===1?ye(t,()=>t.texImage2D(a,0,s,e,n,0,r,i,null)):ye(t,()=>t.texStorage2D(a,1,s,e,n)),ye(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function yB(t){return t.internalFormatFloat}function Hme(t,e,n,s){const[r,i]=jp(e,n);return Gp(t,r,i,yB(s),s.textureFormatFloat,t.FLOAT)}function xB(t){return t.internalFormatHalfFloat}function qme(t,e,n,s){const[r,i]=jp(e,n);return Gp(t,r,i,xB(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function vB(t){return t.downloadTextureFormat}function Kme(t,e,n,s){const[r,i]=jp(e,n);return Gp(t,r,i,vB(s),t.RGBA,t.UNSIGNED_BYTE)}function bB(t){return t.internalFormatPackedFloat}function Xme(t,e,n,s){const[r,i]=Qu(e,n);return Gp(t,r,i,bB(s),t.RGBA,t.FLOAT)}function wB(t){return t.internalFormatPackedHalfFloat}function Yme(t,e,n,s){const[r,i]=Qu(e,n);return Gp(t,r,i,wB(s),t.RGBA,s.textureTypeHalfFloat)}function Zme(t,e,n){return ye(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),$$(t,e,"clipSpacePos",n,3,20,0)&&$$(t,e,"uv",n,2,20,12)}function Jme(t,e,n,s,r,i){ye(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,a,l;r instanceof Uint8Array?(o=new Uint8Array(n*s*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*s*4),a=t.FLOAT,l=i.internalFormatPackedFloat),o.set(r),Y().getNumber("WEBGL_VERSION")===2?ye(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,a,o)):ye(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,a,o)),ye(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Qme(t,e,n){ye(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?Y().getNumber("WEBGL_VERSION")===2?ye(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):ye(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):Y().getNumber("WEBGL_VERSION")===2?ye(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):ye(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),ye(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function ege(t,e,n,s){const r=t.createBuffer();ye(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const a=4*4*e*n;return ye(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),ye(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),ye(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function tge(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function nge(t,e,n,s){const[r,i]=jp(e,n),o=4,a=new Uint8Array(vpe(e*n,o));return ye(t,()=>t.readPixels(0,0,r,i,s.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function sge(t,e,n,s,r,i,o,a){const l=t,c=new Float32Array(bpe(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function rge(t,e,n){const s=new Float32Array(e*n*4);return ye(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hb{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=Y().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,gpe(n,e)):this.gl=Kr(n),e=this.gl,Y().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>ye(i,()=>i.createVertexArray()),this.bindVertexArray=o=>ye(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>ye(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>ye(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>ye(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>ye(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>ye(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>ye(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Y().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=Em(this.gl,i),pr(this.gl,o))this.textureHalfFloatExtension=Em(this.gl,o);else if(Y().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),pr(this.gl,r))this.colorBufferHalfFloatExtension=Em(this.gl,r);else if(Y().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",pr(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(pr(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Wme(this.gl),this.indexBuffer=Gme(this.gl),this.framebuffer=Ope(this.gl),this.textureConfig=JI(this.gl,this.textureHalfFloatExtension)}get debug(){return Y().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;ye(e,()=>e.finish()),ye(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),ye(e,()=>e.deleteFramebuffer(this.framebuffer)),ye(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),ye(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),ye(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),Hme(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),qme(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Kme(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Qme(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),Jme(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),Yme(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),Xme(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(_$(this.gl,this.framebuffer),this.outputTexture=null),ye(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>nge(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,i,o){return sge(this.gl,e,n,s,r,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return tge(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=ege(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(Y().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const o=r.clientWaitSync(i,0,0);return o===r.ALREADY_SIGNALED||o===r.CONDITION_SATISFIED},n=i}else Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>rge(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=jme(n));const s=$pe(n);ye(n,()=>n.attachShader(s,this.vertexShader)),ye(n,()=>n.attachShader(s,e)),_pe(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&lb(n,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;ye(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Zme(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(ye(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&lb(this.gl,this.program),ye(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?Mpe(this.gl,e,n):Lpe(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),ye(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),Vpe(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,i]=Qu(n,s);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&lb(this.gl,this.program),$m(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}ye(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),ye(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Em(this.gl,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await vE(()=>this.disposed||this.isQueryAvailable(e,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=ige(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in Y().platform&&(s=Y().platform.setTimeoutCustom.bind(Y().platform)),vE(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),cb(this.gl,e,this.framebuffer),this.debug&&$m(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(cb(this.gl,this.outputTexture,this.framebuffer),this.debug&&$m(this.gl)):_$(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;cb(r,e,this.framebuffer),this.debug&&$m(r),this.outputTexture=e,ye(r,()=>r.viewport(0,0,n,s)),ye(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),ye(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function ige(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:oge,bincountImpl:kB,bincountReduceImpl:age,bitwiseAndImpl:lge,castImpl:cge,ceilImpl:uge,concatImpl:dge,equalImpl:hge,expImpl:fge,expm1Impl:pge,floorImpl:mge,gatherNdImpl:gge,gatherV2Impl:yge,greaterImpl:xge,greaterEqualImpl:vge,lessImpl:bge,lessEqualImpl:wge,linSpaceImpl:kge,logImpl:Cge,maxImpl:Sge,maximumImpl:Ige,minimumImpl:Tge,multiplyImpl:Nge,negImpl:Ege,notEqualImpl:$ge,prodImpl:_ge,raggedGatherImpl:Age,raggedRangeImpl:Rge,raggedTensorToTensorImpl:Dge,rangeImpl:Pge,rsqrtImpl:Oge,scatterImpl:Fge,sigmoidImpl:Mge,simpleAbsImpl:CB,sliceImpl:Lge,sparseFillEmptyRowsImpl:Vge,sparseReshapeImpl:Bge,sparseSegmentReductionImpl:SB,sqrtImpl:zge,staticRegexReplaceImpl:Uge,stridedSliceImpl:jge,stringNGramsImpl:Wge,stringSplitImpl:Gge,stringToHashBucketFastImpl:Hge,subImpl:qge,tileImpl:Kge,topKImpl:Xge,transposeImpl:nT,uniqueImpl:Yge}=Qle;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IB(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function Zn(t,e){return e===1?[t]:IB(t,e)}function Zge(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jge{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Un(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Zn("rc",this.rank),s=mt(this.rank),r=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let i=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TB{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Un(this.outputShape.length);let s="";for(let r=0;r<4;r++){let i="thisRC = rc;";r%2===1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),s+=`
        ${i}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${Qge(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?eT():QI(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function Qge(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Zpe(["r","c","d"],"inputShape"):uc(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eye{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const r=O$(n,s),i=F$(e,r,s);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=P$(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return r===Tn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Tn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Tn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Tn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Tn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const i=O$(s,r),o=F$(n,i,r);o in this.freeTextures||(this.freeTextures[o]=[]);const a=P$(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=Y().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[o],u=c&&c.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function tye(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function P$(t,e,n,s,r){const i=nye(e,s);let o;if(r){const[l,c]=Qu(t[0],t[1]);o=l*c}else{const[l,c]=jp(t[0],t[1]);o=l*c}const a=tye(n,i);return o*a}function nye(t,e){switch(t){case Tn.PACKED_2X2_FLOAT32:return bB(e);case Tn.PACKED_2X2_FLOAT16:return wB(e);case Tn.UNPACKED_FLOAT32:return yB(e);case Tn.UNPACKED_FLOAT16:return xB(e);case Tn.PACKED_4X1_UNSIGNED_BYTE:return vB(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function sye(t){return Y().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Tn.PACKED_2X2_FLOAT32:Tn.UNPACKED_FLOAT32:t?Tn.PACKED_2X2_FLOAT16:Tn.UNPACKED_FLOAT16}function O$(t,e){if(t===Vs.UPLOAD)return Tn.PACKED_2X2_FLOAT32;if(t===Vs.RENDER||t==null)return sye(e);if(t===Vs.DOWNLOAD||t===Vs.PIXELS)return Tn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function F$(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class di{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Un(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const kr="if (isnan(x)) return x;",rye="return x;",M$="return abs(x);",iye="return (x >= 0.0) ? x : (exp(x) - 1.0);",oye=kr+`
  return (x < 0.0) ? 0.0 : x;
`,aye=kr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Po="return x;",lye="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cye="return x;",uye=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,dye=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,hye=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,fye="return 1.0 / (1.0 + exp(-1.0 * x));";class Ko{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Un(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pye{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Un(this.outputShape.length);const n=e.length,s=Zn("rc",n),r=mt(n),i=Zge(n,s),o=s.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mye=ZM,gye=1e-7,yye=1e-4,Rm={};function xye(t){return t in Rm||(Rm[t]={}),Rm[t]}const vye=Y().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),bye=600;function wye(){return Y().global.screen==null?1024:Y().global.screen.height*Y().global.screen.width*window.devicePixelRatio*bye/1024/1024}class U0 extends xC{nextDataId(){return U0.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Y().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof hb)n=e;else{const s=Kr(Y().getNumber("WEBGL_VERSION"),e);n=new hb(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=Kr(Y().getNumber("WEBGL_VERSION"));n=new hb(s),this.binaryCache=xye(Y().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new eye(this.gpgpu),this.numMBBeforeWarning=wye(),this.texData=new mF(this,ni())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,r,i,o){const a=this.makeTensorInfo(n,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,i]},l.texShape=[r,i];const c=_m(n),u=new D$(c,!1,o),d=this.runWebGLProgram(u,[a],s,[[r,i]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,s){if((Y().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Y().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:Vs.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,i){if(Y().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:Vs.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=n;if(o!=null){let h;l?h=new Ko(a,Po):h=new di(a,Po);const f=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:r}],r),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const c=this.activeTimers!=null;let u;c&&(u=ls());let d;if(r==="complex64"){const h=this.readSync(i.real.dataId),f=this.readSync(i.imag.dataId);d=fo(h,f)}else d=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=ls()-u),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(m=>p.push(m))}const n=this.texData.get(e),{values:s,shape:r,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=n;if(i!=null){let p;l?p=new Ko(r,Po):p=new di(r,Po);const m=this.runWebGLProgram(p,[{dataId:e,shape:r,dtype:o}],o),y=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),y}if(s!=null)return this.convertAndCacheOnCPU(e);if(Y().getBool("DEBUG")&&!Y().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Y().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(o!=="complex64"&&Y().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...Nm(r))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],y=p[1];d=fo(m,y)}else if(c==null)d=this.getValuesFromTexture(e);else{const p=Q(r);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;ye(p,()=>p.deleteBuffer(c))}const h=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ni().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:i,slice:o,dtype:a,isPacked:l,texture:c}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;l?f=new Ko(i,Po):f=new di(i,Po);const p=this.runWebGLProgram(f,[{dataId:e,shape:i,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),d=ni().makeTensorFromTensorInfo(u),h=this.texData.get(u.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>ya(r));return He(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return He(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!Spe(s))throw Y().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),i=Q(n);if(Y().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),f=this.texData.get(h.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...Nm(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(h),p}const o=Y().getBool("WEBGL_PACK")&&r===!0,a=o?_m(n):n,l=o?new Bme(a):new Vme(a),c=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),u=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const i=Fl(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=Fl(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=aZ(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:o[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ls(),endMs:null}}endTimer(e){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=ls(),e)}async getQueryTime(e){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:i,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,i,o)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=vye){return Y().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&Q(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Ms("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return mye(e.shape,n)}packedUnaryOp(e,n,s){const r=new Ko(e.shape,n),i=this.compileAndRun(r,[e],s);return ni().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=CB(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,M$,e.dtype);const n=new di(e.shape,M$),s=this.compileAndRun(n,[e]);return ni().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&_f(s[0])){const i=s.map(o=>la(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return ni().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new pye(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Jge(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const s=[_u(e.shape),...Au(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},i=[_u(n),...Au(n)],o=new TB(i,s),a=!0,l=[s],c=this.runWebGLProgram(o,[r],e.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:i,dtype:o}=s;if(n!=null){const h=Q(i),f=n[0]*n[1]*4;T(h<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=_m(i);let l;r?l=new Lme(a):l=new Mme(a);const c=!0,u=[n??Nm(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,u,c,n);return{dtype:o,shape:i,dataId:d.dataId}}runWebGLProgram(e,n,s,r,i=!1,o){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===nf.DENSE){const g=o??Nm(e.outputShape);l.texShape=g.map(x=>x*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),Q(a.shape)===0)return l.values=Mn(a.dtype,0),a;const c=[],u=n.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let x=this.texData.get(g.dataId);if(x.texture==null){if(!e.packedInputs&&Q(g.shape)<=Y().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:x.values};e.packedInputs&&(x.isPacked=!0,x.shape=g.shape)}if(this.uploadToGPU(g.dataId),!!x.isPacked!=!!e.packedInputs)g=x.isPacked?this.unpackTensor(g):this.packTensor(g),c.push(g),x=this.texData.get(g.dataId);else if(x.isPacked&&!Ey(x.shape,g.shape)){const v=g,b=g.shape;g.shape=x.shape,g=this.packedReshape(g,b),c.push(g),x=this.texData.get(g.dataId),v.shape=b}return{shape:g.shape,texData:x,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},h=Fme(e,u,d),f=this.getAndSaveBinary(h,()=>Pme(this.gpgpu,e,u,d)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),Y().get("ENGINE_COMPILE_ONLY")||Ome(this.gpgpu,f,u,d,r),c.forEach(g=>this.disposeIntermediateTensorInfo(g)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const y=Y().getNumber("WEBGL_FLUSH_THRESHOLD");if(y>0){const g=ls();g-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!Y().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const g=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),g}return a}compileAndRun(e,n,s,r,i=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Y().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=H(()=>{if(!Y().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=Y().getBool("DEBUG");Y().set("DEBUG",!1);const n=this.abs(ot(1e-8)).dataSync()[0];if(Y().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?gye:yye}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:i,texture:o,usage:a,isPacked:l}=n;if(o!=null)return;const c=this.activeTimers!=null;let u;c&&(u=ls());let d=n.texShape;if(d==null&&(d=Upe(s,l),n.texShape=d),i!=null){const h=_m(s);let f,p=d[1],m=d[0];const y=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!y)&&([p,m]=Qu(d[0],d[1])),l?f=new Ume(h,y):f=new D$(h,y);const g=y?[m,p]:d,x=this.makeTensorInfo(g,r),v=this.texData.get(x.dataId);y?v.usage=Vs.PIXELS:v.usage=Vs.UPLOAD,v.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),p,m,i);const b=[[m,p]],C=this.runWebGLProgram(f,[x],r,b,!0),S=this.texData.get(C.dataId);n.texShape=S.texShape,n.isPacked=S.isPacked,n.usage=S.usage,Y().get("ENGINE_COMPILE_ONLY")?this.disposeData(C.dataId):(n.texture=S.texture,n.values=null,this.texData.delete(C.dataId)),this.disposeIntermediateTensorInfo(x),c&&(this.uploadWaitMs+=ls()-u)}else{const h=this.acquireTexture(d,a,r,l);n.texture=h}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return n!=null&&(s.values=kye(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*sy(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(i){throw i}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await pL(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(dB(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=gB(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:r,height:i,width:o,channels:a}=e,l=ni().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,n,s,i,o,a);return ni().makeTensorFromDataId(c,n,s,l)}}U0.nextDataId=0;function kye(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */lM()&&hM("webgl",()=>new U0,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sT=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Kl{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=Le(n,s),this.enableShapeUniforms=Un(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hc=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class rd{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Le(n,s);const i=this.outputShape.length;this.enableShapeUniforms=Un(i);let o="";if(r)if(i===0||Q(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${mt(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Zn("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ps(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Cye={kernelName:Zf,backendName:"webgl",kernelFunc:Ps};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function za(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.makeTensorInfo(s.shape,"complex64"),o=n.texData.get(i.dataId),a=Ps({inputs:{x:s},backend:n}),l=Ps({inputs:{x:r},backend:n});return o.complexTensorInfos={real:a,imag:l},i}const Sye={kernelName:AC,backendName:"webgl",kernelFunc:za};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NB="return (a < 0.) ? b * a : a;",EB=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Iye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s,o=n.makeTensorInfo([],"float32",Da(i,"float32")),a=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new rd(EB,r.shape,o.shape):new Kl(NB,r.shape,o.shape),l=n.runWebGLProgram(a,[r,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const Tye={kernelName:Ox,backendName:"webgl",kernelFunc:Iye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $B="return (a < 0.) ? b * a : a;",_B=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Nye(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,i=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new rd(_B,s.shape,r.shape):new Kl($B,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],"float32")}const Eye={kernelName:e0,backendName:"webgl",kernelFunc:Nye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const id="if (isnan(x)) return x;";function et({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:i})=>{const{x:o}=r,a=i,l=s||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const d=a.texData.get(o.dataId),h=n(d.values,l);return a.makeTensorInfo(o.shape,l,h)}const c=Y().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new Ko(o.shape,e):u=new di(o.shape,t),a.runWebGLProgram(u,[o],l)}}function An({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:c}=o,u=a;if(s&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[y,g]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(v=>{const[b,k]=v,C={dataId:b.dataId,dtype:b.dtype,shape:l.shape},S={dataId:k.dataId,dtype:k.dtype,shape:c.shape},I=new Kl(t,l.shape,c.shape);return u.runWebGLProgram(I,[C,S],Rs(b.dtype,k.dtype))}),x=za({inputs:{real:y,imag:g},backend:u});return u.disposeIntermediateTensorInfo(y),u.disposeIntermediateTensorInfo(g),x}const d=i||Rs(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&r!=null){const p=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,y=l.dtype==="string"?po(p):p,g=l.dtype==="string"?po(m):m,[x,v]=r(l.shape,c.shape,y,g,d),b=u.makeTensorInfo(v,d),k=u.texData.get(b.dataId);return k.values=x,b}const h=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return h?f=new rd(e,l.shape,c.shape,n):f=new Kl(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],d)}}function sf(t,e=!1){if(t==="linear")return e?cye:rye;if(t==="relu")return e?dye:oye;if(t==="elu")return e?uye:iye;if(t==="relu6")return e?hye:aye;if(t==="prelu")return e?_B:$B;if(t==="leakyrelu")return e?EB:NB;if(t==="sigmoid")return e?fye:lye;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AB{constructor(e,n,s,r=!1,i=!1,o=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Un(this.outputShape.length);const u=r?e[1]:e[2],d=Math.ceil(u/2),h=r?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let y="",g="";a&&(l?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:y=`vec4 activation(vec4 x) {
          ${a}
        }`,g="result = activation(result);");const x=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let v="rc.x",b="rc.x";e[0]<n[0]?v=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(b=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${y}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${v};
        int batchB = ${b};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${g}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L$={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class V${constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Le(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B$="return a * b;";function rT(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=Rs(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),c=new V$(L$.REAL,s.shape,r.shape),u=new V$(L$.IMAG,s.shape,r.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=za({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([s,r])){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[c,u]=Nge(s.shape,r.shape,a.values,l.values,i),d=n.makeTensorInfo(u,i),h=n.texData.get(d.dataId);return h.values=c,d}let o;return Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new rd(B$,s.shape,r.shape):o=new Kl(B$,s.shape,r.shape),n.runWebGLProgram(o,[s,r],i)}const $ye={kernelName:op,backendName:"webgl",kernelFunc:rT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ye(t,e,n){const s=[_u(t.shape),...Au(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},i=[_u(e),...Au(e)],o=new TB(i,s),a=!0,l=[s],c=n.runWebGLProgram(o,[r],t.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function he(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=n,a=Q(r.shape),l=yF(i,a),c=Q(l);T(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=o.texData.get(r.dataId);return u.isPacked&&!Ey(r.shape,l)&&!(u.texture!==null&&Ey(u.shape,l))?_ye(r,l,o):(o.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const Aye={kernelName:n0,backendName:"webgl",kernelFunc:he};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z${constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];const a=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const d=1/n;c=`sumValue += dot(values * ${vu(d)?d.toPrecision(2):d}, ones);`}let u="";i%s>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rye{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(s/4)*4,d=s%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dye(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=I0(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function fc(t,e,n,s){const r=Dye(t.shape);let i=t;for(let o=0;o<r.length;o++){const{inSize:a,windowSize:l,outSize:c}=r[o];let u,d;n==="mean"?u=o===0?new z$({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new z$({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new Rye({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},n),d=i,i=s.runWebGLProgram(u,[i],e),d.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(d)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pye{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[n[o]];this.outputShape=s,this.rank=s.length;const r=mt(this.rank),i=Oye(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function Oye(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fye{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let u=0;u<s.length;u++)s[u]=e[n[u]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=mt(this.rank),i=IB("rc",this.rank),o=new Array(this.rank);for(let u=0;u<n.length;u++)o[n[u]]=i[u];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j0(t,e,n){const s=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Fye(t.shape,e):new Pye(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mye(t,e,n,s){const r=e,i=t.shape.length,o=qe(r,t.shape);let a=o;const l=Lt(a,i),c=l!=null;let u=t;c&&(u=j0(t,l,s),a=Zt(a.length,i)),_n("sum",a,i);const[d,h]=kn(u.shape,a);let f=d;n&&(f=on(d,o));const p=Q(h),y=Q(t.shape)/p,g=he({inputs:{x:u},attrs:{shape:[y,p]},backend:s}),x=hS(t.dtype),v=fc(g,x,"sum",s),b=he({inputs:{x:v},attrs:{shape:f},backend:s});return s.disposeIntermediateTensorInfo(g),s.disposeIntermediateTensorInfo(v),c&&s.disposeIntermediateTensorInfo(u),b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W0(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;return Mye(r,i,o,n)}const Lye={kernelName:l0,backendName:"webgl",kernelFunc:W0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ss(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:i}=s,o=n,a=r.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=r.shape[i[u]];let c;if(o.shouldExecuteOnCPU([r])){const d=o.texData.get(r.dataId).values,h=nT(d,r.shape,r.dtype,i,l);c=o.makeTensorInfo(l,r.dtype);const f=o.texData.get(c.dataId);f.values=h}else c=j0(r,i,o);return c}const Vye={kernelName:su,backendName:"webgl",kernelFunc:ss};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RB=1e3;function $y({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,d=n?t.shape[c-2]:t.shape[c-1],h=s?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-1]:t.shape[c-2],p=s?e.shape[u-2]:e.shape[u-1],m=t.shape.slice(0,-2),y=e.shape.slice(0,-2),g=Q(m),x=Q(y),b=Le(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);T(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const k=n?[g,d,f]:[g,f,d],C=s?[x,p,h]:[x,h,p],S=he({inputs:{x:t},backend:r,attrs:{shape:k}}),I=he({inputs:{x:e},backend:r,attrs:{shape:C}}),N=[S,I],E=Math.max(g,x),D=n?S.shape[1]:S.shape[2],R=i!=null,L=o!=null,B=l==="leakyrelu",W=l!=null?sf(l,!0):null,G=R||L||B||W!=null;let q;if((f===1||p===1)&&D>RB&&G===!1){let z=S,P=I;n&&(z=ss({inputs:{x:S},backend:r,attrs:{perm:[0,2,1]}}),N.push(z)),s&&(P=ss({inputs:{x:I},backend:r,attrs:{perm:[0,2,1]}}),N.push(P));const X=p!==1,te=p===1;let se=z;X&&(se=he({inputs:{x:z},backend:r,attrs:{shape:[E,D,1]}}),N.push(se));const ce=p===1?2:1;let ie=P;te&&(ie=he({inputs:{x:P},backend:r,attrs:{shape:[E,1,D]}}),N.push(ie));const de=rT({inputs:{a:se,b:ie},backend:r});q=W0({inputs:{x:de},backend:r,attrs:{axis:ce,keepDims:!0}}),N.push(de)}else{const z=Rs(t.dtype,e.dtype),P=new AB(k,C,[E,f,p],n,s,R,W,L,B),X=[S,I];if(i!=null&&X.push(i),L&&X.push(o),B){const te=r.makeTensorInfo([],"float32",Da(a,"float32"));X.push(te),N.push(te)}q=r.runWebGLProgram(P,X,z)}const A=he({inputs:{x:q},backend:r,attrs:{shape:b}});N.push(q);for(const z of N)r.disposeIntermediateTensorInfo(z);return A}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bye(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;return $y({a:r,b:i,transposeA:l,transposeB:c,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:d,activation:u})}const zye={kernelName:ry,backendName:"webgl",kernelFunc:Bye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U$="return abs(x);";function Uye(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const i=n.texData.get(s.dataId),o=CB(i.values);return n.makeTensorInfo(s.shape,s.dtype,o)}let r;return Y().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Ko(s.shape,U$):r=new di(s.shape,U$),n.runWebGLProgram(r,[s],s.dtype)}const jye={kernelName:mx,backendName:"webgl",kernelFunc:Uye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wye=kr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Gye=et({opSnippet:Wye}),Hye={kernelName:Af,backendName:"webgl",kernelFunc:Gye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qye=kr+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Kye=et({opSnippet:qye}),Xye={kernelName:Rf,backendName:"webgl",kernelFunc:Kye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j$="return a + b;",Yye=An({opSnippet:j$,packedOpSnippet:j$,supportsComplex:!0,cpuKernelImpl:oge}),Zye={kernelName:Hu,backendName:"webgl",kernelFunc:Yye};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jye{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`float v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qye{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`vec4 v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rg(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return Ps({inputs:{x:s[0]},backend:n});if(s.length>Y().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=rg({inputs:s.slice(0,l),backend:n}),u=rg({inputs:s.slice(l),backend:n});return rg({inputs:[c,u],backend:n})}const r=s.map(l=>l.dtype).reduce((l,c)=>Rs(l,c)),i=s.map(l=>l.shape),a=Y().getBool("WEBGL_PACK")?new Qye(s[0].shape,i):new Jye(s[0].shape,i);return n.runWebGLProgram(a,s,r)}const exe={kernelName:SC,backendName:"webgl",kernelFunc:rg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function txe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=qe(i,r.shape);let c=l;const u=Lt(c,a);let d=r;u!=null&&(d=ss({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Zt(c.length,a)),_n("all",c,a);const[h,f]=kn(d.shape,c),p=Q(f),m=he({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),y=fc(m,m.dtype,"all",n);let g;if(o){const x=on(h,l);g=he({inputs:{x:y},backend:n,attrs:{shape:x}})}else g=he({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(d),g}const nxe={kernelName:IC,backendName:"webgl",kernelFunc:txe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=qe(i,r.shape);let c=l;const u=Lt(c,a);let d=r;u!=null&&(d=ss({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Zt(c.length,a)),_n("any",c,a);const[h,f]=kn(d.shape,c),p=Q(f),m=he({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),y=fc(m,m.dtype,"any",n);let g;if(o){const x=on(h,l);g=he({inputs:{x:y},backend:n,attrs:{shape:x}})}else g=he({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(d),g}const rxe={kernelName:TC,backendName:"webgl",kernelFunc:sxe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ixe{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:o}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oxe{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,T(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=mt(l),u=Zn("coords",l);let d,h;if(o===1){h=l+1;const I=mt(h);d=`
        ${I} sourceLocR = ${I}(${u.join()}, 0);
        ++${u[l-1]};
        ${I} sourceLocG = ${I}(${u.join()}, 0);
        ++${u[l-2]};
        ${I} sourceLocA = ${I}(${u.join()}, 0);
        --${u[l-1]};
        ${I} sourceLocB = ${I}(${u.join()}, 0);
        --${u[l-2]};`}else h=l,d=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,h),p="."+f[h-1],m=f.map(I=>"int "+I),y=Zn("sourceLocR",h-1).concat("inIdx.r"),g=Zn("sourceLocG",h-1).concat("inIdx.g"),x=Zn("sourceLocB",h-1).concat("inIdx.b"),v=Zn("sourceLocA",h-1).concat("inIdx.a"),b=s==="max"?"greaterThan":"lessThan",k=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${v.join()})));`,C=`vec4(
            getAChannel(${y.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,S=r?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${S}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${C};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${k}
          vec4 candidate = ${C};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DB(t,e,n,s=null){let r=e.shape[0],i=e.shape[1];s!=null&&(r=s.shape[0],i=s.shape[1]);const o=I0(i),a={windowSize:o,inSize:i,batchSize:r,outSize:Math.ceil(i/o)},l=new ixe(a,n,s==null),c=[e];s!=null&&c.push(s);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const d=DB(t,e,n,u);return t.disposeIntermediateTensorInfo(u),d}function PB(t,e,n,s=null){const r=s!=null?s.shape:e.shape,i=r[r.length-1],o=I0(i),a=new oxe(r,o,n,s==null),l=s==null?[e]:[e,s],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const u=PB(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function OB(t,e,n,s){const r=[n];if(_n("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!Y().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=t.unpackTensor(e),i.push(l));const[c,u]=kn(l.shape,r),d=Q(u),h=he({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});i.push(h);const f=DB(t,h,s);i.push(f);const p=he({inputs:{x:f},backend:t,attrs:{shape:c}});return i.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}return PB(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function axe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=qe(i,r.shape);const a=Lt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=ss({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Zt(o.length,l.shape.length)),_n("argMax",[o[0]],l.shape.length);const u=OB(n,l,o[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const lxe={kernelName:gx,backendName:"webgl",kernelFunc:axe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=qe(i,r.shape);const a=Lt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=ss({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=Zt(o.length,l.shape.length)),_n("argMin",[o[0]],l.shape.length);const u=OB(n,l,o[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const uxe={kernelName:yx,backendName:"webgl",kernelFunc:cxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dxe=kr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,hxe=et({opSnippet:dxe}),fxe={kernelName:Df,backendName:"webgl",kernelFunc:hxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pxe=kr+"return log(x + sqrt(x * x + 1.0));",mxe=et({opSnippet:pxe}),gxe={kernelName:Pf,backendName:"webgl",kernelFunc:mxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yxe=kr+`
  return atan(x);
`,xxe=et({opSnippet:yxe}),vxe={kernelName:Of,backendName:"webgl",kernelFunc:xxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bxe=sT+`
  return atan(a, b);
`,wxe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+hc+`
  return result;
`,kxe=An({opSnippet:bxe,packedOpSnippet:wxe}),Cxe={kernelName:Mf,backendName:"webgl",kernelFunc:kxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sxe=kr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Ixe=et({opSnippet:Sxe}),Txe={kernelName:Ff,backendName:"webgl",kernelFunc:Ixe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rf{constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",y=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let x="0.0";if(m||(x="-1.0 / 1e-20"),s){const I=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${I} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?i?y:g:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const v="max";let b=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(b="avgValue / max(count, 1.0)");const k=Math.floor(o/4)*4,C=o%4,S=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${v}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${k}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${S}
          }

          int xC = xCCorner + ${k};
          if (${C===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${S}
          } else if (${C===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${S}
          } else if (${C===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${S}
          }
        }
        setOutput(${b});
      }
    `}}class iT{constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,y=e.padInfo.front,g=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;const v=n==="avg";let b="0.0";if(v||(b="-1.0 / 1e-20"),s){const E=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${y}, ${g}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${E} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const k="max";let C=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(C="avgValue / max(count, 1.0)");const S=Math.floor(o/4)*4,I=o%4,N=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${k}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${y}, ${g}, ${x});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${S}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${N}
            }

            int xC = xCCorner + ${S};
            if (${I===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${N}
            } else if (${I===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${N}
            } else if (${I===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${N}
            }
          }
        }
        setOutput(${C});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Wp(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;T(Bn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=br(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&at(u.inShape,u.outShape))return Ps({inputs:{x:r},backend:n});const d=new rf(u,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const Exe={kernelName:xx,backendName:"webgl",kernelFunc:Nxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $xe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s,u=[1,1,1],d=vo(r.shape,i,o,u,a,l,c),h=new iT(d,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}const _xe={kernelName:vx,backendName:"webgl",kernelFunc:$xe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Axe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,d=c-1-e.padInfo.left,h=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Rxe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=d-1-e.padInfo.front,m=h-1-e.padInfo.top,y=f-1-e.padInfo.left,g=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${y});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dxe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=vo(o.shape,a,l,d,c,u),f=new Rxe(h);return n.runWebGLProgram(f,[r],o.dtype)}const Pxe={kernelName:EC,backendName:"webgl",kernelFunc:Dxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oxe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;Wp([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=br(o.shape,a,l,1,c),d=new Axe(u);return n.runWebGLProgram(d,[r],o.dtype)}const Fxe={kernelName:NC,backendName:"webgl",kernelFunc:Oxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mxe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;return $y({a:r,b:i,transposeA:o,transposeB:a,backend:n})}const Lxe={kernelName:bx,backendName:"webgl",kernelFunc:Mxe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vxe{constructor(e,n,s,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Le(e,n),Le(e,s);let a="0.0";r!=null&&(Le(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(Le(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bxe{constructor(e,n,s,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Le(e,n),Le(e,s);let a="vec4(0.0)";r!=null&&(Le(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(Le(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zxe=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:i,offset:o,scale:a}=t;T(r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,r,i];let u=null;o!=null&&(u=o.shape,c.push(o));let d=null;a!=null&&(d=a.shape,c.push(a));const h=Y().getBool("WEBGL_PACK_NORMALIZATION")?new Bxe(s.shape,r.shape,i.shape,u,d,l):new Vxe(s.shape,r.shape,i.shape,u,d,l);return e.runWebGLProgram(h,c,c[0].dtype)},Uxe={kernelName:Rx,backendName:"webgl",kernelFunc:zxe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jxe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=mt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=Wxe(this.rank);let r;const i=e.map((o,a)=>`sourceLoc.${C1[a]} = start[${a}] + coords.${C1[a]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const C1=["x","y","z","w","u","v"];function Wxe(t){if(t===1)return"sourceLoc";if(t<=6)return C1.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gxe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=mt(this.rank),s=Zn("coords",this.rank),r=Zn("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,o=`getChannel(getSource(${r.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${o};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${o};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${o};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,d)=>`start[${d}]`).join()});`:e.map((u,d)=>`${r[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hxe(t,e,n,s){const r=s.texData.get(t.dataId),i=s.makeTensorInfo(n,t.dtype),o=s.texData.get(i.dataId);Object.assign(o,r),o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=eI(e,Ne(t.shape));r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};const l=s.dataRefCount.get(o.slice.origDataId)||1;return s.dataRefCount.set(o.slice.origDataId,l+1),i}function od(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s,[a,l]=S0(r,i,o);if(ZS(r,a,l),Q(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const d=n.texData.get(r.dataId),h=Lge(d.values,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,h)}const{isPacked:c}=n.texData.get(r.dataId),u=QS(r.shape,a,l);if(c||!u){const d=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Gxe(l):new jxe(l),h=[a];return n.runWebGLProgram(d,[r],r.dtype,h)}return n.uploadToGPU(r.dataId),Hxe(r,a,l,n)}const qxe={kernelName:a0,backendName:"webgl",kernelFunc:od};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kxe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;T(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((x,v)=>x*v),l=Ap(r.shape,i,a),c=Rp(l.length,i.length),u=Dp(r.shape,i,a),d=iI(o,i.length),h=oI(u,o,i.length),f=[],p=he({inputs:{x:r},backend:n,attrs:{shape:l}}),m=ss({inputs:{x:p},backend:n,attrs:{perm:c}}),y=he({inputs:{x:m},backend:n,attrs:{shape:u}}),g=od({inputs:{x:y},backend:n,attrs:{begin:d,size:h}});return f.push(p),f.push(m),f.push(y),f.forEach(x=>n.disposeIntermediateTensorInfo(x)),g},Xxe={kernelName:wx,backendName:"webgl",kernelFunc:Kxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.readSync(r.dataId),l=n.readSync(i.dataId),c=kB(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const Zxe={kernelName:$C,backendName:"webgl",kernelFunc:Yxe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jxe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Qxe=`
  return float(int(a.r) & int(b.r));
`;function e0e(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=Y().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||o===1){const l=n.texData.get(s.dataId).values,c=n.texData.get(r.dataId).values,[u,d]=lge(s.shape,r.shape,l,c,s.dtype),h=n.makeTensorInfo(d,s.dtype),f=n.texData.get(h.dataId);return f.values=u,h}let a;return i?a=new rd(Jxe,s.shape,r.shape,!1):a=new Kl(Qxe,s.shape,r.shape),n.runWebGLProgram(a,[s,r],s.dtype)}const t0e={kernelName:_C,backendName:"webgl",kernelFunc:e0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n0e(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.readSync(s.dataId),o=n.readSync(r.dataId),a=Le(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const s0e={kernelName:CF,backendName:"webgl",kernelFunc:n0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r0e="return float(a != b);",FB=An({opSnippet:r0e,cpuKernelImpl:$ge,dtype:"bool"}),i0e={kernelName:Xx,backendName:"webgl",kernelFunc:FB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hp(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return Ps({inputs:{x:r.complexTensorInfos.real},backend:n})}const o0e={kernelName:tS,backendName:"webgl",kernelFunc:Hp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a0e="return float(int(x));";function l0e(t,e){const n=new di(t.shape,a0e),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S1(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return Ps({inputs:{x:r},backend:n});const o=vn(r.shape),a=S1({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=za({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const o=Hp({inputs:{input:r},backend:n}),a=S1({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!xF(r.dtype,i)){const o=Ps({inputs:{x:r},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId).values,[a,l,c]=cge(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}if(i==="int32")return l0e(r,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",Mn("bool",1)),l=FB({inputs:{a:r,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${i}`)}const c0e={kernelName:Lf,backendName:"webgl",kernelFunc:S1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W$="return ceil(x);",u0e=et({opSnippet:W$,packedOpSnippet:W$,cpuKernelImpl:uge}),d0e={kernelName:Vf,backendName:"webgl",kernelFunc:u0e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h0e{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f0e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:i,clipValueMax:o}=s;let a;Y().getBool("WEBGL_PACK_CLIP")?a=new f0e(r.shape):a=new h0e(r.shape);const l=[[i],[o]];return n.runWebGLProgram(a,[r],r.dtype,l)}const m0e={kernelName:Bf,backendName:"webgl",kernelFunc:p0e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g0e{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G$(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function y0e(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),i=new g0e(s.shape),o=[G$(s,r.complexTensorInfos.real),G$(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const x0e={kernelName:kx,backendName:"webgl",kernelFunc:y0e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v0e{constructor(e){this.outputShape=[],this.outputShape=bi(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];s.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const r=n.length,i=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b0e{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=bi(e,n);const s=this.outputShape,r=s.length,i=mt(r),o=Zn("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((m,y)=>`T${y}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const c=a[n],u=a.slice(-2),d=a.join();let h=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${u.join()}));
        }`;for(let m=1;m<l.length;m++){const y=l[m-1];h+=`
        if (${c} < ${l[m]}  && ${c} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${Dm(a,c,y)}),
            vec2(${Dm(u,c,y)}));
        }`}const f=l.length,p=l[l.length-1];h+=`
        return getChannel(
          getT${f}(${Dm(a,c,p)}),
          vec2(${Dm(u,c,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${h}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[r-1]} = ${o[r-1]} + 1;
        if (${o[r-1]} < ${s[r-1]}) {
          result.g = getValue(${o});
        }

        ${o[r-2]} = ${o[r-2]} + 1;
        if (${o[r-2]} < ${s[r-2]}) {
          result.a = getValue(${o});
        }

        ${o[r-1]} = ${o[r-1]} - 1;
        if (${o[r-2]} < ${s[r-2]} &&
            ${o[r-1]} < ${s[r-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function Dm(t,e,n){const s=t.indexOf(e);return t.map((i,o)=>o===s?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G0(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return Ps({inputs:{x:r.complexTensorInfos.imag},backend:n})}const w0e={kernelName:qC,backendName:"webgl",kernelFunc:G0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jd(t,e,n){const s=t[0].dtype;if(s==="complex64"){const f=t.map(x=>Hp({inputs:{input:x},backend:n})),p=t.map(x=>G0({inputs:{input:x},backend:n})),m=jd(f,e,n),y=jd(p,e,n),g=za({inputs:{real:m,imag:y},backend:n});return f.forEach(x=>n.disposeIntermediateTensorInfo(x)),p.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),g}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const f=t.map(b=>{const C=[-1,Q(b.shape.slice(e))];return he({inputs:{x:b},backend:n,attrs:{shape:C}})}),p=f.map(b=>({vals:n.readSync(b.dataId),shape:b.shape})),m=bi(f.map(b=>b.shape),1),y=f[0].shape[0]===1,g=dge(p,m,s,y),x=bi(t.map(b=>b.shape),e),v=n.makeTensorInfo(x,s,g);return f.forEach(b=>n.disposeIntermediateTensorInfo(b)),v}const i=t.filter(f=>Q(f.shape)>0),o=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const f=o?new di(t[0].shape,Po):new Ko(t[0].shape,Po);return n.runWebGLProgram(f,t,s)}const a=Y().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const f=[];for(let m=0;m<i.length;m+=a){const y=i.slice(m,m+a);f.push(jd(y,e,n))}const p=jd(f,e,n);for(const m of f)n.disposeIntermediateTensorInfo(m);return p}if(o){const f=new b0e(i.map(p=>p.shape),e);return n.runWebGLProgram(f,i,s)}const{tensors2D:l,outShape:c}=k0e(i,e,n),u=new v0e(l.map(f=>f.shape)),d=n.runWebGLProgram(u,l,s);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const h=he({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),h}function k0e(t,e,n){const s=bi(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>he({inputs:{x:i},attrs:{shape:[-1,Q(i.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MB(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=qe(r,e[0].shape)[0],o=e.map(c=>c.shape);nI(o,i);const a=bi(e.map(c=>c.shape),i);if(Q(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>Q(c.shape)>0);return l.length===1?Ps({inputs:{x:l[0]},backend:n}):jd(l,i,n)}const C0e={kernelName:Cx,backendName:"webgl",kernelFunc:MB};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LB{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,y=e.dataFormat==="channelsLast",g=y?1:2,x=y?2:3,v=y?3:1;let b="",k="";s&&(r?b=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?b=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:b=`
          float activation(float x) {
            ${s}
          }
        `,k="result = activation(result);");const C=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${v}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${y}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${y}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${y}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${y}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${C}
        ${k}
        setOutput(result);
      }
    `}}class S0e{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VB{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Un(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<u;y++)h+=`
           vec4 xTexelC${y*2};
           int xTexelC${y*2}Ready;
           vec4 xTexelC${y*2+1};
           int xTexelC${y*2+1}Ready;
           vec4 xC${y};`;h+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let y=0;y<u;y++)h+=`
           xTexelC${y*2} = vec4(0.0);
           xTexelC${y*2}Ready = 0;
           xTexelC${y*2+1} = vec4(0.0);
           xTexelC${y*2+1}Ready = 0;
           xC${y} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let y=0;y<(d+1)/2;y++){const g=y*2;if(h+=`
           xC = xCCorner + ${g*l};
           `,a===1){if(g<u&&(o%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }
               `,l===1&&g>0?h+=`
                 xC${g} = vec4(xTexelC${g-2}.zw, xTexelC${g}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${g} = vec4(previous.zw, xTexelC${g}.xy);
                   } else {
                     xC${g} = vec4(0.0, 0.0, xTexelC${g}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xC${g} = xTexelC${g};
                 `,g+1<u)){const x=o%2===0?vC(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${x};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                     xTexelC${g+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${g+1}.zw = vec2(0.0);
                     }
                     xTexelC${g+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${g+1} = vec4(previous.zw, xTexelC${g+1}.xy);
                     } else {
                      xC${g+1} = vec4(0.0, 0.0, xTexelC${g+1}.xy);
                     }
                     `:h+=`
                     xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.xy);
                     `):x===1?h+=`
                     xC${g+1} = xTexelC${g};
                     `:h+=`
                     xCOffset = xC + ${x};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                       xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${g+1}.zw = vec2(0.0);
                       }
                       xTexelC${g+1}Ready = 1;
                     }

                     xC${g+1} = xTexelC${g+1};
                     `}}else g<u&&(o%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.0);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
               `,g+1<u&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${g+1} = vec4(xTexelC${g+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(
                   xTexelC${g}.xy, xTexelC${g+1}.xy);
               `,g+1<u&&(h+=`
                   xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
                 `)));g<u&&(h+=`
             wTexel = getW(r, ${g}, d1, d2);
             dotProd += xC${g}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${g}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,g+1<u&&(h+=`
               wTexel = getW(r, ${g+1}, d1, d2);
               dotProd += xC${g+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${g+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let f="",p="";s&&(r?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:i?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:f=`vec4 activation(vec4 x) {
           ${s}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I0e{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Un(this.outputShape.length);const{dataFormat:s}=n,r=rs(),i=s==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _y(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function BB({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=t.shape,c=s.texData.get(t.dataId),u=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,m=!1;let y;const g=[];if(i!=null){const b=_y(i.shape,f);b!=null&&(i=he({inputs:{x:i},backend:s,attrs:{shape:b}}),g.push(i))}if(r!=null){const b=_y(r.shape,f);b!=null&&(r=he({inputs:{x:r},backend:s,attrs:{shape:b}}),g.push(r))}if(!((d===1||h===1)&&u>RB)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&at(c.shape.slice(-3),l.slice(-3))){const b=l[0]*l[1]*(l[2]+1),k={dataId:t.dataId,shape:[1,b,n.inChannels],dtype:t.dtype},C=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,T(Ey(c.shape,k.shape),()=>`packed reshape ${c.shape} to ${k.shape} isn't free`);const S=he({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});g.push(S);const I=$y({a:k,b:S,backend:s,transposeA:p,transposeB:m,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),N=s.texData.get(I.dataId);T(N.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=C,N.shape=n.outShape,y=Ps({inputs:{x:I},backend:s}),y.shape=n.outShape,g.push(I)}else{const b=n.outHeight*n.outWidth,k=he({inputs:{x:t},backend:s,attrs:{shape:f?[n.batchSize,b,n.inChannels]:[n.batchSize,n.inChannels,b]}}),C=he({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),S=$y({a:f?k:C,b:f?C:k,transposeA:!f,transposeB:m,backend:s,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o});y=he({inputs:{x:S},backend:s,attrs:{shape:n.outShape}}),g.push(k),g.push(C),g.push(S)}for(const b of g)s.disposeIntermediateTensorInfo(b);return y}function zB({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:h,dataFormat:f}=n,p=f==="channelsLast",m=l*c*u,y=h*d,g=[n.batchSize,m,y],x=!0,v=!1,b=[];if(i!=null){const A=_y(i.shape,p);A!=null&&(i=he({inputs:{x:i},backend:s,attrs:{shape:A}}),b.push(i))}if(r!=null){const A=_y(r.shape,p);A!=null&&(r=he({inputs:{x:r},backend:s,attrs:{shape:A}}),b.push(r))}const k=he({inputs:{x:e},backend:s,attrs:{shape:[1,m,Q(e.shape)/m]}});b.push(k);const C=new I0e(g,n),S=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],I=s.runWebGLProgram(C,[t],"float32",S),N=he({inputs:{x:I},backend:s,attrs:{shape:g}});b.push(I),b.push(N);const E=r!=null,D=i!=null,R=a==="leakyrelu",L=a?sf(a,!0):null,B=new AB(p?N.shape:k.shape,p?k.shape:N.shape,p?[n.batchSize,y,n.outChannels]:[n.batchSize,n.outChannels,y],x,v,E,L,D,R),W=p?[N,k]:[k,N];if(r&&W.push(r),D&&W.push(i),R){const A=s.makeTensorInfo([],"float32",Da(o,"float32"));W.push(A),b.push(A)}const G=s.runWebGLProgram(B,W,"float32"),q=he({inputs:{x:G},backend:s,attrs:{shape:n.outShape}});b.push(G);for(const A of b)s.disposeIntermediateTensorInfo(A);return q}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s,d=bo(l),h=$n(r.shape,i.shape,o,c,a,u,!1,d);let f;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))f=BB({x:r,filter:i,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&Y().getBool("WEBGL_EXP_CONV")){const m=new VB(h),y=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];f=n.runWebGLProgram(m,[r,i],"float32",y)}else if(Y().getBool("WEBGL_CONV_IM2COL"))f=zB({x:r,filter:i,convInfo:h,backend:n});else{const m=new LB(h);f=n.runWebGLProgram(m,[r,i],"float32")}const p=he({inputs:{x:f},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(f),p}const N0e={kernelName:Sx,backendName:"webgl",kernelFunc:T0e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E0e{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class $0e{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=s-1-e.padInfo.left,c=o?1:2,u=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class _0e{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class A0e{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,c=s-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s,d=bo(l),h=$n(r.shape,u,o,1,a,c,!1,d),f=new E0e(h);return n.runWebGLProgram(f,[r,i],"float32")}const D0e={kernelName:RC,backendName:"webgl",kernelFunc:R0e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P0e{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Un(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,r=n-1-e.padInfo.top,i=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O0e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s,d=bo(c),h=$n(o,i.shape,a,1,l,u,!1,d);if(Y().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const f=[[h.strideHeight,h.strideWidth]],p=new P0e(h);return n.runWebGLProgram(p,[r,i],"float32",f)}else{const f=new $0e(h);return n.runWebGLProgram(f,[r,i],"float32")}}const F0e={kernelName:Ix,backendName:"webgl",kernelFunc:O0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=Pa(r.shape,i.shape,o,l,a),u=new S0e(c);return n.runWebGLProgram(u,[r,i],"float32")}const L0e={kernelName:Tx,backendName:"webgl",kernelFunc:M0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s,c=Pa(r.shape,l,o,1,a),u=new _0e(c);return n.runWebGLProgram(u,[r,i],"float32")}const B0e={kernelName:DC,backendName:"webgl",kernelFunc:V0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z0e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s,c=Pa(l,i.shape,a,1,o),u=new A0e(c);return n.runWebGLProgram(u,[r,i],"float32")}const U0e={kernelName:PC,backendName:"webgl",kernelFunc:z0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j0e=id+`
  return cos(x);
`,W0e=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${hc}
  return result;
`,G0e=et({opSnippet:j0e,packedOpSnippet:W0e}),H0e={kernelName:zf,backendName:"webgl",kernelFunc:G0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q0e=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,K0e=et({opSnippet:q0e}),X0e={kernelName:Uf,backendName:"webgl",kernelFunc:K0e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y0e{constructor(e,n,s,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,c]=e,[u]=n,[d,h]=s;this.outputShape=[u,d,h,c];const f=r==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${l-1}.0`],[y,g,x]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[v,b,k]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${y});
      const float width_ratio = float(${v});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${b};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${k};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z0e=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,u=new Y0e(r.shape,i.shape,a,l,c);return n.runWebGLProgram(u,[r,i,o],"float32")},J0e={kernelName:FC,backendName:"webgl",kernelFunc:Z0e};var of;(function(t){t.Prod="*",t.Sum="+"})(of||(of={}));class H${constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===of.Prod?"1.0":"0.0",a=s?o:`getX(${q$(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";s?(c=r?`end != ${l-1}`:"end != 0",u=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${mt(i)} coords = getOutputCoords();
        int end = ${K$(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${K$(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${q$(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function q$(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function K$(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UB(t,e,n,s,r,i){const o=e.shape.length,a=Lt([s],o);let l=e;a!=null&&(l=ss({inputs:{x:e},backend:n,attrs:{perm:a}}));const c=Zt(1,o)[0];if(c!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const u=l.shape[c];let d=Ps({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const f=new H$(t,l.shape,!1,i),p=[[h]],m=d;d=n.runWebGLProgram(f,[d],d.dtype,p),n.disposeIntermediateTensorInfo(m)}if(r){const h=new H$(t,l.shape,r,i),f=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const h=Oa(a),f=ss({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return UB(of.Prod,r,n,i,o,a)}const eve={kernelName:OC,backendName:"webgl",kernelFunc:Q0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return UB(of.Sum,r,n,i,o,a)}const nve={kernelName:Nx,backendName:"webgl",kernelFunc:tve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=kB(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=age(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const rve={kernelName:MC,backendName:"webgl",kernelFunc:sve};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ive{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ove(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s,a=r.shape[0],l=o==="NHWC"?r.shape[1]:r.shape[2],c=o==="NHWC"?r.shape[2]:r.shape[3],u=o==="NHWC"?r.shape[3]:r.shape[1],d=l*i,h=c*i,f=u/(i*i),p=o==="NHWC"?[a,d,h,f]:[a,f,d,h],m=new ive(p,i,o);return n.runWebGLProgram(m,[r],r.dtype)}const ave={kernelName:LC,backendName:"webgl",kernelFunc:ove};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jB{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Un(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,u="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WB{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Un(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,h=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<d;g++)f+=`
          vec4 xTexelC${g*2};
          int xTexelC${g*2}Ready;
          vec4 xTexelC${g*2+1};
          int xTexelC${g*2+1}Ready;
          vec4 xC${g};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let g=0;g<d;g++)f+=`
          xTexelC${g*2} = vec4(0.0);
          xTexelC${g*2}Ready = 0;
          xTexelC${g*2+1} = vec4(0.0);
          xTexelC${g*2+1}Ready = 0;
          xC${g} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let g=0;g<(h+1)/2;g++){const x=g*2;if(f+=`
          xC = xCCorner + ${x*c};
          `,l===1){if(x<d&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,c===1&&x>0?f+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<d)){const v=a%2===0?vC(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${v};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                    } else {
                     xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                    }
                    `:f+=`
                    xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                    `):v===1?f+=`
                    xC${x+1} = xTexelC${x};
                    `:f+=`
                    xCOffset = xC + ${v};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<d&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<d&&(f+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<d&&(f+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<d&&(f+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",m="";s&&(r?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:p=`vec4 activation(vec4 x) {
          ${s}
        }`,m="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${y}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;let u=l;u==null&&(u=[1,1]),T(Bn(o,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const d=$n(r.shape,i.shape,o,u,a,c,!0);let h;Y().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new WB(d):h=new jB(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[r,i],"float32",f)}const cve={kernelName:Ex,backendName:"webgl",kernelFunc:lve};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uve{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class dve{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s,d=$n(r.shape,u,o,a,l,c,!0),h=new uve(d);return n.runWebGLProgram(h,[r,i],"float32")}const fve={kernelName:VC,backendName:"webgl",kernelFunc:hve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pve(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s,d=$n(u,i.shape,o,a,l,c,!0),h=new dve(d);return n.runWebGLProgram(h,[r,i],"float32")}const mve={kernelName:BC,backendName:"webgl",kernelFunc:pve};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gve{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yve(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],i=Q(s.shape),o=he({inputs:{x:s},backend:n,attrs:{shape:[i]}}),a=new gve(i),l=n.runWebGLProgram(a,[o],o.dtype),c=he({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const xve={kernelName:SF,backendName:"webgl",kernelFunc:yve};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vve{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:d,left:h}=r;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=Tp(r.shape,i.shape,o,a,"NHWC",l);let u;const d=new vve(c);u=n.runWebGLProgram(d,[r,i],"float32");const h=he({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),h}const wve={kernelName:$x,backendName:"webgl",kernelFunc:bve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kve(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=pI(r,i.length);gI(o.length,l,i);const{path:c,steps:u}=yI(a,l),d=u.length;let h=null,f=o.length;const p=[];for(let m=0;m<d;++m){for(const y of u[m]){const{permutationIndices:g,expandDims:x}=mI(f,l[y]);let v;xI(g)?v=i[y]:(v=ss({inputs:{x:i[y]},backend:n,attrs:{perm:g}}),p.push(v));const b=v.shape.slice();for(let k=0;k<x.length;++k)b.splice(x[k],0,1);at(v.shape,b)||(v=he({inputs:{x:v},backend:n,attrs:{shape:b}}),p.push(v)),h===null?h=v:(h=rT({inputs:{a:v,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=W0({inputs:{x:h},backend:n,attrs:{axis:c[m]-(o.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const Cve={kernelName:zC,backendName:"webgl",kernelFunc:kve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sve="return (x >= 0.0) ? x : (exp(x) - 1.0);",Ive=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Tve=et({opSnippet:Sve,packedOpSnippet:Ive}),Nve={kernelName:Wf,backendName:"webgl",kernelFunc:Tve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eve="return (b >= 0.0) ? a : a * (b + 1.0);",$ve=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,_ve=t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,i=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new rd($ve,s.shape,r.shape):new Kl(Eve,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],s.dtype)},Ave={kernelName:UC,backendName:"webgl",kernelFunc:_ve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rve=`
  return vec4(equal(a, b));
`,Dve="return float(a == b);",Pve=An({opSnippet:Dve,packedOpSnippet:Rve,dtype:"bool",cpuKernelImpl:hge}),Ove={kernelName:_x,backendName:"webgl",kernelFunc:Pve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fve=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${aI};
  float a1 = ${lI};
  float a2 = ${cI};
  float a3 = ${uI};
  float a4 = ${dI};
  float a5 = ${hI};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Mve=et({opSnippet:Fve}),Lve={kernelName:Gf,backendName:"webgl",kernelFunc:Mve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vve=id+`
  return exp(x);
`,Bve=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,GB=et({opSnippet:Vve,packedOpSnippet:Bve,cpuKernelImpl:fge,dtype:"float32"}),zve={kernelName:Hf,backendName:"webgl",kernelFunc:GB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I1(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=r;return r<0&&(T(-(o+1)<=r,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+r+1),a.splice(l,0,1),he({inputs:{x:i},backend:s,attrs:{shape:a}})}const Uve={kernelName:Ax,backendName:"webgl",kernelFunc:I1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X$="return exp(x) - 1.0;",jve=et({opSnippet:X$,packedOpSnippet:X$,cpuKernelImpl:pge}),Wve={kernelName:qf,backendName:"webgl",kernelFunc:jve};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y${constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const i=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=s?`${r}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HB(t,e,n){const s=n.texData.get(t.dataId),r=Q(t.shape),i=t.shape[t.shape.length-1],o=r/i,a=he({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),l=a.shape,c=new Y$("real",l,e),u=new Y$("imag",l,e),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=za({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);const m=he({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gve(t){const{inputs:e,backend:n}=t,{input:s}=e;return HB(s,!1,n)}const Hve={kernelName:jC,backendName:"webgl",kernelFunc:Gve};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qve{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qp(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:i}=n;if(i=i||Wu(r),i==="string"){const o=qt(i,Q(s));return o.fill(r),e.makeTensorInfo(s,i,o)}else{const o=new qve(s,r),a=[[r]];return e.runWebGLProgram(o,[],i,a)}}const Kve={kernelName:WC,backendName:"webgl",kernelFunc:qp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xve{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yve={kernelName:GC,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new Xve(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z$="return floor(x);",Zve=et({opSnippet:Z$,packedOpSnippet:Z$,cpuKernelImpl:mge}),Jve={kernelName:Kf,backendName:"webgl",kernelFunc:Zve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qve=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,ebe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,tbe=An({opSnippet:Qve,packedOpSnippet:ebe,dtype:"int32"}),nbe={kernelName:Xf,backendName:"webgl",kernelFunc:tbe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sbe{constructor(e){this.variableNames=["A"];const n=rs(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rbe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=rs(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ibe={kernelName:kZ,backendName:"webgl",kernelFunc:obe};let xc,fb=Y().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function obe(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:i}=s,o=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=o?[r.videoWidth,r.videoHeight]:[r.width,r.height],u=[c,l],d=[c,l,i];if(a||o){const m=Y().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(xc==null||m!==fb)&&(fb=m,xc=document.createElement("canvas").getContext("2d",{willReadFrequently:fb})),xc.canvas.width=l,xc.canvas.height=c,xc.drawImage(r,0,0,l,c),r=xc.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=Vs.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),r);const f=Y().getBool("WEBGL_PACK")?new rbe(d):new sbe(d),p=n.runWebGLProgram(f,[h],"int32");return n.disposeData(h.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function abe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s,m=bo(u),y=$n(r.shape,i.shape,l,d,c,h,!1,m);let g;const x=[],v=o!=null,b=a!=null,k=f==="leakyrelu",C=()=>{const I=[r,i],N=(E,D)=>{if(D==="NCHW"&&E.shape.length===1&&E.shape[0]!==1){const R=he({inputs:{x:E},backend:n,attrs:{shape:[E.shape[0],1,1]}});return x.push(R),R}return E};if(v&&I.push(N(o,u)),b&&I.push(N(a,u)),k){const E=n.makeTensorInfo([],"float32",Da(p,"float32"));I.push(E),x.push(E)}return I};if(y.filterHeight===1&&y.filterWidth===1&&y.dilationHeight===1&&y.dilationWidth===1&&y.strideHeight===1&&y.strideWidth===1&&(y.padInfo.type==="SAME"||y.padInfo.type==="VALID"))g=BB({x:r,filter:i,convInfo:y,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(y.strideWidth<=2&&m==="channelsLast"&&Y().getBool("WEBGL_EXP_CONV")){const I=f?sf(f,!0):null,N=new VB(y,v,I,b,k),E=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],D=C();g=n.runWebGLProgram(N,D,"float32",E)}else if(Y().getBool("WEBGL_CONV_IM2COL"))g=zB({x:r,filter:i,convInfo:y,backend:n,bias:o,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const I=f?sf(f,!1):null,N=new LB(y,v,I,b,k),E=C();g=n.runWebGLProgram(N,E,"float32")}const S=he({inputs:{x:g},backend:n,attrs:{shape:y.outShape}});return x.push(g),x.forEach(I=>n.disposeIntermediateTensorInfo(I)),S}const lbe={kernelName:iy,backendName:"webgl",kernelFunc:abe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=s,p=[];let m=u;m==null&&(m=[1,1]),T(Bn(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const y=$n(r.shape,i.shape,l,m,c,d,!0),g=Y().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,x=h?sf(h,g):null,v=[r,i],b=o!=null,k=a!=null,C=h==="leakyrelu";if(b&&v.push(o),k&&v.push(a),C){const E=n.makeTensorInfo([],"float32",Da(f,"float32"));v.push(E),p.push(E)}let S;g?S=new WB(y,b,x,k,C):S=new jB(y,b,x,k,C);const I=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],N=n.runWebGLProgram(S,v,"float32",I);return p.forEach(E=>n.disposeIntermediateTensorInfo(E)),N}const ube={kernelName:jF,backendName:"webgl",kernelFunc:cbe};class dbe{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const i=mt(s.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hbe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=r.shape,o=i[i.length-1],a=Q(s.shape),[l,c,u,d]=YS(s,r),h=he({inputs:{x:r},backend:n,attrs:{shape:[c,o]}}),f=he({inputs:{x:s},backend:n,attrs:{shape:[Q(s.shape)/u,u]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const g=n.readSync(r.dataId),x=n.bufferSync(s),v=gge(g,x,s.dtype,c,o,u,d,s.shape,a);return n.makeTensorInfo(l,s.dtype,v.values)}const p=new dbe(o,d,[c,u],s.shape),m=n.runWebGLProgram(p,[f,h],f.dtype),y=he({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),y}const fbe={kernelName:IF,backendName:"webgl",kernelFunc:hbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pbe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=mt(this.rank),r=mbe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function mbe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qB(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s,l=qe(o,r.shape)[0];if(Y().get("DEBUG")){const x=n.readSync(i.dataId),v=r.shape[l];for(let b=0;b<x.length;++b){const k=x[b];T(k<=v-1&&k>=0,()=>`GatherV2: the index value ${k} is not in [0, ${v-1}]`)}}const c=bI(r,i,l,a),u=Q(i.shape),d=[],h=he({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=he({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(h),d.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const x=n.bufferSync(f),v=n.bufferSync(h),b=yge(v,x,p);return d.forEach(k=>n.disposeIntermediateTensorInfo(k)),n.makeTensorInfo(c.outputShape,b.dtype,b.values)}const m=new pbe(h.shape,p),y=n.runWebGLProgram(m,[h,f],h.dtype);d.push(y);const g=he({inputs:{x:y},backend:n,attrs:{shape:c.outputShape}});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),g}const gbe={kernelName:Dx,backendName:"webgl",kernelFunc:qB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ybe="return float(a > b);",xbe=`
  return vec4(greaterThan(a, b));
`,vbe=An({opSnippet:ybe,packedOpSnippet:xbe,cpuKernelImpl:xge,dtype:"bool"}),bbe={kernelName:Px,backendName:"webgl",kernelFunc:vbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wbe="return float(a >= b);",kbe=`
  return vec4(greaterThanEqual(a, b));
`,Cbe=An({opSnippet:wbe,packedOpSnippet:kbe,dtype:"bool",cpuKernelImpl:vge}),Sbe={kernelName:Yf,backendName:"webgl",kernelFunc:Cbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ibe(t){const{inputs:e,backend:n}=t,{input:s}=e;return HB(s,!0,n)}const Tbe={kernelName:HC,backendName:"webgl",kernelFunc:Ibe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nbe="return float(!isnan(x) && !isinf(x));",Ebe=et({opSnippet:Nbe,dtype:"bool"}),$be={kernelName:Jf,backendName:"webgl",kernelFunc:Ebe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _be="return float(isinf(x));",Abe=et({opSnippet:_be,dtype:"bool"}),Rbe={kernelName:Qf,backendName:"webgl",kernelFunc:Abe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dbe="return float(isnan(x));",Pbe=et({opSnippet:Dbe,dtype:"bool"}),Obe={kernelName:ep,backendName:"webgl",kernelFunc:Pbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fbe="return float(a < b);",Mbe=`
  return vec4(lessThan(a, b));
`,Lbe=An({opSnippet:Fbe,packedOpSnippet:Mbe,cpuKernelImpl:bge,dtype:"bool"}),Vbe={kernelName:Fx,backendName:"webgl",kernelFunc:Lbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bbe="return float(a <= b);",zbe=`
  return vec4(lessThanEqual(a, b));
`,Ube=An({opSnippet:Bbe,packedOpSnippet:zbe,cpuKernelImpl:wge,dtype:"bool"}),jbe={kernelName:Mx,backendName:"webgl",kernelFunc:Ube};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wbe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=kge(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const Gbe={kernelName:TF,backendName:"webgl",kernelFunc:Wbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hbe=id+`
  return x < 0.0 ? 0./0. : log(x);
`,qbe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Kbe=et({opSnippet:Hbe,packedOpSnippet:qbe,cpuKernelImpl:Cge}),Xbe={kernelName:tp,backendName:"webgl",kernelFunc:Kbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ybe=id+`
  return log(1.0 + x);
`,Zbe=et({opSnippet:Ybe}),Jbe={kernelName:np,backendName:"webgl",kernelFunc:Zbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qbe="return float(a >= 1.0 && b >= 1.0);",ewe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,twe=An({opSnippet:Qbe,packedOpSnippet:ewe,dtype:"bool"}),nwe={kernelName:Lx,backendName:"webgl",kernelFunc:twe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const swe="return float(!(x >= 1.0));",rwe=et({opSnippet:swe}),iwe={kernelName:Vx,backendName:"webgl",kernelFunc:rwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const owe="return float(a >= 1.0 || b >= 1.0);",awe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,lwe=An({opSnippet:owe,packedOpSnippet:awe,dtype:"bool"}),cwe={kernelName:Bx,backendName:"webgl",kernelFunc:lwe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uwe{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dwe{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hwe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s,c=Y().getBool("WEBGL_PACK_NORMALIZATION")?new dwe(r.shape,i,o,a,l):new uwe(r.shape,i,o,a,l);return n.runWebGLProgram(c,[r],r.dtype)},fwe={kernelName:zx,backendName:"webgl",kernelFunc:hwe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pwe{constructor(e,n,s,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mwe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s,d=new pwe(r.shape,a,l,c,u);return n.runWebGLProgram(d,[r,i,o],r.dtype)},gwe={kernelName:KC,backendName:"webgl",kernelFunc:mwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ywe(t,e,n,s){const r=Q(e),o=Q(t.shape)/r,a=he({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=fc(a,t.dtype,"max",s),c=he({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KB(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=r.shape.length,l=qe(i,r.shape);let c=l;const u=Lt(c,a),d=u!=null,h=n.shouldExecuteOnCPU([r]);let f=r;if(d){if(h){const v=n.texData.get(f.dataId).values,b=new Array(a);for(let S=0;S<b.length;S++)b[S]=r.shape[u[S]];const k=nT(v,r.shape,r.dtype,u,b);f=n.makeTensorInfo(b,r.dtype);const C=n.texData.get(f.dataId);C.values=k}else f=j0(r,u,n);c=Zt(c.length,a)}_n("max",c,a);const[p,m]=kn(f.shape,c);let y=p;o&&(y=on(p,l));let g;if(h){const v=n.texData.get(f.dataId).values,b=Sge(v,Q(m),y,r.dtype);g=n.makeTensorInfo(y,r.dtype);const k=n.texData.get(g.dataId);k.values=b}else g=ywe(f,m,y,n);return d&&n.disposeIntermediateTensorInfo(f),g}const xwe={kernelName:Ux,backendName:"webgl",kernelFunc:KB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vwe=sT+`
  return max(a, b);
`,bwe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+hc+`
  return result;
`,wwe=An({opSnippet:vwe,packedOpSnippet:bwe,cpuKernelImpl:Ige}),kwe={kernelName:sp,backendName:"webgl",kernelFunc:wwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Wp(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;T(Bn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=br(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&at(u.inShape,u.outShape))return Ps({inputs:{x:r},backend:n});const d=new rf(u,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const Swe={kernelName:jx,backendName:"webgl",kernelFunc:Cwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:c}=s,u=[1,1,1],d=vo(r.shape,i,o,u,a,c,l),h=new iT(d,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}const Twe={kernelName:Wx,backendName:"webgl",kernelFunc:Iwe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nwe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=o-1-e.padInfo.left,c=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class Ewe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $we(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=vo(o.shape,a,l,d,c,u),f=new iT(h,"max",!0),p=n.runWebGLProgram(f,[o],o.dtype),m=new Ewe(h),y=n.runWebGLProgram(m,[r,p],o.dtype);return n.disposeIntermediateTensorInfo(p),y}const _we={kernelName:YC,backendName:"webgl",kernelFunc:$we};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Awe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;Wp([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=br(a.shape,l,c,1,u,d),f=!0,p=new rf(h,"max",f),m=n.runWebGLProgram(p,[a],a.dtype),y=new Nwe(h),g=n.runWebGLProgram(y,[r,m],a.dtype);return n.disposeIntermediateTensorInfo(m),g}const Rwe={kernelName:XC,backendName:"webgl",kernelFunc:Awe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dwe(t,e,n,s){let r=new rf(n,"max",!1);const i=s.runWebGLProgram(r,[t],"float32");r=new rf(n,"max",!0,!0,e);const o=s.runWebGLProgram(r,[t],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pwe={kernelName:NF,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;T(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];T(Bn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=br(s.shape,r,i,c,o),[d,h]=Dwe(s,a,u,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Owe(t,e,n,s){const r=Q(e),o=Q(t.shape)/r,a=he({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=fc(a,"float32","mean",s),c=he({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fwe={kernelName:Gx,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:i}=e,o=n,a=s.shape.length,l=qe(i,s.shape);let c=l;const u=Lt(c,a),d=u!=null,h=o.shouldExecuteOnCPU([s]),f=[];let p=s;if(d){if(h){const b=o.texData.get(p.dataId).values,k=new Array(a);for(let I=0;I<k.length;I++)k[I]=s.shape[u[I]];const C=nT(b,s.shape,s.dtype,u,k);p=o.makeTensorInfo(k,s.dtype);const S=o.texData.get(p.dataId);S.values=C}else p=j0(s,u,o);f.push(p),c=Zt(c.length,a)}_n("sum",c,a);const[m,y]=kn(p.shape,c);let g=m;r&&(g=on(m,l));const x=Owe(p,y,g,o);for(const v of f)o.disposeIntermediateTensorInfo(v);return x}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=qe(i,r.shape);let c=l;const u=Lt(c,a);let d=r;u!=null&&(d=ss({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Zt(c.length,r.shape.length)),_n("min",c,a);const[h,f]=kn(d.shape,c),p=Q(f),m=he({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),y=fc(m,m.dtype,"min",n);let g;if(o){const x=on(h,l);g=he({inputs:{x:y},backend:n,attrs:{shape:x}})}else g=he({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(d),g}const Lwe={kernelName:Hx,backendName:"webgl",kernelFunc:Mwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vwe=sT+`
  return min(a, b);
`,Bwe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+hc+`
  return result;
`,zwe=An({opSnippet:Vwe,packedOpSnippet:Bwe,cpuKernelImpl:Tge}),Uwe={kernelName:rp,backendName:"webgl",kernelFunc:zwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jwe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((u,d)=>u[0]+e[d]+u[1]);const r=e.length,i=mt(r),o=n.map(u=>u[0]).join(","),a=n.map((u,d)=>u[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wwe{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+e[m]+p[1]);const r=e.length,i=mt(r),o=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+e[m]).join(","),l=Zn("rc",r),c=Zn("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=s==="reflect"?0:1;let f="";if(r===1){const p=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const p=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[r-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gwe=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:i}=n,o=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Wwe(s.shape,r,i):new jwe(s.shape,r,i);return e.runWebGLProgram(o,[s],s.dtype)},Hwe={kernelName:qx,backendName:"webgl",kernelFunc:Gwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qwe=`if (b == 0.0) return NAN;
  return mod(a, b);`,Kwe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+hc+`
  return result;
`,Xwe=An({opSnippet:qwe,packedOpSnippet:Kwe}),Ywe={kernelName:ip,backendName:"webgl",kernelFunc:Xwe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zwe{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jwe=`
if (a == b) {
  return 1.0;
};
return a / b;`,Qwe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,XB=An({opSnippet:Jwe,packedOpSnippet:Qwe,checkOutOfBounds:!0}),e1e={kernelName:jf,backendName:"webgl",kernelFunc:XB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J$="return a - b;",YB=An({opSnippet:J$,packedOpSnippet:J$,supportsComplex:!0,cpuKernelImpl:qge}),t1e={kernelName:wp,backendName:"webgl",kernelFunc:YB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZB(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=qe([i],r.shape),a=KB({inputs:{x:r},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=on(a.shape,o),c=he({inputs:{x:a},backend:n,attrs:{shape:l}}),u=YB({inputs:{a:r,b:c},backend:n}),d=GB({inputs:{x:u},backend:n}),h=W0({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),f=he({inputs:{x:h},backend:n,attrs:{shape:l}}),p=XB({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}const n1e={kernelName:d0,backendName:"webgl",kernelFunc:ZB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s1e(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s,l=a?r:ZB({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new Zwe(c,u,i),h=[[o]],f=n.runWebGLProgram(d,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),f}const r1e={kernelName:EF,backendName:"webgl",kernelFunc:s1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i1e=kr+`
  return -x;
`,o1e=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function a1e(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const i=n.texData.get(s.dataId),[o,a]=Ege(i.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,o)}let r;return Y().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Ko(s.shape,o1e):r=new di(s.shape,i1e),n.runWebGLProgram(r,[s],s.dtype)}const l1e={kernelName:Kx,backendName:"webgl",kernelFunc:a1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c1e=GS;function u1e(t){Ms("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),{selectedIndices:d}=c1e(c,u,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const d1e={kernelName:ZC,backendName:"webgl",kernelFunc:u1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h1e=HS;function f1e(t){Ms("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s,u=n.readSync(r.dataId),d=n.readSync(i.dataId),{selectedIndices:h,validOutputs:f}=h1e(u,d,o,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const p1e={kernelName:JC,backendName:"webgl",kernelFunc:f1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m1e=qS;function g1e(t){Ms("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s,u=n.readSync(r.dataId),d=n.readSync(i.dataId),h=o,f=a,p=l,m=c,{selectedIndices:y,selectedScores:g}=m1e(u,d,h,f,p,m);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const y1e={kernelName:QC,backendName:"webgl",kernelFunc:g1e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x1e{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v1e=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s,c=Q(r.shape),u=new x1e(c,o,a,l),d=he({inputs:{x:r},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(u,[d],i);n.disposeIntermediateTensorInfo(d);const f=[...r.shape,o],p=he({inputs:{x:h},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),p},b1e={kernelName:Zx,backendName:"webgl",kernelFunc:v1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ay(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=Hp({inputs:{input:s},backend:n}),i=Ay({inputs:{x:r},backend:n}),o=G0({inputs:{input:s},backend:n}),a=Ay({inputs:{x:o},backend:n}),l=za({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return qp({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const w1e={kernelName:p0,backendName:"webgl",kernelFunc:Ay};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JB(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=Hp({inputs:{input:s},backend:n}),i=JB({inputs:{x:r},backend:n}),o=G0({inputs:{input:s},backend:n}),a=Ay({inputs:{x:o},backend:n}),l=za({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return qp({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const k1e={kernelName:Yx,backendName:"webgl",kernelFunc:JB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C1e(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return I1({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{bC(i,u.shape,"All tensors passed to stack must have matching shapes"),T(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=I1({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=MB({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const S1e={kernelName:Jx,backendName:"webgl",kernelFunc:C1e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I1e{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const r=e.length,i=mt(r),o=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T1e{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,y)=>m[0]+e[y]+m[1]);const r=e.length,i=mt(r),o=n.map(m=>m[0]).join(","),a=n.map((m,y)=>m[0]+e[y]).join(","),l=Zn("rc",r),c=Zn("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=[`${i} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${u}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${u}) {`],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,y=r===1?2:4;m<y;m++)p+=`
        ${h[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${m}] = getChannel(getX(${c.join()}), ${d});
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QB=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;if(Q(r.shape)===0){const c=i.map((u,d)=>u[0]+r.shape[d]+u[1]);return qp({backend:n,attrs:{shape:c,value:o,dtype:r.dtype}})}const a=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new T1e(r.shape,i,o):new I1e(r.shape,i,o),l=[[o]];return n.runWebGLProgram(a,[r],r.dtype,l)},N1e={kernelName:Qx,backendName:"webgl",kernelFunc:QB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E1e=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,$1e=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+hc+`
  return result;
`,_1e=An({opSnippet:E1e,packedOpSnippet:$1e}),A1e={kernelName:ap,backendName:"webgl",kernelFunc:_1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=[],c=qe(i,r.shape);let u=c;const d=Lt(u,a);let h=r;d!=null&&(h=ss({inputs:{x:r},backend:n,attrs:{perm:d}}),u=Zt(u.length,a),l.push(h)),_n("prod",u,a);let f;if(n.shouldExecuteOnCPU([h])){const p=n.texData.get(h.dataId).values,{outVals:m,outShape:y,outDtype:g}=_ge(h.shape,h.dtype,p,u);f=n.makeTensorInfo(y,g,m)}else{const[p,m]=kn(h.shape,u),y=Q(m),g=he({inputs:{x:h},backend:n,attrs:{shape:[-1,y]}}),x=hS(r.dtype),v=fc(g,x,"prod",n);f=he({inputs:{x:v},backend:n,attrs:{shape:p}}),l.push(g),l.push(v)}if(o){l.push(f);const p=on(f.shape,c);f=he({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const D1e={kernelName:t0,backendName:"webgl",kernelFunc:R1e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P1e(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=s,l=r.map(g=>n.readSync(g.dataId)),c=r.map(g=>g.shape),u=n.readSync(i.dataId),d=n.readSync(o.dataId),[h,f,p]=Age(l,c,u,i.shape,i.dtype,d,o.shape,a),m=h.map(g=>n.makeTensorInfo([g.length],"int32",g)),y=n.makeTensorInfo(p,i.dtype,f);return m.concat([y])}const O1e={kernelName:$F,backendName:"webgl",kernelFunc:P1e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1e(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:i}=e,o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=Rge(o,s.shape,s.dtype,a,r.shape,l,i.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],s.dtype,u);return[d,h]}const M1e={kernelName:_F,backendName:"webgl",kernelFunc:F1e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L1e(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),d=n.readSync(o.dataId),h=a.map(y=>n.readSync(y.dataId)),f=a.map(y=>y.shape),[p,m]=Dge(c,r.shape,u,i.shape,i.dtype,d,o.shape,h,f,l);return n.makeTensorInfo(p,i.dtype,m)}const V1e={kernelName:AF,backendName:"webgl",kernelFunc:L1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ez=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:i,dtype:o}=n,a=Pge(s,r,i,o);return e.makeTensorInfo([a.length],o,a)},B1e={kernelName:eS,backendName:"webgl",kernelFunc:ez};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z1e="return 1.0 / x;",U1e=et({opSnippet:z1e}),j1e={kernelName:lp,backendName:"webgl",kernelFunc:U1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W1e=kr+`
  return (x < 0.0) ? 0.0 : x;
`,G1e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,H1e=et({opSnippet:W1e,packedOpSnippet:G1e}),q1e={kernelName:cp,backendName:"webgl",kernelFunc:H1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K1e=kr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,X1e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Y1e=et({opSnippet:K1e,packedOpSnippet:X1e}),Z1e={kernelName:up,backendName:"webgl",kernelFunc:Y1e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class J1e{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;i?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q1e{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;i?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eke(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=Y().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Q1e(r.shape,l,c,i,o):new J1e(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],"float32")}const tke={kernelName:r0,backendName:"webgl",kernelFunc:eke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nke{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ske(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new nke(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const rke={kernelName:sS,backendName:"webgl",kernelFunc:ske};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ike{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;i?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oke{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;i?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ake(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=Y().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new oke(r.shape,l,c,i,o):new ike(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],r.dtype)}const lke={kernelName:s0,backendName:"webgl",kernelFunc:ake};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cke{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uke(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new cke(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const dke={kernelName:nS,backendName:"webgl",kernelFunc:uke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hke{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>r(l)).join(","),o=mt(s);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fke{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=Zn("rc",s),i=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,o=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=mt(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${i}){
            result.g = ${c(r.slice())};
          }
          if(${o}) {
            result.b = ${u(r.slice())};
            if(${i}) {
              result.a = ${d(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return h(p)}function c(p){return p[s-1]="("+p[s-1]+" + 1)",h(p)}function u(p){return p[s-2]="("+p[s-2]+" + 1)",h(p)}function d(p){return p[s-1]="("+p[s-1]+" + 1)",p[s-2]="("+p[s-2]+" + 1)",h(p)}function h(p){const m=e.map((x,v)=>f(v,p)),y=m.join(","),g=m.slice(-2).join(",");return`getChannel(getX(${y}), vec2(${g}))`}function f(p,m){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s,o=r.shape.length,a=qe(i,r.shape);if(o===0)return Ps({inputs:{x:r},backend:n});const l=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new fke(r.shape,a):new hke(r.shape,a);return n.runWebGLProgram(l,[r],r.dtype)}const mke={kernelName:i0,backendName:"webgl",kernelFunc:pke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gke{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yke={kernelName:uS,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=new gke(s.shape,i),[c,u]=rI(o,s.shape[1],s.shape[2]),d=[[c,u,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xke=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,vke=et({opSnippet:xke}),bke={kernelName:dp,backendName:"webgl",kernelFunc:vke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wke="return inversesqrt(x);",kke=et({opSnippet:wke,cpuKernelImpl:Oge}),Cke={kernelName:hp,backendName:"webgl",kernelFunc:kke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oT{constructor(e,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const c=mt(i.length),u=mt(o.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const y=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${y}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ske{constructor(e,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const c=mt(i.length),u=mt(o.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const y=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides",x=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${g};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${x};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${y}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ike(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=ac(i,r,o),h=[d/c,c];if(d===0)return n.makeTensorInfo(o,r.dtype);const f=he({inputs:{x:r},backend:n,attrs:{shape:[l,a]}}),p=he({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let y;Y().getBool("WEBGL_PACK")?y=new Ske(l,a,f.shape.length,p.shape.length,u,h):y=new oT(l,a,f.shape.length,p.shape.length,u,h);const g=n.runWebGLProgram(y,[p,f,m],p.dtype),x=he({inputs:{x:g},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),x}const Tke={kernelName:RF,backendName:"webgl",kernelFunc:Ike};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nke{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=Y().getNumber("WEBGL_VERSION")===2?i:o,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eke(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=new Nke(r.shape[0],r.shape[1],i.shape[1],o),l=[[r.shape[1]]];return n.runWebGLProgram(a,[r,i],"int32",l)}const $ke={kernelName:PF,backendName:"webgl",kernelFunc:Eke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ke{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,i;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)i="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<e&&l.push(`${a[u]}`);r=l.join(),i=c.join()}const o=mt(s);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ake(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e,o=new _ke(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(o,[s,r,i],Rs(r.dtype,i.dtype))}const Rke={kernelName:o0,backendName:"webgl",kernelFunc:Ake};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dke=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${T0};
  float scale = ${N0};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Pke=et({opSnippet:Dke}),Oke={kernelName:fp,backendName:"webgl",kernelFunc:Pke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fke=id+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,Mke=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Lke=et({opSnippet:Fke,packedOpSnippet:Mke,cpuKernelImpl:Mge}),Vke={kernelName:yp,backendName:"webgl",kernelFunc:Lke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bke=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,zke=et({opSnippet:Bke}),Uke={kernelName:gp,backendName:"webgl",kernelFunc:zke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jke=id+`
  return sin(x);
`,Wke=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${hc}
  return result;
`,Gke=et({opSnippet:jke,packedOpSnippet:Wke}),Hke={kernelName:pp,backendName:"webgl",kernelFunc:Gke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qke=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Kke=et({opSnippet:qke}),Xke={kernelName:mp,backendName:"webgl",kernelFunc:Kke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yke=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Zke=et({opSnippet:Yke}),Jke={kernelName:xp,backendName:"webgl",kernelFunc:Zke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qke=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;T(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((g,x)=>g*x),l=[[0,0]];l.push(...o);for(let g=1+i.length;g<r.shape.length;++g)l.push([0,0]);const c=[],u=QB({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),d=Ap(u.shape,i,a,!1),h=Rp(d.length,i.length,!1),f=Dp(u.shape,i,a,!1),p=he({inputs:{x:u},backend:n,attrs:{shape:d}}),m=ss({inputs:{x:p},backend:n,attrs:{perm:h}}),y=he({inputs:{x:m},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(m),c.forEach(g=>n.disposeIntermediateTensorInfo(g)),y},eCe={kernelName:c0,backendName:"webgl",kernelFunc:Qke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tCe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[d,h,f,p,m]=Vge(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(y=>Number(y)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const nCe={kernelName:OF,backendName:"webgl",kernelFunc:tCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sCe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(r.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(i.dataId)),[c,u,d]=Bge(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const rCe={kernelName:FF,backendName:"webgl",kernelFunc:sCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iCe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=SB(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const oCe={kernelName:MF,backendName:"webgl",kernelFunc:iCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aCe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=SB(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const lCe={kernelName:LF,backendName:"webgl",kernelFunc:aCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cCe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=ac(i,r,a),f=!1;if(i.dtype==="string"){const g=n.bufferSync(r),x=n.bufferSync(i),v=ya(n.readSync(o.dataId)[0]),b=Fge(g,x,a,h,u,c,l,d,v,f);return n.makeTensorInfo(a,b.dtype,b.values)}const p=new oT(c,l,r.shape.length,i.shape.length,d,[h,1],f),m=n.runWebGLProgram(p,[i,r,o],i.dtype),y=he({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),y}const uCe={kernelName:VF,backendName:"webgl",kernelFunc:cCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=qe(o,r.shape)[0],l=vI(r,i,a),c=r.shape.length,u=new Array(c).fill(0),d=r.shape.slice();return l.map(h=>{const f=[...d];f[a]=h;const p=od({inputs:{x:r},backend:n,attrs:{begin:u,size:f}});return u[a]+=h,p})}const hCe={kernelName:u0,backendName:"webgl",kernelFunc:dCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q$="return sqrt(x);",fCe=et({opSnippet:Q$,packedOpSnippet:Q$,cpuKernelImpl:zge}),pCe={kernelName:vp,backendName:"webgl",kernelFunc:fCe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mCe="return x * x;",gCe=et({opSnippet:mCe}),yCe={kernelName:rS,backendName:"webgl",kernelFunc:gCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e_="return (a - b) * (a - b);",xCe=An({opSnippet:e_,packedOpSnippet:e_}),vCe={kernelName:bp,backendName:"webgl",kernelFunc:xCe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(r.dataId),o=po(i),a=Uge(o,"string",s);return n.makeTensorInfo(r.shape,"string",a)}const wCe={kernelName:iS,backendName:"webgl",kernelFunc:bCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kCe({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=kr+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new di(s.shape,r);return n.runWebGLProgram(i,[s],s.dtype)}const CCe={kernelName:Ip,backendName:"webgl",kernelFunc:kCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SCe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,i=mt(s.length),o=mt(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((c,u)=>(l++,s.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ICe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s,{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:y,isSimpleSlice:g,begin:x,end:v,strides:b}=tI(r.shape,i,o,a,l,c,u,d,h);let k;if(m)k=he({inputs:{x:r},backend:n,attrs:{shape:p}});else if(y||g){T(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const S=JS(x,v,b),I=od({inputs:{x:r},backend:n,attrs:{begin:x,size:S}});k=he({inputs:{x:I},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(I)}else if(n.shouldExecuteOnCPU([r])){const I=n.readSync(r.dataId),N=He(r.shape,r.dtype,I),E=jge(f,N,b,x);k=n.makeTensorInfo(p,r.dtype,E.values)}else{const I=new SCe(x,b,f);k=n.runWebGLProgram(I,[r],r.dtype)}const C=he({inputs:{x:k},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(k),C}const TCe={kernelName:oS,backendName:"webgl",kernelFunc:ICe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NCe(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=e,h=n.readSync(u.dataId),f=n.readSync(d.dataId),[p,m]=Wge(h,f,r,i,o,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const ECe={kernelName:BF,backendName:"webgl",kernelFunc:NCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ce(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[c,u,d]=Gge(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const _Ce={kernelName:zF,backendName:"webgl",kernelFunc:$Ce};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ACe(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=Hge(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const RCe={kernelName:UF,backendName:"webgl",kernelFunc:ACe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DCe="return tan(x);",PCe=et({opSnippet:DCe}),OCe={kernelName:kp,backendName:"webgl",kernelFunc:PCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FCe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,MCe=et({opSnippet:FCe}),LCe={kernelName:Cp,backendName:"webgl",kernelFunc:MCe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VCe(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:r,indices:i,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=ac(o,i,r.shape),h=[d/c,c];if(d===0)return n.makeTensorInfo(r.shape,i.dtype);const f=he({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),p=he({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),m=he({inputs:{x:r},backend:n,attrs:{shape:h}}),y=new oT(l,a,f.shape.length,p.shape.length,u,h,!1,!0),g=n.runWebGLProgram(y,[p,f,m],m.dtype),x=he({inputs:{x:g},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),x}const BCe={kernelName:DF,backendName:"webgl",kernelFunc:VCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zCe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[o]*n[o];this.outputShape=s,this.rank=s.length;const r=mt(this.rank),i=UCe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function UCe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tz(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),c=r.dtype==="string"?l.map(h=>ya(h)):l,u=He(r.shape,r.dtype,c),d=Kge(u,i);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new zCe(r.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}const jCe={kernelName:Sp,backendName:"webgl",kernelFunc:tz};class WCe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class GCe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wa(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function t_(t){let e=1;for(;e<t;)e*=2;return e}function HCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s,a=Y().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=Y().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([r])||u<a||i>l){const E=n.readSync(r.dataId),[D,R]=Xge(E,c,r.dtype,i,o);return[n.makeTensorInfo(D.shape,D.dtype,D.values),n.makeTensorInfo(R.shape,R.dtype,R.values)]}if(i===0)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[r,qp({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(r.dataId),h=d!==null&&d.isPacked,f=h?n.unpackTensor(r):r,m=Q(c)/u,y=he({inputs:{x:f},attrs:{shape:[m,u]},backend:n});h&&Wa(n,f);const g=t_(i),x=t_(u);let v=null;const b=()=>v===null?[y,y]:[y,v],k=(E,D,R)=>{const L=b(),B=new WCe(R),G=[[u],[v===null?1:0],[Number.NEGATIVE_INFINITY],[E],[D]],q=v;v=n.runWebGLProgram(B,L,"int32",G),Wa(n,q)};for(let E=1;E<g;E*=2){const D=E*2;for(let R=E;R>=1;R/=2)k(D,R,[m,x])}for(let E=x;E>g;E/=2){const D=b(),R=new GCe([m,E/2]),B=[[u],[v===null?1:0],[g]],W=v;v=n.runWebGLProgram(R,D,"int32",B),Wa(n,W);const G=g/2,q=G*2;for(let A=G;A>=1;A/=2)k(q,A,v.shape)}let C=v;v=od({inputs:{x:v},backend:n,attrs:{begin:0,size:[m,i]}}),Wa(n,C);let S=qB({inputs:{x:y,indices:v},backend:n,attrs:{axis:1,batchDims:1}});Wa(n,y);const I=c.slice(0,-1);I.push(i),C=v,v=he({inputs:{x:v},attrs:{shape:I},backend:n}),Wa(n,C);const N=S;return S=he({inputs:{x:S},attrs:{shape:I},backend:n}),Wa(n,N),[S,v]}const qCe={kernelName:aS,backendName:"webgl",kernelFunc:HCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KCe{constructor(e,n,s,r,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XCe(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=s,[u,d,h,f]=r.shape,[p,m]=c??[d,h],y=[u,p,m,f],g=new KCe(d,h,o,a,l,y);return n.runWebGLProgram(g,[r,i],"float32")}const YCe={kernelName:lS,backendName:"webgl",kernelFunc:XCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZCe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;Wp(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=s.readSync(i.dataId),{outputValues:a,outputShape:l,indices:c}=Yge(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const JCe={kernelName:cS,backendName:"webgl",kernelFunc:ZCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QCe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r,a=o.shape.length,l=r.shape[i],c=new Array(a-1);let u=0;for(let m=0;m<a;m++)m!==i&&(c[u++]=o.shape[m]);const d=[],h=new Array(a).fill(0),f=o.shape.slice();f[i]=1;const p=new Array(l);for(let m=0;m<p.length;m++){h[i]=m;const y=od({inputs:{x:o},backend:n,attrs:{begin:h,size:f}}),g=he({inputs:{x:y},backend:n,attrs:{shape:c}});p[m]=g,d.push(y)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const eSe={kernelName:h0,backendName:"webgl",kernelFunc:QCe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tSe{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/s);this.outputShape=[r,a];const l="0.0",c="sumValue",u=Math.floor(s/4)*4,d=s%4,h=`
        sumValue += dot(values, segFilter);
    `;let f="";i%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s,a=r.shape.length,l=[];let c=0;const u=Lt([c],a);let d=r;u!=null&&(d=ss({inputs:{x:r},backend:n,attrs:{perm:u}}),l.push(d),c=Zt(1,a)[0]);const h=ML(d.shape,c,o),f=Q([d.shape[c]]),p=he({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(p);const m=hS(r.dtype),y=(b,k,C,S,I)=>{const N=b.shape[0],E=b.shape[1],D=FL(E,I),R={windowSize:D,inSize:E,batchSize:N,numSegments:I},L=new tSe(R,k),B=n.compileAndRun(L,[b,C],S);if(l.push(B),B.shape[1]===I)return B;const W=ez({backend:n,attrs:{start:0,stop:I,step:1,dtype:"float32"}}),G=tz({inputs:{x:W},backend:n,attrs:{reps:[E/D]}});return l.push(W),l.push(G),y(B,k,G,S,I)},g=y(p,"unsortedSegmentSum",i,m,o),x=he({inputs:{x:g},backend:n,attrs:{shape:h}});let v=x;if(u!=null){l.push(x);const b=Oa(u);v=ss({inputs:{x:v},backend:n,attrs:{perm:b}})}return l.forEach(b=>n.disposeIntermediateTensorInfo(b)),v}const sSe={kernelName:f0,backendName:"webgl",kernelFunc:nSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rSe=[zye,jye,Hye,Xye,Zye,exe,nxe,rxe,lxe,uxe,fxe,gxe,vxe,Cxe,Txe,Exe,_xe,Pxe,Fxe,Lxe,Uxe,Xxe,Zxe,t0e,s0e,c0e,d0e,m0e,Sye,x0e,C0e,N0e,D0e,F0e,L0e,B0e,U0e,H0e,X0e,J0e,eve,nve,rve,ave,cve,fve,mve,xve,wve,Cve,Nve,Ave,Ove,Lve,zve,Uve,Wve,Hve,Kve,Yve,Jve,nbe,ibe,lbe,ube,fbe,gbe,bbe,Sbe,Cye,Tbe,w0e,$be,Rbe,Obe,Tye,Vbe,jbe,Gbe,Xbe,Jbe,nwe,iwe,cwe,fwe,gwe,xwe,kwe,Swe,Twe,_we,Rwe,Pwe,Fwe,Lwe,Uwe,Hwe,Ywe,r1e,$ye,l1e,d1e,p1e,y1e,i0e,b1e,k1e,S1e,N1e,A1e,Eye,D1e,O1e,M1e,V1e,B1e,o0e,e1e,j1e,q1e,Z1e,Aye,tke,rke,lke,dke,mke,yke,bke,Cke,Tke,$ke,Rke,Oke,Vke,Uke,Hke,Xke,qxe,n1e,Jke,eCe,nCe,rCe,oCe,lCe,uCe,hCe,pCe,yCe,vCe,wCe,CCe,TCe,ECe,_Ce,RCe,t1e,Lye,OCe,LCe,BCe,jCe,qCe,YCe,Vye,JCe,eSe,sSe,w1e];for(const t of rSe)WF(t);const H0=["fever","cough","fatigue","difficulty_breathing","body_aches","headache","sore_throat","loss_of_taste","nausea","diarrhea","chills","rash","congestion","vomiting","chest_pain","dizziness","sweating","muscle_weakness","joint_pain","runny_nose","loss_of_smell","eye_pain","abdominal_pain","heart_palpitations","swollen_lymph_nodes","weight_loss","appetite_loss","bleeding","shortness_of_breath","confusion","insomnia","anxiety","depression","tremors","seizures","blurred_vision","tinnitus","hearing_loss","numbness","tingling","memory_loss","balance_problems","speech_difficulties","swelling","jaundice","excessive_thirst","frequent_urination","night_sweats","hair_loss","brittle_nails","mood_swings","hallucinations","paranoia","skin_discoloration","muscle_cramps","back_pain","neck_pain","shoulder_pain","knee_pain","ankle_pain","dry_mouth","irritability","low_energy","blisters","sun_sensitivity","weak_pulse","fainting","cold_sensitivity","hot_flashes","pelvic_pain","itching","burning_sensation","weight_gain","bruising","blood_in_stool","blood_in_urine","yellow_eyes","difficulty_swallowing","red_eyes","persistent_cough","delirium","loss_of_consciousness","hot_skin","cold_skin","shivering","dark_urine","fatty_stools","bluish_skin","pale_skin","increased_hunger","delayed_wound_healing","slow_growth","bone_pain","unsteady_gait","vision_loss","sleep_apnea","urinary_incontinence","bloating","hives","increased_heart_rate","low_blood_pressure","high_blood_pressure","sunken_eyes","enlarged_spleen","enlarged_liver","cold_hands","cold_feet","difficulty_concentrating","dry_eyes","pink_eyes","ringing_ears","irregular_heartbeat","unusual_cravings","frequent_infections","mouth_sores","drooping_face","slurred_speech","clumsiness","nail_clubbing","painful_urination","frequent_hiccups","loss_of_control","heat_intolerance","frequent_burping","spasms"],nz=["Common Cold","COVID-19","Flu","Bronchitis","Pneumonia","Allergies","Asthma","Migraine","Sinus Infection","Tuberculosis","Malaria","Dengue","Gastroenteritis","Chronic Fatigue Syndrome","Meningitis","Hypertension","Type 2 Diabetes","Anxiety Disorder","Depression","Rheumatoid Arthritis","Osteoarthritis","Multiple Sclerosis","Parkinsons Disease","Alzheimers Disease","Epilepsy","Lupus","Fibromyalgia","Celiac Disease","Crohns Disease","Ulcerative Colitis","Hypothyroidism","Hyperthyroidism","Anemia","Psoriasis","Eczema","Skin Cancer","Lung Cancer","Breast Cancer","Prostate Cancer","Leukemia","Lymphoma","Hepatitis A","Hepatitis B","Hepatitis C","Chronic Kidney Disease","Irritable Bowel Syndrome","Gout","Acid Reflux","Peptic Ulcer","Endometriosis","Polycystic Ovary Syndrome (PCOS)","Ovarian Cyst","Heart Disease","Stroke","Peripheral Artery Disease","Deep Vein Thrombosis","Obesity","Insomnia","Sleep Apnea","Vertigo","HIV/AIDS","Chikungunya","Zika Virus","Typhoid","Measles","Mumps","Rubella","Chickenpox","Shingles","Scarlet Fever","Whooping Cough","Huntingtons Disease","Amyotrophic Lateral Sclerosis (ALS)","Marfan Syndrome","Hemophilia","Thalassemia","Sickle Cell Anemia","Vitamin D Deficiency","Osteoporosis","Lymphedema","Raynaud’s Disease","Addison’s Disease","Cystic Fibrosis","Panic Disorder","Obsessive-Compulsive Disorder (OCD)","Bipolar Disorder","Schizophrenia","Panic Attacks","Autism Spectrum Disorder (ASD)"],sz={"Common Cold":{initial:300,followUp:200,emergency:800},"COVID-19":{initial:2e3,followUp:1e3,emergency:5e3,specialist:3500},Flu:{initial:400,followUp:250,emergency:1e3},Bronchitis:{initial:450,followUp:300,emergency:1200,specialist:2e3},Pneumonia:{initial:600,followUp:400,emergency:2500,specialist:3e3},Allergies:{initial:350,followUp:250,specialist:1800},Asthma:{initial:500,followUp:350,emergency:1500,specialist:2500},Migraine:{initial:400,followUp:300,emergency:1200,specialist:2e3},"Sinus Infection":{initial:350,followUp:250,specialist:1800},Tuberculosis:{initial:5e3,followUp:2500,specialist:6e3},Malaria:{initial:550,followUp:400,emergency:2e3},Dengue:{initial:6e3,followUp:4500,emergency:8e3,specialist:7e3},Gastroenteritis:{initial:4500,followUp:3e3,emergency:6e3},"Chronic Fatigue Syndrome":{initial:6500,followUp:4e3,specialist:7500},Meningitis:{initial:8e3,followUp:6e3,emergency:12e3,specialist:1e4},Hypertension:{initial:3e3,followUp:1500,emergency:5e3,specialist:4e3},"Type 2 Diabetes":{initial:3500,followUp:2e3,specialist:4500},"Anxiety Disorder":{initial:4e3,followUp:2500,specialist:5e3},Depression:{initial:4e3,followUp:2500,specialist:5e3},"Rheumatoid Arthritis":{initial:5e3,followUp:3e3,specialist:6e3},Osteoarthritis:{initial:4500,followUp:3e3,specialist:5500},"Multiple Sclerosis":{initial:6e3,followUp:4e3,specialist:7500},"Parkinsons Disease":{initial:7e3,followUp:5e3,specialist:8500},"Alzheimers Disease":{initial:8e3,followUp:6e3,specialist:1e4},Epilepsy:{initial:6e3,followUp:4e3,emergency:1e4},Lupus:{initial:5500,followUp:3500,specialist:6500},Fibromyalgia:{initial:5e3,followUp:3e3,specialist:6e3},"Celiac Disease":{initial:4e3,followUp:2500,specialist:5e3},"Crohns Disease":{initial:5500,followUp:3500,specialist:6500},"Ulcerative Colitis":{initial:5500,followUp:3500,specialist:6500},Hypothyroidism:{initial:3e3,followUp:2e3,specialist:4500},Hyperthyroidism:{initial:3e3,followUp:2e3,specialist:4500},Anemia:{initial:2500,followUp:1500,specialist:3500},Psoriasis:{initial:4e3,followUp:2500,specialist:5e3},Eczema:{initial:3500,followUp:2e3,specialist:4500},"Skin Cancer":{initial:1e4,followUp:7e3,specialist:15e3},"Lung Cancer":{initial:15e3,followUp:1e4,emergency:2e4,specialist:18e3},"Breast Cancer":{initial:12e3,followUp:8e3,specialist:16e3},"Prostate Cancer":{initial:12e3,followUp:8e3,specialist:16e3},Leukemia:{initial:15e3,followUp:1e4,specialist:18e3},Lymphoma:{initial:14e3,followUp:9e3,specialist:17e3},"Hepatitis A":{initial:5e3,followUp:3e3,specialist:7e3},"Hepatitis B":{initial:6e3,followUp:4e3,specialist:8e3},"Hepatitis C":{initial:7e3,followUp:5e3,specialist:9e3},"Chronic Kidney Disease":{initial:9e3,followUp:6e3,specialist:12e3},"Irritable Bowel Syndrome":{initial:4e3,followUp:2500,specialist:5e3},Gout:{initial:4500,followUp:3e3,specialist:5500},"Acid Reflux":{initial:3e3,followUp:2e3,specialist:4e3},"Peptic Ulcer":{initial:4e3,followUp:2500,specialist:5e3},Endometriosis:{initial:7e3,followUp:5e3,specialist:9e3},"Polycystic Ovary Syndrome (PCOS)":{initial:6e3,followUp:4e3,specialist:8e3},"Ovarian Cyst":{initial:5e3,followUp:3500,specialist:7500},"Heart Disease":{initial:8e3,followUp:6e3,emergency:12e3,specialist:1e4},Stroke:{initial:1e4,followUp:7e3,emergency:15e3},"Peripheral Artery Disease":{initial:7e3,followUp:5e3,specialist:9e3},"Deep Vein Thrombosis":{initial:6e3,followUp:4e3,specialist:8e3},Obesity:{initial:3e3,followUp:2e3,specialist:4500},Insomnia:{initial:4e3,followUp:2500,specialist:5e3},"Sleep Apnea":{initial:5e3,followUp:3500,specialist:7500},Vertigo:{initial:4e3,followUp:2500,specialist:5e3},"HIV/AIDS":{initial:1e4,followUp:7e3,specialist:15e3},Chikungunya:{initial:5e3,followUp:3500,emergency:7e3},"Zika Virus":{initial:5e3,followUp:3500,specialist:7e3},Typhoid:{initial:6e3,followUp:4e3,emergency:8e3},Measles:{initial:4e3,followUp:2500,specialist:5e3},Mumps:{initial:3500,followUp:2e3,specialist:4500},Rubella:{initial:3500,followUp:2e3,specialist:4500},Chickenpox:{initial:3e3,followUp:2e3,specialist:4e3},Shingles:{initial:4500,followUp:3e3,specialist:5500}},rz={"Common Cold":["Paracetamol for fever and pain relief","Decongestants like pseudoephedrine","Cough suppressants containing dextromethorphan","Antihistamines for runny nose","Zinc supplements to boost immune system","Vitamin C supplements"],"COVID-19":["Paracetamol for fever","Stay hydrated and rest","Follow current medical guidelines","Consult doctor for specific treatments","Pulse oximeter monitoring","Isolation protocols"],Hypertension:["ACE inhibitors as prescribed","Beta blockers if recommended","Calcium channel blockers","Regular blood pressure monitoring","Low-sodium diet essential","Lifestyle modifications"],"Type 2 Diabetes":["Metformin as prescribed","Blood glucose monitoring","Insulin if prescribed","Strict dietary control","Regular exercise routine","Foot care essentials"],"Anxiety Disorder":["SSRIs if prescribed","Anti-anxiety medications","Therapy sessions","Stress management techniques","Lifestyle modifications","Sleep hygiene practices"],Flu:["Oseltamivir (Tamiflu) if prescribed","Paracetamol or ibuprofen for fever","Decongestants for nasal congestion","Plenty of fluids and rest"],Bronchitis:["Expectorants to help clear mucus","Cough suppressants for sleep","Bronchodilators if prescribed","Steam inhalation"],Pneumonia:["Prescribed antibiotics if bacterial","Pain relievers for chest pain","Cough medicine","Immediate medical attention required"],Allergies:["Antihistamines (e.g., cetirizine, loratadine)","Nasal corticosteroids if prescribed","Decongestants for blocked nose","Avoid known allergens"],Asthma:["Inhaled bronchodilators","Prescribed corticosteroids","Peak flow monitoring","Follow asthma action plan"],Migraine:["Pain relievers (ibuprofen, aspirin)","Anti-migraine medications if prescribed","Rest in a quiet, dark room","Stay hydrated"],"Sinus Infection":["Saline nasal spray","Decongestants","Pain relievers","Antibiotics if prescribed"],Tuberculosis:["Prescribed TB medications only","Complete full course of treatment","Regular medical monitoring","Immediate medical attention required"],Malaria:["Prescribed antimalarial medications","Fever reducers","Immediate medical attention required","Complete prescribed course"],Dengue:["Paracetamol for fever (avoid aspirin)","Plenty of fluids","Rest and monitoring","Immediate medical attention required"],Gastroenteritis:["Oral rehydration solutions","Anti-diarrheal medication if needed","Bland diet (BRAT)","Probiotics may help"],"Chronic Fatigue Syndrome":["Pain relievers as needed","Sleep medications if prescribed","Antidepressants if prescribed","Professional medical supervision required"],"Rheumatoid Arthritis":["Nonsteroidal anti-inflammatory drugs (NSAIDs)","Disease-modifying antirheumatic drugs (DMARDs)","Biologic agents if prescribed","Corticosteroids for flare-ups","Physical therapy for joint mobility"],Osteoarthritis:["Acetaminophen for pain relief","NSAIDs for inflammation","Topical analgesics","Glucosamine supplements","Physical therapy and exercise"],"Multiple Sclerosis":["Disease-modifying therapies (DMTs)","Corticosteroids for relapses","Muscle relaxants for spasms","Pain relievers for neuropathic pain","Lifestyle changes and physical therapy"],"Parkinsons Disease":["Levodopa/carbidopa","Dopamine agonists","MAO-B inhibitors","Anticholinergics for tremors","Physiotherapy for movement issues"],"Alzheimers Disease":["Cholinesterase inhibitors (e.g., donepezil)","Memantine for moderate-to-severe stages","Antidepressants or antipsychotics if prescribed","Cognitive and behavioral therapies"],Epilepsy:["Antiepileptic drugs (AEDs)","Emergency treatment for seizures","Lifestyle changes to avoid triggers","Regular medical supervision"],Lupus:["NSAIDs for joint pain","Antimalarial drugs (e.g., hydroxychloroquine)","Corticosteroids for inflammation","Immunosuppressants if prescribed","Regular medical monitoring"],Fibromyalgia:["Pain relievers (e.g., acetaminophen)","Antidepressants for symptom management","Anti-seizure medications","Physical therapy and stress management"],"Celiac Disease":["Strict gluten-free diet","Nutritional supplements if needed","Consultation with a dietitian","Medical supervision for complications"],"Crohns Disease":["Anti-inflammatory medications (e.g., corticosteroids)","Immunosuppressants","Antibiotics for infections","Dietary adjustments and nutritional supplements"],"Ulcerative Colitis":["5-aminosalicylic acid (5-ASA) medications","Corticosteroids for flares","Immunomodulators if prescribed","Dietary changes and stress management"],Hypothyroidism:["Levothyroxine (thyroid hormone replacement)","Regular thyroid function tests","Lifestyle adjustments as needed"],Hyperthyroidism:["Antithyroid medications (e.g., methimazole)","Beta-blockers for symptoms","Radioactive iodine therapy","Regular monitoring of thyroid levels"],Anemia:["Iron supplements for iron-deficiency anemia","Vitamin B12 supplements for pernicious anemia","Folate supplements if needed","Dietary changes to include iron-rich foods"],Psoriasis:["Topical corticosteroids","Vitamin D analogues (e.g., calcipotriol)","Phototherapy (light therapy)","Systemic medications for severe cases"],Eczema:["Moisturizers for dry skin","Topical corticosteroids for inflammation","Antihistamines for itch relief","Avoiding known irritants or allergens"],Glaucoma:["Prescription eye drops (e.g., prostaglandin analogues)","Beta-blockers for intraocular pressure","Surgical options if necessary","Regular eye check-ups"],"Lung Cancer":["Chemotherapy or targeted therapy","Radiation therapy","Immunotherapy if prescribed","Palliative care for symptom management"],"Breast Cancer":["Hormonal therapy (e.g., tamoxifen)","Chemotherapy as recommended","Targeted therapy (e.g., HER2 inhibitors)","Surgery or radiation therapy"],"Prostate Cancer":["Androgen deprivation therapy","Radiation therapy","Chemotherapy for advanced stages","Active surveillance for early cases"],Hepatitis:["Antiviral medications for hepatitis B or C","Vaccination for hepatitis prevention","Liver function monitoring","Lifestyle changes to reduce liver strain"],"Kidney Stones":["Pain relievers for acute pain","Alpha blockers to relax ureter muscles","Increased fluid intake","Lithotripsy or surgery if necessary"],"Ovarian Cysts":["Pain relievers for discomfort","Hormonal birth control for prevention","Surgical removal if cysts are large","Regular monitoring via ultrasound"],UTI:["Antibiotics as prescribed","Increased water intake","Urinary analgesics for pain relief","Good personal hygiene practices"],Pancreatitis:["Pain management in acute cases","IV fluids and fasting for severe cases","Enzyme supplements for chronic cases","Lifestyle changes (e.g., alcohol cessation)"],Meningitis:["Emergency medical attention required","Prescribed antibiotics if bacterial","Pain relief medication","Hospital treatment necessary"]},iSe={fever:.6,cough:.4,fatigue:.3,difficulty_breathing:.8,body_aches:.3,headache:.3,sore_throat:.2,loss_of_taste:.4,nausea:.3,diarrhea:.4,chills:.4,rash:.3,congestion:.2,vomiting:.5,chest_pain:.7,dizziness:.4,sweating:.3,muscle_weakness:.4,joint_pain:.3,runny_nose:.2,loss_of_smell:.4,eye_pain:.3,abdominal_pain:.6,heart_palpitations:.7,swollen_lymph_nodes:.3,weight_loss:.6,appetite_loss:.5,bleeding:.8,shortness_of_breath:.8,confusion:.7,insomnia:.4,anxiety:.5,depression:.6,tremors:.7,seizures:.9,blurred_vision:.6,tinnitus:.4,hearing_loss:.5,numbness:.5,tingling:.4,memory_loss:.7,balance_problems:.7,speech_difficulties:.8,swelling:.4,jaundice:.8,excessive_thirst:.5,frequent_urination:.4,night_sweats:.5,hair_loss:.2,brittle_nails:.1,mood_swings:.5,hallucinations:.8,paranoia:.7,skin_discoloration:.3,muscle_cramps:.4,back_pain:.3,neck_pain:.3,shoulder_pain:.3,knee_pain:.3,ankle_pain:.3,dry_mouth:.2,irritability:.4,low_energy:.4,blisters:.3,sun_sensitivity:.3,weak_pulse:.6,fainting:.7,cold_sensitivity:.3,hot_flashes:.3,pelvic_pain:.5,itching:.3,burning_sensation:.4,weight_gain:.3,bruising:.4,blood_in_stool:.8,blood_in_urine:.8,yellow_eyes:.7,difficulty_swallowing:.7,red_eyes:.2,persistent_cough:.5,delirium:.8,loss_of_consciousness:.9,hot_skin:.4,cold_skin:.4,shivering:.4,dark_urine:.6,fatty_stools:.6,bluish_skin:.8,pale_skin:.6,increased_hunger:.3,delayed_wound_healing:.6,slow_growth:.5,bone_pain:.7,unsteady_gait:.7,vision_loss:.9,sleep_apnea:.7,urinary_incontinence:.6,bloating:.3,hives:.3,increased_heart_rate:.7,low_blood_pressure:.7,high_blood_pressure:.7,sunken_eyes:.6,enlarged_spleen:.6,enlarged_liver:.6,cold_hands:.3,cold_feet:.3,difficulty_concentrating:.4,dry_eyes:.2,pink_eyes:.2,ringing_ears:.4,irregular_heartbeat:.8,unusual_cravings:.4,frequent_infections:.6,mouth_sores:.4,drooping_face:.8,slurred_speech:.8,clumsiness:.5,nail_clubbing:.5,painful_urination:.6,frequent_hiccups:.3,loss_of_control:.8,heat_intolerance:.5,frequent_burping:.3,spasms:.6};let vc=null;const oSe=()=>{const t=kae();return t.add(ab({inputShape:[H0.length],units:256,activation:"relu"})),t.add(v$({rate:.3})),t.add(ab({units:128,activation:"relu"})),t.add(v$({rate:.2})),t.add(ab({units:nz.length,activation:"softmax"})),t};async function aSe(){if(!vc)try{vc=oSe(),vc.compile({optimizer:Ya.adam(.001),loss:"categoricalCrossentropy",metrics:["accuracy"]});const e=vc.getWeights().map(n=>LM(n.shape,0,.1));vc.setWeights(e)}catch(t){throw console.error("Error initializing model:",t),new Error("Failed to initialize symptom analysis model")}return vc}function lSe(t){const e=t.toLowerCase();return H0.map(n=>e.includes(n.toLowerCase().replace("_"," "))?1:0)}function cSe(t){return H0.reduce((e,n,s)=>e+t[s]*(iSe[n]||0),0)}function uSe(t,e){const n=rz[t]||[],s=sz[t],r=["Rest and stay hydrated","Monitor your symptoms",...n],i={high:["Seek immediate medical attention","Schedule an urgent consultation",`Initial consultation fee: KSH${s.initial}`,`Emergency consultation fee: KSH${s.emergency||s.initial*2}`,"Consider emergency care if symptoms worsen",s.specialist?`Specialist consultation available: KSH${s.specialist}`:""],medium:["Schedule a follow-up appointment","Begin prescribed treatment plan",`Initial consultation fee: KSH${s.initial}`,`Follow-up consultation fee: KSH${s.followUp}`,s.specialist?`Specialist consultation available: KSH${s.specialist}`:"","Contact your doctor if symptoms persist"],low:["Continue normal activities with caution","Use over-the-counter medications as listed above","If symptoms persist beyond 5-7 days:",`  - Schedule a consultation (Fee: KSH${s.initial})`,"Practice preventive measures"]};return[...r,...i[e]||[]]}function dSe(t,e){var s;return((s={"Common Cold":{low:"3-7 days",medium:"7-10 days",high:"10-14 days"},"COVID-19":{low:"7-14 days",medium:"14-21 days",high:"21-30 days"}}[t])==null?void 0:s[e])||"Varies based on treatment adherence and response"}function hSe(t){return{"Common Cold":["Frequent hand washing","Avoid close contact with infected individuals","Maintain good sleep hygiene","Stay warm and dry"],"COVID-19":["Wear masks in public spaces","Maintain social distancing","Regular hand sanitization","Avoid crowded places","Keep spaces well-ventilated"],Flu:["Get vaccinated annually","Wash hands regularly","Avoid touching face","Cover mouth and nose when sneezing","Stay hydrated"],Bronchitis:["Avoid smoking","Stay away from air pollution","Wash hands frequently","Get vaccinated for flu and pneumonia","Use a humidifier"],Pneumonia:["Get vaccinated","Avoid smoking","Wash hands frequently","Maintain good oral hygiene","Eat a healthy diet"],Allergies:["Avoid known allergens","Keep indoor spaces clean","Use air purifiers","Wear masks during allergy season","Take antihistamines as prescribed"],Asthma:["Avoid exposure to allergens","Use prescribed inhalers regularly","Stay away from air pollution and smoke","Keep up with vaccinations","Monitor symptoms closely"],Migraine:["Manage stress effectively","Maintain a consistent sleep schedule","Avoid known triggers (e.g., certain foods, bright lights)","Stay hydrated","Exercise regularly"],"Sinus Infection":["Avoid allergens and irritants","Stay hydrated","Use nasal sprays as recommended","Avoid smoking","Practice good hand hygiene"],Tuberculosis:["Ensure proper ventilation in living spaces","Avoid close contact with infected individuals","Get vaccinated with BCG vaccine","Adhere to prescribed treatments","Maintain a healthy immune system"],Malaria:["Use mosquito nets while sleeping","Apply mosquito repellents","Wear protective clothing","Avoid stagnant water near living areas","Take antimalarial medication as needed"],Dengue:["Eliminate mosquito breeding grounds","Use insect repellents","Wear long-sleeved clothing","Use mosquito nets","Stay indoors during peak mosquito activity hours"],Gastroenteritis:["Wash hands thoroughly before eating","Avoid consuming contaminated food and water","Practice good kitchen hygiene","Stay hydrated","Ensure proper food storage"],"Chronic Fatigue Syndrome":["Prioritize rest and relaxation","Engage in light, consistent physical activity","Manage stress effectively","Eat a balanced diet","Avoid overexertion"],Meningitis:["Get vaccinated","Avoid sharing personal items","Practice good hygiene","Stay away from infected individuals","Seek immediate medical attention for symptoms"],Hypertension:["Maintain a healthy weight","Follow a low-sodium diet","Engage in regular physical activity","Manage stress effectively","Avoid smoking and excessive alcohol consumption"],"Type 2 Diabetes":["Maintain a healthy weight","Follow a balanced, low-sugar diet","Exercise regularly","Monitor blood glucose levels","Avoid tobacco products"],"Anxiety Disorder":["Practice mindfulness and relaxation techniques","Engage in regular physical activity","Maintain a consistent sleep schedule","Avoid excessive caffeine and alcohol","Seek professional counseling if needed"],Depression:["Engage in regular physical activity","Stay connected with supportive individuals","Maintain a consistent sleep schedule","Eat a balanced diet","Seek professional therapy or counseling"],"Rheumatoid Arthritis":["Engage in regular low-impact exercises","Avoid smoking","Maintain a healthy weight","Follow prescribed treatment plans","Eat an anti-inflammatory diet"],Osteoarthritis:["Maintain a healthy weight","Engage in low-impact exercises","Avoid high-impact activities","Manage joint stress","Use proper posture and ergonomic supports"],"Multiple Sclerosis":["Maintain regular exercise","Manage stress effectively","Stay hydrated","Avoid extreme heat","Get adequate sleep"],"Parkinsons Disease":["Exercise regularly","Eat a balanced diet","Avoid smoking and excessive alcohol consumption","Engage in mental exercises","Seek support for mobility aids"],"Alzheimers Disease":["Engage in regular cognitive exercises","Maintain physical activity","Eat a brain-healthy diet","Stay socially active","Control cardiovascular risk factors"],Epilepsy:["Take prescribed medications regularly","Avoid known seizure triggers","Get enough sleep","Manage stress","Stay hydrated"],Lupus:["Avoid sun exposure","Take prescribed medications","Exercise regularly","Follow a balanced diet","Get regular health check-ups"],Fibromyalgia:["Manage stress","Exercise regularly","Get adequate rest","Avoid overexertion","Eat a balanced, anti-inflammatory diet"],"Celiac Disease":["Avoid gluten-containing foods","Follow a gluten-free diet strictly","Read food labels carefully","Seek regular medical check-ups","Be cautious of cross-contamination"],"Crohns Disease":["Eat a balanced diet","Avoid smoking","Manage stress","Take medications as prescribed","Stay hydrated"],"Ulcerative Colitis":["Eat a healthy, balanced diet","Avoid triggers (e.g., high-fat, spicy foods)","Take medications as prescribed","Manage stress","Stay hydrated"],Hypothyroidism:["Take thyroid medication as prescribed","Monitor thyroid function regularly","Maintain a healthy diet","Exercise regularly","Manage stress"],Hyperthyroidism:["Take prescribed medications","Avoid excessive iodine intake","Monitor thyroid function regularly","Engage in regular physical activity","Manage stress"],Anemia:["Eat iron-rich foods","Take iron supplements if prescribed","Avoid excessive tea or coffee with meals","Maintain a healthy diet","Stay hydrated"],Psoriasis:["Avoid skin irritants","Maintain a healthy skin care routine","Use prescribed topical treatments","Stay hydrated","Manage stress"],Eczema:["Avoid skin irritants and allergens","Use moisturizing lotions regularly","Avoid scratching","Use prescribed treatments","Keep the skin clean and hydrated"],"Skin Cancer":["Avoid excessive sun exposure","Wear sunscreen regularly","Check skin regularly for abnormalities","Seek regular skin check-ups","Wear protective clothing"],"Lung Cancer":["Avoid smoking and secondhand smoke","Follow a healthy diet","Engage in regular physical activity","Avoid exposure to harmful chemicals","Get regular health check-ups"],"Breast Cancer":["Get regular mammograms","Maintain a healthy weight","Exercise regularly","Limit alcohol intake","Avoid smoking"],"Prostate Cancer":["Get regular prostate exams","Maintain a healthy diet","Exercise regularly","Limit alcohol intake","Avoid smoking"],Leukemia:["Avoid known carcinogens","Maintain a healthy lifestyle","Stay up to date on vaccinations","Avoid exposure to harmful chemicals","Seek medical advice if symptoms occur"],Lymphoma:["Avoid known carcinogens","Maintain a healthy lifestyle","Get regular check-ups","Stay up to date on vaccinations","Avoid exposure to harmful chemicals"],"Hepatitis A":["Get vaccinated for Hepatitis A","Practice good hand hygiene","Avoid drinking contaminated water","Avoid consuming unclean food","Get regular health check-ups"],"Hepatitis B":["Get vaccinated for Hepatitis B","Avoid sharing needles or personal items","Practice safe sex","Get regular liver function tests","Avoid alcohol and excessive medications"],"Hepatitis C":["Avoid sharing needles","Get tested for Hepatitis C","Avoid alcohol and excessive medications","Practice safe sex","Get regular liver function tests"],"Chronic Kidney Disease":["Manage blood pressure","Monitor blood sugar levels","Avoid smoking and excessive alcohol consumption","Eat a kidney-friendly diet","Stay hydrated"],"Irritable Bowel Syndrome":["Eat a balanced diet","Avoid triggers (e.g., high-fat foods)","Exercise regularly","Manage stress","Stay hydrated"],Gout:["Limit alcohol intake","Avoid foods high in purines","Maintain a healthy weight","Drink plenty of water","Take medications as prescribed"],"Acid Reflux":["Avoid large meals and lying down after eating","Eat smaller, more frequent meals","Avoid trigger foods","Maintain a healthy weight","Elevate the head of the bed"],"Peptic Ulcer":["Avoid spicy foods","Limit alcohol intake","Quit smoking","Take medications as prescribed","Eat smaller, more frequent meals"],Endometriosis:["Manage stress","Exercise regularly","Eat a balanced diet","Take medications as prescribed","Consider fertility treatment if needed"],"Polycystic Ovary Syndrome (PCOS)":["Maintain a healthy weight","Exercise regularly","Eat a balanced diet","Take medications as prescribed","Manage stress"],"Ovarian Cyst":["Monitor symptoms","Follow up with healthcare provider regularly","Exercise regularly","Eat a balanced diet","Take prescribed medications"],"Heart Disease":["Maintain a healthy weight","Exercise regularly","Follow a heart-healthy diet","Avoid smoking","Manage stress"],Stroke:["Control blood pressure","Maintain a healthy weight","Exercise regularly","Avoid smoking and excessive alcohol","Eat a healthy diet"],"Peripheral Artery Disease":["Exercise regularly","Maintain a healthy weight","Control blood pressure and cholesterol levels","Quit smoking","Eat a healthy diet"],"Deep Vein Thrombosis":["Stay active and exercise regularly","Avoid prolonged sitting or standing","Wear compression stockings","Take blood-thinning medications if prescribed","Drink plenty of water"],Obesity:["Maintain a healthy weight","Exercise regularly","Eat a balanced diet","Get enough sleep","Manage stress"],Insomnia:["Maintain a consistent sleep schedule","Create a calming bedtime routine","Avoid caffeine and heavy meals before bed","Create a comfortable sleep environment","Exercise regularly"],"Sleep Apnea":["Maintain a healthy weight","Sleep on your side","Avoid alcohol and sedatives before sleep","Use CPAP machine as prescribed","Avoid smoking"],Vertigo:["Practice balance exercises","Avoid sudden head movements","Stay hydrated","Avoid alcohol","Seek medical attention if symptoms persist"],"HIV/AIDS":["Practice safe sex","Get tested regularly","Take antiretroviral medications as prescribed","Avoid sharing needles","Maintain a healthy lifestyle"],Chikungunya:["Use mosquito repellents","Wear protective clothing","Eliminate mosquito breeding sites","Stay indoors during peak mosquito activity hours","Use mosquito nets"],"Zika Virus":["Use mosquito repellents","Wear protective clothing","Eliminate mosquito breeding grounds","Avoid travel to areas with outbreaks","Use mosquito nets"],Typhoid:["Drink safe water","Eat food from hygienic sources","Practice good hand hygiene","Get vaccinated for Typhoid","Avoid unclean water"],Measles:["Get vaccinated for measles","Avoid close contact with infected individuals","Practice good hand hygiene","Stay up-to-date on vaccinations","Seek medical attention if symptoms develop"],Mumps:["Get vaccinated for mumps","Avoid sharing personal items","Practice good hand hygiene","Isolate infected individuals","Seek medical attention if symptoms develop"],Rubella:["Get vaccinated for rubella","Avoid exposure to infected individuals","Practice good hand hygiene","Stay up to date on vaccinations","Seek medical attention if symptoms occur"],Chickenpox:["Get vaccinated for chickenpox","Avoid scratching the rash","Isolate infected individuals","Practice good hand hygiene","Use anti-itch treatments as prescribed"],Shingles:["Get vaccinated for shingles","Avoid contact with people who have weakened immune systems","Practice good hand hygiene","Avoid scratching the rash","Use prescribed antiviral medications"],"Scarlet Fever":["Get treatment for strep throat promptly","Practice good hand hygiene","Avoid close contact with infected individuals","Seek medical attention if symptoms occur","Isolate infected individuals"],"Whooping Cough":["Get vaccinated for whooping cough","Avoid close contact with infected individuals","Practice good hand hygiene","Isolate infected individuals","Get treatment if symptoms occur"],"Huntingtons Disease":["Genetic counseling","Regular check-ups","Stay active mentally and physically","Seek family support","Manage symptoms with prescribed treatments"],"Amyotrophic Lateral Sclerosis (ALS)":["Seek early diagnosis and support","Maintain muscle strength through exercise","Consider physical therapy","Maintain a balanced diet","Seek supportive care"],"Marfan Syndrome":["Monitor cardiovascular health","Avoid excessive physical exertion","Take prescribed medications","Get regular check-ups","Maintain a healthy lifestyle"],Hemophilia:["Avoid injury or trauma","Take prescribed clotting factor treatments","Practice safe activities","Monitor for signs of bleeding","Stay up to date on medical care"],Thalassemia:["Regular blood transfusions if necessary","Take iron chelation therapy","Maintain a healthy diet","Get regular check-ups","Avoid excessive iron intake"],"Sickle Cell Anemia":["Stay hydrated","Avoid temperature extremes","Avoid high altitudes","Take prescribed pain management","Follow up with regular medical check-ups"],"Vitamin D Deficiency":["Get regular sun exposure","Consume vitamin D-rich foods","Take vitamin D supplements if prescribed","Avoid excessive use of sunscreen","Get blood tests to monitor vitamin D levels"],Osteoporosis:["Consume calcium-rich foods","Engage in weight-bearing exercises","Take prescribed calcium and vitamin D supplements","Avoid smoking","Avoid excessive alcohol consumption"],Lymphedema:["Engage in lymphatic massage","Maintain a healthy weight","Wear compression garments as prescribed","Avoid injury to affected areas","Seek regular medical advice"],"Raynaud’s Disease":["Avoid cold temperatures","Manage stress","Wear warm gloves and socks","Avoid smoking","Exercise regularly"],"Addison’s Disease":["Take prescribed corticosteroids","Monitor for symptoms of low blood pressure","Avoid stress","Eat a balanced diet","Get regular check-ups"],"Cystic Fibrosis":["Take prescribed medications","Engage in regular physical activity","Maintain good nutrition","Use prescribed chest physiotherapy","Get regular medical check-ups"],"Panic Disorder":["Practice relaxation techniques","Avoid caffeine and alcohol","Seek therapy","Exercise regularly","Avoid stress triggers"],"Obsessive-Compulsive Disorder (OCD)":["Engage in cognitive-behavioral therapy","Avoid stress triggers","Take prescribed medications","Practice mindfulness","Maintain a consistent routine"],"Bipolar Disorder":["Follow prescribed medication regimen","Engage in therapy","Maintain a stable sleep routine","Avoid stress","Stay active physically and socially"],Schizophrenia:["Take prescribed antipsychotic medications","Engage in therapy","Stay connected with support systems","Maintain a healthy routine","Avoid drugs and alcohol"],"Panic Attacks":["Practice relaxation techniques","Avoid stress triggers","Seek professional counseling","Maintain a healthy lifestyle","Use prescribed medications if necessary"],"Autism Spectrum Disorder (ASD)":["Engage in early intervention therapies","Provide structured routines","Encourage social interaction","Support sensory processing needs","Maintain consistent communication"]}[t]||["Maintain good hygiene","Follow doctor's recommendations"]}function fSe(t){return{Hypertension:["Regular exercise (30 minutes daily)","Reduce salt intake","Maintain healthy weight","Limit alcohol consumption","Practice stress management"],"Type 2 Diabetes":["Regular blood sugar monitoring","Balanced diet with controlled carbs","Regular physical activity","Weight management","Foot care routine"]}[t]||["Maintain a balanced diet","Regular exercise","Adequate rest"]}function pSe(t,e){return["HIV/AIDS","Tuberculosis","Meningitis","Multiple Sclerosis","Lupus","Rheumatoid Arthritis","Parkinsons Disease","Alzheimers Disease","Epilepsy","Lung Cancer","Breast Cancer","Prostate Cancer","Leukemia","Lymphoma","Chronic Kidney Disease","Hepatitis B","Hepatitis C","Cystic Fibrosis","Hemophilia","Thalassemia","Sickle Cell Anemia","Marfan Syndrome","Amyotrophic Lateral Sclerosis (ALS)","Huntingtons Disease","Osteoporosis","Endometriosis","Polycystic Ovary Syndrome (PCOS)","Ovarian Cyst","Heart Disease","Stroke","Peripheral Artery Disease","Deep Vein Thrombosis"].includes(t)||e>.8}function mSe(t){return{Tuberculosis:"Pulmonologist",Meningitis:"Neurologist","Multiple Sclerosis":"Neurologist",Lupus:"Rheumatologist","Rheumatoid Arthritis":"Rheumatologist","Parkinsons Disease":"Neurologist","Alzheimers Disease":"Neurologist","HIV/AIDS":"Infectious Disease Specialist",Epilepsy:"Neurologist","Lung Cancer":"Oncologist","Breast Cancer":"Oncologist","Prostate Cancer":"Oncologist",Leukemia:"Hematologist/Oncologist",Lymphoma:"Hematologist/Oncologist","Chronic Kidney Disease":"Nephrologist","Hepatitis B":"Hepatologist","Hepatitis C":"Hepatologist","Cystic Fibrosis":"Pulmonologist",Hemophilia:"Hematologist",Thalassemia:"Hematologist","Sickle Cell Anemia":"Hematologist","Marfan Syndrome":"Geneticist","Amyotrophic Lateral Sclerosis (ALS)":"Neurologist","Huntingtons Disease":"Neurologist",Osteoporosis:"Endocrinologist",Endometriosis:"Gynecologist","Polycystic Ovary Syndrome (PCOS)":"Gynecologist","Ovarian Cyst":"Gynecologist","Heart Disease":"Cardiologist",Stroke:"Neurologist","Peripheral Artery Disease":"Vascular Surgeon","Deep Vein Thrombosis":"Vascular Surgeon",Obesity:"Endocrinologist",Insomnia:"Sleep Specialist","Sleep Apnea":"Sleep Specialist",Vertigo:"Otolaryngologist (ENT)",Chikungunya:"Infectious Disease Specialist","Zika Virus":"Infectious Disease Specialist",Typhoid:"Infectious Disease Specialist",Measles:"Pediatrician",Mumps:"Pediatrician",Rubella:"Pediatrician",Chickenpox:"Pediatrician",Shingles:"Dermatologist","Scarlet Fever":"Pediatrician","Whooping Cough":"Pediatrician","Vitamin D Deficiency":"Endocrinologist","Raynaud’s Disease":"Rheumatologist","Addison’s Disease":"Endocrinologist","Panic Disorder":"Psychiatrist","Obsessive-Compulsive Disorder (OCD)":"Psychiatrist","Bipolar Disorder":"Psychiatrist",Schizophrenia:"Psychiatrist","Panic Attacks":"Psychiatrist","Autism Spectrum Disorder (ASD)":"Developmental Pediatrician"}[t]||"Relevant Specialist"}async function aT(t){try{const e=await aSe(),n=lSe(t),s=sg([n],[1,H0.length]),r=e.predict(s),i=await r.data(),o=Array.from(i).indexOf(Math.max(...Array.from(i))),a=nz[o],l=i[o],c=cSe(n);let u;c>.7?u="high":c>.4?u="medium":u="low";const d=uSe(a,u),h=rz[a]||[],f=sz[a];We([s,r]);const p={diagnosis:a,confidence:l,condition:a,probability:l,recommendations:d,urgency:u,medications:h,consultationFees:f,estimatedRecoveryTime:dSe(a,u),preventiveMeasures:hSe(a),lifestyle:fSe(a)};return pSe(a,c)&&(p.specialistReferral=mSe(a)),p}catch(e){throw console.error("Error analyzing symptoms:",e),new Error("Failed to analyze symptoms")}}function gSe({symptoms:t}){const[e,n]=M.useState(null),[s,r]=M.useState(!0),[i,o]=M.useState(null),a=M.useRef(null);return M.useEffect(()=>{(async()=>{try{const c=await aT(`${t.mainSymptom} ${t.additionalInfo||""}`);n(c),setTimeout(()=>{var u;(u=a.current)==null||u.scrollIntoView({behavior:"smooth",block:"start"})},300)}catch{o("Failed to analyze symptoms. Please try again later.")}finally{r(!1)}})()},[t]),s?w.jsxs("div",{className:"flex items-center justify-center p-8",children:[w.jsx(RG,{className:"h-8 w-8 text-blue-500 animate-pulse"}),w.jsx("span",{className:"ml-3 text-lg",children:"Analyzing symptoms..."})]}):i?w.jsx("div",{className:"bg-red-50 p-4 rounded-lg",children:w.jsxs("div",{className:"flex items-center",children:[w.jsx(PG,{className:"h-5 w-5 text-red-400"}),w.jsx("span",{className:"ml-3 text-red-800",children:i})]})}):e?w.jsxs("footer",{ref:a,className:"bg-gray-100 p-6 rounded-lg shadow-lg space-y-4",children:[w.jsx("div",{className:"bg-blue-500 text-white p-4 rounded-lg shadow-md text-center",children:w.jsx("h3",{className:"text-xl font-semibold",children:"Our Daktari's Analysis Results"})}),w.jsxs("div",{className:"bg-orange-500 text-white p-4 rounded-lg shadow-md",children:[w.jsx("h4",{className:"text-lg font-medium",children:"Possible Condition"}),w.jsx("p",{className:"text-white",children:e.condition})]}),w.jsxs("div",{className:"bg-gray-200 p-4 rounded-lg shadow-md",children:[w.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Confidence Level"}),w.jsx("div",{className:"w-full bg-gray-300 rounded-full h-2.5 mt-2",children:w.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${e.probability*100}%`}})}),w.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[(e.probability*100).toFixed(1),"% confidence"]}),w.jsx("h4",{className:"text-lg font-medium text-gray-900 mt-4",children:"Urgency Level"}),w.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${e.urgency==="high"?"bg-red-600 text-white":e.urgency==="medium"?"bg-yellow-500 text-white":"bg-green-500 text-white"}`,children:e.urgency.charAt(0).toUpperCase()+e.urgency.slice(1)})]}),w.jsxs("div",{className:"bg-green-500 text-white p-4 rounded-lg shadow-md",children:[w.jsx("h4",{className:"text-lg font-medium",children:"Recommendations"}),w.jsx("ul",{className:"list-disc list-inside space-y-1",children:e.recommendations.map((l,c)=>w.jsx("li",{children:l},c))})]})]}):null}const ySe=Pn.object({mainSymptom:Pn.string().min(3,"Please describe your main symptom"),duration:Pn.string().min(1,"Please specify the duration"),severity:Pn.enum(["mild","moderate","severe"]),additionalInfo:Pn.string().optional()}),n_=["https://images.pexels.com/photos/3786157/pexels-photo-3786157.jpeg?auto=compress&fit=crop&w=1200&q=80","https://images.pexels.com/photos/708852/pexels-photo-708852.jpeg?auto=compress&fit=crop&w=1200&q=80"];function xSe(){var f,p,m,y,g,x;const[t,e]=M.useState(null),[n,s]=M.useState(!1),[r,i]=M.useState(0),[o,a]=M.useState(!1),{register:l,handleSubmit:c,formState:{errors:u,isSubmitting:d}}=Qk({resolver:eC(ySe)});M.useEffect(()=>{const v=setInterval(()=>{a(!0),setTimeout(()=>{i(b=>(b+1)%n_.length),a(!1)},500)},9e3);return()=>clearInterval(v)},[]);const h=async v=>{s(!0);try{const b=`Patient reports ${v.mainSymptom}. This has been occurring for ${v.duration}. The severity is ${v.severity}. `+(v.additionalInfo?`Additional notes: ${v.additionalInfo}`:""),k=await aT(b),C={condition:k.diagnosis||k.condition,confidence:k.confidence||.8,recommendations:k.recommendations||[],severity:v.severity,duration:v.duration};e(C),zt.success("Symptoms analyzed successfully!")}catch(b){console.error("Analysis error:",b),zt.error("Failed to analyze symptoms. Please try again.")}finally{s(!1)}};return w.jsxs("div",{className:"relative min-h-screen overflow-hidden",children:[w.jsxs("div",{className:"absolute inset-0 z-0",children:[n_.map((v,b)=>w.jsx("img",{src:v,alt:"Background",className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-500 ${r===b?"opacity-100":"opacity-0"} ${o?"scale-105":"scale-100"}`},v)),w.jsx("div",{className:"absolute inset-0 bg-black/50"})]}),w.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center px-4 py-12",children:w.jsxs("div",{className:"w-full max-w-2xl bg-white rounded-lg shadow-xl p-8",children:[w.jsx("h2",{className:"text-3xl font-bold text-center mb-8 text-blue-800",children:"describe your symptoms to daktari"}),w.jsxs("form",{onSubmit:c(h),className:"space-y-6",children:[w.jsxs("div",{className:"space-y-4",children:[w.jsxs("label",{className:"block",children:[w.jsx("span",{className:"text-sm font-medium text-green-700",children:"Main Symptom"}),w.jsx("textarea",{...l("mainSymptom"),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:3,placeholder:"Example: severe headache with throbbing pain on the right side"}),u.mainSymptom&&w.jsx("p",{className:"mt-1 text-sm text-red-600",children:(p=(f=u.mainSymptom)==null?void 0:f.message)==null?void 0:p.toString()})]}),w.jsxs("label",{className:"block",children:[w.jsx("span",{className:"text-sm font-medium text-green-700",children:"Duration"}),w.jsx("input",{type:"text",...l("duration"),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Example: 3 days, 2 weeks, etc."}),u.duration&&w.jsx("p",{className:"mt-1 text-sm text-red-600",children:(y=(m=u.duration)==null?void 0:m.message)==null?void 0:y.toString()})]}),w.jsxs("label",{className:"block",children:[w.jsx("span",{className:"text-sm font-medium text-green-700",children:"Severity"}),w.jsxs("select",{...l("severity"),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[w.jsx("option",{value:"mild",children:"Mild - Noticeable but not interfering with daily activities"}),w.jsx("option",{value:"moderate",children:"Moderate - Affecting some daily activities"}),w.jsx("option",{value:"severe",children:"Severe - Significantly impacting daily life"})]}),u.severity&&w.jsx("p",{className:"mt-1 text-sm text-red-600",children:(x=(g=u.severity)==null?void 0:g.message)==null?void 0:x.toString()})]}),w.jsxs("label",{className:"block",children:[w.jsx("span",{className:"text-sm font-medium text-green-700",children:"Additional Information"}),w.jsx("textarea",{...l("additionalInfo"),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:3,placeholder:"Example: symptoms worsen in the morning, associated with nausea, etc."})]})]}),w.jsx(In,{type:"submit",className:`w-full py-3 rounded-md bg-red-600 text-white font-medium hover:bg-blue-700 transition-colors ${d||n?"opacity-75 cursor-not-allowed":""}`,disabled:d||n,children:n?"Analyzing Symptoms...":d?"Submitting...":"Submit Symptoms"})]})]})}),t&&w.jsx("div",{className:"relative z-10 mt-8 mx-auto max-w-2xl bg-white rounded-lg shadow-xl p-8",children:w.jsx(gSe,{symptoms:{mainSymptom:t.condition,severity:t.severity,duration:t.duration,confidence:t.confidence,recommendations:t.recommendations}})})]})}function iz(t,e){return function(){return t.apply(e,arguments)}}const{toString:vSe}=Object.prototype,{getPrototypeOf:lT}=Object,{iterator:q0,toStringTag:oz}=Symbol,K0=(t=>e=>{const n=vSe.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Zr=t=>(t=t.toLowerCase(),e=>K0(e)===t),X0=t=>e=>typeof e===t,{isArray:ad}=Array,af=X0("undefined");function bSe(t){return t!==null&&!af(t)&&t.constructor!==null&&!af(t.constructor)&&_s(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const az=Zr("ArrayBuffer");function wSe(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&az(t.buffer),e}const kSe=X0("string"),_s=X0("function"),lz=X0("number"),Y0=t=>t!==null&&typeof t=="object",CSe=t=>t===!0||t===!1,ig=t=>{if(K0(t)!=="object")return!1;const e=lT(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(oz in t)&&!(q0 in t)},SSe=Zr("Date"),ISe=Zr("File"),TSe=Zr("Blob"),NSe=Zr("FileList"),ESe=t=>Y0(t)&&_s(t.pipe),$Se=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||_s(t.append)&&((e=K0(t))==="formdata"||e==="object"&&_s(t.toString)&&t.toString()==="[object FormData]"))},_Se=Zr("URLSearchParams"),[ASe,RSe,DSe,PSe]=["ReadableStream","Request","Response","Headers"].map(Zr),OSe=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Kp(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let s,r;if(typeof t!="object"&&(t=[t]),ad(t))for(s=0,r=t.length;s<r;s++)e.call(null,t[s],s,t);else{const i=n?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let a;for(s=0;s<o;s++)a=i[s],e.call(null,t[a],a,t)}}function cz(t,e){e=e.toLowerCase();const n=Object.keys(t);let s=n.length,r;for(;s-- >0;)if(r=n[s],e===r.toLowerCase())return r;return null}const hl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,uz=t=>!af(t)&&t!==hl;function T1(){const{caseless:t}=uz(this)&&this||{},e={},n=(s,r)=>{const i=t&&cz(e,r)||r;ig(e[i])&&ig(s)?e[i]=T1(e[i],s):ig(s)?e[i]=T1({},s):ad(s)?e[i]=s.slice():e[i]=s};for(let s=0,r=arguments.length;s<r;s++)arguments[s]&&Kp(arguments[s],n);return e}const FSe=(t,e,n,{allOwnKeys:s}={})=>(Kp(e,(r,i)=>{n&&_s(r)?t[i]=iz(r,n):t[i]=r},{allOwnKeys:s}),t),MSe=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),LSe=(t,e,n,s)=>{t.prototype=Object.create(e.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},VSe=(t,e,n,s)=>{let r,i,o;const a={};if(e=e||{},t==null)return e;do{for(r=Object.getOwnPropertyNames(t),i=r.length;i-- >0;)o=r[i],(!s||s(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=n!==!1&&lT(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},BSe=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const s=t.indexOf(e,n);return s!==-1&&s===n},zSe=t=>{if(!t)return null;if(ad(t))return t;let e=t.length;if(!lz(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},USe=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&lT(Uint8Array)),jSe=(t,e)=>{const s=(t&&t[q0]).call(t);let r;for(;(r=s.next())&&!r.done;){const i=r.value;e.call(t,i[0],i[1])}},WSe=(t,e)=>{let n;const s=[];for(;(n=t.exec(e))!==null;)s.push(n);return s},GSe=Zr("HTMLFormElement"),HSe=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,r){return s.toUpperCase()+r}),s_=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),qSe=Zr("RegExp"),dz=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),s={};Kp(n,(r,i)=>{let o;(o=e(r,i,t))!==!1&&(s[i]=o||r)}),Object.defineProperties(t,s)},KSe=t=>{dz(t,(e,n)=>{if(_s(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=t[n];if(_s(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},XSe=(t,e)=>{const n={},s=r=>{r.forEach(i=>{n[i]=!0})};return ad(t)?s(t):s(String(t).split(e)),n},YSe=()=>{},ZSe=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function JSe(t){return!!(t&&_s(t.append)&&t[oz]==="FormData"&&t[q0])}const QSe=t=>{const e=new Array(10),n=(s,r)=>{if(Y0(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[r]=s;const i=ad(s)?[]:{};return Kp(s,(o,a)=>{const l=n(o,r+1);!af(l)&&(i[a]=l)}),e[r]=void 0,i}}return s};return n(t,0)},eIe=Zr("AsyncFunction"),tIe=t=>t&&(Y0(t)||_s(t))&&_s(t.then)&&_s(t.catch),hz=((t,e)=>t?setImmediate:e?((n,s)=>(hl.addEventListener("message",({source:r,data:i})=>{r===hl&&i===n&&s.length&&s.shift()()},!1),r=>{s.push(r),hl.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",_s(hl.postMessage)),nIe=typeof queueMicrotask<"u"?queueMicrotask.bind(hl):typeof process<"u"&&process.nextTick||hz,sIe=t=>t!=null&&_s(t[q0]),J={isArray:ad,isArrayBuffer:az,isBuffer:bSe,isFormData:$Se,isArrayBufferView:wSe,isString:kSe,isNumber:lz,isBoolean:CSe,isObject:Y0,isPlainObject:ig,isReadableStream:ASe,isRequest:RSe,isResponse:DSe,isHeaders:PSe,isUndefined:af,isDate:SSe,isFile:ISe,isBlob:TSe,isRegExp:qSe,isFunction:_s,isStream:ESe,isURLSearchParams:_Se,isTypedArray:USe,isFileList:NSe,forEach:Kp,merge:T1,extend:FSe,trim:OSe,stripBOM:MSe,inherits:LSe,toFlatObject:VSe,kindOf:K0,kindOfTest:Zr,endsWith:BSe,toArray:zSe,forEachEntry:jSe,matchAll:WSe,isHTMLForm:GSe,hasOwnProperty:s_,hasOwnProp:s_,reduceDescriptors:dz,freezeMethods:KSe,toObjectSet:XSe,toCamelCase:HSe,noop:YSe,toFiniteNumber:ZSe,findKey:cz,global:hl,isContextDefined:uz,isSpecCompliantForm:JSe,toJSONObject:QSe,isAsyncFn:eIe,isThenable:tIe,setImmediate:hz,asap:nIe,isIterable:sIe};function Be(t,e,n,s,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),s&&(this.request=s),r&&(this.response=r,this.status=r.status?r.status:null)}J.inherits(Be,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:J.toJSONObject(this.config),code:this.code,status:this.status}}});const fz=Be.prototype,pz={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{pz[t]={value:t}});Object.defineProperties(Be,pz);Object.defineProperty(fz,"isAxiosError",{value:!0});Be.from=(t,e,n,s,r,i)=>{const o=Object.create(fz);return J.toFlatObject(t,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),Be.call(o,t.message,e,n,s,r),o.cause=t,o.name=t.name,i&&Object.assign(o,i),o};const rIe=null;function N1(t){return J.isPlainObject(t)||J.isArray(t)}function mz(t){return J.endsWith(t,"[]")?t.slice(0,-2):t}function r_(t,e,n){return t?t.concat(e).map(function(r,i){return r=mz(r),!n&&i?"["+r+"]":r}).join(n?".":""):e}function iIe(t){return J.isArray(t)&&!t.some(N1)}const oIe=J.toFlatObject(J,{},null,function(e){return/^is[A-Z]/.test(e)});function Z0(t,e,n){if(!J.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=J.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,y){return!J.isUndefined(y[m])});const s=n.metaTokens,r=n.visitor||u,i=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&J.isSpecCompliantForm(e);if(!J.isFunction(r))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(J.isDate(p))return p.toISOString();if(!l&&J.isBlob(p))throw new Be("Blob is not supported. Use a Buffer instead.");return J.isArrayBuffer(p)||J.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,m,y){let g=p;if(p&&!y&&typeof p=="object"){if(J.endsWith(m,"{}"))m=s?m:m.slice(0,-2),p=JSON.stringify(p);else if(J.isArray(p)&&iIe(p)||(J.isFileList(p)||J.endsWith(m,"[]"))&&(g=J.toArray(p)))return m=mz(m),g.forEach(function(v,b){!(J.isUndefined(v)||v===null)&&e.append(o===!0?r_([m],b,i):o===null?m:m+"[]",c(v))}),!1}return N1(p)?!0:(e.append(r_(y,m,i),c(p)),!1)}const d=[],h=Object.assign(oIe,{defaultVisitor:u,convertValue:c,isVisitable:N1});function f(p,m){if(!J.isUndefined(p)){if(d.indexOf(p)!==-1)throw Error("Circular reference detected in "+m.join("."));d.push(p),J.forEach(p,function(g,x){(!(J.isUndefined(g)||g===null)&&r.call(e,g,J.isString(x)?x.trim():x,m,h))===!0&&f(g,m?m.concat(x):[x])}),d.pop()}}if(!J.isObject(t))throw new TypeError("data must be an object");return f(t),e}function i_(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function cT(t,e){this._pairs=[],t&&Z0(t,this,e)}const gz=cT.prototype;gz.append=function(e,n){this._pairs.push([e,n])};gz.toString=function(e){const n=e?function(s){return e.call(this,s,i_)}:i_;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function aIe(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function yz(t,e,n){if(!e)return t;const s=n&&n.encode||aIe;J.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let i;if(r?i=r(e,n):i=J.isURLSearchParams(e)?e.toString():new cT(e,n).toString(s),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class o_{constructor(){this.handlers=[]}use(e,n,s){return this.handlers.push({fulfilled:e,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){J.forEach(this.handlers,function(s){s!==null&&e(s)})}}const xz={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},lIe=typeof URLSearchParams<"u"?URLSearchParams:cT,cIe=typeof FormData<"u"?FormData:null,uIe=typeof Blob<"u"?Blob:null,dIe={isBrowser:!0,classes:{URLSearchParams:lIe,FormData:cIe,Blob:uIe},protocols:["http","https","file","blob","url","data"]},uT=typeof window<"u"&&typeof document<"u",E1=typeof navigator=="object"&&navigator||void 0,hIe=uT&&(!E1||["ReactNative","NativeScript","NS"].indexOf(E1.product)<0),fIe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",pIe=uT&&window.location.href||"http://localhost",mIe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:uT,hasStandardBrowserEnv:hIe,hasStandardBrowserWebWorkerEnv:fIe,navigator:E1,origin:pIe},Symbol.toStringTag,{value:"Module"})),Jn={...mIe,...dIe};function gIe(t,e){return Z0(t,new Jn.classes.URLSearchParams,Object.assign({visitor:function(n,s,r,i){return Jn.isNode&&J.isBuffer(n)?(this.append(s,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function yIe(t){return J.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function xIe(t){const e={},n=Object.keys(t);let s;const r=n.length;let i;for(s=0;s<r;s++)i=n[s],e[i]=t[i];return e}function vz(t){function e(n,s,r,i){let o=n[i++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=i>=n.length;return o=!o&&J.isArray(r)?r.length:o,l?(J.hasOwnProp(r,o)?r[o]=[r[o],s]:r[o]=s,!a):((!r[o]||!J.isObject(r[o]))&&(r[o]=[]),e(n,s,r[o],i)&&J.isArray(r[o])&&(r[o]=xIe(r[o])),!a)}if(J.isFormData(t)&&J.isFunction(t.entries)){const n={};return J.forEachEntry(t,(s,r)=>{e(yIe(s),r,n,0)}),n}return null}function vIe(t,e,n){if(J.isString(t))try{return(e||JSON.parse)(t),J.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(t)}const Xp={transitional:xz,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const s=n.getContentType()||"",r=s.indexOf("application/json")>-1,i=J.isObject(e);if(i&&J.isHTMLForm(e)&&(e=new FormData(e)),J.isFormData(e))return r?JSON.stringify(vz(e)):e;if(J.isArrayBuffer(e)||J.isBuffer(e)||J.isStream(e)||J.isFile(e)||J.isBlob(e)||J.isReadableStream(e))return e;if(J.isArrayBufferView(e))return e.buffer;if(J.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return gIe(e,this.formSerializer).toString();if((a=J.isFileList(e))||s.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Z0(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return i||r?(n.setContentType("application/json",!1),vIe(e)):e}],transformResponse:[function(e){const n=this.transitional||Xp.transitional,s=n&&n.forcedJSONParsing,r=this.responseType==="json";if(J.isResponse(e)||J.isReadableStream(e))return e;if(e&&J.isString(e)&&(s&&!this.responseType||r)){const o=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?Be.from(a,Be.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Jn.classes.FormData,Blob:Jn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};J.forEach(["delete","get","head","post","put","patch"],t=>{Xp.headers[t]={}});const bIe=J.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),wIe=t=>{const e={};let n,s,r;return t&&t.split(`
`).forEach(function(o){r=o.indexOf(":"),n=o.substring(0,r).trim().toLowerCase(),s=o.substring(r+1).trim(),!(!n||e[n]&&bIe[n])&&(n==="set-cookie"?e[n]?e[n].push(s):e[n]=[s]:e[n]=e[n]?e[n]+", "+s:s)}),e},a_=Symbol("internals");function Ed(t){return t&&String(t).trim().toLowerCase()}function og(t){return t===!1||t==null?t:J.isArray(t)?t.map(og):String(t)}function kIe(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(t);)e[s[1]]=s[2];return e}const CIe=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function pb(t,e,n,s,r){if(J.isFunction(s))return s.call(this,e,n);if(r&&(e=n),!!J.isString(e)){if(J.isString(s))return e.indexOf(s)!==-1;if(J.isRegExp(s))return s.test(e)}}function SIe(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,s)=>n.toUpperCase()+s)}function IIe(t,e){const n=J.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+n,{value:function(r,i,o){return this[s].call(this,e,r,i,o)},configurable:!0})})}let As=class{constructor(e){e&&this.set(e)}set(e,n,s){const r=this;function i(a,l,c){const u=Ed(l);if(!u)throw new Error("header name must be a non-empty string");const d=J.findKey(r,u);(!d||r[d]===void 0||c===!0||c===void 0&&r[d]!==!1)&&(r[d||l]=og(a))}const o=(a,l)=>J.forEach(a,(c,u)=>i(c,u,l));if(J.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(J.isString(e)&&(e=e.trim())&&!CIe(e))o(wIe(e),n);else if(J.isObject(e)&&J.isIterable(e)){let a={},l,c;for(const u of e){if(!J.isArray(u))throw TypeError("Object iterator must return a key-value pair");a[c=u[0]]=(l=a[c])?J.isArray(l)?[...l,u[1]]:[l,u[1]]:u[1]}o(a,n)}else e!=null&&i(n,e,s);return this}get(e,n){if(e=Ed(e),e){const s=J.findKey(this,e);if(s){const r=this[s];if(!n)return r;if(n===!0)return kIe(r);if(J.isFunction(n))return n.call(this,r,s);if(J.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Ed(e),e){const s=J.findKey(this,e);return!!(s&&this[s]!==void 0&&(!n||pb(this,this[s],s,n)))}return!1}delete(e,n){const s=this;let r=!1;function i(o){if(o=Ed(o),o){const a=J.findKey(s,o);a&&(!n||pb(s,s[a],a,n))&&(delete s[a],r=!0)}}return J.isArray(e)?e.forEach(i):i(e),r}clear(e){const n=Object.keys(this);let s=n.length,r=!1;for(;s--;){const i=n[s];(!e||pb(this,this[i],i,e,!0))&&(delete this[i],r=!0)}return r}normalize(e){const n=this,s={};return J.forEach(this,(r,i)=>{const o=J.findKey(s,i);if(o){n[o]=og(r),delete n[i];return}const a=e?SIe(i):String(i).trim();a!==i&&delete n[i],n[a]=og(r),s[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return J.forEach(this,(s,r)=>{s!=null&&s!==!1&&(n[r]=e&&J.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const s=new this(e);return n.forEach(r=>s.set(r)),s}static accessor(e){const s=(this[a_]=this[a_]={accessors:{}}).accessors,r=this.prototype;function i(o){const a=Ed(o);s[a]||(IIe(r,o),s[a]=!0)}return J.isArray(e)?e.forEach(i):i(e),this}};As.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);J.reduceDescriptors(As.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(s){this[n]=s}}});J.freezeMethods(As);function mb(t,e){const n=this||Xp,s=e||n,r=As.from(s.headers);let i=s.data;return J.forEach(t,function(a){i=a.call(n,i,r.normalize(),e?e.status:void 0)}),r.normalize(),i}function bz(t){return!!(t&&t.__CANCEL__)}function ld(t,e,n){Be.call(this,t??"canceled",Be.ERR_CANCELED,e,n),this.name="CanceledError"}J.inherits(ld,Be,{__CANCEL__:!0});function wz(t,e,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?t(n):e(new Be("Request failed with status code "+n.status,[Be.ERR_BAD_REQUEST,Be.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function TIe(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function NIe(t,e){t=t||10;const n=new Array(t),s=new Array(t);let r=0,i=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=s[i];o||(o=c),n[r]=l,s[r]=c;let d=i,h=0;for(;d!==r;)h+=n[d++],d=d%t;if(r=(r+1)%t,r===i&&(i=(i+1)%t),c-o<e)return;const f=u&&c-u;return f?Math.round(h*1e3/f):void 0}}function EIe(t,e){let n=0,s=1e3/e,r,i;const o=(c,u=Date.now())=>{n=u,r=null,i&&(clearTimeout(i),i=null),t.apply(null,c)};return[(...c)=>{const u=Date.now(),d=u-n;d>=s?o(c,u):(r=c,i||(i=setTimeout(()=>{i=null,o(r)},s-d)))},()=>r&&o(r)]}const Ry=(t,e,n=3)=>{let s=0;const r=NIe(50,250);return EIe(i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,l=o-s,c=r(l),u=o<=a;s=o;const d={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-o)/c:void 0,event:i,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(d)},n)},l_=(t,e)=>{const n=t!=null;return[s=>e[0]({lengthComputable:n,total:t,loaded:s}),e[1]]},c_=t=>(...e)=>J.asap(()=>t(...e)),$Ie=Jn.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,Jn.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(Jn.origin),Jn.navigator&&/(msie|trident)/i.test(Jn.navigator.userAgent)):()=>!0,_Ie=Jn.hasStandardBrowserEnv?{write(t,e,n,s,r,i){const o=[t+"="+encodeURIComponent(e)];J.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),J.isString(s)&&o.push("path="+s),J.isString(r)&&o.push("domain="+r),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function AIe(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function RIe(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function kz(t,e,n){let s=!AIe(e);return t&&(s||n==!1)?RIe(t,e):e}const u_=t=>t instanceof As?{...t}:t;function Xl(t,e){e=e||{};const n={};function s(c,u,d,h){return J.isPlainObject(c)&&J.isPlainObject(u)?J.merge.call({caseless:h},c,u):J.isPlainObject(u)?J.merge({},u):J.isArray(u)?u.slice():u}function r(c,u,d,h){if(J.isUndefined(u)){if(!J.isUndefined(c))return s(void 0,c,d,h)}else return s(c,u,d,h)}function i(c,u){if(!J.isUndefined(u))return s(void 0,u)}function o(c,u){if(J.isUndefined(u)){if(!J.isUndefined(c))return s(void 0,c)}else return s(void 0,u)}function a(c,u,d){if(d in e)return s(c,u);if(d in t)return s(void 0,c)}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u,d)=>r(u_(c),u_(u),d,!0)};return J.forEach(Object.keys(Object.assign({},t,e)),function(u){const d=l[u]||r,h=d(t[u],e[u],u);J.isUndefined(h)&&d!==a||(n[u]=h)}),n}const Cz=t=>{const e=Xl({},t);let{data:n,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:i,headers:o,auth:a}=e;e.headers=o=As.from(o),e.url=yz(kz(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(J.isFormData(n)){if(Jn.hasStandardBrowserEnv||Jn.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[c,...u]=l?l.split(";").map(d=>d.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...u].join("; "))}}if(Jn.hasStandardBrowserEnv&&(s&&J.isFunction(s)&&(s=s(e)),s||s!==!1&&$Ie(e.url))){const c=r&&i&&_Ie.read(i);c&&o.set(r,c)}return e},DIe=typeof XMLHttpRequest<"u",PIe=DIe&&function(t){return new Promise(function(n,s){const r=Cz(t);let i=r.data;const o=As.from(r.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=r,u,d,h,f,p;function m(){f&&f(),p&&p(),r.cancelToken&&r.cancelToken.unsubscribe(u),r.signal&&r.signal.removeEventListener("abort",u)}let y=new XMLHttpRequest;y.open(r.method.toUpperCase(),r.url,!0),y.timeout=r.timeout;function g(){if(!y)return;const v=As.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),k={data:!a||a==="text"||a==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:v,config:t,request:y};wz(function(S){n(S),m()},function(S){s(S),m()},k),y=null}"onloadend"in y?y.onloadend=g:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(g)},y.onabort=function(){y&&(s(new Be("Request aborted",Be.ECONNABORTED,t,y)),y=null)},y.onerror=function(){s(new Be("Network Error",Be.ERR_NETWORK,t,y)),y=null},y.ontimeout=function(){let b=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const k=r.transitional||xz;r.timeoutErrorMessage&&(b=r.timeoutErrorMessage),s(new Be(b,k.clarifyTimeoutError?Be.ETIMEDOUT:Be.ECONNABORTED,t,y)),y=null},i===void 0&&o.setContentType(null),"setRequestHeader"in y&&J.forEach(o.toJSON(),function(b,k){y.setRequestHeader(k,b)}),J.isUndefined(r.withCredentials)||(y.withCredentials=!!r.withCredentials),a&&a!=="json"&&(y.responseType=r.responseType),c&&([h,p]=Ry(c,!0),y.addEventListener("progress",h)),l&&y.upload&&([d,f]=Ry(l),y.upload.addEventListener("progress",d),y.upload.addEventListener("loadend",f)),(r.cancelToken||r.signal)&&(u=v=>{y&&(s(!v||v.type?new ld(null,t,y):v),y.abort(),y=null)},r.cancelToken&&r.cancelToken.subscribe(u),r.signal&&(r.signal.aborted?u():r.signal.addEventListener("abort",u)));const x=TIe(r.url);if(x&&Jn.protocols.indexOf(x)===-1){s(new Be("Unsupported protocol "+x+":",Be.ERR_BAD_REQUEST,t));return}y.send(i||null)})},OIe=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let s=new AbortController,r;const i=function(c){if(!r){r=!0,a();const u=c instanceof Error?c:this.reason;s.abort(u instanceof Be?u:new ld(u instanceof Error?u.message:u))}};let o=e&&setTimeout(()=>{o=null,i(new Be(`timeout ${e} of ms exceeded`,Be.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(i):c.removeEventListener("abort",i)}),t=null)};t.forEach(c=>c.addEventListener("abort",i));const{signal:l}=s;return l.unsubscribe=()=>J.asap(a),l}},FIe=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let s=0,r;for(;s<n;)r=s+e,yield t.slice(s,r),s=r},MIe=async function*(t,e){for await(const n of LIe(t))yield*FIe(n,e)},LIe=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:s}=await e.read();if(n)break;yield s}}finally{await e.cancel()}},d_=(t,e,n,s)=>{const r=MIe(t,e);let i=0,o,a=l=>{o||(o=!0,s&&s(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await r.next();if(c){a(),l.close();return}let d=u.byteLength;if(n){let h=i+=d;n(h)}l.enqueue(new Uint8Array(u))}catch(c){throw a(c),c}},cancel(l){return a(l),r.return()}},{highWaterMark:2})},J0=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Sz=J0&&typeof ReadableStream=="function",VIe=J0&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Iz=(t,...e)=>{try{return!!t(...e)}catch{return!1}},BIe=Sz&&Iz(()=>{let t=!1;const e=new Request(Jn.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),h_=64*1024,$1=Sz&&Iz(()=>J.isReadableStream(new Response("").body)),Dy={stream:$1&&(t=>t.body)};J0&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Dy[e]&&(Dy[e]=J.isFunction(t[e])?n=>n[e]():(n,s)=>{throw new Be(`Response type '${e}' is not supported`,Be.ERR_NOT_SUPPORT,s)})})})(new Response);const zIe=async t=>{if(t==null)return 0;if(J.isBlob(t))return t.size;if(J.isSpecCompliantForm(t))return(await new Request(Jn.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(J.isArrayBufferView(t)||J.isArrayBuffer(t))return t.byteLength;if(J.isURLSearchParams(t)&&(t=t+""),J.isString(t))return(await VIe(t)).byteLength},UIe=async(t,e)=>{const n=J.toFiniteNumber(t.getContentLength());return n??zIe(e)},jIe=J0&&(async t=>{let{url:e,method:n,data:s,signal:r,cancelToken:i,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:c,headers:u,withCredentials:d="same-origin",fetchOptions:h}=Cz(t);c=c?(c+"").toLowerCase():"text";let f=OIe([r,i&&i.toAbortSignal()],o),p;const m=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let y;try{if(l&&BIe&&n!=="get"&&n!=="head"&&(y=await UIe(u,s))!==0){let k=new Request(e,{method:"POST",body:s,duplex:"half"}),C;if(J.isFormData(s)&&(C=k.headers.get("content-type"))&&u.setContentType(C),k.body){const[S,I]=l_(y,Ry(c_(l)));s=d_(k.body,h_,S,I)}}J.isString(d)||(d=d?"include":"omit");const g="credentials"in Request.prototype;p=new Request(e,{...h,signal:f,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:s,duplex:"half",credentials:g?d:void 0});let x=await fetch(p);const v=$1&&(c==="stream"||c==="response");if($1&&(a||v&&m)){const k={};["status","statusText","headers"].forEach(N=>{k[N]=x[N]});const C=J.toFiniteNumber(x.headers.get("content-length")),[S,I]=a&&l_(C,Ry(c_(a),!0))||[];x=new Response(d_(x.body,h_,S,()=>{I&&I(),m&&m()}),k)}c=c||"text";let b=await Dy[J.findKey(Dy,c)||"text"](x,t);return!v&&m&&m(),await new Promise((k,C)=>{wz(k,C,{data:b,headers:As.from(x.headers),status:x.status,statusText:x.statusText,config:t,request:p})})}catch(g){throw m&&m(),g&&g.name==="TypeError"&&/Load failed|fetch/i.test(g.message)?Object.assign(new Be("Network Error",Be.ERR_NETWORK,t,p),{cause:g.cause||g}):Be.from(g,g&&g.code,t,p)}}),_1={http:rIe,xhr:PIe,fetch:jIe};J.forEach(_1,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const f_=t=>`- ${t}`,WIe=t=>J.isFunction(t)||t===null||t===!1,Tz={getAdapter:t=>{t=J.isArray(t)?t:[t];const{length:e}=t;let n,s;const r={};for(let i=0;i<e;i++){n=t[i];let o;if(s=n,!WIe(n)&&(s=_1[(o=String(n)).toLowerCase()],s===void 0))throw new Be(`Unknown adapter '${o}'`);if(s)break;r[o||"#"+i]=s}if(!s){const i=Object.entries(r).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?i.length>1?`since :
`+i.map(f_).join(`
`):" "+f_(i[0]):"as no adapter specified";throw new Be("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:_1};function gb(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new ld(null,t)}function p_(t){return gb(t),t.headers=As.from(t.headers),t.data=mb.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Tz.getAdapter(t.adapter||Xp.adapter)(t).then(function(s){return gb(t),s.data=mb.call(t,t.transformResponse,s),s.headers=As.from(s.headers),s},function(s){return bz(s)||(gb(t),s&&s.response&&(s.response.data=mb.call(t,t.transformResponse,s.response),s.response.headers=As.from(s.response.headers))),Promise.reject(s)})}const Nz="1.9.0",Q0={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Q0[t]=function(s){return typeof s===t||"a"+(e<1?"n ":" ")+t}});const m_={};Q0.transitional=function(e,n,s){function r(i,o){return"[Axios v"+Nz+"] Transitional option '"+i+"'"+o+(s?". "+s:"")}return(i,o,a)=>{if(e===!1)throw new Be(r(o," has been removed"+(n?" in "+n:"")),Be.ERR_DEPRECATED);return n&&!m_[o]&&(m_[o]=!0,console.warn(r(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(i,o,a):!0}};Q0.spelling=function(e){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function GIe(t,e,n){if(typeof t!="object")throw new Be("options must be an object",Be.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let r=s.length;for(;r-- >0;){const i=s[r],o=e[i];if(o){const a=t[i],l=a===void 0||o(a,i,t);if(l!==!0)throw new Be("option "+i+" must be "+l,Be.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Be("Unknown option "+i,Be.ERR_BAD_OPTION)}}const ag={assertOptions:GIe,validators:Q0},ei=ag.validators;let bl=class{constructor(e){this.defaults=e||{},this.interceptors={request:new o_,response:new o_}}async request(e,n){try{return await this._request(e,n)}catch(s){if(s instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const i=r.stack?r.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Xl(this.defaults,n);const{transitional:s,paramsSerializer:r,headers:i}=n;s!==void 0&&ag.assertOptions(s,{silentJSONParsing:ei.transitional(ei.boolean),forcedJSONParsing:ei.transitional(ei.boolean),clarifyTimeoutError:ei.transitional(ei.boolean)},!1),r!=null&&(J.isFunction(r)?n.paramsSerializer={serialize:r}:ag.assertOptions(r,{encode:ei.function,serialize:ei.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),ag.assertOptions(n,{baseUrl:ei.spelling("baseURL"),withXsrfToken:ei.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&J.merge(i.common,i[n.method]);i&&J.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),n.headers=As.concat(o,i);const a=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(l=l&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const c=[];this.interceptors.response.forEach(function(m){c.push(m.fulfilled,m.rejected)});let u,d=0,h;if(!l){const p=[p_.bind(this),void 0];for(p.unshift.apply(p,a),p.push.apply(p,c),h=p.length,u=Promise.resolve(n);d<h;)u=u.then(p[d++],p[d++]);return u}h=a.length;let f=n;for(d=0;d<h;){const p=a[d++],m=a[d++];try{f=p(f)}catch(y){m.call(this,y);break}}try{u=p_.call(this,f)}catch(p){return Promise.reject(p)}for(d=0,h=c.length;d<h;)u=u.then(c[d++],c[d++]);return u}getUri(e){e=Xl(this.defaults,e);const n=kz(e.baseURL,e.url,e.allowAbsoluteUrls);return yz(n,e.params,e.paramsSerializer)}};J.forEach(["delete","get","head","options"],function(e){bl.prototype[e]=function(n,s){return this.request(Xl(s||{},{method:e,url:n,data:(s||{}).data}))}});J.forEach(["post","put","patch"],function(e){function n(s){return function(i,o,a){return this.request(Xl(a||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}bl.prototype[e]=n(),bl.prototype[e+"Form"]=n(!0)});let HIe=class Ez{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const s=this;this.promise.then(r=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](r);s._listeners=null}),this.promise.then=r=>{let i;const o=new Promise(a=>{s.subscribe(a),i=a}).then(r);return o.cancel=function(){s.unsubscribe(i)},o},e(function(i,o,a){s.reason||(s.reason=new ld(i,o,a),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=s=>{e.abort(s)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new Ez(function(r){e=r}),cancel:e}}};function qIe(t){return function(n){return t.apply(null,n)}}function KIe(t){return J.isObject(t)&&t.isAxiosError===!0}const A1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(A1).forEach(([t,e])=>{A1[e]=t});function $z(t){const e=new bl(t),n=iz(bl.prototype.request,e);return J.extend(n,bl.prototype,e,{allOwnKeys:!0}),J.extend(n,e,null,{allOwnKeys:!0}),n.create=function(r){return $z(Xl(t,r))},n}const Yt=$z(Xp);Yt.Axios=bl;Yt.CanceledError=ld;Yt.CancelToken=HIe;Yt.isCancel=bz;Yt.VERSION=Nz;Yt.toFormData=Z0;Yt.AxiosError=Be;Yt.Cancel=Yt.CanceledError;Yt.all=function(e){return Promise.all(e)};Yt.spread=qIe;Yt.isAxiosError=KIe;Yt.mergeConfig=Xl;Yt.AxiosHeaders=As;Yt.formToJSON=t=>vz(J.isHTMLForm(t)?new FormData(t):t);Yt.getAdapter=Tz.getAdapter;Yt.HttpStatusCode=A1;Yt.default=Yt;const{Axios:J_e,AxiosError:Q_e,CanceledError:eAe,isCancel:tAe,CancelToken:nAe,VERSION:sAe,all:rAe,Cancel:iAe,isAxiosError:oAe,spread:aAe,toFormData:lAe,AxiosHeaders:cAe,HttpStatusCode:uAe,formToJSON:dAe,getAdapter:hAe,mergeConfig:fAe}=Yt,XIe=Yt.create({baseURL:"/api"}),YIe=async t=>{try{return(await XIe.post("/payment",t)).data}catch{throw new Error("Payment processing failed")}},ZIe=Pn.object({cardNumber:Pn.string().min(16,"Invalid card number"),expiryDate:Pn.string().regex(/^\d{2}\/\d{2}$/,"Invalid expiry date (MM/YY)"),cvv:Pn.string().length(3,"Invalid CVV"),name:Pn.string().min(2,"Invalid name"),address:Pn.string().min(5,"Invalid address")});function JIe({amount:t,onSuccess:e}){const[n,s]=M.useState(!1),{register:r,handleSubmit:i,formState:{errors:o}}=Qk({resolver:eC(ZIe)}),a=async l=>{s(!0);try{await YIe({...l,amount:t}),zt.success("Payment processed successfully!"),e()}catch{zt.error("Payment failed. Please try again.")}finally{s(!1)}};return w.jsxs("div",{className:"w-full max-w-md space-y-8 rounded-xl bg-white p-8 shadow-lg",children:[w.jsxs("div",{className:"text-center",children:[w.jsx("h2",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Payment Details"}),w.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Amount to pay: $",t.toFixed(2)]})]}),w.jsxs("form",{onSubmit:i(a),className:"mt-8 space-y-6",children:[w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Card Number"}),w.jsxs("div",{className:"relative mt-1",children:[w.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:w.jsx(VG,{className:"h-5 w-5 text-gray-400"})}),w.jsx("input",{...r("cardNumber"),type:"text",placeholder:"1234 5678 9012 3456",className:"block w-full rounded-md border border-gray-300 pl-10 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500"})]}),o.cardNumber&&w.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.cardNumber.message})]}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Expiry Date"}),w.jsx("input",{...r("expiryDate"),type:"text",placeholder:"MM/YY",className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500"}),o.expiryDate&&w.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.expiryDate.message})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CVV"}),w.jsx("input",{...r("cvv"),type:"text",placeholder:"123",className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500"}),o.cvv&&w.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.cvv.message})]})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cardholder Name"}),w.jsxs("div",{className:"relative mt-1",children:[w.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:w.jsx(ox,{className:"h-5 w-5 text-gray-400"})}),w.jsx("input",{...r("name"),type:"text",placeholder:"John Doe",className:"block w-full rounded-md border border-gray-300 pl-10 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500"})]}),o.name&&w.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.name.message})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Billing Address"}),w.jsxs("div",{className:"relative mt-1",children:[w.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:w.jsx(FG,{className:"h-5 w-5 text-gray-400"})}),w.jsx("input",{...r("address"),type:"text",placeholder:"123 Main St, City, Country",className:"block w-full rounded-md border border-gray-300 pl-10 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500"})]}),o.address&&w.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.address.message})]})]}),w.jsx(In,{type:"submit",className:"w-full",disabled:n,children:n?"Processing...":"Pay Now"})]})]})}function Jr(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function Yl(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}const _z=6048e5,QIe=864e5;let eTe={};function ev(){return eTe}function lf(t,e){var a,l,c,u;const n=ev(),s=(e==null?void 0:e.weekStartsOn)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,r=Jr(t),i=r.getDay(),o=(i<s?7:0)+i-s;return r.setDate(r.getDate()-o),r.setHours(0,0,0,0),r}function Py(t){return lf(t,{weekStartsOn:1})}function Az(t){const e=Jr(t),n=e.getFullYear(),s=Yl(t,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const r=Py(s),i=Yl(t,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const o=Py(i);return e.getTime()>=r.getTime()?n+1:e.getTime()>=o.getTime()?n:n-1}function g_(t){const e=Jr(t);return e.setHours(0,0,0,0),e}function y_(t){const e=Jr(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function tTe(t,e){const n=g_(t),s=g_(e),r=+n-y_(n),i=+s-y_(s);return Math.round((r-i)/QIe)}function nTe(t){const e=Az(t),n=Yl(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),Py(n)}function sTe(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function rTe(t){if(!sTe(t)&&typeof t!="number")return!1;const e=Jr(t);return!isNaN(Number(e))}function iTe(t){const e=Jr(t),n=Yl(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}const oTe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},aTe=(t,e,n)=>{let s;const r=oTe[t];return typeof r=="string"?s=r:e===1?s=r.one:s=r.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function yb(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const lTe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},cTe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},uTe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},dTe={date:yb({formats:lTe,defaultWidth:"full"}),time:yb({formats:cTe,defaultWidth:"full"}),dateTime:yb({formats:uTe,defaultWidth:"full"})},hTe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},fTe=(t,e,n,s)=>hTe[t];function $d(t){return(e,n)=>{const s=n!=null&&n.context?String(n.context):"standalone";let r;if(s==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,a=n!=null&&n.width?String(n.width):o;r=t.formattingValues[a]||t.formattingValues[o]}else{const o=t.defaultWidth,a=n!=null&&n.width?String(n.width):t.defaultWidth;r=t.values[a]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return r[i]}}const pTe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},mTe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},gTe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},yTe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},xTe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},vTe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},bTe=(t,e)=>{const n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},wTe={ordinalNumber:bTe,era:$d({values:pTe,defaultWidth:"wide"}),quarter:$d({values:mTe,defaultWidth:"wide",argumentCallback:t=>t-1}),month:$d({values:gTe,defaultWidth:"wide"}),day:$d({values:yTe,defaultWidth:"wide"}),dayPeriod:$d({values:xTe,defaultWidth:"wide",formattingValues:vTe,defaultFormattingWidth:"wide"})};function _d(t){return(e,n={})=>{const s=n.width,r=s&&t.matchPatterns[s]||t.matchPatterns[t.defaultMatchWidth],i=e.match(r);if(!i)return null;const o=i[0],a=s&&t.parsePatterns[s]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?CTe(a,d=>d.test(o)):kTe(a,d=>d.test(o));let c;c=t.valueCallback?t.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=e.slice(o.length);return{value:c,rest:u}}}function kTe(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function CTe(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function STe(t){return(e,n={})=>{const s=e.match(t.matchPattern);if(!s)return null;const r=s[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const a=e.slice(r.length);return{value:o,rest:a}}}const ITe=/^(\d+)(th|st|nd|rd)?/i,TTe=/\d+/i,NTe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ETe={any:[/^b/i,/^(a|c)/i]},$Te={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},_Te={any:[/1/i,/2/i,/3/i,/4/i]},ATe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},RTe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},DTe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},PTe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},OTe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},FTe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},MTe={ordinalNumber:STe({matchPattern:ITe,parsePattern:TTe,valueCallback:t=>parseInt(t,10)}),era:_d({matchPatterns:NTe,defaultMatchWidth:"wide",parsePatterns:ETe,defaultParseWidth:"any"}),quarter:_d({matchPatterns:$Te,defaultMatchWidth:"wide",parsePatterns:_Te,defaultParseWidth:"any",valueCallback:t=>t+1}),month:_d({matchPatterns:ATe,defaultMatchWidth:"wide",parsePatterns:RTe,defaultParseWidth:"any"}),day:_d({matchPatterns:DTe,defaultMatchWidth:"wide",parsePatterns:PTe,defaultParseWidth:"any"}),dayPeriod:_d({matchPatterns:OTe,defaultMatchWidth:"any",parsePatterns:FTe,defaultParseWidth:"any"})},LTe={code:"en-US",formatDistance:aTe,formatLong:dTe,formatRelative:fTe,localize:wTe,match:MTe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function VTe(t){const e=Jr(t);return tTe(e,iTe(e))+1}function BTe(t){const e=Jr(t),n=+Py(e)-+nTe(e);return Math.round(n/_z)+1}function Rz(t,e){var u,d,h,f;const n=Jr(t),s=n.getFullYear(),r=ev(),i=(e==null?void 0:e.firstWeekContainsDate)??((d=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((f=(h=r.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??1,o=Yl(t,0);o.setFullYear(s+1,0,i),o.setHours(0,0,0,0);const a=lf(o,e),l=Yl(t,0);l.setFullYear(s,0,i),l.setHours(0,0,0,0);const c=lf(l,e);return n.getTime()>=a.getTime()?s+1:n.getTime()>=c.getTime()?s:s-1}function zTe(t,e){var a,l,c,u;const n=ev(),s=(e==null?void 0:e.firstWeekContainsDate)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,r=Rz(t,e),i=Yl(t,0);return i.setFullYear(r,0,s),i.setHours(0,0,0,0),lf(i,e)}function UTe(t,e){const n=Jr(t),s=+lf(n,e)-+zTe(n,e);return Math.round(s/_z)+1}function ft(t,e){const n=t<0?"-":"",s=Math.abs(t).toString().padStart(e,"0");return n+s}const $o={y(t,e){const n=t.getFullYear(),s=n>0?n:1-n;return ft(e==="yy"?s%100:s,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):ft(n+1,2)},d(t,e){return ft(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return ft(t.getHours()%12||12,e.length)},H(t,e){return ft(t.getHours(),e.length)},m(t,e){return ft(t.getMinutes(),e.length)},s(t,e){return ft(t.getSeconds(),e.length)},S(t,e){const n=e.length,s=t.getMilliseconds(),r=Math.trunc(s*Math.pow(10,n-3));return ft(r,e.length)}},bc={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},x_={G:function(t,e,n){const s=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const s=t.getFullYear(),r=s>0?s:1-s;return n.ordinalNumber(r,{unit:"year"})}return $o.y(t,e)},Y:function(t,e,n,s){const r=Rz(t,s),i=r>0?r:1-r;if(e==="YY"){const o=i%100;return ft(o,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):ft(i,e.length)},R:function(t,e){const n=Az(t);return ft(n,e.length)},u:function(t,e){const n=t.getFullYear();return ft(n,e.length)},Q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return ft(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return ft(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(t,e,n){const s=t.getMonth();switch(e){case"M":case"MM":return $o.M(t,e);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(t,e,n){const s=t.getMonth();switch(e){case"L":return String(s+1);case"LL":return ft(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(t,e,n,s){const r=UTe(t,s);return e==="wo"?n.ordinalNumber(r,{unit:"week"}):ft(r,e.length)},I:function(t,e,n){const s=BTe(t);return e==="Io"?n.ordinalNumber(s,{unit:"week"}):ft(s,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):$o.d(t,e)},D:function(t,e,n){const s=VTe(t);return e==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):ft(s,e.length)},E:function(t,e,n){const s=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(t,e,n,s){const r=t.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return ft(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(t,e,n,s){const r=t.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return ft(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(t,e,n){const s=t.getDay(),r=s===0?7:s;switch(e){case"i":return String(r);case"ii":return ft(r,e.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(t,e,n){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(t,e,n){const s=t.getHours();let r;switch(s===12?r=bc.noon:s===0?r=bc.midnight:r=s/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(t,e,n){const s=t.getHours();let r;switch(s>=17?r=bc.evening:s>=12?r=bc.afternoon:s>=4?r=bc.morning:r=bc.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let s=t.getHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return $o.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):$o.H(t,e)},K:function(t,e,n){const s=t.getHours()%12;return e==="Ko"?n.ordinalNumber(s,{unit:"hour"}):ft(s,e.length)},k:function(t,e,n){let s=t.getHours();return s===0&&(s=24),e==="ko"?n.ordinalNumber(s,{unit:"hour"}):ft(s,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):$o.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):$o.s(t,e)},S:function(t,e){return $o.S(t,e)},X:function(t,e,n){const s=t.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return b_(s);case"XXXX":case"XX":return Za(s);case"XXXXX":case"XXX":default:return Za(s,":")}},x:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"x":return b_(s);case"xxxx":case"xx":return Za(s);case"xxxxx":case"xxx":default:return Za(s,":")}},O:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+v_(s,":");case"OOOO":default:return"GMT"+Za(s,":")}},z:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+v_(s,":");case"zzzz":default:return"GMT"+Za(s,":")}},t:function(t,e,n){const s=Math.trunc(t.getTime()/1e3);return ft(s,e.length)},T:function(t,e,n){const s=t.getTime();return ft(s,e.length)}};function v_(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),r=Math.trunc(s/60),i=s%60;return i===0?n+String(r):n+String(r)+e+ft(i,2)}function b_(t,e){return t%60===0?(t>0?"-":"+")+ft(Math.abs(t)/60,2):Za(t,e)}function Za(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),r=ft(Math.trunc(s/60),2),i=ft(s%60,2);return n+r+e+i}const w_=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Dz=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},jTe=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],s=n[1],r=n[2];if(!r)return w_(t,e);let i;switch(s){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",w_(s,e)).replace("{{time}}",Dz(r,e))},WTe={p:Dz,P:jTe},GTe=/^D+$/,HTe=/^Y+$/,qTe=["D","DD","YY","YYYY"];function KTe(t){return GTe.test(t)}function XTe(t){return HTe.test(t)}function YTe(t,e,n){const s=ZTe(t,e,n);if(console.warn(s),qTe.includes(t))throw new RangeError(s)}function ZTe(t,e,n){const s=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${s} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const JTe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,QTe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,eNe=/^'([^]*?)'?$/,tNe=/''/g,nNe=/[a-zA-Z]/;function sNe(t,e,n){var u,d,h,f;const s=ev(),r=s.locale??LTe,i=s.firstWeekContainsDate??((d=(u=s.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,o=s.weekStartsOn??((f=(h=s.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)??0,a=Jr(t);if(!rTe(a))throw new RangeError("Invalid time value");let l=e.match(QTe).map(p=>{const m=p[0];if(m==="p"||m==="P"){const y=WTe[m];return y(p,r.formatLong)}return p}).join("").match(JTe).map(p=>{if(p==="''")return{isToken:!1,value:"'"};const m=p[0];if(m==="'")return{isToken:!1,value:rNe(p)};if(x_[m])return{isToken:!0,value:p};if(m.match(nNe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:p}});r.localize.preprocessor&&(l=r.localize.preprocessor(a,l));const c={firstWeekContainsDate:i,weekStartsOn:o,locale:r};return l.map(p=>{if(!p.isToken)return p.value;const m=p.value;(XTe(m)||KTe(m))&&YTe(m,e,String(t));const y=x_[m[0]];return y(a,m,r.localize,c)}).join("")}function rNe(t){const e=t.match(eNe);return e?e[1].replace(tNe,"'"):t}const dT=M.createContext({});function hT(t){const e=M.useRef(null);return e.current===null&&(e.current=t()),e.current}const tv=M.createContext(null),fT=M.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class iNe extends M.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=n.offsetHeight||0,s.width=n.offsetWidth||0,s.top=n.offsetTop,s.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function oNe({children:t,isPresent:e}){const n=M.useId(),s=M.useRef(null),r=M.useRef({width:0,height:0,top:0,left:0}),{nonce:i}=M.useContext(fT);return M.useInsertionEffect(()=>{const{width:o,height:a,top:l,left:c}=r.current;if(e||!s.current||!o||!a)return;s.current.dataset.motionPopId=n;const u=document.createElement("style");return i&&(u.nonce=i),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),w.jsx(iNe,{isPresent:e,childRef:s,sizeRef:r,children:M.cloneElement(t,{ref:s})})}const aNe=({children:t,initial:e,isPresent:n,onExitComplete:s,custom:r,presenceAffectsLayout:i,mode:o})=>{const a=hT(lNe),l=M.useId(),c=M.useCallback(d=>{a.set(d,!0);for(const h of a.values())if(!h)return;s&&s()},[a,s]),u=M.useMemo(()=>({id:l,initial:e,isPresent:n,custom:r,onExitComplete:c,register:d=>(a.set(d,!1),()=>a.delete(d))}),i?[Math.random(),c]:[n,c]);return M.useMemo(()=>{a.forEach((d,h)=>a.set(h,!1))},[n]),M.useEffect(()=>{!n&&!a.size&&s&&s()},[n]),o==="popLayout"&&(t=w.jsx(oNe,{isPresent:n,children:t})),w.jsx(tv.Provider,{value:u,children:t})};function lNe(){return new Map}function Pz(t=!0){const e=M.useContext(tv);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:s,register:r}=e,i=M.useId();M.useEffect(()=>{t&&r(i)},[t]);const o=M.useCallback(()=>t&&s&&s(i),[i,s,t]);return!n&&s?[!1,o]:[!0]}const Pm=t=>t.key||"";function k_(t){const e=[];return M.Children.forEach(t,n=>{M.isValidElement(n)&&e.push(n)}),e}const pT=typeof window<"u",Oz=pT?M.useLayoutEffect:M.useEffect,cNe=({children:t,custom:e,initial:n=!0,onExitComplete:s,presenceAffectsLayout:r=!0,mode:i="sync",propagate:o=!1})=>{const[a,l]=Pz(o),c=M.useMemo(()=>k_(t),[t]),u=o&&!a?[]:c.map(Pm),d=M.useRef(!0),h=M.useRef(c),f=hT(()=>new Map),[p,m]=M.useState(c),[y,g]=M.useState(c);Oz(()=>{d.current=!1,h.current=c;for(let b=0;b<y.length;b++){const k=Pm(y[b]);u.includes(k)?f.delete(k):f.get(k)!==!0&&f.set(k,!1)}},[y,u.length,u.join("-")]);const x=[];if(c!==p){let b=[...c];for(let k=0;k<y.length;k++){const C=y[k],S=Pm(C);u.includes(S)||(b.splice(k,0,C),x.push(C))}i==="wait"&&x.length&&(b=x),g(k_(b)),m(c);return}const{forceRender:v}=M.useContext(dT);return w.jsx(w.Fragment,{children:y.map(b=>{const k=Pm(b),C=o&&!a?!1:c===y||u.includes(k),S=()=>{if(f.has(k))f.set(k,!0);else return;let I=!0;f.forEach(N=>{N||(I=!1)}),I&&(v==null||v(),g(h.current),o&&(l==null||l()),s&&s())};return w.jsx(aNe,{isPresent:C,initial:!d.current||n?void 0:!1,custom:C?void 0:e,presenceAffectsLayout:r,mode:i,onExitComplete:C?void 0:S,children:b},k)})})},Ws=t=>t;let Fz=Ws;function mT(t){let e;return()=>(e===void 0&&(e=t()),e)}const Ru=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s},Ji=t=>t*1e3,Qi=t=>t/1e3,uNe={useManualTiming:!1};function dNe(t){let e=new Set,n=new Set,s=!1,r=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(c){i.has(c)&&(l.schedule(c),t()),c(o)}const l={schedule:(c,u=!1,d=!1)=>{const f=d&&s?e:n;return u&&i.add(c),f.has(c)||f.add(c),c},cancel:c=>{n.delete(c),i.delete(c)},process:c=>{if(o=c,s){r=!0;return}s=!0,[e,n]=[n,e],e.forEach(a),e.clear(),s=!1,r&&(r=!1,l.process(c))}};return l}const Om=["read","resolveKeyframes","update","preRender","render","postRender"],hNe=40;function Mz(t,e){let n=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,o=Om.reduce((g,x)=>(g[x]=dNe(i),g),{}),{read:a,resolveKeyframes:l,update:c,preRender:u,render:d,postRender:h}=o,f=()=>{const g=performance.now();n=!1,r.delta=s?1e3/60:Math.max(Math.min(g-r.timestamp,hNe),1),r.timestamp=g,r.isProcessing=!0,a.process(r),l.process(r),c.process(r),u.process(r),d.process(r),h.process(r),r.isProcessing=!1,n&&e&&(s=!1,t(f))},p=()=>{n=!0,s=!0,r.isProcessing||t(f)};return{schedule:Om.reduce((g,x)=>{const v=o[x];return g[x]=(b,k=!1,C=!1)=>(n||p(),v.schedule(b,k,C)),g},{}),cancel:g=>{for(let x=0;x<Om.length;x++)o[Om[x]].cancel(g)},state:r,steps:o}}const{schedule:Ot,cancel:Ca,state:Dn,steps:xb}=Mz(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ws,!0),Lz=M.createContext({strict:!1}),C_={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Du={};for(const t in C_)Du[t]={isEnabled:e=>C_[t].some(n=>!!e[n])};function fNe(t){for(const e in t)Du[e]={...Du[e],...t[e]}}const pNe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Oy(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||pNe.has(t)}let Vz=t=>!Oy(t);function mNe(t){t&&(Vz=e=>e.startsWith("on")?!Oy(e):t(e))}try{mNe(require("@emotion/is-prop-valid").default)}catch{}function gNe(t,e,n){const s={};for(const r in t)r==="values"&&typeof t.values=="object"||(Vz(r)||n===!0&&Oy(r)||!e&&!Oy(r)||t.draggable&&r.startsWith("onDrag"))&&(s[r]=t[r]);return s}function yNe(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...s)=>t(...s);return new Proxy(n,{get:(s,r)=>r==="create"?t:(e.has(r)||e.set(r,t(r)),e.get(r))})}const nv=M.createContext({});function cf(t){return typeof t=="string"||Array.isArray(t)}function sv(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const gT=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],yT=["initial",...gT];function rv(t){return sv(t.animate)||yT.some(e=>cf(t[e]))}function Bz(t){return!!(rv(t)||t.variants)}function xNe(t,e){if(rv(t)){const{initial:n,animate:s}=t;return{initial:n===!1||cf(n)?n:void 0,animate:cf(s)?s:void 0}}return t.inherit!==!1?e:{}}function vNe(t){const{initial:e,animate:n}=xNe(t,M.useContext(nv));return M.useMemo(()=>({initial:e,animate:n}),[S_(e),S_(n)])}function S_(t){return Array.isArray(t)?t.join(" "):t}const bNe=Symbol.for("motionComponentSymbol");function Bc(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function wNe(t,e,n){return M.useCallback(s=>{s&&t.onMount&&t.onMount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):Bc(n)&&(n.current=s))},[e])}const xT=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),kNe="framerAppearId",zz="data-"+xT(kNe),{schedule:vT}=Mz(queueMicrotask,!1),Uz=M.createContext({});function CNe(t,e,n,s,r){var i,o;const{visualElement:a}=M.useContext(nv),l=M.useContext(Lz),c=M.useContext(tv),u=M.useContext(fT).reducedMotion,d=M.useRef(null);s=s||l.renderer,!d.current&&s&&(d.current=s(t,{visualState:e,parent:a,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const h=d.current,f=M.useContext(Uz);h&&!h.projection&&r&&(h.type==="html"||h.type==="svg")&&SNe(d.current,n,r,f);const p=M.useRef(!1);M.useInsertionEffect(()=>{h&&p.current&&h.update(n,c)});const m=n[zz],y=M.useRef(!!m&&!(!((i=window.MotionHandoffIsComplete)===null||i===void 0)&&i.call(window,m))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,m)));return Oz(()=>{h&&(p.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),vT.render(h.render),y.current&&h.animationState&&h.animationState.animateChanges())}),M.useEffect(()=>{h&&(!y.current&&h.animationState&&h.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var g;(g=window.MotionHandoffMarkAsComplete)===null||g===void 0||g.call(window,m)}),y.current=!1))}),h}function SNe(t,e,n,s){const{layoutId:r,layout:i,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:jz(t.parent)),t.projection.setOptions({layoutId:r,layout:i,alwaysMeasureLayout:!!o||a&&Bc(a),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:s,layoutScroll:l,layoutRoot:c})}function jz(t){if(t)return t.options.allowProjection!==!1?t.projection:jz(t.parent)}function INe({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:s,Component:r}){var i,o;t&&fNe(t);function a(c,u){let d;const h={...M.useContext(fT),...c,layoutId:TNe(c)},{isStatic:f}=h,p=vNe(c),m=s(c,f);if(!f&&pT){NNe();const y=ENe(h);d=y.MeasureLayout,p.visualElement=CNe(r,m,h,e,y.ProjectionNode)}return w.jsxs(nv.Provider,{value:p,children:[d&&p.visualElement?w.jsx(d,{visualElement:p.visualElement,...h}):null,n(r,c,wNe(m,p.visualElement,u),m,f,p.visualElement)]})}a.displayName=`motion.${typeof r=="string"?r:`create(${(o=(i=r.displayName)!==null&&i!==void 0?i:r.name)!==null&&o!==void 0?o:""})`}`;const l=M.forwardRef(a);return l[bNe]=r,l}function TNe({layoutId:t}){const e=M.useContext(dT).id;return e&&t!==void 0?e+"-"+t:t}function NNe(t,e){M.useContext(Lz).strict}function ENe(t){const{drag:e,layout:n}=Du;if(!e&&!n)return{};const s={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}const $Ne=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function bT(t){return typeof t!="string"||t.includes("-")?!1:!!($Ne.indexOf(t)>-1||/[A-Z]/u.test(t))}function I_(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function wT(t,e,n,s){if(typeof e=="function"){const[r,i]=I_(s);e=e(n!==void 0?n:t.custom,r,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[r,i]=I_(s);e=e(n!==void 0?n:t.custom,r,i)}return e}const R1=t=>Array.isArray(t),_Ne=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),ANe=t=>R1(t)?t[t.length-1]||0:t,Qn=t=>!!(t&&t.getVelocity);function lg(t){const e=Qn(t)?t.get():t;return _Ne(e)?e.toValue():e}function RNe({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:n},s,r,i){const o={latestValues:DNe(s,r,i,t),renderState:e()};return n&&(o.onMount=a=>n({props:s,current:a,...o}),o.onUpdate=a=>n(a)),o}const Wz=t=>(e,n)=>{const s=M.useContext(nv),r=M.useContext(tv),i=()=>RNe(t,e,s,r);return n?i():hT(i)};function DNe(t,e,n,s){const r={},i=s(t,{});for(const h in i)r[h]=lg(i[h]);let{initial:o,animate:a}=t;const l=rv(t),c=Bz(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const d=u?a:o;if(d&&typeof d!="boolean"&&!sv(d)){const h=Array.isArray(d)?d:[d];for(let f=0;f<h.length;f++){const p=wT(t,h[f]);if(p){const{transitionEnd:m,transition:y,...g}=p;for(const x in g){let v=g[x];if(Array.isArray(v)){const b=u?v.length-1:0;v=v[b]}v!==null&&(r[x]=v)}for(const x in m)r[x]=m[x]}}}return r}const cd=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],pc=new Set(cd),Gz=t=>e=>typeof e=="string"&&e.startsWith(t),Hz=Gz("--"),PNe=Gz("var(--"),kT=t=>PNe(t)?ONe.test(t.split("/*")[0].trim()):!1,ONe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,qz=(t,e)=>e&&typeof t=="number"?e.transform(t):t,mo=(t,e,n)=>n>e?e:n<t?t:n,ud={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},uf={...ud,transform:t=>mo(0,1,t)},Fm={...ud,default:1},Yp=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Ao=Yp("deg"),Ci=Yp("%"),Re=Yp("px"),FNe=Yp("vh"),MNe=Yp("vw"),T_={...Ci,parse:t=>Ci.parse(t)/100,transform:t=>Ci.transform(t*100)},LNe={borderWidth:Re,borderTopWidth:Re,borderRightWidth:Re,borderBottomWidth:Re,borderLeftWidth:Re,borderRadius:Re,radius:Re,borderTopLeftRadius:Re,borderTopRightRadius:Re,borderBottomRightRadius:Re,borderBottomLeftRadius:Re,width:Re,maxWidth:Re,height:Re,maxHeight:Re,top:Re,right:Re,bottom:Re,left:Re,padding:Re,paddingTop:Re,paddingRight:Re,paddingBottom:Re,paddingLeft:Re,margin:Re,marginTop:Re,marginRight:Re,marginBottom:Re,marginLeft:Re,backgroundPositionX:Re,backgroundPositionY:Re},VNe={rotate:Ao,rotateX:Ao,rotateY:Ao,rotateZ:Ao,scale:Fm,scaleX:Fm,scaleY:Fm,scaleZ:Fm,skew:Ao,skewX:Ao,skewY:Ao,distance:Re,translateX:Re,translateY:Re,translateZ:Re,x:Re,y:Re,z:Re,perspective:Re,transformPerspective:Re,opacity:uf,originX:T_,originY:T_,originZ:Re},N_={...ud,transform:Math.round},CT={...LNe,...VNe,zIndex:N_,size:Re,fillOpacity:uf,strokeOpacity:uf,numOctaves:N_},BNe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},zNe=cd.length;function UNe(t,e,n){let s="",r=!0;for(let i=0;i<zNe;i++){const o=cd[i],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const c=qz(a,CT[o]);if(!l){r=!1;const u=BNe[o]||o;s+=`${u}(${c}) `}n&&(e[o]=c)}}return s=s.trim(),n?s=n(e,r?"":s):r&&(s="none"),s}function ST(t,e,n){const{style:s,vars:r,transformOrigin:i}=t;let o=!1,a=!1;for(const l in e){const c=e[l];if(pc.has(l)){o=!0;continue}else if(Hz(l)){r[l]=c;continue}else{const u=qz(c,CT[l]);l.startsWith("origin")?(a=!0,i[l]=u):s[l]=u}}if(e.transform||(o||n?s.transform=UNe(e,t.transform,n):s.transform&&(s.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;s.transformOrigin=`${l} ${c} ${u}`}}const jNe={offset:"stroke-dashoffset",array:"stroke-dasharray"},WNe={offset:"strokeDashoffset",array:"strokeDasharray"};function GNe(t,e,n=1,s=0,r=!0){t.pathLength=1;const i=r?jNe:WNe;t[i.offset]=Re.transform(-s);const o=Re.transform(e),a=Re.transform(n);t[i.array]=`${o} ${a}`}function E_(t,e,n){return typeof t=="string"?t:Re.transform(e+n*t)}function HNe(t,e,n){const s=E_(e,t.x,t.width),r=E_(n,t.y,t.height);return`${s} ${r}`}function IT(t,{attrX:e,attrY:n,attrScale:s,originX:r,originY:i,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},u,d){if(ST(t,c,d),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:h,style:f,dimensions:p}=t;h.transform&&(p&&(f.transform=h.transform),delete h.transform),p&&(r!==void 0||i!==void 0||f.transform)&&(f.transformOrigin=HNe(p,r!==void 0?r:.5,i!==void 0?i:.5)),e!==void 0&&(h.x=e),n!==void 0&&(h.y=n),s!==void 0&&(h.scale=s),o!==void 0&&GNe(h,o,a,l,!1)}const TT=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Kz=()=>({...TT(),attrs:{}}),NT=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Xz(t,{style:e,vars:n},s,r){Object.assign(t.style,e,r&&r.getProjectionStyles(s));for(const i in n)t.style.setProperty(i,n[i])}const Yz=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Zz(t,e,n,s){Xz(t,e,void 0,s);for(const r in e.attrs)t.setAttribute(Yz.has(r)?r:xT(r),e.attrs[r])}const Fy={};function qNe(t){Object.assign(Fy,t)}function Jz(t,{layout:e,layoutId:n}){return pc.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Fy[t]||t==="opacity")}function ET(t,e,n){var s;const{style:r}=t,i={};for(const o in r)(Qn(r[o])||e.style&&Qn(e.style[o])||Jz(o,t)||((s=n==null?void 0:n.getValue(o))===null||s===void 0?void 0:s.liveStyle)!==void 0)&&(i[o]=r[o]);return i}function Qz(t,e,n){const s=ET(t,e,n);for(const r in t)if(Qn(t[r])||Qn(e[r])){const i=cd.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;s[i]=t[r]}return s}function KNe(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const $_=["x","y","width","height","cx","cy","r"],XNe={useVisualState:Wz({scrapeMotionValuesFromProps:Qz,createRenderState:Kz,onUpdate:({props:t,prevProps:e,current:n,renderState:s,latestValues:r})=>{if(!n)return;let i=!!t.drag;if(!i){for(const a in r)if(pc.has(a)){i=!0;break}}if(!i)return;let o=!e;if(e)for(let a=0;a<$_.length;a++){const l=$_[a];t[l]!==e[l]&&(o=!0)}o&&Ot.read(()=>{KNe(n,s),Ot.render(()=>{IT(s,r,NT(n.tagName),t.transformTemplate),Zz(n,s)})})}})},YNe={useVisualState:Wz({scrapeMotionValuesFromProps:ET,createRenderState:TT})};function eU(t,e,n){for(const s in e)!Qn(e[s])&&!Jz(s,n)&&(t[s]=e[s])}function ZNe({transformTemplate:t},e){return M.useMemo(()=>{const n=TT();return ST(n,e,t),Object.assign({},n.vars,n.style)},[e])}function JNe(t,e){const n=t.style||{},s={};return eU(s,n,t),Object.assign(s,ZNe(t,e)),s}function QNe(t,e){const n={},s=JNe(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=s,n}function e2e(t,e,n,s){const r=M.useMemo(()=>{const i=Kz();return IT(i,e,NT(s),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};eU(i,t.style,t),r.style={...i,...r.style}}return r}function t2e(t=!1){return(n,s,r,{latestValues:i},o)=>{const l=(bT(n)?e2e:QNe)(s,i,o,n),c=gNe(s,typeof n=="string",t),u=n!==M.Fragment?{...c,...l,ref:r}:{},{children:d}=s,h=M.useMemo(()=>Qn(d)?d.get():d,[d]);return M.createElement(n,{...u,children:h})}}function n2e(t,e){return function(s,{forwardMotionProps:r}={forwardMotionProps:!1}){const o={...bT(s)?XNe:YNe,preloadedFeatures:t,useRender:t2e(r),createVisualElement:e,Component:s};return INe(o)}}function tU(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}function iv(t,e,n){const s=t.getProps();return wT(s,e,n!==void 0?n:s.custom,t)}const s2e=mT(()=>window.ScrollTimeline!==void 0);class r2e{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let s=0;s<this.animations.length;s++)this.animations[s][e]=n}attachTimeline(e,n){const s=this.animations.map(r=>{if(s2e()&&r.attachTimeline)return r.attachTimeline(e);if(typeof n=="function")return n(r)});return()=>{s.forEach((r,i)=>{r&&r(),this.animations[i].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class i2e extends r2e{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function $T(t,e){return t?t[e]||t.default||t:void 0}const D1=2e4;function nU(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<D1;)e+=n,s=t.next(e);return e>=D1?1/0:e}function _T(t){return typeof t=="function"}function __(t,e){t.timeline=e,t.onfinish=null}const AT=t=>Array.isArray(t)&&typeof t[0]=="number",o2e={linearEasing:void 0};function a2e(t,e){const n=mT(t);return()=>{var s;return(s=o2e[e])!==null&&s!==void 0?s:n()}}const My=a2e(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),sU=(t,e,n=10)=>{let s="";const r=Math.max(Math.round(e/n),2);for(let i=0;i<r;i++)s+=t(Ru(0,r-1,i))+", ";return`linear(${s.substring(0,s.length-2)})`};function rU(t){return!!(typeof t=="function"&&My()||!t||typeof t=="string"&&(t in P1||My())||AT(t)||Array.isArray(t)&&t.every(rU))}const Wd=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,P1={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Wd([0,.65,.55,1]),circOut:Wd([.55,0,1,.45]),backIn:Wd([.31,.01,.66,-.59]),backOut:Wd([.33,1.53,.69,.99])};function iU(t,e){if(t)return typeof t=="function"&&My()?sU(t,e):AT(t)?Wd(t):Array.isArray(t)?t.map(n=>iU(n,e)||P1.easeOut):P1[t]}const Nr={x:!1,y:!1};function oU(){return Nr.x||Nr.y}function l2e(t,e,n){var s;if(t instanceof Element)return[t];if(typeof t=="string"){let r=document;const i=(s=void 0)!==null&&s!==void 0?s:r.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}function aU(t,e){const n=l2e(t),s=new AbortController,r={passive:!0,...e,signal:s.signal};return[n,r,()=>s.abort()]}function A_(t){return e=>{e.pointerType==="touch"||oU()||t(e)}}function c2e(t,e,n={}){const[s,r,i]=aU(t,n),o=A_(a=>{const{target:l}=a,c=e(a);if(typeof c!="function"||!l)return;const u=A_(d=>{c(d),l.removeEventListener("pointerleave",u)});l.addEventListener("pointerleave",u,r)});return s.forEach(a=>{a.addEventListener("pointerenter",o,r)}),i}const lU=(t,e)=>e?t===e?!0:lU(t,e.parentElement):!1,RT=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,u2e=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function d2e(t){return u2e.has(t.tagName)||t.tabIndex!==-1}const Gd=new WeakSet;function R_(t){return e=>{e.key==="Enter"&&t(e)}}function vb(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const h2e=(t,e)=>{const n=t.currentTarget;if(!n)return;const s=R_(()=>{if(Gd.has(n))return;vb(n,"down");const r=R_(()=>{vb(n,"up")}),i=()=>vb(n,"cancel");n.addEventListener("keyup",r,e),n.addEventListener("blur",i,e)});n.addEventListener("keydown",s,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",s),e)};function D_(t){return RT(t)&&!oU()}function f2e(t,e,n={}){const[s,r,i]=aU(t,n),o=a=>{const l=a.currentTarget;if(!D_(a)||Gd.has(l))return;Gd.add(l);const c=e(a),u=(f,p)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),!(!D_(f)||!Gd.has(l))&&(Gd.delete(l),typeof c=="function"&&c(f,{success:p}))},d=f=>{u(f,n.useGlobalTarget||lU(l,f.target))},h=f=>{u(f,!1)};window.addEventListener("pointerup",d,r),window.addEventListener("pointercancel",h,r)};return s.forEach(a=>{!d2e(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(n.useGlobalTarget?window:a).addEventListener("pointerdown",o,r),a.addEventListener("focus",c=>h2e(c,r),r)}),i}function p2e(t){return t==="x"||t==="y"?Nr[t]?null:(Nr[t]=!0,()=>{Nr[t]=!1}):Nr.x||Nr.y?null:(Nr.x=Nr.y=!0,()=>{Nr.x=Nr.y=!1})}const cU=new Set(["width","height","top","left","right","bottom",...cd]);let cg;function m2e(){cg=void 0}const Si={now:()=>(cg===void 0&&Si.set(Dn.isProcessing||uNe.useManualTiming?Dn.timestamp:performance.now()),cg),set:t=>{cg=t,queueMicrotask(m2e)}};function DT(t,e){t.indexOf(e)===-1&&t.push(e)}function PT(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class OT{constructor(){this.subscriptions=[]}add(e){return DT(this.subscriptions,e),()=>PT(this.subscriptions,e)}notify(e,n,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,n,s);else for(let i=0;i<r;i++){const o=this.subscriptions[i];o&&o(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function uU(t,e){return e?t*(1e3/e):0}const P_=30,g2e=t=>!isNaN(parseFloat(t));class y2e{constructor(e,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,r=!0)=>{const i=Si.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Si.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=g2e(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new OT);const s=this.events[e].add(n);return e==="change"?()=>{s(),Ot.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Si.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>P_)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,P_);return uU(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function df(t,e){return new y2e(t,e)}function x2e(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,df(n))}function v2e(t,e){const n=iv(t,e);let{transitionEnd:s={},transition:r={},...i}=n||{};i={...i,...s};for(const o in i){const a=ANe(i[o]);x2e(t,o,a)}}function b2e(t){return!!(Qn(t)&&t.add)}function O1(t,e){const n=t.getValue("willChange");if(b2e(n))return n.add(e)}function dU(t){return t.props[zz]}const hU=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,w2e=1e-7,k2e=12;function C2e(t,e,n,s,r){let i,o,a=0;do o=e+(n-e)/2,i=hU(o,s,r)-t,i>0?n=o:e=o;while(Math.abs(i)>w2e&&++a<k2e);return o}function Zp(t,e,n,s){if(t===e&&n===s)return Ws;const r=i=>C2e(i,0,1,t,n);return i=>i===0||i===1?i:hU(r(i),e,s)}const fU=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,pU=t=>e=>1-t(1-e),mU=Zp(.33,1.53,.69,.99),FT=pU(mU),gU=fU(FT),yU=t=>(t*=2)<1?.5*FT(t):.5*(2-Math.pow(2,-10*(t-1))),MT=t=>1-Math.sin(Math.acos(t)),xU=pU(MT),vU=fU(MT),bU=t=>/^0[^.\s]+$/u.test(t);function S2e(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||bU(t):!0}const uh=t=>Math.round(t*1e5)/1e5,LT=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function I2e(t){return t==null}const T2e=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,VT=(t,e)=>n=>!!(typeof n=="string"&&T2e.test(n)&&n.startsWith(t)||e&&!I2e(n)&&Object.prototype.hasOwnProperty.call(n,e)),wU=(t,e,n)=>s=>{if(typeof s!="string")return s;const[r,i,o,a]=s.match(LT);return{[t]:parseFloat(r),[e]:parseFloat(i),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},N2e=t=>mo(0,255,t),bb={...ud,transform:t=>Math.round(N2e(t))},fl={test:VT("rgb","red"),parse:wU("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+bb.transform(t)+", "+bb.transform(e)+", "+bb.transform(n)+", "+uh(uf.transform(s))+")"};function E2e(t){let e="",n="",s="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,s+=s,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const F1={test:VT("#"),parse:E2e,transform:fl.transform},zc={test:VT("hsl","hue"),parse:wU("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+Ci.transform(uh(e))+", "+Ci.transform(uh(n))+", "+uh(uf.transform(s))+")"},qn={test:t=>fl.test(t)||F1.test(t)||zc.test(t),parse:t=>fl.test(t)?fl.parse(t):zc.test(t)?zc.parse(t):F1.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?fl.transform(t):zc.transform(t)},$2e=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function _2e(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(LT))===null||e===void 0?void 0:e.length)||0)+(((n=t.match($2e))===null||n===void 0?void 0:n.length)||0)>0}const kU="number",CU="color",A2e="var",R2e="var(",O_="${}",D2e=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function hf(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},r=[];let i=0;const a=e.replace(D2e,l=>(qn.test(l)?(s.color.push(i),r.push(CU),n.push(qn.parse(l))):l.startsWith(R2e)?(s.var.push(i),r.push(A2e),n.push(l)):(s.number.push(i),r.push(kU),n.push(parseFloat(l))),++i,O_)).split(O_);return{values:n,split:a,indexes:s,types:r}}function SU(t){return hf(t).values}function IU(t){const{split:e,types:n}=hf(t),s=e.length;return r=>{let i="";for(let o=0;o<s;o++)if(i+=e[o],r[o]!==void 0){const a=n[o];a===kU?i+=uh(r[o]):a===CU?i+=qn.transform(r[o]):i+=r[o]}return i}}const P2e=t=>typeof t=="number"?0:t;function O2e(t){const e=SU(t);return IU(t)(e.map(P2e))}const Sa={test:_2e,parse:SU,createTransformer:IU,getAnimatableNone:O2e},F2e=new Set(["brightness","contrast","saturate","opacity"]);function M2e(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(LT)||[];if(!s)return t;const r=n.replace(s,"");let i=F2e.has(e)?1:0;return s!==n&&(i*=100),e+"("+i+r+")"}const L2e=/\b([a-z-]*)\(.*?\)/gu,M1={...Sa,getAnimatableNone:t=>{const e=t.match(L2e);return e?e.map(M2e).join(" "):t}},V2e={...CT,color:qn,backgroundColor:qn,outlineColor:qn,fill:qn,stroke:qn,borderColor:qn,borderTopColor:qn,borderRightColor:qn,borderBottomColor:qn,borderLeftColor:qn,filter:M1,WebkitFilter:M1},BT=t=>V2e[t];function TU(t,e){let n=BT(t);return n!==M1&&(n=Sa),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const B2e=new Set(["auto","none","0"]);function z2e(t,e,n){let s=0,r;for(;s<t.length&&!r;){const i=t[s];typeof i=="string"&&!B2e.has(i)&&hf(i).values.length&&(r=t[s]),s++}if(r&&n)for(const i of e)t[i]=TU(n,r)}const F_=t=>t===ud||t===Re,M_=(t,e)=>parseFloat(t.split(", ")[e]),L_=(t,e)=>(n,{transform:s})=>{if(s==="none"||!s)return 0;const r=s.match(/^matrix3d\((.+)\)$/u);if(r)return M_(r[1],e);{const i=s.match(/^matrix\((.+)\)$/u);return i?M_(i[1],t):0}},U2e=new Set(["x","y","z"]),j2e=cd.filter(t=>!U2e.has(t));function W2e(t){const e=[];return j2e.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const Pu={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:L_(4,13),y:L_(5,14)};Pu.translateX=Pu.x;Pu.translateY=Pu.y;const wl=new Set;let L1=!1,V1=!1;function NU(){if(V1){const t=Array.from(wl).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const r=W2e(s);r.length&&(n.set(s,r),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const r=n.get(s);r&&r.forEach(([i,o])=>{var a;(a=s.getValue(i))===null||a===void 0||a.set(o)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}V1=!1,L1=!1,wl.forEach(t=>t.complete()),wl.clear()}function EU(){wl.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(V1=!0)})}function G2e(){EU(),NU()}class zT{constructor(e,n,s,r,i,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=r,this.element=i,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(wl.add(this),L1||(L1=!0,Ot.read(EU),Ot.resolveKeyframes(NU))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:r}=this;for(let i=0;i<e.length;i++)if(e[i]===null)if(i===0){const o=r==null?void 0:r.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(s&&n){const l=s.readValue(n,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),r&&o===void 0&&r.set(e[0])}else e[i]=e[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),wl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,wl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const $U=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),H2e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function q2e(t){const e=H2e.exec(t);if(!e)return[,];const[,n,s,r]=e;return[`--${n??s}`,r]}function _U(t,e,n=1){const[s,r]=q2e(t);if(!s)return;const i=window.getComputedStyle(e).getPropertyValue(s);if(i){const o=i.trim();return $U(o)?parseFloat(o):o}return kT(r)?_U(r,e,n+1):r}const AU=t=>e=>e.test(t),K2e={test:t=>t==="auto",parse:t=>t},RU=[ud,Re,Ci,Ao,MNe,FNe,K2e],V_=t=>RU.find(AU(t));class DU extends zT{constructor(e,n,s,r,i){super(e,n,s,r,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),kT(c))){const u=_U(c,n.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!cU.has(s)||e.length!==2)return;const[r,i]=e,o=V_(r),a=V_(i);if(o!==a)if(F_(o)&&F_(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let r=0;r<e.length;r++)S2e(e[r])&&s.push(r);s.length&&z2e(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Pu[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&e.getValue(s,r).jump(r,!1)}measureEndState(){var e;const{element:n,name:s,unresolvedKeyframes:r}=this;if(!n||!n.current)return;const i=n.getValue(s);i&&i.jump(this.measuredOrigin,!1);const o=r.length-1,a=r[o];r[o]=Pu[s](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{n.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const B_=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Sa.test(t)||t==="0")&&!t.startsWith("url("));function X2e(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function Y2e(t,e,n,s){const r=t[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],o=B_(r,e),a=B_(i,e);return!o||!a?!1:X2e(t)||(n==="spring"||_T(n))&&s}const Z2e=t=>t!==null;function ov(t,{repeat:e,repeatType:n="loop"},s){const r=t.filter(Z2e),i=e&&n!=="loop"&&e%2===1?0:r.length-1;return!i||s===void 0?r[i]:s}const J2e=40;class PU{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Si.now(),this.options={autoplay:e,delay:n,type:s,repeat:r,repeatDelay:i,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>J2e?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&G2e(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=Si.now(),this.hasAttemptedResolve=!0;const{name:s,type:r,velocity:i,delay:o,onComplete:a,onUpdate:l,isGenerator:c}=this.options;if(!c&&!Y2e(e,s,r,i))if(o)this.options.duration=0;else{l&&l(ov(e,this.options,n)),a&&a(),this.resolveFinishedPromise();return}const u=this.initPlayback(e,n);u!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...u},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Ut=(t,e,n)=>t+(e-t)*n;function wb(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Q2e({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let r=0,i=0,o=0;if(!e)r=i=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=wb(l,a,t+1/3),i=wb(l,a,t),o=wb(l,a,t-1/3)}return{red:Math.round(r*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:s}}function Ly(t,e){return n=>n>0?e:t}const kb=(t,e,n)=>{const s=t*t,r=n*(e*e-s)+s;return r<0?0:Math.sqrt(r)},eEe=[F1,fl,zc],tEe=t=>eEe.find(e=>e.test(t));function z_(t){const e=tEe(t);if(!e)return!1;let n=e.parse(t);return e===zc&&(n=Q2e(n)),n}const U_=(t,e)=>{const n=z_(t),s=z_(e);if(!n||!s)return Ly(t,e);const r={...n};return i=>(r.red=kb(n.red,s.red,i),r.green=kb(n.green,s.green,i),r.blue=kb(n.blue,s.blue,i),r.alpha=Ut(n.alpha,s.alpha,i),fl.transform(r))},nEe=(t,e)=>n=>e(t(n)),Jp=(...t)=>t.reduce(nEe),B1=new Set(["none","hidden"]);function sEe(t,e){return B1.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function rEe(t,e){return n=>Ut(t,e,n)}function UT(t){return typeof t=="number"?rEe:typeof t=="string"?kT(t)?Ly:qn.test(t)?U_:aEe:Array.isArray(t)?OU:typeof t=="object"?qn.test(t)?U_:iEe:Ly}function OU(t,e){const n=[...t],s=n.length,r=t.map((i,o)=>UT(i)(i,e[o]));return i=>{for(let o=0;o<s;o++)n[o]=r[o](i);return n}}function iEe(t,e){const n={...t,...e},s={};for(const r in n)t[r]!==void 0&&e[r]!==void 0&&(s[r]=UT(t[r])(t[r],e[r]));return r=>{for(const i in s)n[i]=s[i](r);return n}}function oEe(t,e){var n;const s=[],r={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const o=e.types[i],a=t.indexes[o][r[o]],l=(n=t.values[a])!==null&&n!==void 0?n:0;s[i]=l,r[o]++}return s}const aEe=(t,e)=>{const n=Sa.createTransformer(e),s=hf(t),r=hf(e);return s.indexes.var.length===r.indexes.var.length&&s.indexes.color.length===r.indexes.color.length&&s.indexes.number.length>=r.indexes.number.length?B1.has(t)&&!r.values.length||B1.has(e)&&!s.values.length?sEe(t,e):Jp(OU(oEe(s,r),r.values),n):Ly(t,e)};function FU(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Ut(t,e,n):UT(t)(t,e)}const lEe=5;function MU(t,e,n){const s=Math.max(e-lEe,0);return uU(n-t(s),e-s)}const Gt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},j_=.001;function cEe({duration:t=Gt.duration,bounce:e=Gt.bounce,velocity:n=Gt.velocity,mass:s=Gt.mass}){let r,i,o=1-e;o=mo(Gt.minDamping,Gt.maxDamping,o),t=mo(Gt.minDuration,Gt.maxDuration,Qi(t)),o<1?(r=c=>{const u=c*o,d=u*t,h=u-n,f=z1(c,o),p=Math.exp(-d);return j_-h/f*p},i=c=>{const d=c*o*t,h=d*n+n,f=Math.pow(o,2)*Math.pow(c,2)*t,p=Math.exp(-d),m=z1(Math.pow(c,2),o);return(-r(c)+j_>0?-1:1)*((h-f)*p)/m}):(r=c=>{const u=Math.exp(-c*t),d=(c-n)*t+1;return-.001+u*d},i=c=>{const u=Math.exp(-c*t),d=(n-c)*(t*t);return u*d});const a=5/t,l=dEe(r,i,a);if(t=Ji(t),isNaN(l))return{stiffness:Gt.stiffness,damping:Gt.damping,duration:t};{const c=Math.pow(l,2)*s;return{stiffness:c,damping:o*2*Math.sqrt(s*c),duration:t}}}const uEe=12;function dEe(t,e,n){let s=n;for(let r=1;r<uEe;r++)s=s-t(s)/e(s);return s}function z1(t,e){return t*Math.sqrt(1-e*e)}const hEe=["duration","bounce"],fEe=["stiffness","damping","mass"];function W_(t,e){return e.some(n=>t[n]!==void 0)}function pEe(t){let e={velocity:Gt.velocity,stiffness:Gt.stiffness,damping:Gt.damping,mass:Gt.mass,isResolvedFromDuration:!1,...t};if(!W_(t,fEe)&&W_(t,hEe))if(t.visualDuration){const n=t.visualDuration,s=2*Math.PI/(n*1.2),r=s*s,i=2*mo(.05,1,1-(t.bounce||0))*Math.sqrt(r);e={...e,mass:Gt.mass,stiffness:r,damping:i}}else{const n=cEe(t);e={...e,...n,mass:Gt.mass},e.isResolvedFromDuration=!0}return e}function LU(t=Gt.visualDuration,e=Gt.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:s,restDelta:r}=n;const i=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:f}=pEe({...n,velocity:-Qi(n.velocity||0)}),p=h||0,m=c/(2*Math.sqrt(l*u)),y=o-i,g=Qi(Math.sqrt(l/u)),x=Math.abs(y)<5;s||(s=x?Gt.restSpeed.granular:Gt.restSpeed.default),r||(r=x?Gt.restDelta.granular:Gt.restDelta.default);let v;if(m<1){const k=z1(g,m);v=C=>{const S=Math.exp(-m*g*C);return o-S*((p+m*g*y)/k*Math.sin(k*C)+y*Math.cos(k*C))}}else if(m===1)v=k=>o-Math.exp(-g*k)*(y+(p+g*y)*k);else{const k=g*Math.sqrt(m*m-1);v=C=>{const S=Math.exp(-m*g*C),I=Math.min(k*C,300);return o-S*((p+m*g*y)*Math.sinh(I)+k*y*Math.cosh(I))/k}}const b={calculatedDuration:f&&d||null,next:k=>{const C=v(k);if(f)a.done=k>=d;else{let S=0;m<1&&(S=k===0?Ji(p):MU(v,k,C));const I=Math.abs(S)<=s,N=Math.abs(o-C)<=r;a.done=I&&N}return a.value=a.done?o:C,a},toString:()=>{const k=Math.min(nU(b),D1),C=sU(S=>b.next(k*S).value,k,30);return k+"ms "+C}};return b}function G_({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const d=t[0],h={done:!1,value:d},f=I=>a!==void 0&&I<a||l!==void 0&&I>l,p=I=>a===void 0?l:l===void 0||Math.abs(a-I)<Math.abs(l-I)?a:l;let m=n*e;const y=d+m,g=o===void 0?y:o(y);g!==y&&(m=g-d);const x=I=>-m*Math.exp(-I/s),v=I=>g+x(I),b=I=>{const N=x(I),E=v(I);h.done=Math.abs(N)<=c,h.value=h.done?g:E};let k,C;const S=I=>{f(h.value)&&(k=I,C=LU({keyframes:[h.value,p(h.value)],velocity:MU(v,I,h.value),damping:r,stiffness:i,restDelta:c,restSpeed:u}))};return S(0),{calculatedDuration:null,next:I=>{let N=!1;return!C&&k===void 0&&(N=!0,b(I),S(I)),k!==void 0&&I>=k?C.next(I-k):(!N&&b(I),h)}}}const mEe=Zp(.42,0,1,1),gEe=Zp(0,0,.58,1),VU=Zp(.42,0,.58,1),yEe=t=>Array.isArray(t)&&typeof t[0]!="number",xEe={linear:Ws,easeIn:mEe,easeInOut:VU,easeOut:gEe,circIn:MT,circInOut:vU,circOut:xU,backIn:FT,backInOut:gU,backOut:mU,anticipate:yU},H_=t=>{if(AT(t)){Fz(t.length===4);const[e,n,s,r]=t;return Zp(e,n,s,r)}else if(typeof t=="string")return xEe[t];return t};function vEe(t,e,n){const s=[],r=n||FU,i=t.length-1;for(let o=0;o<i;o++){let a=r(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||Ws:e;a=Jp(l,a)}s.push(a)}return s}function bEe(t,e,{clamp:n=!0,ease:s,mixer:r}={}){const i=t.length;if(Fz(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=vEe(e,s,r),l=a.length,c=u=>{if(o&&u<t[0])return e[0];let d=0;if(l>1)for(;d<t.length-2&&!(u<t[d+1]);d++);const h=Ru(t[d],t[d+1],u);return a[d](h)};return n?u=>c(mo(t[0],t[i-1],u)):c}function wEe(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const r=Ru(0,e,s);t.push(Ut(n,1,r))}}function kEe(t){const e=[0];return wEe(e,t.length-1),e}function CEe(t,e){return t.map(n=>n*e)}function SEe(t,e){return t.map(()=>e||VU).splice(0,t.length-1)}function Vy({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const r=yEe(s)?s.map(H_):H_(s),i={done:!1,value:e[0]},o=CEe(n&&n.length===e.length?n:kEe(e),t),a=bEe(o,e,{ease:Array.isArray(r)?r:SEe(e,r)});return{calculatedDuration:t,next:l=>(i.value=a(l),i.done=l>=t,i)}}const IEe=t=>{const e=({timestamp:n})=>t(n);return{start:()=>Ot.update(e,!0),stop:()=>Ca(e),now:()=>Dn.isProcessing?Dn.timestamp:Si.now()}},TEe={decay:G_,inertia:G_,tween:Vy,keyframes:Vy,spring:LU},NEe=t=>t/100;class jT extends PU{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:s,element:r,keyframes:i}=this.options,o=(r==null?void 0:r.KeyframeResolver)||zT,a=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new o(i,a,n,s,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:s=0,repeatDelay:r=0,repeatType:i,velocity:o=0}=this.options,a=_T(n)?n:TEe[n]||Vy;let l,c;a!==Vy&&typeof e[0]!="number"&&(l=Jp(NEe,FU(e[0],e[1])),e=[0,100]);const u=a({...this.options,keyframes:e});i==="mirror"&&(c=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=nU(u));const{calculatedDuration:d}=u,h=d+r,f=h*(s+1)-r;return{generator:u,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:d,resolvedDuration:h,totalDuration:f}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:s}=this;if(!s){const{keyframes:I}=this.options;return{done:!0,value:I[I.length-1]}}const{finalKeyframe:r,generator:i,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:c,totalDuration:u,resolvedDuration:d}=s;if(this.startTime===null)return i.next(0);const{delay:h,repeat:f,repeatType:p,repeatDelay:m,onUpdate:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const g=this.currentTime-h*(this.speed>=0?1:-1),x=this.speed>=0?g<0:g>u;this.currentTime=Math.max(g,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let v=this.currentTime,b=i;if(f){const I=Math.min(this.currentTime,u)/d;let N=Math.floor(I),E=I%1;!E&&I>=1&&(E=1),E===1&&N--,N=Math.min(N,f+1),!!(N%2)&&(p==="reverse"?(E=1-E,m&&(E-=m/d)):p==="mirror"&&(b=o)),v=mo(0,1,E)*d}const k=x?{done:!1,value:l[0]}:b.next(v);a&&(k.value=a(k.value));let{done:C}=k;!x&&c!==null&&(C=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const S=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&C);return S&&r!==void 0&&(k.value=ov(l,this.options,r)),y&&y(k.value),S&&this.finish(),k}get duration(){const{resolved:e}=this;return e?Qi(e.calculatedDuration):0}get time(){return Qi(this.currentTime)}set time(e){e=Ji(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Qi(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=IEe,onPlay:n,startTime:s}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),n&&n();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=s??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const EEe=new Set(["opacity","clipPath","filter","transform"]);function $Ee(t,e,n,{delay:s=0,duration:r=300,repeat:i=0,repeatType:o="loop",ease:a="easeInOut",times:l}={}){const c={[e]:n};l&&(c.offset=l);const u=iU(a,r);return Array.isArray(u)&&(c.easing=u),t.animate(c,{delay:s,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}const _Ee=mT(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),By=10,AEe=2e4;function REe(t){return _T(t.type)||t.type==="spring"||!rU(t.ease)}function DEe(t,e){const n=new jT({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let s={done:!1,value:t[0]};const r=[];let i=0;for(;!s.done&&i<AEe;)s=n.sample(i),r.push(s.value),i+=By;return{times:void 0,keyframes:r,duration:i-By,ease:"linear"}}const BU={anticipate:yU,backInOut:gU,circInOut:vU};function PEe(t){return t in BU}class q_ extends PU{constructor(e){super(e);const{name:n,motionValue:s,element:r,keyframes:i}=this.options;this.resolver=new DU(i,(o,a)=>this.onKeyframesResolved(o,a),n,s,r),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:s=300,times:r,ease:i,type:o,motionValue:a,name:l,startTime:c}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof i=="string"&&My()&&PEe(i)&&(i=BU[i]),REe(this.options)){const{onComplete:d,onUpdate:h,motionValue:f,element:p,...m}=this.options,y=DEe(e,m);e=y.keyframes,e.length===1&&(e[1]=e[0]),s=y.duration,r=y.times,i=y.ease,o="keyframes"}const u=$Ee(a.owner.current,l,e,{...this.options,duration:s,times:r,ease:i});return u.startTime=c??this.calcStartTime(),this.pendingTimeline?(__(u,this.pendingTimeline),this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:d}=this.options;a.set(ov(e,this.options,n)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:s,times:r,type:o,ease:i,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return Qi(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return Qi(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.currentTime=Ji(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return Ws;const{animation:s}=n;__(s,e)}return Ws}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:s,duration:r,type:i,ease:o,times:a}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:u,onComplete:d,element:h,...f}=this.options,p=new jT({...f,keyframes:s,duration:r,type:i,ease:o,times:a,isGenerator:!0}),m=Ji(this.time);c.setWithVelocity(p.sample(m-By).value,p.sample(m).value,By)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:s,repeatDelay:r,repeatType:i,damping:o,type:a}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=n.owner.getProps();return _Ee()&&s&&EEe.has(s)&&!l&&!c&&!r&&i!=="mirror"&&o!==0&&a!=="inertia"}}const OEe={type:"spring",stiffness:500,damping:25,restSpeed:10},FEe=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),MEe={type:"keyframes",duration:.8},LEe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},VEe=(t,{keyframes:e})=>e.length>2?MEe:pc.has(t)?t.startsWith("scale")?FEe(e[1]):OEe:LEe;function BEe({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:r,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const WT=(t,e,n,s={},r,i)=>o=>{const a=$T(s,t)||{},l=a.delay||s.delay||0;let{elapsed:c=0}=s;c=c-Ji(l);let u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:h=>{e.set(h),a.onUpdate&&a.onUpdate(h)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:i?void 0:r};BEe(a)||(u={...u,...VEe(t,u)}),u.duration&&(u.duration=Ji(u.duration)),u.repeatDelay&&(u.repeatDelay=Ji(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(d=!0)),d&&!i&&e.get()!==void 0){const h=ov(u.keyframes,a);if(h!==void 0)return Ot.update(()=>{u.onUpdate(h),u.onComplete()}),new i2e([])}return!i&&q_.supports(u)?new q_(u):new jT(u)};function zEe({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function zU(t,e,{delay:n=0,transitionOverride:s,type:r}={}){var i;let{transition:o=t.getDefaultTransition(),transitionEnd:a,...l}=e;s&&(o=s);const c=[],u=r&&t.animationState&&t.animationState.getState()[r];for(const d in l){const h=t.getValue(d,(i=t.latestValues[d])!==null&&i!==void 0?i:null),f=l[d];if(f===void 0||u&&zEe(u,d))continue;const p={delay:n,...$T(o||{},d)};let m=!1;if(window.MotionHandoffAnimation){const g=dU(t);if(g){const x=window.MotionHandoffAnimation(g,d,Ot);x!==null&&(p.startTime=x,m=!0)}}O1(t,d),h.start(WT(d,h,f,t.shouldReduceMotion&&cU.has(d)?{type:!1}:p,t,m));const y=h.animation;y&&c.push(y)}return a&&Promise.all(c).then(()=>{Ot.update(()=>{a&&v2e(t,a)})}),c}function U1(t,e,n={}){var s;const r=iv(t,e,n.type==="exit"?(s=t.presenceContext)===null||s===void 0?void 0:s.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const o=r?()=>Promise.all(zU(t,r,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=i;return UEe(t,e,u+c,d,h,n)}:()=>Promise.resolve(),{when:l}=i;if(l){const[c,u]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>u())}else return Promise.all([o(),a(n.delay)])}function UEe(t,e,n=0,s=0,r=1,i){const o=[],a=(t.variantChildren.size-1)*s,l=r===1?(c=0)=>c*s:(c=0)=>a-c*s;return Array.from(t.variantChildren).sort(jEe).forEach((c,u)=>{c.notify("AnimationStart",e),o.push(U1(c,e,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function jEe(t,e){return t.sortNodePosition(e)}function WEe(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const r=e.map(i=>U1(t,i,n));s=Promise.all(r)}else if(typeof e=="string")s=U1(t,e,n);else{const r=typeof e=="function"?iv(t,e,n.custom):e;s=Promise.all(zU(t,r,n))}return s.then(()=>{t.notify("AnimationComplete",e)})}const GEe=yT.length;function UU(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?UU(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<GEe;n++){const s=yT[n],r=t.props[s];(cf(r)||r===!1)&&(e[s]=r)}return e}const HEe=[...gT].reverse(),qEe=gT.length;function KEe(t){return e=>Promise.all(e.map(({animation:n,options:s})=>WEe(t,n,s)))}function XEe(t){let e=KEe(t),n=K_(),s=!0;const r=l=>(c,u)=>{var d;const h=iv(t,u,l==="exit"?(d=t.presenceContext)===null||d===void 0?void 0:d.custom:void 0);if(h){const{transition:f,transitionEnd:p,...m}=h;c={...c,...m,...p}}return c};function i(l){e=l(t)}function o(l){const{props:c}=t,u=UU(t.parent)||{},d=[],h=new Set;let f={},p=1/0;for(let y=0;y<qEe;y++){const g=HEe[y],x=n[g],v=c[g]!==void 0?c[g]:u[g],b=cf(v),k=g===l?x.isActive:null;k===!1&&(p=y);let C=v===u[g]&&v!==c[g]&&b;if(C&&s&&t.manuallyAnimateOnMount&&(C=!1),x.protectedKeys={...f},!x.isActive&&k===null||!v&&!x.prevProp||sv(v)||typeof v=="boolean")continue;const S=YEe(x.prevProp,v);let I=S||g===l&&x.isActive&&!C&&b||y>p&&b,N=!1;const E=Array.isArray(v)?v:[v];let D=E.reduce(r(g),{});k===!1&&(D={});const{prevResolvedValues:R={}}=x,L={...R,...D},B=q=>{I=!0,h.has(q)&&(N=!0,h.delete(q)),x.needsAnimating[q]=!0;const A=t.getValue(q);A&&(A.liveStyle=!1)};for(const q in L){const A=D[q],z=R[q];if(f.hasOwnProperty(q))continue;let P=!1;R1(A)&&R1(z)?P=!tU(A,z):P=A!==z,P?A!=null?B(q):h.add(q):A!==void 0&&h.has(q)?B(q):x.protectedKeys[q]=!0}x.prevProp=v,x.prevResolvedValues=D,x.isActive&&(f={...f,...D}),s&&t.blockInitialAnimation&&(I=!1),I&&(!(C&&S)||N)&&d.push(...E.map(q=>({animation:q,options:{type:g}})))}if(h.size){const y={};h.forEach(g=>{const x=t.getBaseTarget(g),v=t.getValue(g);v&&(v.liveStyle=!0),y[g]=x??null}),d.push({animation:y})}let m=!!d.length;return s&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(m=!1),s=!1,m?e(d):Promise.resolve()}function a(l,c){var u;if(n[l].isActive===c)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(h=>{var f;return(f=h.animationState)===null||f===void 0?void 0:f.setActive(l,c)}),n[l].isActive=c;const d=o(l);for(const h in n)n[h].protectedKeys={};return d}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>n,reset:()=>{n=K_(),s=!0}}}function YEe(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!tU(e,t):!1}function Ga(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function K_(){return{animate:Ga(!0),whileInView:Ga(),whileHover:Ga(),whileTap:Ga(),whileDrag:Ga(),whileFocus:Ga(),exit:Ga()}}class Ua{constructor(e){this.isMounted=!1,this.node=e}update(){}}class ZEe extends Ua{constructor(e){super(e),e.animationState||(e.animationState=XEe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();sv(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let JEe=0;class QEe extends Ua{constructor(){super(...arguments),this.id=JEe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const r=this.node.animationState.setActive("exit",!e);n&&!e&&r.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const e$e={animation:{Feature:ZEe},exit:{Feature:QEe}};function ff(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}function Qp(t){return{point:{x:t.pageX,y:t.pageY}}}const t$e=t=>e=>RT(e)&&t(e,Qp(e));function dh(t,e,n,s){return ff(t,e,t$e(n),s)}const X_=(t,e)=>Math.abs(t-e);function n$e(t,e){const n=X_(t.x,e.x),s=X_(t.y,e.y);return Math.sqrt(n**2+s**2)}class jU{constructor(e,n,{transformPagePoint:s,contextWindow:r,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=Sb(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,f=n$e(d.offset,{x:0,y:0})>=3;if(!h&&!f)return;const{point:p}=d,{timestamp:m}=Dn;this.history.push({...p,timestamp:m});const{onStart:y,onMove:g}=this.handlers;h||(y&&y(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),g&&g(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=Cb(h,this.transformPagePoint),Ot.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:f,onSessionEnd:p,resumeAnimation:m}=this.handlers;if(this.dragSnapToOrigin&&m&&m(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=Sb(d.type==="pointercancel"?this.lastMoveEventInfo:Cb(h,this.transformPagePoint),this.history);this.startEvent&&f&&f(d,y),p&&p(d,y)},!RT(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=s,this.contextWindow=r||window;const o=Qp(e),a=Cb(o,this.transformPagePoint),{point:l}=a,{timestamp:c}=Dn;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(e,Sb(a,this.history)),this.removeListeners=Jp(dh(this.contextWindow,"pointermove",this.handlePointerMove),dh(this.contextWindow,"pointerup",this.handlePointerUp),dh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Ca(this.updatePoint)}}function Cb(t,e){return e?{point:e(t.point)}:t}function Y_(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Sb({point:t},e){return{point:t,delta:Y_(t,WU(e)),offset:Y_(t,s$e(e)),velocity:r$e(e,.1)}}function s$e(t){return t[0]}function WU(t){return t[t.length-1]}function r$e(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const r=WU(t);for(;n>=0&&(s=t[n],!(r.timestamp-s.timestamp>Ji(e)));)n--;if(!s)return{x:0,y:0};const i=Qi(r.timestamp-s.timestamp);if(i===0)return{x:0,y:0};const o={x:(r.x-s.x)/i,y:(r.y-s.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const GU=1e-4,i$e=1-GU,o$e=1+GU,HU=.01,a$e=0-HU,l$e=0+HU;function qs(t){return t.max-t.min}function c$e(t,e,n){return Math.abs(t-e)<=n}function Z_(t,e,n,s=.5){t.origin=s,t.originPoint=Ut(e.min,e.max,t.origin),t.scale=qs(n)/qs(e),t.translate=Ut(n.min,n.max,t.origin)-t.originPoint,(t.scale>=i$e&&t.scale<=o$e||isNaN(t.scale))&&(t.scale=1),(t.translate>=a$e&&t.translate<=l$e||isNaN(t.translate))&&(t.translate=0)}function hh(t,e,n,s){Z_(t.x,e.x,n.x,s?s.originX:void 0),Z_(t.y,e.y,n.y,s?s.originY:void 0)}function J_(t,e,n){t.min=n.min+e.min,t.max=t.min+qs(e)}function u$e(t,e,n){J_(t.x,e.x,n.x),J_(t.y,e.y,n.y)}function Q_(t,e,n){t.min=e.min-n.min,t.max=t.min+qs(e)}function fh(t,e,n){Q_(t.x,e.x,n.x),Q_(t.y,e.y,n.y)}function d$e(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?Ut(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?Ut(n,t,s.max):Math.min(t,n)),t}function eA(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function h$e(t,{top:e,left:n,bottom:s,right:r}){return{x:eA(t.x,n,r),y:eA(t.y,e,s)}}function tA(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function f$e(t,e){return{x:tA(t.x,e.x),y:tA(t.y,e.y)}}function p$e(t,e){let n=.5;const s=qs(t),r=qs(e);return r>s?n=Ru(e.min,e.max-s,t.min):s>r&&(n=Ru(t.min,t.max-r,e.min)),mo(0,1,n)}function m$e(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const j1=.35;function g$e(t=j1){return t===!1?t=0:t===!0&&(t=j1),{x:nA(t,"left","right"),y:nA(t,"top","bottom")}}function nA(t,e,n){return{min:sA(t,e),max:sA(t,n)}}function sA(t,e){return typeof t=="number"?t:t[e]||0}const rA=()=>({translate:0,scale:1,origin:0,originPoint:0}),Uc=()=>({x:rA(),y:rA()}),iA=()=>({min:0,max:0}),en=()=>({x:iA(),y:iA()});function sr(t){return[t("x"),t("y")]}function qU({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function y$e({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function x$e(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function Ib(t){return t===void 0||t===1}function W1({scale:t,scaleX:e,scaleY:n}){return!Ib(t)||!Ib(e)||!Ib(n)}function Ja(t){return W1(t)||KU(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function KU(t){return oA(t.x)||oA(t.y)}function oA(t){return t&&t!=="0%"}function zy(t,e,n){const s=t-n,r=e*s;return n+r}function aA(t,e,n,s,r){return r!==void 0&&(t=zy(t,r,s)),zy(t,n,s)+e}function G1(t,e=0,n=1,s,r){t.min=aA(t.min,e,n,s,r),t.max=aA(t.max,e,n,s,r)}function XU(t,{x:e,y:n}){G1(t.x,e.translate,e.scale,e.originPoint),G1(t.y,n.translate,n.scale,n.originPoint)}const lA=.999999999999,cA=1.0000000000001;function v$e(t,e,n,s=!1){const r=n.length;if(!r)return;e.x=e.y=1;let i,o;for(let a=0;a<r;a++){i=n[a],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(s&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Wc(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,XU(t,o)),s&&Ja(i.latestValues)&&Wc(t,i.latestValues))}e.x<cA&&e.x>lA&&(e.x=1),e.y<cA&&e.y>lA&&(e.y=1)}function jc(t,e){t.min=t.min+e,t.max=t.max+e}function uA(t,e,n,s,r=.5){const i=Ut(t.min,t.max,r);G1(t,e,n,i,s)}function Wc(t,e){uA(t.x,e.x,e.scaleX,e.scale,e.originX),uA(t.y,e.y,e.scaleY,e.scale,e.originY)}function YU(t,e){return qU(x$e(t.getBoundingClientRect(),e))}function b$e(t,e,n){const s=YU(t,n),{scroll:r}=e;return r&&(jc(s.x,r.offset.x),jc(s.y,r.offset.y)),s}const ZU=({current:t})=>t?t.ownerDocument.defaultView:null,w$e=new WeakMap;class k$e{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=en(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const r=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Qp(u).point)},i=(u,d)=>{const{drag:h,dragPropagation:f,onDragStart:p}=this.getProps();if(h&&!f&&(this.openDragLock&&this.openDragLock(),this.openDragLock=p2e(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),sr(y=>{let g=this.getAxisMotionValue(y).get()||0;if(Ci.test(g)){const{projection:x}=this.visualElement;if(x&&x.layout){const v=x.layout.layoutBox[y];v&&(g=qs(v)*(parseFloat(g)/100))}}this.originPoint[y]=g}),p&&Ot.postRender(()=>p(u,d)),O1(this.visualElement,"transform");const{animationState:m}=this.visualElement;m&&m.setActive("whileDrag",!0)},o=(u,d)=>{const{dragPropagation:h,dragDirectionLock:f,onDirectionLock:p,onDrag:m}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:y}=d;if(f&&this.currentDirection===null){this.currentDirection=C$e(y),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",d.point,y),this.updateAxis("y",d.point,y),this.visualElement.render(),m&&m(u,d)},a=(u,d)=>this.stop(u,d),l=()=>sr(u=>{var d;return this.getAnimationState(u)==="paused"&&((d=this.getAxisMotionValue(u).animation)===null||d===void 0?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new jU(e,{onSessionStart:r,onStart:i,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:ZU(this.visualElement)})}stop(e,n){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:r}=n;this.startAnimation(r);const{onDragEnd:i}=this.getProps();i&&Ot.postRender(()=>i(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:r}=this.getProps();if(!s||!Mm(e,r,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(o=d$e(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:s}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;n&&Bc(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&r?this.constraints=h$e(r.layoutBox,n):this.constraints=!1,this.elastic=g$e(s),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&sr(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=m$e(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Bc(e))return!1;const s=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const i=b$e(s,r.root,this.visualElement.getTransformPagePoint());let o=f$e(r.layout.layoutBox,i);if(n){const a=n(y$e(o));this.hasMutatedConstraints=!!a,a&&(o=qU(a))}return o}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:r,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=sr(u=>{if(!Mm(u,n,this.currentDirection))return;let d=l&&l[u]||{};o&&(d={min:0,max:0});const h=r?200:1e6,f=r?40:1e7,p={type:"inertia",velocity:s?e[u]:0,bounceStiffness:h,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(u,p)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return O1(this.visualElement,e),s.start(WT(e,s,0,n,this.visualElement,!1))}stopAnimation(){sr(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){sr(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),r=s[n];return r||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){sr(n=>{const{drag:s}=this.getProps();if(!Mm(n,s,this.currentDirection))return;const{projection:r}=this.visualElement,i=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[n];i.set(e[n]-Ut(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!Bc(n)||!s||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};sr(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();r[o]=p$e({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),sr(o=>{if(!Mm(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(Ut(l,c,r[o]))})}addListeners(){if(!this.visualElement.current)return;w$e.set(this.visualElement,this);const e=this.visualElement.current,n=dh(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();Bc(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,i=r.addEventListener("measure",s);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Ot.read(s);const o=ff(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(sr(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:o=j1,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:r,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function Mm(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function C$e(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class S$e extends Ua{constructor(e){super(e),this.removeGroupControls=Ws,this.removeListeners=Ws,this.controls=new k$e(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ws}unmount(){this.removeGroupControls(),this.removeListeners()}}const dA=t=>(e,n)=>{t&&Ot.postRender(()=>t(e,n))};class I$e extends Ua{constructor(){super(...arguments),this.removePointerDownListener=Ws}onPointerDown(e){this.session=new jU(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:ZU(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:r}=this.node.getProps();return{onSessionStart:dA(e),onStart:dA(n),onMove:s,onEnd:(i,o)=>{delete this.session,r&&Ot.postRender(()=>r(i,o))}}}mount(){this.removePointerDownListener=dh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const ug={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function hA(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Ad={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Re.test(t))t=parseFloat(t);else return t;const n=hA(t,e.target.x),s=hA(t,e.target.y);return`${n}% ${s}%`}},T$e={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,r=Sa.parse(t);if(r.length>5)return s;const i=Sa.createTransformer(t),o=typeof r[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;r[0+o]/=a,r[1+o]/=l;const c=Ut(a,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=c),typeof r[3+o]=="number"&&(r[3+o]/=c),i(r)}};class N$e extends M.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:r}=this.props,{projection:i}=e;qNe(E$e),i&&(n.group&&n.group.add(i),s&&s.register&&r&&s.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),ug.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:r,isPresent:i}=this.props,o=s.projection;return o&&(o.isPresent=i,r||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||Ot.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),vT.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),s&&s.deregister&&s.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function JU(t){const[e,n]=Pz(),s=M.useContext(dT);return w.jsx(N$e,{...t,layoutGroup:s,switchLayoutGroup:M.useContext(Uz),isPresent:e,safeToRemove:n})}const E$e={borderRadius:{...Ad,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ad,borderTopRightRadius:Ad,borderBottomLeftRadius:Ad,borderBottomRightRadius:Ad,boxShadow:T$e};function $$e(t,e,n){const s=Qn(t)?t:df(t);return s.start(WT("",s,e,n)),s.animation}function _$e(t){return t instanceof SVGElement&&t.tagName!=="svg"}const A$e=(t,e)=>t.depth-e.depth;class R$e{constructor(){this.children=[],this.isDirty=!1}add(e){DT(this.children,e),this.isDirty=!0}remove(e){PT(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(A$e),this.isDirty=!1,this.children.forEach(e)}}function D$e(t,e){const n=Si.now(),s=({timestamp:r})=>{const i=r-n;i>=e&&(Ca(s),t(i-e))};return Ot.read(s,!0),()=>Ca(s)}const QU=["TopLeft","TopRight","BottomLeft","BottomRight"],P$e=QU.length,fA=t=>typeof t=="string"?parseFloat(t):t,pA=t=>typeof t=="number"||Re.test(t);function O$e(t,e,n,s,r,i){r?(t.opacity=Ut(0,n.opacity!==void 0?n.opacity:1,F$e(s)),t.opacityExit=Ut(e.opacity!==void 0?e.opacity:1,0,M$e(s))):i&&(t.opacity=Ut(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,s));for(let o=0;o<P$e;o++){const a=`border${QU[o]}Radius`;let l=mA(e,a),c=mA(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||pA(l)===pA(c)?(t[a]=Math.max(Ut(fA(l),fA(c),s),0),(Ci.test(c)||Ci.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=Ut(e.rotate||0,n.rotate||0,s))}function mA(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const F$e=ej(0,.5,xU),M$e=ej(.5,.95,Ws);function ej(t,e,n){return s=>s<t?0:s>e?1:n(Ru(t,e,s))}function gA(t,e){t.min=e.min,t.max=e.max}function nr(t,e){gA(t.x,e.x),gA(t.y,e.y)}function yA(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function xA(t,e,n,s,r){return t-=e,t=zy(t,1/n,s),r!==void 0&&(t=zy(t,1/r,s)),t}function L$e(t,e=0,n=1,s=.5,r,i=t,o=t){if(Ci.test(e)&&(e=parseFloat(e),e=Ut(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Ut(i.min,i.max,s);t===i&&(a-=e),t.min=xA(t.min,e,n,a,r),t.max=xA(t.max,e,n,a,r)}function vA(t,e,[n,s,r],i,o){L$e(t,e[n],e[s],e[r],e.scale,i,o)}const V$e=["x","scaleX","originX"],B$e=["y","scaleY","originY"];function bA(t,e,n,s){vA(t.x,e,V$e,n?n.x:void 0,s?s.x:void 0),vA(t.y,e,B$e,n?n.y:void 0,s?s.y:void 0)}function wA(t){return t.translate===0&&t.scale===1}function tj(t){return wA(t.x)&&wA(t.y)}function kA(t,e){return t.min===e.min&&t.max===e.max}function z$e(t,e){return kA(t.x,e.x)&&kA(t.y,e.y)}function CA(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function nj(t,e){return CA(t.x,e.x)&&CA(t.y,e.y)}function SA(t){return qs(t.x)/qs(t.y)}function IA(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class U$e{constructor(){this.members=[]}add(e){DT(this.members,e),e.scheduleRender()}remove(e){if(PT(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(r=>e===r);if(n===0)return!1;let s;for(let r=n;r>=0;r--){const i=this.members[r];if(i.isPresent!==!1){s=i;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function j$e(t,e,n){let s="";const r=t.x.translate/e.x,i=t.y.translate/e.y,o=(n==null?void 0:n.z)||0;if((r||i||o)&&(s=`translate3d(${r}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:f,skewY:p}=n;c&&(s=`perspective(${c}px) ${s}`),u&&(s+=`rotate(${u}deg) `),d&&(s+=`rotateX(${d}deg) `),h&&(s+=`rotateY(${h}deg) `),f&&(s+=`skewX(${f}deg) `),p&&(s+=`skewY(${p}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(s+=`scale(${a}, ${l})`),s||"none"}const Qa={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Hd=typeof window<"u"&&window.MotionDebug!==void 0,Tb=["","X","Y","Z"],W$e={visibility:"hidden"},TA=1e3;let G$e=0;function Nb(t,e,n,s){const{latestValues:r}=e;r[t]&&(n[t]=r[t],e.setStaticValue(t,0),s&&(s[t]=0))}function sj(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=dU(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Ot,!(r||i))}const{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&sj(s)}function rj({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:r}){return class{constructor(o={},a=e==null?void 0:e()){this.id=G$e++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Hd&&(Qa.totalNodes=Qa.resolvedTargetDeltas=Qa.recalculatedProjection=0),this.nodes.forEach(K$e),this.nodes.forEach(Q$e),this.nodes.forEach(e_e),this.nodes.forEach(X$e),Hd&&window.MotionDebug.record(Qa)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new R$e)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new OT),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=_$e(o),this.instance=o;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let d;const h=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,d&&d(),d=D$e(h,250),ug.hasAnimatedSinceResize&&(ug.hasAnimatedSinceResize=!1,this.nodes.forEach(EA))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:h,hasRelativeTargetChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||u.getDefaultTransition()||i_e,{onLayoutAnimationStart:y,onLayoutAnimationComplete:g}=u.getProps(),x=!this.targetLayout||!nj(this.targetLayout,p)||f,v=!h&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||v||h&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(d,v);const b={...$T(m,"layout"),onPlay:y,onComplete:g};(u.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b)}else h||EA(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ca(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(t_e),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&sj(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(NA);return}this.isUpdating||this.nodes.forEach(Z$e),this.isUpdating=!1,this.nodes.forEach(J$e),this.nodes.forEach(H$e),this.nodes.forEach(q$e),this.clearAllSnapshots();const a=Si.now();Dn.delta=mo(0,1e3/60,a-Dn.timestamp),Dn.timestamp=a,Dn.isProcessing=!0,xb.update.process(Dn),xb.preRender.process(Dn),xb.render.process(Dn),Dn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,vT.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Y$e),this.sharedNodes.forEach(n_e)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ot.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ot.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=en(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const l=s(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!tj(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&(a||Ja(this.latestValues)||u)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),o_e(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return en();const l=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(a_e))){const{scroll:u}=this.root;u&&(jc(l.x,u.offset.x),jc(l.y,u.offset.y))}return l}removeElementScroll(o){var a;const l=en();if(nr(l,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&nr(l,o),jc(l.x,d.offset.x),jc(l.y,d.offset.y))}return l}applyTransform(o,a=!1){const l=en();nr(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Wc(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Ja(u.latestValues)&&Wc(l,u.latestValues)}return Ja(this.latestValues)&&Wc(l,this.latestValues),l}removeTransform(o){const a=en();nr(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Ja(c.latestValues))continue;W1(c.latestValues)&&c.updateSnapshot();const u=en(),d=c.measurePageBox();nr(u,d),bA(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Ja(this.latestValues)&&bA(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Dn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:h}=this.options;if(!(!this.layout||!(d||h))){if(this.resolvedRelativeTargetAt=Dn.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=en(),this.relativeTargetOrigin=en(),fh(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),nr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=en(),this.targetWithTransforms=en()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),u$e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):nr(this.target,this.layout.layoutBox),XU(this.target,this.targetDelta)):nr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=en(),this.relativeTargetOrigin=en(),fh(this.relativeTargetOrigin,this.target,f.target),nr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Hd&&Qa.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||W1(this.parent.latestValues)||KU(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Dn.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;nr(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,f=this.treeScale.y;v$e(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=en());const{target:p}=a;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(yA(this.prevProjectionDelta.x,this.projectionDelta.x),yA(this.prevProjectionDelta.y,this.projectionDelta.y)),hh(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==f||!IA(this.projectionDelta.x,this.prevProjectionDelta.x)||!IA(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p)),Hd&&Qa.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Uc(),this.projectionDelta=Uc(),this.projectionDeltaWithTransform=Uc()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=Uc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const h=en(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,m=f!==p,y=this.getStack(),g=!y||y.members.length<=1,x=!!(m&&!g&&this.options.crossfade===!0&&!this.path.some(r_e));this.animationProgress=0;let v;this.mixTargetDelta=b=>{const k=b/1e3;$A(d.x,o.x,k),$A(d.y,o.y,k),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(fh(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),s_e(this.relativeTarget,this.relativeTargetOrigin,h,k),v&&z$e(this.relativeTarget,v)&&(this.isProjectionDirty=!1),v||(v=en()),nr(v,this.relativeTarget)),m&&(this.animationValues=u,O$e(u,c,this.latestValues,k,x,g)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=k},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ca(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ot.update(()=>{ug.hasAnimatedSinceResize=!0,this.currentAnimation=$$e(0,TA,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(TA),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&ij(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||en();const d=qs(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+d;const h=qs(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+h}nr(a,l),Wc(a,u),hh(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new U$e),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&Nb("z",o,c,this.animationValues);for(let u=0;u<Tb.length;u++)Nb(`rotate${Tb[u]}`,o,c,this.animationValues),Nb(`skew${Tb[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return W$e;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=lg(o==null?void 0:o.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=lg(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Ja(this.latestValues)&&(m.transform=u?u({},""):"none",this.hasProjected=!1),m}const h=d.animationValues||d.latestValues;this.applyTransformsToTarget(),c.transform=j$e(this.projectionDeltaWithTransform,this.treeScale,h),u&&(c.transform=u(h,c.transform));const{x:f,y:p}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,d.animationValues?c.opacity=d===this?(l=(a=h.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:c.opacity=d===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const m in Fy){if(h[m]===void 0)continue;const{correct:y,applyTo:g}=Fy[m],x=c.transform==="none"?h[m]:y(h[m],d);if(g){const v=g.length;for(let b=0;b<v;b++)c[g[b]]=x}else c[m]=x}return this.options.layoutId&&(c.pointerEvents=d===this?lg(o==null?void 0:o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(NA),this.root.sharedNodes.clear()}}}function H$e(t){t.updateLayout()}function q$e(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:r}=t.layout,{animationType:i}=t.options,o=n.source!==t.layout.source;i==="size"?sr(d=>{const h=o?n.measuredBox[d]:n.layoutBox[d],f=qs(h);h.min=s[d].min,h.max=h.min+f}):ij(i,n.layoutBox,s)&&sr(d=>{const h=o?n.measuredBox[d]:n.layoutBox[d],f=qs(s[d]);h.max=h.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[d].max=t.relativeTarget[d].min+f)});const a=Uc();hh(a,s,n.layoutBox);const l=Uc();o?hh(l,t.applyTransform(r,!0),n.measuredBox):hh(l,s,n.layoutBox);const c=!tj(a);let u=!1;if(!t.resumeFrom){const d=t.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:f}=d;if(h&&f){const p=en();fh(p,n.layoutBox,h.layoutBox);const m=en();fh(m,s,f.layoutBox),nj(p,m)||(u=!0),d.options.layoutRoot&&(t.relativeTarget=m,t.relativeTargetOrigin=p,t.relativeParent=d)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function K$e(t){Hd&&Qa.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function X$e(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Y$e(t){t.clearSnapshot()}function NA(t){t.clearMeasurements()}function Z$e(t){t.isLayoutDirty=!1}function J$e(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function EA(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Q$e(t){t.resolveTargetDelta()}function e_e(t){t.calcProjection()}function t_e(t){t.resetSkewAndRotation()}function n_e(t){t.removeLeadSnapshot()}function $A(t,e,n){t.translate=Ut(e.translate,0,n),t.scale=Ut(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function _A(t,e,n,s){t.min=Ut(e.min,n.min,s),t.max=Ut(e.max,n.max,s)}function s_e(t,e,n,s){_A(t.x,e.x,n.x,s),_A(t.y,e.y,n.y,s)}function r_e(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const i_e={duration:.45,ease:[.4,0,.1,1]},AA=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),RA=AA("applewebkit/")&&!AA("chrome/")?Math.round:Ws;function DA(t){t.min=RA(t.min),t.max=RA(t.max)}function o_e(t){DA(t.x),DA(t.y)}function ij(t,e,n){return t==="position"||t==="preserve-aspect"&&!c$e(SA(e),SA(n),.2)}function a_e(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const l_e=rj({attachResizeListener:(t,e)=>ff(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Eb={current:void 0},oj=rj({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Eb.current){const t=new l_e({});t.mount(window),t.setOptions({layoutScroll:!0}),Eb.current=t}return Eb.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),c_e={pan:{Feature:I$e},drag:{Feature:S$e,ProjectionNode:oj,MeasureLayout:JU}};function PA(t,e,n){const{props:s}=t;t.animationState&&s.whileHover&&t.animationState.setActive("whileHover",n==="Start");const r="onHover"+n,i=s[r];i&&Ot.postRender(()=>i(e,Qp(e)))}class u_e extends Ua{mount(){const{current:e}=this.node;e&&(this.unmount=c2e(e,n=>(PA(this.node,n,"Start"),s=>PA(this.node,s,"End"))))}unmount(){}}class d_e extends Ua{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Jp(ff(this.node.current,"focus",()=>this.onFocus()),ff(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function OA(t,e,n){const{props:s}=t;t.animationState&&s.whileTap&&t.animationState.setActive("whileTap",n==="Start");const r="onTap"+(n==="End"?"":n),i=s[r];i&&Ot.postRender(()=>i(e,Qp(e)))}class h_e extends Ua{mount(){const{current:e}=this.node;e&&(this.unmount=f2e(e,n=>(OA(this.node,n,"Start"),(s,{success:r})=>OA(this.node,s,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const H1=new WeakMap,$b=new WeakMap,f_e=t=>{const e=H1.get(t.target);e&&e(t)},p_e=t=>{t.forEach(f_e)};function m_e({root:t,...e}){const n=t||document;$b.has(n)||$b.set(n,{});const s=$b.get(n),r=JSON.stringify(e);return s[r]||(s[r]=new IntersectionObserver(p_e,{root:t,...e})),s[r]}function g_e(t,e,n){const s=m_e(e);return H1.set(t,n),s.observe(t),()=>{H1.delete(t),s.unobserve(t)}}const y_e={some:0,all:1};class x_e extends Ua{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:r="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:y_e[r]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return g_e(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(v_e(e,n))&&this.startObserver()}unmount(){}}function v_e({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const b_e={inView:{Feature:x_e},tap:{Feature:h_e},focus:{Feature:d_e},hover:{Feature:u_e}},w_e={layout:{ProjectionNode:oj,MeasureLayout:JU}},q1={current:null},aj={current:!1};function k_e(){if(aj.current=!0,!!pT)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>q1.current=t.matches;t.addListener(e),e()}else q1.current=!1}const C_e=[...RU,qn,Sa],S_e=t=>C_e.find(AU(t)),FA=new WeakMap;function I_e(t,e,n){for(const s in e){const r=e[s],i=n[s];if(Qn(r))t.addValue(s,r);else if(Qn(i))t.addValue(s,df(r,{owner:t}));else if(i!==r)if(t.hasValue(s)){const o=t.getValue(s);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=t.getStaticValue(s);t.addValue(s,df(o!==void 0?o:r,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const MA=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class T_e{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:r,blockInitialAnimation:i,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=zT,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=Si.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,Ot.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:u}=o;this.onUpdate=u,this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.blockInitialAnimation=!!i,this.isControllingVariants=rv(n),this.isVariantNode=Bz(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...h}=this.scrapeMotionValuesFromProps(n,{},this);for(const f in h){const p=h[f];l[f]!==void 0&&Qn(p)&&p.set(l[f],!1)}}mount(e){this.current=e,FA.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),aj.current||k_e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:q1.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){FA.delete(this.current),this.projection&&this.projection.unmount(),Ca(this.notifyUpdate),Ca(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=pc.has(e),r=n.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&Ot.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{r(),i(),o&&o(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Du){const n=Du[e];if(!n)continue;const{isEnabled:s,Feature:r}=n;if(!this.features[e]&&r&&s(this.props)&&(this.features[e]=new r(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):en()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<MA.length;s++){const r=MA[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const i="on"+r,o=e[i];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=I_e(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=df(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){var s;let r=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(s=this.getBaseTargetFromProps(this.props,e))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,e,this.options);return r!=null&&(typeof r=="string"&&($U(r)||bU(r))?r=parseFloat(r):!S_e(r)&&Sa.test(n)&&(r=TU(e,n)),this.setBaseTarget(e,Qn(r)?r.get():r)),Qn(r)?r.get():r}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:s}=this.props;let r;if(typeof s=="string"||typeof s=="object"){const o=wT(this.props,s,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);o&&(r=o[e])}if(s&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Qn(i)?i:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new OT),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class lj extends T_e{constructor(){super(...arguments),this.KeyframeResolver=DU}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Qn(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function N_e(t){return window.getComputedStyle(t)}class E_e extends lj{constructor(){super(...arguments),this.type="html",this.renderInstance=Xz}readValueFromInstance(e,n){if(pc.has(n)){const s=BT(n);return s&&s.default||0}else{const s=N_e(e),r=(Hz(n)?s.getPropertyValue(n):s[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:n}){return YU(e,n)}build(e,n,s){ST(e,n,s.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return ET(e,n,s)}}class $_e extends lj{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=en}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(pc.has(n)){const s=BT(n);return s&&s.default||0}return n=Yz.has(n)?n:xT(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,s){return Qz(e,n,s)}build(e,n,s){IT(e,n,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,s,r){Zz(e,n,s,r)}mount(e){this.isSVGTag=NT(e.tagName),super.mount(e)}}const __e=(t,e)=>bT(t)?new $_e(e):new E_e(e,{allowProjection:t!==M.Fragment}),A_e=n2e({...e$e,...b_e,...c_e,...w_e},__e),Li=yNe(A_e);function R_e(){const{isOpen:t,toggleChat:e,messages:n,addMessage:s}=a8(),r=wf(h=>h.user),[i,o]=M.useState(!1),[a,l]=M.useState(!1),c=M.useRef(null),u=n.some(h=>h.sender==="system"&&h.text.includes("describe your symptoms"));M.useEffect(()=>{var h;(h=c.current)==null||h.scrollIntoView({behavior:"smooth"})},[n,a]);const d=async h=>{h.preventDefault();const p=h.currentTarget.elements.namedItem("message"),m=p.value.trim();if(m){const y={text:m,sender:"user",timestamp:Date.now(),id:`${Date.now()}`};if(s(y),p.value="",!u)l(!0),setTimeout(()=>{const g={text:`Hello ${(r==null?void 0:r.username)||"patient"}, describe your symptoms to daktari 😊.`,sender:"system",timestamp:Date.now(),id:`${Date.now()}`};s(g),l(!1)},1500);else{o(!0),l(!0);try{const g=await aT(m);setTimeout(()=>{const x={text:`Based on your symptoms, our doctor's analysis suggests:
              
Condition: ${g.condition}
Confidence: ${(g.probability*100).toFixed(1)}%
Urgency: ${g.urgency.toUpperCase()}

Recommended Medications:
${g.medications.map(v=>`• ${v}`).join(`
`)}

Other Recommendations:
${g.recommendations.filter(v=>!g.medications.includes(v)).map(v=>`• ${v}`).join(`
`)}

Consultation Fees:
• Initial consultation: KSH ${g.consultationFees.initial}
• Follow-up visit: KSH ${g.consultationFees.followUp}

If symptoms persist or worsen, please schedule a consultation with one of our doctors.`,sender:"system",timestamp:Date.now(),id:`${Date.now()}`};s(x)},2e3),setTimeout(()=>{const x={text:"Thank you for your message. Daktari will review your case shortly.",sender:"system",timestamp:Date.now(),id:`${Date.now()}`};s(x),l(!1)},3500)}catch{zt.error("Failed to analyze symptoms. Please try again.");const g={text:"Sorry, there was an error analyzing your symptoms. Daktari will review your case directly.",sender:"system",timestamp:Date.now(),id:`${Date.now()}`};s(g),l(!1)}finally{o(!1)}}}};return w.jsxs(w.Fragment,{children:[w.jsx(Li.div,{initial:{scale:1},whileHover:{scale:1.05},whileTap:{scale:.95},className:"fixed bottom-4 right-4 z-50",children:w.jsx(In,{onClick:e,className:"rounded-full w-12 h-12 bg-blue-600 text-white shadow-lg transition-all",children:w.jsx(mP,{className:"h-6 w-6"})})}),w.jsx(cNe,{children:t&&w.jsxs(Li.div,{initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-20 right-4 w-[90%] max-w-sm bg-white rounded-lg shadow-xl z-50 overflow-hidden",children:[w.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gradient-to-r from-blue-600 to-blue-500 text-white",children:[w.jsxs("div",{children:[w.jsx("h3",{className:"text-lg font-semibold",children:"Welcome to teleCure Health 🩺"}),w.jsx("p",{className:"text-sm text-blue-100",children:"Chat with our online doctor 👨‍⚕️"})]}),w.jsx(Li.button,{whileHover:{rotate:90},whileTap:{scale:.9},onClick:e,className:"p-1 rounded-full hover:bg-blue-700 transition-colors",children:w.jsx(qk,{className:"h-5 w-5"})})]}),w.jsxs("div",{className:"h-72 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[n.map(h=>w.jsxs(Li.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2},className:`flex flex-col ${h.sender==="user"?"items-end":"items-start"}`,children:[w.jsx("div",{className:`max-w-[80%] rounded-lg p-3 whitespace-pre-wrap shadow-sm ${h.sender==="user"?"bg-blue-500 text-white rounded-br-none":h.sender==="system"?"bg-teal-100 text-teal-800 rounded-bl-none":"bg-green-500 text-white rounded-bl-none"}`,children:h.text}),w.jsx("span",{className:"text-xs text-gray-500 mt-1",children:sNe(new Date(h.timestamp),"HH:mm")})]},h.id)),a&&w.jsx(Li.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-start space-x-2",children:w.jsx("div",{className:"bg-teal-100 text-teal-800 rounded-lg rounded-bl-none p-3 shadow-sm",children:w.jsxs("div",{className:"flex space-x-1",children:[w.jsx(Li.span,{animate:{y:[0,-5,0]},transition:{repeat:1/0,duration:1,repeatDelay:.2},className:"inline-block w-2 h-2 bg-green-500 rounded-full"}),w.jsx(Li.span,{animate:{y:[0,-5,0]},transition:{repeat:1/0,duration:1,delay:.2,repeatDelay:.2},className:"inline-block w-2 h-2 bg-green-500 rounded-full"}),w.jsx(Li.span,{animate:{y:[0,-5,0]},transition:{repeat:1/0,duration:1,delay:.4,repeatDelay:.2},className:"inline-block w-2 h-2 bg-green-500 rounded-full"})]})})}),w.jsx("div",{ref:c})]}),w.jsx("form",{onSubmit:d,className:"p-3 border-t bg-white",children:w.jsxs("div",{className:"flex gap-2",children:[w.jsx("input",{type:"text",name:"message",className:"flex-1 rounded-md border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-blue-500 transition-all",placeholder:"Type your message...",disabled:i}),w.jsx(Li.button,{type:"submit",whileHover:{scale:1.05},whileTap:{scale:.95},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition-all disabled:opacity-50",disabled:i,children:"Send"})]})})]})})]})}function D_e({onClose:t}){const[e,n]=M.useState(!1),[s,r]=M.useState(0),i=Bu(),o=["https://actionchange.org/wp-content/uploads/2019/10/pict_large-6.jpg","https://images.pexels.com/photos/3786157/pexels-photo-3786157.jpeg?auto=compress&cs=tinysrgb&w=1200","https://th.bing.com/th/id/OIP.aCFNQ4HBUV9RP00fm6tIwwHaEK?cb=iwc2&rs=1&pid=ImgDetMain"];M.useEffect(()=>{console.log("useEffect fired: Popup will show in 20 seconds.");const c=setTimeout(()=>{n(!0),console.log("Popup should now be visible.")},6e4),u=setInterval(()=>{r(d=>(d+1)%o.length)},8e3);return()=>{clearTimeout(c),clearInterval(u)}},[]);const a=()=>{n(!1),t()},l=()=>{i("/symptoms"),n(!1)};return e?w.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 animate-fadeIn",children:w.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl w-full max-w-md transform transition-all duration-300 ease-in-out animate-slideIn",children:[w.jsx("button",{onClick:a,className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700 transition-colors",children:w.jsx("svg",{className:"w-6 h-6",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:w.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})}),w.jsxs("div",{className:"p-6",children:[w.jsx("div",{className:"aspect-video mb-4 bg-blue-100 rounded-lg overflow-hidden",children:w.jsx("img",{src:o[s],alt:"Hospital Services",className:"w-full h-full object-cover transition-opacity duration-1000 ease-in-out",style:{opacity:1}})}),w.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Special Health Package"}),w.jsx("p",{className:"text-gray-600 mb-4",children:"Get comprehensive health checkups at 30% off! Limited time offer for new patients."}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex items-center text-gray-700",children:[w.jsx("svg",{className:"w-5 h-5 mr-2 text-green-500",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:w.jsx("path",{d:"M5 13l4 4L19 7"})}),"Full Body Checkup"]}),w.jsxs("div",{className:"flex items-center text-gray-700",children:[w.jsx("svg",{className:"w-5 h-5 mr-2 text-green-500",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:w.jsx("path",{d:"M5 13l4 4L19 7"})}),"Cardiac Screening"]}),w.jsxs("div",{className:"flex items-center text-gray-700",children:[w.jsx("svg",{className:"w-5 h-5 mr-2 text-green-500",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:w.jsx("path",{d:"M5 13l4 4L19 7"})}),"Diabetes Screening"]})]}),w.jsx("button",{onClick:l,className:"mt-6 w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Book Now"})]})]})}):null}const P_e="https://images.pexels.com/photos/30677589/pexels-photo-30677589/free-photo-of-professional-consultation-in-lagos-office-setting.jpeg?auto=compress&cs=tinysrgb&w=1200",O_e="https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=1200";function F_e(){return w.jsxs("div",{className:"relative min-h-screen overflow-hidden",children:[w.jsxs("div",{className:"relative w-full",children:[w.jsxs("div",{className:"absolute inset-0 z-0 h-full w-full",children:[w.jsx("img",{src:P_e,alt:"Healthcare background",className:"w-full h-full object-cover",style:{minHeight:"480px",maxHeight:"700px"}}),w.jsx("div",{className:"absolute inset-0 bg-black/60"})]}),w.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center min-h-[480px] max-h-[700px] px-4 py-12 text-white",children:[w.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-4 text-center drop-shadow-lg",children:"teleCure: Your AI-Powered Health & Wellness Companion"}),w.jsx("p",{className:"text-lg md:text-2xl mb-8 text-center max-w-2xl drop-shadow",children:"Gamified self-care, mental health support, women, men and children safety, and AI-driven telemedicine—all in one secure platform."}),w.jsxs("div",{className:"flex flex-wrap gap-4 justify-center",children:[w.jsx(ym,{to:"/register",children:w.jsx(In,{className:"bg-red-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg text-lg font-semibold",children:"Get Started"})}),w.jsx(ym,{to:"/symptoms",children:w.jsx(In,{variant:"outline",className:"border-white hover:bg-blue-700 text-white px-6 py-3 rounded-lg text-lg font-semibold",children:"Try Symptom Checker"})})]})]})]}),w.jsxs("div",{className:"relative z-20 bg-white/90 py-16 px-4",children:[w.jsx("h2",{className:"text-3xl font-bold text-center mb-8 text-blue-800",children:"How teleCure Works"}),w.jsxs("div",{className:"max-w-5xl mx-auto grid md:grid-cols-2 gap-8",children:[w.jsxs("div",{children:[w.jsx("h3",{className:"text-xl font-semibold text-green-700 mb-2",children:"1. Take Self-Assessment Quizzes"}),w.jsxs("ul",{className:"list-disc ml-6 text-gray-700",children:[w.jsx("li",{children:"Short, validated mental health quizz"}),w.jsx("li",{children:"Track your scores and progress over time"}),w.jsx("li",{children:"Earn badges for regular check-ins"})]}),w.jsx("h3",{className:"text-xl font-semibold text-green-700 mt-6 mb-2",children:"2. Chat with AI or Join Peer Circles"}),w.jsxs("ul",{className:"list-disc ml-6 text-gray-700",children:[w.jsx("li",{children:"24/7 AI-powered therapist for quick support"}),w.jsx("li",{children:"Anonymous, moderated peer support groups"}),w.jsx("li",{children:"Crisis SOS button for emergencies"})]})]}),w.jsxs("div",{children:[w.jsx("h3",{className:"text-xl font-semibold text-pink-700 mb-2",children:"3. Women’s Health & Safety"}),w.jsxs("ul",{className:"list-disc ml-6 text-gray-700",children:[w.jsx("li",{children:"Domestic violence help center & discreet chat"}),w.jsx("li",{children:"Wellness tracker: mood, sleep, nutrition"}),w.jsx("li",{children:"Encrypted journaling with mood analysis"})]}),w.jsx("h3",{className:"text-xl font-semibold text-blue-700 mt-6 mb-2",children:"4. Men’s & Community Health"}),w.jsxs("ul",{className:"list-disc ml-6 text-gray-700",children:[w.jsx("li",{children:"Men’s mental health portal & mentorship"}),w.jsx("li",{children:"Tailored resources for under-served groups"})]})]})]})]}),w.jsxs("div",{className:"relative z-20 bg-white py-10 px-2 md:px-8",children:[w.jsxs("div",{className:"flex flex-col items-center mb-4",children:[w.jsx("span",{className:"bg-pink-100 text-pink-700 px-4 py-1 rounded-full text-xs font-semibold mb-2",children:"Why Choose Us"}),w.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-center mb-6",children:"why teleCure"})]}),w.jsxs("div",{className:"max-w-5xl mx-auto grid grid-cols-2 md:grid-cols-3 gap-4 md:gap-8",children:[w.jsxs("div",{className:"flex items-center space-x-3 bg-white rounded-lg shadow-sm p-3 md:p-4",children:[w.jsx(vm,{className:"h-7 w-7 text-blue-600 bg-blue-100 rounded-md p-1"}),w.jsxs("div",{children:[w.jsx("div",{className:"font-semibold text-sm md:text-base",children:"Quick Consultations"}),w.jsx("div",{className:"text-xs text-gray-500",children:"Get diagnosed and receive prescriptions in under minutes"})]})]}),w.jsxs("div",{className:"flex items-center space-x-3 bg-white rounded-lg shadow-sm p-3 md:p-4",children:[w.jsx(qG,{className:"h-7 w-7 text-green-600 bg-green-100 rounded-md p-1"}),w.jsxs("div",{children:[w.jsx("div",{className:"font-semibold text-sm md:text-base",children:"Secure Data Records"}),w.jsx("div",{className:"text-xs text-gray-500",children:"Your medical data is encrypted and stored securely on secure technology"})]})]}),w.jsxs("div",{className:"flex items-center space-x-3 bg-white rounded-lg shadow-sm p-3 md:p-4",children:[w.jsx(h2,{className:"h-7 w-7 text-purple-600 bg-purple-100 rounded-md p-1"}),w.jsxs("div",{children:[w.jsx("div",{className:"font-semibold text-sm md:text-base",children:"Expert Doctors"}),w.jsx("div",{className:"text-xs text-gray-500",children:"Access to qualified healthcare professionals 24/7"})]})]}),w.jsxs("div",{className:"flex items-center space-x-3 bg-white rounded-lg shadow-sm p-3 md:p-4",children:[w.jsx(OG,{className:"h-7 w-7 text-orange-600 bg-orange-100 rounded-md p-1"}),w.jsxs("div",{children:[w.jsx("div",{className:"font-semibold text-sm md:text-base",children:"Medicine Reminders"}),w.jsx("div",{className:"text-xs text-gray-500",children:"Never miss a dose with our smart medication reminder system"})]})]}),w.jsxs("div",{className:"flex items-center space-x-3 bg-white rounded-lg shadow-sm p-3 md:p-4",children:[w.jsx(BG,{className:"h-7 w-7 text-red-600 bg-red-100 rounded-md p-1"}),w.jsxs("div",{children:[w.jsx("div",{className:"font-semibold text-sm md:text-base",children:"Health Monitoring"}),w.jsx("div",{className:"text-xs text-gray-500",children:"Track your vital signs and health progress over time"})]})]}),w.jsxs("div",{className:"flex items-center space-x-3 bg-white rounded-lg shadow-sm p-3 md:p-4",children:[w.jsx(zG,{className:"h-7 w-7 text-pink-600 bg-pink-100 rounded-md p-1"}),w.jsxs("div",{children:[w.jsx("div",{className:"font-semibold text-sm md:text-base",children:"Preventive Care"}),w.jsx("div",{className:"text-xs text-gray-500",children:"Get personalized health tips and preventive care recommendations"})]})]})]})]}),w.jsxs("div",{className:"relative z-20 py-16 px-4",children:[w.jsx("div",{className:"absolute inset-0 w-full h-full z-0",style:{backgroundImage:`url(${O_e})`,backgroundSize:"cover",backgroundPosition:"center",filter:"brightness(0.7)"}}),w.jsx("div",{className:"absolute inset-0 bg-blue-900/60 z-0"}),w.jsxs("div",{className:"relative z-10",children:[w.jsx("h2",{className:"text-3xl font-bold text-center mb-2 text-white drop-shadow-lg",children:"How teleCure Patient Journey Works"}),w.jsx("p",{className:"text-center text-blue-100 mb-10",children:"Our platform connects you with doctors in three simple steps"}),w.jsxs("div",{className:"max-w-5xl mx-auto grid md:grid-cols-3 gap-8",children:[w.jsxs("div",{className:"bg-white/90 rounded-2xl shadow-lg p-8 flex flex-col items-center transition hover:shadow-2xl",children:[w.jsx("div",{className:"bg-blue-100 rounded-full p-4 mb-4",children:w.jsx(WG,{className:"h-8 w-8 text-blue-600"})}),w.jsx("h3",{className:"font-bold text-xl mb-2 text-gray-900 text-center",children:"Describe Symptoms"}),w.jsx("p",{className:"text-gray-600 text-center mb-4",children:"Share your symptoms and medical history through our secure platform"}),w.jsxs("div",{className:"flex items-center gap-2 bg-pink-50 rounded-full px-4 py-2 text-pink-700 text-sm font-medium",children:[w.jsx(vm,{className:"h-4 w-4"})," unlimited to yourself"]})]}),w.jsxs("div",{className:"bg-white/90 rounded-2xl shadow-lg p-8 flex flex-col items-center transition hover:shadow-2xl",children:[w.jsx("div",{className:"bg-purple-100 rounded-full p-4 mb-4",children:w.jsx(HG,{className:"h-8 w-8 text-purple-600"})}),w.jsx("h3",{className:"font-bold text-xl mb-2 text-gray-900 text-center",children:"AI Analysis"}),w.jsx("p",{className:"text-gray-600 text-center mb-4",children:"Our AI system analyzes your symptoms and medical records for preliminary assessment"}),w.jsxs("div",{className:"flex items-center gap-2 bg-pink-50 rounded-full px-4 py-2 text-pink-700 text-sm font-medium",children:[w.jsx(vm,{className:"h-4 w-4"})," 30 seconds"]})]}),w.jsxs("div",{className:"bg-white/90 rounded-2xl shadow-lg p-8 flex flex-col items-center transition hover:shadow-2xl",children:[w.jsx("div",{className:"bg-green-100 rounded-full p-4 mb-4",children:w.jsx(h2,{className:"h-8 w-8 text-green-600"})}),w.jsx("h3",{className:"font-bold text-xl mb-2 text-gray-900 text-center",children:"Doctor Review"}),w.jsx("p",{className:"text-gray-600 text-center mb-4",children:"A qualified doctor reviews your case and provides personalized treatment"}),w.jsxs("div",{className:"flex items-center gap-2 bg-pink-50 rounded-full px-4 py-2 text-pink-700 text-sm font-medium",children:[w.jsx(vm,{className:"h-4 w-4"})," 5-7 minutes"]})]})]})]})]}),w.jsxs("div",{className:"relative z-20 bg-blue-50 py-16 px-4",children:[w.jsx("h2",{className:"text-3xl font-bold text-center mb-8 text-blue-800",children:"Platform Features"}),w.jsxs("div",{className:"max-w-5xl mx-auto grid md:grid-cols-2 gap-8",children:[w.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[w.jsx("h4",{className:"font-bold text-lg mb-2 text-blue-700",children:"AI Symptom Triage Agent"}),w.jsx("p",{className:"text-gray-700 mb-2",children:"Describe your symptoms in plain language and get instant, AI-powered triage and recommendations."}),w.jsx(ym,{to:"/symptoms",children:w.jsx(In,{className:"bg-blue-700 text-white mt-2",children:"Try Now"})})]}),w.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[w.jsx("h4",{className:"font-bold text-lg mb-2 text-green-700",children:"Video Consults & e-Prescriptions"}),w.jsx("p",{className:"text-gray-700 mb-2",children:"Book video calls with doctors and receive e-prescriptions securely."}),w.jsx(In,{className:"bg-green-700 text-white mt-2",disabled:!0,children:"Coming Soon"})]}),w.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[w.jsx("h4",{className:"font-bold text-lg mb-2 text-pink-700",children:"Mental Wellness & Safety"}),w.jsx("p",{className:"text-gray-700 mb-2",children:"Access resources, track wellness, and get help discreetly when needed."}),w.jsx(ym,{to:"/mental-wellness",children:w.jsx(In,{className:"bg-blue-700 text-white mt-2",children:"Try Now"})})]}),w.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[w.jsx("h4",{className:"font-bold text-lg mb-2 text-yellow-700",children:"Community & Peer Support"}),w.jsx("p",{className:"text-gray-700 mb-2",children:"Join moderated support circles and connect with mentors."}),w.jsx(In,{className:"bg-yellow-700 text-white mt-2",disabled:!0,children:"Coming Soon"})]})]})]})]})}const Ir=[{id:"phq9",name:"Depression Screening",description:"A validated 9-question tool to screen for the presence and severity of depression.",questions:[{id:1,text:"Little interest or pleasure in doing things",scale:[0,1,2,3],labels:["Not at all","Several days","More than half the days","Nearly every day"]}]},{id:"gad7",name:"Anxiety Screening",description:"A 7-question screening tool for generalized anxiety disorder.",questions:[{id:1,text:"Feeling nervous, anxious, or on edge",scale:[0,1,2,3],labels:["Not at all","Several days","More than half the days","Nearly every day"]}]}],M_e=[{id:"anxiety",name:"Anxiety Support",description:"A safe space to discuss anxiety, share coping techniques, and support each other through challenging times.",members:248,nextMeeting:"Tomorrow, 7:00 PM",tags:["Anxiety","Stress","Coping Skills"],image:"https://th.bing.com/th/id/OIP._O4S2JO1BSUyLmhkH3XLZgHaEK?cb=iwc2&rs=1&pid=ImgDetMain"},{id:"depression",name:"Depression Recovery",description:"Connect with others who understand depression. Share experiences and strategies for managing symptoms.",members:312,nextMeeting:"Thursday, 6:30 PM",tags:["Depression","Mood","Self-Care"],image:"https://th.bing.com/th/id/OIP.2K_To1HeNnpIWFflqKkxPwHaJA?cb=iwc2&w=882&h=1073&rs=1&pid=ImgDetMain"},{id:"mindfulness",name:"Mindfulness Practice",description:"Learn and practice mindfulness techniques together. Open to beginners and experienced practitioners alike.",members:173,nextMeeting:"Saturday, 10:00 AM",tags:["Mindfulness","Meditation","Present Moment"],image:"https://th.bing.com/th/id/OIP.UtX0_UXLxAYlc7JqCwGN6gHaE0?cb=iwc2&rs=1&pid=ImgDetMain"}],L_e=[{id:"suicide-prevention",name:"National Suicide Prevention Lifeline",phone:"988",description:"Free and confidential support for people in distress, prevention and crisis resources.",hours:"24/7",website:"https://988lifeline.org/"},{id:"crisis-text",name:"Crisis Text Line",phone:"Text HOME to 741741",description:"Free crisis counseling via text message.",hours:"24/7",website:"https://www.crisistextline.org/"},{id:"domestic-violence",name:"National Domestic Violence Hotline",phone:"1-800-799-7233",description:"Advocates are available to talk to anyone experiencing domestic violence.",hours:"24/7",website:"https://www.thehotline.org/"}],V_e=({onClick:t})=>w.jsxs("div",{className:"relative",children:[w.jsx("div",{className:"absolute inset-0 rounded-full animate-ping bg-red-200 opacity-75"}),w.jsx("div",{className:"absolute inset-0 rounded-full animate-ping bg-red-300 opacity-75 animation-delay-300"}),w.jsx("button",{onClick:t,className:"relative bg-red-600 hover:bg-red-700 text-white font-bold py-6 px-6 rounded-full w-40 h-40 border-4 border-red-700 shadow-lg transform hover:scale-105 transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-red-500 focus:ring-opacity-50 z-10",children:w.jsxs("div",{className:"flex flex-col items-center justify-center",children:[w.jsx("span",{className:"text-3xl mb-1",children:"SOS"}),w.jsx("span",{className:"text-sm",children:"Emergency Help"})]})})]});function B_e(){var R,L,B,W,G,q,A,z;const[t,e]=M.useState(null),[n,s]=M.useState(0),[r,i]=M.useState({}),[o,a]=M.useState([{id:"1",sender:"bot",text:"Hi there! I'm your wellness assistant. How are you feeling today?",timestamp:new Date}]),[l,c]=M.useState(""),[u,d]=M.useState(!1),[h,f]=M.useState(!1),[p,m]=M.useState(!1),[y,g]=M.useState(null),x=P=>{e(P),s(0),i({})},v=(P,X)=>{i({...r,[P]:X});const te=Ir.find(se=>se.id===t);te&&n<te.questions.length-1&&s(n+1)},b=()=>{e(null),s(0),i({})},k=P=>{const X=P.toLowerCase();return X.includes("suicide")||X.includes("kill myself")||X.includes("want to die")?(f(!0),"I'm concerned about what you're sharing. It sounds like you're going through a really difficult time. I think it would be helpful to connect you with a trained professional who can provide better support."):X.includes("sad")||X.includes("depressed")?"I'm sorry to hear you're feeling down. Would you like to try a quick breathing exercise together, or perhaps I can suggest some mood-lifting activities?":X.includes("anxious")||X.includes("worried")?"Anxiety can be really challenging. Let's take a moment to ground ourselves. Can you name 5 things you can see right now? This can help bring you to the present moment.":"Thank you for sharing. Can you tell me more about what's on your mind today?"},C=()=>{if(!l.trim())return;const P={id:Date.now().toString(),sender:"user",text:l,timestamp:new Date};a(X=>[...X,P]),c(""),d(!0),setTimeout(()=>{const X={id:(Date.now()+1).toString(),sender:"bot",text:k(P.text),timestamp:new Date};a(te=>[...te,X]),d(!1)},1500)},S=P=>{P.key==="Enter"&&!P.shiftKey&&(P.preventDefault(),C())},I=()=>{navigator.geolocation.getCurrentPosition(P=>{g({lat:P.coords.latitude,lng:P.coords.longitude}),m(!0)},()=>{m(!0)})},N=P=>{window.location.href=`tel:${P.replace(/\D/g,"")}`},E=()=>{a(P=>[...P,{id:Date.now().toString(),sender:"bot",text:"I'm connecting you with a counselor now. Please stay on this page. A counselor will join this conversation shortly.",timestamp:new Date}]),f(!1)},D=["https://images.pexels.com/photos/3786157/pexels-photo-3786157.jpeg?auto=compress&cs=tinysrgb&w=1200","https://th.bing.com/th/id/OIP.aCFNQ4HBUV9RP00fm6tIwwHaEK?cb=iwc2&rs=1&pid=ImgDetMain","https://actionchange.org/wp-content/uploads/2019/10/pict_large-6.jpg","https://th.bing.com/th/id/OIP.UtX0_UXLxAYlc7JqCwGN6gHaE0?cb=iwc2&rs=1&pid=ImgDetMain"];return w.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-pink-50",children:[w.jsxs("div",{className:"relative overflow-hidden",children:[w.jsxs("div",{className:"absolute inset-0 w-full h-full grid grid-cols-2 grid-rows-2 z-0",children:[w.jsx("img",{src:D[0],alt:"Hero 1",className:"object-cover w-full h-full",style:{filter:"brightness(0.7)"}}),w.jsx("img",{src:D[1],alt:"Hero 2",className:"object-cover w-full h-full",style:{filter:"brightness(0.7)"}}),w.jsx("img",{src:D[2],alt:"Hero 3",className:"object-cover w-full h-full",style:{filter:"brightness(0.7)"}}),w.jsx("img",{src:D[3],alt:"Hero 4",className:"object-cover w-full h-full",style:{filter:"brightness(0.7)"}})]}),w.jsx("div",{className:"absolute inset-0 bg-black/40 z-10"}),w.jsxs("div",{className:"relative z-20 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24 md:py-32 flex flex-col items-center text-center",children:[w.jsxs("div",{className:"animate-fade-in-down",children:[w.jsx("h1",{className:"text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-6 tracking-tight",children:"Your Journey to Mental Wellness"}),w.jsx("p",{className:"text-xl md:text-2xl text-white/90 max-w-3xl mx-auto mb-8",children:"A safe space to assess, connect, and nurture your mental health. All resources are private and confidential."})]}),w.jsx("div",{className:"absolute bottom-5 left-1/2 transform -translate-x-1/2 w-full max-w-6xl grid grid-cols-1 md:grid-cols-3 gap-4 px-4"})]})]}),w.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-24",children:[w.jsxs("section",{id:"assessments",className:"py-12",children:[w.jsxs("div",{className:"text-center mb-12",children:[w.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Self-Assessment Quizzes"}),w.jsx("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:"Use these scientifically validated tools to check in with your mental health. Your results are private and stored securely to help track your progress."})]}),t?w.jsx("div",{className:"bg-white rounded-xl shadow-md p-8 max-w-3xl mx-auto",children:Object.keys(r).length===((R=Ir.find(P=>P.id===t))==null?void 0:R.questions.length)?w.jsxs("div",{className:"text-center",children:[w.jsxs("div",{className:"mb-6",children:[w.jsx(BarChart3,{className:"h-16 w-16 text-pink-600 mx-auto mb-4"}),w.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Assessment Complete"}),w.jsx("p",{className:"text-gray-600",children:"Thank you for completing the assessment. Your results have been saved."})]}),w.jsxs("div",{className:"bg-pink-50 rounded-lg p-6 mb-6",children:[w.jsx("h4",{className:"font-semibold text-pink-800 mb-2",children:"Your Score Summary"}),w.jsx("p",{className:"text-gray-700",children:"Based on your responses, your current score indicates mild symptoms. Remember that this is just a screening tool and not a diagnosis."})]}),w.jsx("button",{onClick:b,className:"bg-pink-600 hover:bg-pink-700 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-300",children:"Take Another Assessment"})]}):w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:"mb-8",children:[w.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:(L=Ir.find(P=>P.id===t))==null?void 0:L.name}),w.jsxs("p",{className:"text-gray-600",children:["Question ",n+1," of ",(B=Ir.find(P=>P.id===t))==null?void 0:B.questions.length]}),w.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-4",children:w.jsx("div",{className:"bg-pink-600 h-2 rounded-full transition-all duration-500",style:{width:`${(n+1)/(((W=Ir.find(P=>P.id===t))==null?void 0:W.questions.length)||1)*100}%`}})})]}),w.jsxs("div",{className:"mb-8",children:[w.jsx("h4",{className:"text-xl font-medium text-gray-800 mb-4",children:(q=(G=Ir.find(P=>P.id===t))==null?void 0:G.questions[n])==null?void 0:q.text}),w.jsx("div",{className:"space-y-3",children:(z=(A=Ir.find(P=>P.id===t))==null?void 0:A.questions[n])==null?void 0:z.scale.map((P,X)=>{var se,ce,ie,de;const te=(ce=(se=Ir.find(ge=>ge.id===t))==null?void 0:se.questions[n])==null?void 0:ce.labels;return w.jsx("button",{onClick:()=>{var ge,Ee;return v(((Ee=(ge=Ir.find(Te=>Te.id===t))==null?void 0:ge.questions[n])==null?void 0:Ee.id)||0,P)},className:`w-full text-left p-4 rounded-lg transition-all duration-200 ${r[((de=(ie=Ir.find(ge=>ge.id===t))==null?void 0:ie.questions[n])==null?void 0:de.id)||0]===P?"bg-pink-100 border-2 border-pink-500":"bg-gray-50 hover:bg-gray-100 border-2 border-transparent"}`,children:te&&te[X]},X)})})]}),w.jsxs("div",{className:"flex justify-between",children:[w.jsx("button",{onClick:b,className:"text-pink-600 hover:text-pink-800 font-medium transition-colors duration-300",children:"Cancel"}),n>0&&w.jsx("button",{onClick:()=>s(n-1),className:"text-pink-600 hover:text-pink-800 font-medium transition-colors duration-300",children:"Previous"})]})]})}):w.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto",children:Ir.map(P=>w.jsx("div",{className:"bg-white rounded-xl shadow-md overflow-hidden transform transition-all duration-300 hover:shadow-lg hover:-translate-y-1",children:w.jsxs("div",{className:"p-6",children:[w.jsxs("div",{className:"flex items-center mb-4",children:[w.jsx(LG,{className:"h-8 w-8 text-pink-600 mr-3"}),w.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:P.name})]}),w.jsx("p",{className:"text-gray-600 mb-6",children:P.description}),w.jsx("button",{onClick:()=>x(P.id),className:"w-full bg-pink-600 hover:bg-pink-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-300",children:"Start Assessment"})]})},P.id))})]}),w.jsxs("section",{id:"chatbot",className:"py-12",children:[w.jsxs("div",{className:"text-center mb-12",children:[w.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:"24/7 AI-Powered Support"}),w.jsx("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:"Our AI assistant is here to listen, provide coping strategies, and guide you through difficult moments. All conversations are private and encrypted."})]}),w.jsxs("div",{className:"max-w-3xl mx-auto bg-white rounded-2xl shadow-lg overflow-hidden",children:[w.jsx("div",{className:"bg-gradient-to-r from-pink-600 to-purple-600 p-4 text-white",children:w.jsxs("div",{className:"flex items-center",children:[w.jsx(d2,{className:"h-8 w-8 mr-3"}),w.jsxs("div",{children:[w.jsx("h3",{className:"font-semibold text-lg",children:"Wellness Assistant"}),w.jsx("p",{className:"text-sm opacity-90",children:"Always here to listen"})]})]})}),h&&w.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 m-4 rounded-md",children:w.jsxs("div",{className:"flex items-start",children:[w.jsx("div",{className:"flex-shrink-0",children:w.jsx("svg",{className:"h-5 w-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:w.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),w.jsxs("div",{className:"ml-3",children:[w.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Crisis Support Needed"}),w.jsx("div",{className:"mt-2 text-sm text-red-700",children:w.jsx("p",{children:"We've detected that you might need additional support right now."})}),w.jsx("div",{className:"mt-4",children:w.jsx("button",{onClick:E,className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-md text-sm transition-colors duration-300",children:"Connect with Live Counselor Now"})})]})]})}),w.jsxs("div",{className:"h-96 overflow-y-auto p-4 space-y-4",style:{scrollBehavior:"smooth"},children:[o.map(P=>w.jsx("div",{className:`flex ${P.sender==="user"?"justify-end":"justify-start"}`,children:w.jsxs("div",{className:`max-w-xs md:max-w-md rounded-lg p-3 ${P.sender==="user"?"bg-pink-100 text-gray-800 rounded-br-none":"bg-gray-100 text-gray-800 rounded-bl-none"}`,children:[w.jsxs("div",{className:"flex items-center mb-1",children:[P.sender==="bot"?w.jsx(d2,{className:"h-4 w-4 text-pink-600 mr-1"}):w.jsx(ox,{className:"h-4 w-4 text-blue-600 mr-1"}),w.jsx("span",{className:"text-xs text-gray-500",children:P.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),w.jsx("p",{className:"whitespace-pre-wrap",children:P.text})]})},P.id)),u&&w.jsx("div",{className:"flex justify-start",children:w.jsx("div",{className:"bg-gray-100 rounded-lg p-3 rounded-bl-none",children:w.jsxs("div",{className:"flex space-x-2",children:[w.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-0"}),w.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-150"}),w.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce delay-300"})]})})})]}),w.jsxs("div",{className:"border-t border-gray-200 p-4",children:[w.jsxs("div",{className:"flex items-center",children:[w.jsx("textarea",{value:l,onChange:P=>c(P.target.value),onKeyPress:S,className:"flex-1 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent resize-none",placeholder:"Type your message here...",rows:1}),w.jsx("button",{onClick:C,disabled:!l.trim()||u,className:`ml-3 rounded-full p-2 ${!l.trim()||u?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-pink-600 text-white hover:bg-pink-700"} transition-colors duration-300`,children:w.jsx(GG,{className:"h-5 w-5"})})]}),w.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Your conversations are private. If you're in immediate danger, please use the Crisis SOS button below."})]})]})]}),w.jsxs("section",{id:"support-circles",className:"py-12",children:[w.jsxs("div",{className:"text-center mb-12",children:[w.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Peer Support Circles"}),w.jsx("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:"Connect with others who understand what you're going through. All groups are moderated by mental health professionals to ensure a safe, supportive environment."})]}),w.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:M_e.map(P=>w.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden transform transition-all duration-300 hover:shadow-lg hover:-translate-y-1",children:[w.jsxs("div",{className:"h-48 w-full relative",children:[w.jsx("img",{src:P.image,alt:P.name,className:"w-full h-full object-cover"}),w.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 to-transparent flex items-end",children:w.jsxs("div",{className:"p-4 text-white",children:[w.jsx("h3",{className:"text-xl font-semibold",children:P.name}),w.jsxs("div",{className:"flex items-center mt-1",children:[w.jsx(KG,{className:"h-4 w-4 mr-1"}),w.jsxs("span",{className:"text-sm",children:[P.members," members"]})]})]})})]}),w.jsxs("div",{className:"p-5",children:[w.jsx("p",{className:"text-gray-600 mb-4",children:P.description}),w.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:P.tags.map((X,te)=>w.jsx("span",{className:"bg-pink-100 text-pink-800 text-xs px-3 py-1 rounded-full",children:X},te))}),w.jsxs("div",{className:"flex items-center text-gray-700 mb-4",children:[w.jsx(MG,{className:"h-4 w-4 mr-2 text-pink-600"}),w.jsxs("span",{className:"text-sm",children:["Next meeting: ",P.nextMeeting]})]}),w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("button",{className:"bg-pink-600 hover:bg-pink-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-300 flex items-center",children:[w.jsx(mP,{className:"h-4 w-4 mr-2"}),"Join Group"]}),w.jsxs("div",{className:"flex items-center text-gray-500 text-sm",children:[w.jsx(Mg,{className:"h-4 w-4 mr-1"}),w.jsx("span",{children:"Private"})]})]})]})]},P.id))}),w.jsxs("div",{className:"mt-12 text-center",children:[w.jsx("p",{className:"text-gray-600 mb-6",children:"Don't see a group that fits your needs?"}),w.jsx("button",{className:"bg-white border-2 border-pink-600 text-pink-600 hover:bg-pink-50 font-medium py-2 px-6 rounded-lg transition-colors duration-300",children:"Suggest a New Group"})]})]}),w.jsxs("section",{id:"crisis-sos",className:"py-12",children:[w.jsxs("div",{className:"text-center mb-10",children:[w.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Crisis SOS Button"}),w.jsx("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:"Immediate access to emergency services and crisis hotlines with one tap. Your location can be shared with emergency services if neede d (with your permission)."})]}),w.jsxs("div",{className:"max-w-lg mx-auto bg-white rounded-2xl shadow-lg overflow-hidden",children:[w.jsxs("div",{className:"bg-gradient-to-r from-red-500 to-red-700 p-6",children:[w.jsx("h3",{className:"text-white text-2xl font-bold mb-2",children:"One-Tap Emergency Access"}),w.jsx("p",{className:"text-white/90",children:"Press the SOS button to immediately access crisis resources and hotlines."})]}),w.jsxs("div",{className:"p-8 flex flex-col items-center",children:[w.jsx(V_e,{onClick:I}),w.jsx("p",{className:"mt-6 text-sm text-gray-500 text-center max-w-sm",children:"This button is for mental health crises. For medical emergencies, please dial your local emergency number (911 in the US)."})]})]}),p&&w.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:w.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[w.jsxs("div",{className:"bg-red-600 p-4 flex justify-between items-center",children:[w.jsx("h3",{className:"text-white text-xl font-bold",children:"Crisis Resources"}),w.jsx("button",{onClick:()=>m(!1),className:"text-white hover:text-red-100",children:w.jsx(qk,{className:"h-6 w-6"})})]}),y&&w.jsx("div",{className:"p-4 bg-blue-50 border-b border-blue-100",children:w.jsxs("div",{className:"flex items-start",children:[w.jsx(UG,{className:"h-5 w-5 text-blue-600 mt-0.5 mr-2 flex-shrink-0"}),w.jsxs("div",{children:[w.jsx("h4",{className:"font-medium text-blue-800",children:"Location Detected"}),w.jsx("p",{className:"text-sm text-blue-600",children:"Your approximate location has been detected. This can help find local resources."})]})]})}),w.jsxs("div",{className:"p-6 space-y-6",children:[w.jsxs("div",{className:"space-y-4",children:[w.jsx("h4",{className:"font-bold text-lg text-gray-800",children:"Emergency Hotlines"}),L_e.map(P=>w.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[w.jsx("h5",{className:"font-semibold text-gray-800",children:P.name}),w.jsx("p",{className:"text-gray-600 text-sm mb-3",children:P.description}),w.jsxs("div",{className:"flex flex-wrap gap-y-2 text-sm",children:[w.jsxs("div",{className:"flex items-center mr-6",children:[w.jsx(gP,{className:"h-4 w-4 text-red-600 mr-1"}),w.jsx("span",{children:P.phone})]}),w.jsxs("div",{className:"flex items-center",children:[w.jsx(DG,{className:"h-4 w-4 text-red-600 mr-1"}),w.jsx("span",{children:P.hours})]})]}),w.jsx("button",{onClick:()=>N(P.phone),className:"mt-3 bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg text-sm transition-colors duration-300 w-full",children:"Call Now"})]},P.id))]}),w.jsxs("div",{children:[w.jsx("h4",{className:"font-bold text-lg text-gray-800 mb-3",children:"Local Emergency Services"}),w.jsx("p",{className:"text-gray-600",children:"For immediate danger or life-threatening emergencies, please call your local emergency number."}),w.jsx("button",{onClick:()=>N("911"),className:"mt-3 bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg text-sm transition-colors duration-300",children:"Call 911 (US Emergency Services)"})]})]})]})})]})]}),w.jsx("footer",{className:"bg-black text-white mt-16",children:w.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-12",children:[w.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-8 mb-8",children:[w.jsxs("div",{className:"flex-1 max-w-xs",children:[w.jsxs("div",{className:"flex items-center mb-4",children:[w.jsx("img",{src:"https://i.postimg.cc/hjmyGVDp/fave.png",alt:"teleCure Logo",className:"h-10 w-10 mr-3 rounded"}),w.jsx("span",{className:"font-bold text-xl text-pink-200",children:"teleCure"})]}),w.jsx("p",{className:"text-blue-400 text-sm",children:"Bridging the gap between patients and healthcare professionals through technology."})]}),w.jsxs("div",{className:"flex flex-col items-start md:items-center",children:[w.jsx("h3",{className:"text-pink-200 font-medium mb-4",children:"Connect With Us"}),w.jsxs("div",{className:"flex space-x-4",children:[w.jsx("a",{href:"https://twitter.com/",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-pink-400 transition-colors duration-200","aria-label":"Twitter",children:w.jsx("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{d:"M22.46 6c-.77.35-1.6.58-2.47.69a4.3 4.3 0 0 0 1.88-2.37 8.59 8.59 0 0 1-2.72 1.04 4.28 4.28 0 0 0-7.29 3.9A12.13 12.13 0 0 1 3.1 4.9a4.28 4.28 0 0 0 1.32 5.71c-.7-.02-1.36-.21-1.94-.53v.05a4.28 4.28 0 0 0 3.43 4.19c-.33.09-.68.14-1.04.14-.25 0-.5-.02-.74-.07a4.29 4.29 0 0 0 4 2.98A8.6 8.6 0 0 1 2 19.54a12.13 12.13 0 0 0 6.56 1.92c7.88 0 12.2-6.53 12.2-12.2 0-.19 0-.37-.01-.56A8.7 8.7 0 0 0 24 4.59a8.48 8.48 0 0 1-2.54.7z"})})}),w.jsx("a",{href:"https://linkedin.com/",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-pink-400 transition-colors duration-200","aria-label":"LinkedIn",children:w.jsx("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{d:"M19 0h-14c-2.76 0-5 2.24-5 5v14c0 2.76 2.24 5 5 5h14c2.76 0 5-2.24 5-5v-14c0-2.76-2.24-5-5-5zm-11 19h-3v-9h3v9zm-1.5-10.29c-.97 0-1.75-.79-1.75-1.75s.78-1.75 1.75-1.75 1.75.79 1.75 1.75-.78 1.75-1.75 1.75zm13.5 10.29h-3v-4.5c0-1.08-.02-2.47-1.5-2.47-1.5 0-1.73 1.17-1.73 2.39v4.58h-3v-9h2.89v1.23h.04c.4-.76 1.38-1.56 2.85-1.56 3.05 0 3.61 2.01 3.61 4.62v4.71z"})})})]})]}),w.jsxs("div",{className:"flex flex-col items-start",children:[w.jsx("h3",{className:"text-pink-200 font-medium mb-4",children:"Quick Links"}),w.jsxs("nav",{className:"flex flex-col space-y-2",children:[w.jsx("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors duration-200 text-sm",children:"Home"}),w.jsx("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors duration-200 text-sm",children:"Services"}),w.jsx("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors duration-200 text-sm",children:"About Us"}),w.jsx("a",{href:"#",className:"text-gray-400 hover:text-white transition-colors duration-200 text-sm",children:"Contact"})]})]}),w.jsxs("div",{className:"flex flex-col items-start",children:[w.jsx("h3",{className:"text-pink-200 font-medium mb-4",children:"Contact"}),w.jsxs("address",{className:"not-italic text-gray-400 text-sm space-y-2",children:[w.jsx("p",{children:"123 Health St, Suite 100"}),w.jsx("p",{children:"Medical City, MC 12345"}),w.jsx("p",{children:"Phone: (123) 456-7890"}),w.jsx("p",{children:"Email: info@telecure.com"})]})]})]}),w.jsxs("div",{className:"border-t border-gray-800 pt-8",children:[w.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[w.jsxs("p",{className:"text-gray-500 text-sm mb-4 md:mb-0",children:["© ",new Date().getFullYear()," teleCure. All rights reserved."]}),w.jsxs("div",{className:"flex space-x-6",children:[w.jsx("a",{href:"#",className:"text-gray-500 hover:text-white transition-colors duration-200 text-sm",children:"Privacy Policy"}),w.jsx("a",{href:"#",className:"text-gray-500 hover:text-white transition-colors duration-200 text-sm",children:"Terms of Service"}),w.jsx("a",{href:"#",className:"text-gray-500 hover:text-white transition-colors duration-200 text-sm",children:"Cookies"})]})]}),w.jsx("p",{className:"text-center text-gray-600 text-xs mt-4",children:"Made with ❤️ by the teleCure team"})]})]})})]})}const z_e=void 0;console.error("❌ OpenAI API key is missing in environment variables.");const U_e=async t=>{var e,n;try{return((n=(e=(await Yt.post("https://api.deepseek.com",{model:"gpt-4",messages:[{role:"system",content:"You are a helpful and responsible AI medical assistant. Provide accurate answers and remind users you're not a licensed doctor."},{role:"user",content:t}],temperature:.5},{headers:{Authorization:`Bearer ${z_e}`,"Content-Type":"application/json"}})).data.choices[0])==null?void 0:e.message)==null?void 0:n.content)||"No response from AI."}catch(s){return console.error("❌ Error calling OpenAI:",s),"Sorry, I couldn't process your question. Please try again later."}},LA=()=>{const[t,e]=M.useState(!1),[n,s]=M.useState(""),[r,i]=M.useState(""),o=async()=>{if(n.trim())try{const a=await U_e(n);i(a),s("")}catch(a){console.error("Error asking question:",a),i("Sorry, something went wrong. Please try again.")}};return w.jsxs(w.Fragment,{children:[w.jsx("button",{onClick:()=>e(!t),style:{position:"fixed",bottom:"1.5rem",left:"1.5rem",backgroundColor:"#10b981",color:"white",borderRadius:"50%",width:"56px",height:"56px",fontSize:"24px",border:"none",cursor:"pointer",zIndex:3e3},"aria-label":"Toggle Medical Chatbot",children:"🏥"}),t&&w.jsxs("div",{style:{position:"fixed",bottom:"5.5rem",left:"1.5rem",width:"300px",backgroundColor:"white",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.2)",padding:"1rem",zIndex:2e3},children:[w.jsx("h3",{style:{marginBottom:"0.5rem"},children:"TeleCure AI Assistant"}),w.jsx("textarea",{placeholder:"Ask a health question...",value:n,onChange:a=>s(a.target.value),rows:3,style:{width:"100%",borderRadius:"6px",padding:"0.5rem",border:"1px solid #ccc",resize:"none",marginBottom:"0.5rem"}}),w.jsx("button",{onClick:o,style:{width:"100%",padding:"0.5rem",backgroundColor:"#10b981",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold"},children:"Ask"}),r&&w.jsxs("div",{style:{marginTop:"0.75rem",whiteSpace:"pre-wrap"},children:[w.jsx("strong",{children:"AI:"}),w.jsx("p",{children:r})]})]})]})};function VA({children:t}){return wf(n=>n.isAuthenticated)?w.jsx(w.Fragment,{children:t}):w.jsx(N6,{to:"/register"})}function j_e(){const t=wf(e=>e.isAuthenticated);return w.jsx(F6,{children:w.jsxs("div",{className:"min-h-screen bg-gray-50",children:[w.jsx(l8,{}),w.jsx("main",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-12",children:w.jsxs($6,{children:[w.jsx(_o,{path:"/",element:w.jsx(F_e,{})}),w.jsx(_o,{path:"/login",element:w.jsx(c8,{})}),w.jsx(_o,{path:"/register",element:w.jsx(sZ,{})}),w.jsx(_o,{path:"/mental-wellness",element:w.jsx(B_e,{})}),w.jsx(_o,{path:"/healthbot",element:w.jsx(LA,{})}),w.jsx(_o,{path:"/symptoms",element:w.jsx(VA,{children:w.jsx(xSe,{})})}),w.jsx(_o,{path:"/payment",element:w.jsx(VA,{children:w.jsx(JIe,{amount:50,onSuccess:()=>{}})})})]})}),t&&w.jsx(R_e,{}),t&&w.jsx(LA,{})," ",w.jsx($G,{position:"top-right"}),w.jsx(D_e,{})]})})}QD(document.getElementById("root")).render(w.jsx(M.StrictMode,{children:w.jsx(j_e,{})}));
